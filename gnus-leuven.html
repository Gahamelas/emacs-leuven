<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta name="generator" content="HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />
<title>Gnus Leuven Config</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Org-mode" />
<meta name="author" content="Fabrice Niessen" />
<meta name="keywords" content="emacs, gnus, dotfile, config" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/bigblow.css" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css" />
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js">
</script>
</head>
<body>
<div id="content">
<h1 class="title">Gnus Leuven Config</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Overview</a></li>
<li><a href="#sec-2">Header</a></li>
<li><a href="#sec-3">Loading Libraries of Lisp Code for Emacs</a></li>
<li><a href="#sec-4">Starting Up Gnus</a>
<ul>
<li><a href="#sec-4-1">Finding the News</a></li>
<li><a href="#sec-4-2">New Groups</a></li>
<li><a href="#sec-4-3">Startup Files</a></li>
<li><a href="#sec-4-4">Auto Save</a></li>
<li><a href="#sec-4-5">Active File</a></li>
</ul>
</li>
<li><a href="#sec-5">Group Buffer</a>
<ul>
<li><a href="#sec-5-1">Group Buffer Format</a></li>
<li><a href="#sec-5-2">Selecting a Group</a></li>
<li><a href="#sec-5-3">Exiting Gnus</a></li>
<li><a href="#sec-5-4">Group Topics</a></li>
<li><a href="#sec-5-5">Misc Group Stuff</a></li>
</ul>
</li>
<li><a href="#sec-6">Summary buffer</a>
<ul>
<li><a href="#sec-6-1">Summary Buffer Format</a></li>
<li><a href="#sec-6-2">Paging the Article</a></li>
<li><a href="#sec-6-3">Reply, Followup and Post</a></li>
<li><a href="#sec-6-4">Marking Articles</a></li>
<li><a href="#sec-6-5">Threading</a></li>
<li><a href="#sec-6-6">Sorting the Summary Buffer</a></li>
<li><a href="#sec-6-7">Article Caching</a></li>
<li><a href="#sec-6-8">Article Treatment</a></li>
<li><a href="#sec-6-9">MIME Commands</a></li>
<li><a href="#sec-6-10">Charsets</a></li>
<li><a href="#sec-6-11">Various Summary Stuff</a>
<ul>
<li><a href="#sec-6-11-1">Gnus Stripes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-7">Article Buffer</a>
<ul>
<li><a href="#sec-7-1">Hiding headers</a></li>
</ul>
</li>
<li><a href="#sec-8">Emacs MIME</a>
<ul>
<li><a href="#sec-8-1">Decoding and Viewing</a></li>
<li><a href="#sec-8-2">Non-MIME</a></li>
<li><a href="#sec-8-3">Display Customization</a></li>
<li><a href="#sec-8-4">Composing</a></li>
<li><a href="#sec-8-5">Basic Functions</a></li>
</ul>
</li>
<li><a href="#sec-9">Back to Article Buffer</a></li>
<li><a href="#sec-10">Composing Messages</a>
<ul>
<li><a href="#sec-10-1">Mail</a></li>
<li><a href="#sec-10-2">Posting Server</a></li>
<li><a href="#sec-10-3">Archived Messages</a></li>
<li><a href="#sec-10-4">Posting Styles</a>
<ul>
<li><a href="#sec-10-4-1">Multiple servers</a></li>
<li><a href="#sec-10-4-2">Headers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-11">Message</a>
<ul>
<li><a href="#sec-11-1">Interface</a></li>
<li><a href="#sec-11-2">Commands</a></li>
<li><a href="#sec-11-3">Variables</a></li>
</ul>
</li>
<li><a href="#sec-12">Select Methods</a>
<ul>
<li><a href="#sec-12-1">Getting News</a></li>
<li><a href="#sec-12-2">Getting Mail</a></li>
<li><a href="#sec-12-3">Browsing the Web</a></li>
<li><a href="#sec-12-4">IMAP</a></li>
<li><a href="#sec-12-5">Gnus Unplugged</a></li>
</ul>
</li>
<li><a href="#sec-13">Scoring</a>
<ul>
<li><a href="#sec-13-1">From Sacha Chua</a></li>
</ul>
</li>
<li><a href="#sec-14">Searching</a></li>
<li><a href="#sec-15">Various</a>
<ul>
<li><a href="#sec-15-1">Interactive</a></li>
<li><a href="#sec-15-2">Formatting Variables</a></li>
<li><a href="#sec-15-3">Window Layout</a></li>
<li><a href="#sec-15-4">Interaction with other modes</a></li>
<li><a href="#sec-15-5">Various Various</a></li>
</ul>
</li>
<li><a href="#sec-16">Appendices</a>
<ul>
<li><a href="#sec-16-1">History</a></li>
<li><a href="#sec-16-2">Frequently Asked Questions</a></li>
<li><a href="#sec-16-3">Feature</a></li>
<li><a href="#sec-16-4">File Local Variables</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Overview</h2>
<div class="outline-text-2" id="text-1">
<p>See <a href="http://www.gnu.org/software/emacs/manual/gnus.html">http://www.gnu.org/software/emacs/manual/gnus.html</a></p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Header</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="current-time">
(format-time-string "%Y%m%d.%H%M")
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;; gnus-leuven.el --- my Gnus config file

;; Copyright (C) 2004-2015 Fabrice Niessen

;; Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;
;; URL: https://github.com/fniessen/emacs-leuven-theme
;; Version: 20150505.2250
;; Keywords: emacs, gnus, dotfile, config
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;
;;    __ _ _ __  _   _ ___
;;   / _` | '_ \| | | / __|
;;  | (_| | | | | |_| \__ \
;; (_)__, |_| |_|\__,_|___/
;;   |___/

;; This file is NOT part of GNU Emacs.

;; This program is free software: you can redistribute it and/or
;; modify it under the terms of the GNU General Public License as
;; published by the Free Software Foundation, either version 3 of
;; the License, or (at your option) any later version.
;;
;; This program is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
;; GNU General Public License for more details.
;;
;; You should have received a copy of the GNU General Public License
;; along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.

;;; Commentary:

;;** Help
;;
;; For help on The Gnus Newsreader, see:
;;     (info "(gnus)")  &lt;== C-x C-e here!
;;
;;** BUG
;;
;; Updating info for nnimap does not occurr for group INBOX (well for
;; subgroups) - i.e., mail GCc'ed to INBOX is lost...

;; http://www.emacswiki.org/emacs/GnusTutorial

;; Disconnected from IMAP? In the `*Server*' buffer, hit 'C' to close the
;; server and then 'O' to reopen it.

;; "You should byte-compile Gnus" because the function `gnus' isn't
;; byte-compiled. Check `M-x locate-library RET gnus RET' if it picks up the
;; .el or .elc file.
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;; Code:

;; This file is only provided as an example. Customize it to your own taste!
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(message "* Load Gnus Leuven")

;;* Loading

(require 'gnus)

;; list of packages that `try-require' can't find
(setq leuven--missing-packages nil)
</pre></div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Loading Libraries of Lisp Code for Emacs</h2>
<div class="outline-text-2 org-src-container" id="text-3">
<pre class="src src-emacs-lisp">
  ;; Require a feature/library if available; if not, fail silently.
  (unless (fboundp 'try-require)
    (defun try-require (feature)
      "Attempt to load a FEATURE (or library).
    Return true if the library given as argument is successfully loaded.  If
    not, just print a message."
      (condition-case err
          (progn
            (if (stringp feature)
                (load-library feature)
              (require feature))
            t)                          ; Necessary for correct behavior in
                                        ; conditional expressions.
        (file-error
         (message "Requiring `%s'... missing" feature)
         nil))))
</pre></div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Starting Up Gnus</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(setq gnus-directory "~/.gnus.d/")      ; XXX
</pre></div>
<p>If you're running a recent Emacs, look into the EPA library to encrypt your <code>.authinfo</code> file.</p>
<p>See <a href="http://www.emacswiki.org/emacs/GnusEncryptedAuthInfo">http://www.emacswiki.org/emacs/GnusEncryptedAuthInfo</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;* 1 (info "(gnus)Starting Up") Gnus

  (message "1 Starting Gnus...")

  ;; support for `.authinfo' file
  (when (try-require 'auth-source)

    ;; log debug messages
    (setq auth-source-debug t))
</pre></div>
<div class="note">
<p>Richard Stallman &lt;rms@gnu.org&gt; writes:</p>
<p>&gt; <a href="http://www.theguardian.com/technology/2014/sep/29/londoners-wi-fi-security-herod-clause">http://www.theguardian.com/technology/2014/sep/29/londoners-wi-fi-security-herod-clause</a> &gt; &gt; says that POP3 passwords are sometimes transmitted in plain text. &gt; &gt; Is plaintext transmission of passwords inherent in POP3 &gt; or is it optional?</p>
<p>Modern pop3 servers support STARTTLS, and Emacs will upgrade to a TLS connection whenever the server supports it. (If you have an Emacs compiled with gnutls support, but I would guess that almost all Emacs instances has that.)</p>
<p>Virtually all the Emacs network transports that I know of will upgrade to TLS opportunistically, if the servers allow it, so Emacs should send no passwords unencrypted.</p>
<p>The only exceptions are HTTP and IRC, unless the latter has been fixed lately. And there are hopefully nobody who does a login that matters over HTTP.</p>
</div>
</div>
<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Finding the News</h3>
<div class="outline-text-3" id="text-4-1">
<p>Download and <b>install</b> of <a href="http://www.gnu.org/software/gnutls/">GnuTLS library</a> may be required.</p>
<p>Go to <a href="http://schwarzvogel.de/ssl_tls_testing.shtml">Testing SSL and TLS services</a> to test the <b>opening of TLS connections</b>.</p>
<p>Setting the following right is the only thing really required! The rest is customization.</p>
<div class="note">
<p>The account label allows for multiple accounts on the same server (see <code>.authinfo</code> for logins).</p>
</div>
<div class="note">
<p>The groups in the gnus-select-method don't get a prefix like "nnimap". Nice!</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 1.1 (info "(gnus)Finding the News")

  (if (equal (system-name) "MUNDANEUM") ; private config

      ;; Configure incoming mail.
      (setq gnus-select-method
            '(nnimap "mail"
                     (nnimap-address "mail")
                     (nnimap-server-port 993)
                     (nnimap-stream ssl)
                     ;; (nnimap-split-methods default) ; &lt;&lt; ABSOLUTELY NEEDED
                     (nnimap-split-methods nnimap-split-fancy) ; &lt;&lt;&lt; NOT QUOTED!!!
                     ;;                        ; XXX when (try-require 'bbdb-gnus)...
                     ))

    (setq gnus-select-method '(nnnil "")))

  ;; ;; Allow "hostname NOT matched" in the server certificate.
  ;; (setq starttls-extra-arguments '("--insecure"))
  ;;                                   ;! Not used in an Emacs 24 with built-in
  ;;                                   ;! gnutls support.

  ;; Using Gnus for news.
  (setq gnus-secondary-select-methods
        '((nntp "gmane"
                (nntp-address "news.gmane.org"))
          (nntp "eternal-september"
                (nntp-address "news.eternal-september.org"))))

  ;; Required when posting to an authenticated news server.
  (add-hook 'nntp-server-opened-hook 'nntp-send-authinfo)
</pre></div>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">New Groups</h3>
<div class="outline-text-3" id="text-4-2">
<p>Finding new newsgroups is done:</p>
<ul class="org-ul">
<li>at startup (if <code>gnus-check-new-newsgroups</code> is non-nil) or</li>
<li>by using the function <code>gnus-find-new-newsgroup</code>.</li>
</ul>
<p>You can always subscribe to the new groups just by pressing <code>U</code> in the group buffer.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 1.4 (info "(gnus)New Groups")

  ;; Gnus will not check for new newsgroups at startup
  (setq gnus-check-new-newsgroups nil)
  ;; save you some time at startup and when you do the `g' command

  ;; don't save the list of killed groups
  ;; WARNING As Gnus has no record of which groups are new and which are
  ;; old, the automatic new newsgroups subscription methods becomes
  ;; meaningless
  (setq gnus-save-killed-list nil)

  ;; make all new groups that come from mail back-ends subscribed
  (setq gnus-auto-subscribed-groups
        "^nnml\\|^nnimap")
</pre></div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Startup Files</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 1.6 (info "(gnus)Startup Files")

  ;; don't save a `.newsrc' file (for using other newsreaders) on exit
  (setq gnus-save-newsrc-file nil)  ; speed-up

  ;; ignore the `.newsrc' file
  (setq gnus-read-newsrc-file nil)  ; speed-up

  ;; my `.newsrc' file (and the derived .el/.eld files)
  (setq gnus-startup-file (concat gnus-directory ".newsrc"))
</pre></div>
<p>To stop the repetitive (and growing) "nntp read" messages, ensure you subscribe to at least one group for every NNTP server. You can even unsubscribe directly afterward…</p>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Auto Save</h3>
<div class="outline-text-3 org-src-container" id="text-4-4">
<pre class="src src-emacs-lisp">
;;** 1.7 (info "(gnus)Auto Save")

  ;; enable showing of [Gmail]/* groups
  (setq gnus-ignored-newsgroups "")

  ;; unconditionally read the dribble file
  (setq gnus-always-read-dribble-file t)
</pre></div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">Active File</h3>
<div class="outline-text-3 org-src-container" id="text-4-5">
<pre class="src src-emacs-lisp">
;;** 1.8 (info "(gnus)The Active File")

  ;;  Gnus will only know about the groups in my `.newsrc' file
  (setq gnus-read-active-file nil)  ; speed-up

  (message "1 Starting Gnus... Done")
</pre></div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Group Buffer</h2>
<div class="outline-text-2 org-src-container" id="text-5">
<pre class="src src-emacs-lisp">
;;* 2 (info "(gnus)The Group Buffer")

  (message "2 Group Buffer...")
</pre></div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Group Buffer Format</h3>
<div class="outline-text-3 org-src-container" id="text-5-1">
<pre class="src src-emacs-lisp">
;;** 2.1 (info "(gnus)Group Buffer Format")

  (defun gnus-user-format-function-y (headers)
    "Return string for count of unread articles."
    (if (&gt; (string-to-number gnus-tmp-number-of-unread) 0)
        (concat gnus-tmp-number-of-unread " Unread")
      ""))

  (defun gnus-user-format-function-U (headers)
    "Return string for count of unseen articles."
    (if (&gt; (gnus-number-of-unseen-articles-in-group gnus-tmp-group) 0)
        ;; found in gnus-group.el
        (concat (int-to-string
                 (gnus-number-of-unseen-articles-in-group
                  gnus-tmp-group)) " Unseen")
      ""))

  (defun gnus-user-format-function-T (headers)
    "Return string for count of ticked articles."
    (if (&gt; (gnus-range-length (cdr (assq 'tick gnus-tmp-marked))) 0)
        (concat (int-to-string
                 (gnus-range-length (cdr (assq 'tick gnus-tmp-marked))))
                " Ticked")
      ""))

  ;; create some faces
  (defface leuven-gnus-unseen '((t (:weight normal :foreground "#FC7202")))
    "Face for count of unread articles.")
  ;; (defface leuven-gnus-total '((t (:foreground "#2EAE2C")))
  ;;   "Face for size of article in summary buffer.")

  (setq gnus-face-1 'gnus-summary-normal-ticked)
  (setq gnus-face-2 'gnus-summary-normal-unread)
  (setq gnus-face-3 'leuven-gnus-unseen)
  ;; (setq gnus-face-4 'leuven-gnus-total)

  ;; format of the group buffer
  (setq gnus-group-line-format (concat "%1{%M%}"
                                       "%2{%m%}"
                                       "  "
                                       "%(%-42,42g%) "
                                       "%2{%10uy%} "
                                       "%3{%10uU%} "
                                       "%1{%10uT%} "
                                       ;; "%4{%6t Total%}"
                                       "\n"))
</pre></div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">Selecting a Group</h3>
<div class="outline-text-3 org-src-container" id="text-5-2">
<pre class="src src-emacs-lisp">
;;** 2.3 (info "(gnus)Selecting a Group")

  ;; no groups are considered big (&gt; 200 articles)
  (setq gnus-large-newsgroup nil)
</pre></div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">Exiting Gnus</h3>
<div class="outline-text-3" id="text-5-3">
<p>Cleanup all Gnus buffers on exit.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 2.15 (info "(gnus)Exiting Gnus")

  ;; quit Gnus properly, if it is running ...
  (defun exit-gnus ()
    "Save and exit Gnus."
    (if (and (fboundp 'gnus-group-exit)
             (gnus-alive-p))
        (with-current-buffer (get-buffer "*Group*")
          (let (gnus-interactive-exit)
            (gnus-group-exit)))))

  ;; ... before exiting Emacs (not leaving auto-save files around)
  (add-hook 'kill-emacs-hook 'exit-gnus)
</pre></div>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">Group Topics</h3>
<div class="outline-text-3 org-src-container" id="text-5-4">
<pre class="src src-emacs-lisp">
;;** 2.16 (info "(gnus)Group Topics")

  ;; permanently enable the topic mode
  (add-hook 'gnus-group-mode-hook 'gnus-topic-mode)

  ;; remove the binding of `C-c C-x', used by Org clocking commands
  (add-hook 'gnus-topic-mode-hook
            (lambda ()
              (define-key gnus-topic-mode-map
                (kbd "C-c C-x") nil)))
</pre></div>
</div>
<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">Misc Group Stuff</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 2.17 (info "(gnus)Misc Group Stuff")

  (defface highlight-line-gnus
    '((t (:background "#DAEAFC")))
    "Face for highlighting the current line with `highlight-line-gnus'."
    :group 'hl-line)

  (defun leuven--hl-line-highlight ()
    "Enable line highlighting in the current buffer."
    (set (make-local-variable 'hl-line-face) 'highlight-line-gnus)
    (hl-line-mode 1))

  ;; highlight current line in group buffer
  (add-hook 'gnus-group-mode-hook 'leuven--hl-line-highlight)

  ;; jump to the first group with unread articles, after getting new news
  (add-hook 'gnus-after-getting-new-news-hook
            'gnus-group-first-unread-group)

  ;; keep track of when I last read a group
  (add-hook 'gnus-select-group-hook 'gnus-group-set-timestamp)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; turn off the column number in the group buffer, and remove the binding
  ;; of `C-c C-x', used by Org clocking commands
  (add-hook 'gnus-group-mode-hook
            (lambda ()
              (progn
                (set (make-local-variable 'column-number-mode) nil)
                (define-key gnus-group-mode-map
                  (kbd "C-c C-x") nil))))

  (message "2 Group Buffer... Done")
</pre></div>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Summary buffer</h2>
<div class="outline-text-2 org-src-container" id="text-6">
<pre class="src src-emacs-lisp">
;;* 3 (info "(gnus)The Summary Buffer")

  (message "3 Summary Buffer...")
</pre></div>
<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Summary Buffer Format</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 3.1 (info "(gnus)Summary Buffer Format")
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; auxiliary summary mode commands for Gnus
  ;; http://theotp1.physik.uni-ulm.de/~ste/comp/emacs/gnus/rs-gnus-summary.el
  (when (try-require 'rs-gnus-summary-XXX)

    ;; summary line indicators
    (setq rs-gnus-summary-line-content-type-alist
          '((".*" " ")
            ("^multipart/mixed" "@")))

    ;; display `@' for message with attachment in summary line
    (defalias 'gnus-user-format-function-attachment
      'rs-gnus-summary-line-content-type)

    ;; alias for the score function:
    (defalias 'gnus-user-format-function-score
      'rs-gnus-summary-line-score))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; date format depending on age of article
  (setq gnus-user-date-format-alist ;; `user-date'
        '(((gnus-seconds-today) . "Today, %H:%M")
          ((+ 86400 (gnus-seconds-today)) . "Yesterday, %H:%M")
          (604800 . "%A, %H:%M")
          ((gnus-seconds-month) . "%d %a %H:%M")
          ((gnus-seconds-year) . "%m-%d %a %H:%M")
          (t . "%Y-%m-%d %a %H:%M")))

  ;; create some faces
  (defface leuven-gnus-date '((t (:foreground "#FF80BF")))
    "Face for date in summary buffer.")
 (defface leuven-gnus-size '((t (:foreground "#8FBF60")))
    "Face for size of article in summary buffer.")

  (setq gnus-face-7 'gnus-summary-high-unread)
  (setq gnus-face-8 'leuven-gnus-date)
  (setq gnus-face-9 'leuven-gnus-size)

  ;; format specification of the lines in the summary buffer
  (setq gnus-summary-line-format
        ;; for the record, the default string is
        ;; `%U%R%z%I%(%[%4L: %-20,20n%]%) %s\n'
        (concat
         "%U"                           ; "read" status
         "%3{%R%}"                      ; "reply" status
         "%7{%z%} "                     ; score
         "%8{%~(pad-left 20)&amp;user-date; %} " ; date
         "%9{ %4k %}"                   ; size
         "%*" "%-15,15f "               ; cursor before name of the poster
         ;; (if (boundp 'rs-gnus-summary-line-content-type-alist)
         ;;     "%u&amp;attachment; ")
         "%u&amp;r;  "
         "%B"
         "%I%s"
         "\n"))

  ;; string indicating that the current article has the same subject as the
  ;; previous
  (setq gnus-summary-same-subject "")

  ;; strings indicating that the current article has the same subject as the
  ;; previous
  (if (char-displayable-p ?\u2514)      ; box drawings
      (progn                            ; tree layout using Unicode characters
        (setq gnus-sum-thread-tree-root "")
        (setq gnus-sum-thread-tree-false-root "")
        (setq gnus-sum-thread-tree-single-indent "")
        (setq gnus-sum-thread-tree-indent "    ")
        (setq gnus-sum-thread-tree-vertical "│   ")
        (setq gnus-sum-thread-tree-leaf-with-other "├───")
        (setq gnus-sum-thread-tree-single-leaf "└───"))
    (progn                              ; tree layout using ASCII characters
      (setq gnus-sum-thread-tree-root "")
      (setq gnus-sum-thread-tree-false-root "")
      (setq gnus-sum-thread-tree-single-indent "")
      (setq gnus-sum-thread-tree-indent "    ")
      (setq gnus-sum-thread-tree-vertical "|   ")
      (setq gnus-sum-thread-tree-leaf-with-other "+---")
      (setq gnus-sum-thread-tree-single-leaf "+---"))) ; "`---"

  (with-eval-after-load "message"
    ;; regexp matching alternative email addresses
    (setq message-alternative-emails
          (concat
           (regexp-quote "johndoe@example.com") "\\|"
           (regexp-quote "janedoe@example.com")))

    ;; `From' headers that may be suppressed in favor of `To' headers
    (setq gnus-ignored-from-addresses
          (concat
           (regexp-quote user-mail-address) "\\|" message-alternative-emails)))

  ;; extra headers to parse (to check when matching recipients)
  (when (boundp 'nnmail-extra-headers)
    (add-to-list 'nnmail-extra-headers 'Cc))

  (defun leuven-gnus-count-recipients (header)
    "Given a Gnus message header, returns priority mark.
  If I am the only recipient, return \"!\".
  If I am one of the recipients listed in To:, return \"T\".
  If I am one of a few recipients, return \"C\".
  If I am one of many recipients, return \"*\".
  Else, return \" \"."
    (let* ((to (or (cdr (assoc 'To (mail-header-extra header))) ""))
           (cc (or (cdr (assoc 'Cc (mail-header-extra header))) "")))
      (cond
       ((and (string-match gnus-ignored-from-addresses to)
             (fboundp 'bbdb-split))
        (let ((len (length (bbdb-split to ","))))
          (cond
           ((= len 1) "»")
           (t "T"))))
       ((and (string-match gnus-ignored-from-addresses (concat to ", " cc))
             (fboundp 'bbdb-split))
        (if (&lt; (length (bbdb-split (concat to ", " cc) ",")) 5)
            ;; number of recipients to consider as large
            "C"
          "*"))
       (t " "))))

  (defalias 'gnus-user-format-function-r 'leuven-gnus-count-recipients)

  ;; format specification for the summary mode line
  (setq gnus-summary-mode-line-format "%V: %%b")
</pre></div>
</div>
</div>
<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">Paging the Article</h3>
<div class="outline-text-3 org-src-container" id="text-6-2">
<pre class="src src-emacs-lisp">
;;** 3.4 (info "(gnus)Paging the Article")

  ;; added some key bindings to the gnus summary mode
  (define-key gnus-summary-mode-map
    (kbd "&lt;M-up&gt;") '(lambda () (scroll-other-window -1)))

  (define-key gnus-summary-mode-map
    (kbd "&lt;M-down&gt;") '(lambda () (scroll-other-window 1)))
</pre></div>
</div>
<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">Reply, Followup and Post</h3>
<div class="outline-text-3" id="text-6-3">
<p>Messages posted via Usenet do not show up in the Emacs bug tracker. Avoid to forget about this programmatically!</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 3.5 (info "(gnus)Reply Followup and Post")

  (defun leuven-gnus-summary-followup-with-original ()
    "Force sending messages to `gnu.emacs.bug' per email."
    (interactive)
    (if (string-match (rx "gnu.emacs.bug") gnus-newsgroup-name)
                                        ; answer per email
        (call-interactively 'gnus-summary-wide-reply-with-original)
                                        ; post via news
      (call-interactively 'gnus-summary-followup-with-original)))

  (with-eval-after-load "gnus-sum"
    (define-key gnus-summary-mode-map
      (kbd "F") 'leuven-gnus-summary-followup-with-original))
</pre></div>
<p>Source: Michael Heerdegen.</p>
</div>
</div>
<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4">Marking Articles</h3>
<div class="outline-text-3" id="text-6-4">
<p><a href="https://github.com/cofi/dotfiles/blob/master/gnus.el">https://github.com/cofi/dotfiles/blob/master/gnus.el</a></p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check that every mark is displayable in the current font</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (when (char-displayable-p ?\u2691)
    (setq gnus-ticked-mark ?⚑))

  (when (char-displayable-p ?\u2690)
    (setq gnus-dormant-mark ?⚐))

  (when (char-displayable-p ?\u2709)
    (setq gnus-unread-mark ?✉))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (when (char-displayable-p ?\u2717)
    (setq gnus-del-mark ?✗))

  (when (char-displayable-p ?\u2713)
    (setq gnus-read-mark ?✓))

  (setq gnus-ancient-mark ? ))

  (when (char-displayable-p ?\u2620)
    (setq gnus-killed-mark ?☠))

  (when (char-displayable-p ?\u2197)
    (setq gnus-canceled-mark ?↗))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (when (char-displayable-p ?\u2191)
    (setq gnus-score-over-mark ?↑))

  (when (char-displayable-p ?\u2193)
    (setq gnus-score-below-mark ?↓))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (when (char-displayable-p ?\u21BA)
    (setq gnus-replied-mark ?↺))

  (when (char-displayable-p ?\u21AA)
    (setq gnus-forwarded-mark ?↪))

  (when (char-displayable-p ?\u260D)
    (setq gnus-cached-mark ?☍))

  (when (char-displayable-p ?\u2729)
    (setq gnus-unseen-mark ?✩))

  (when (char-displayable-p ?\u2605)
    (setq gnus-recent-mark ?★))

  (when (char-displayable-p ?\u2699)
    (setq gnus-process-mark ?⚙))

  (when (char-displayable-p ?\u267B)
    (setq gnus-expirable-mark ?♻))
</pre></div>
</div>
</div>
<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5">Threading</h3>
<div class="outline-text-3" id="text-6-5">
<p>Threading is the representation of discussions "as they happen". Use <code>T T</code> to toggle threading.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 3.9 (info "(gnus)Threading")

  ;; gather threads by comparing the Subject header of the articles
  (setq gnus-summary-thread-gathering-function
        'gnus-gather-threads-by-subject)
        ;; 'gnus-gather-threads-by-references)

  ;; don't grab old headers to build threads
  (setq gnus-fetch-old-headers nil)     ; nil to speed up (otherwise, it can
                                        ; seriously impact performance)

  ;; fill in all the gaps to tie loose threads together
  (setq gnus-build-sparse-threads nil)  ; was 'some

  ;; ;; sort the articles within a thread after it has been gathered together
  ;; (setq gnus-sort-gathered-threads-function 'gnus-thread-sort-by-date)
</pre></div>
<p>Show/hide threads with <code>&gt;</code> / <code>&lt;</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (define-key gnus-summary-mode-map
    (kbd "&gt;") 'gnus-summary-show-thread)
  (define-key gnus-summary-mode-map
    (kbd "&lt;") 'gnus-summary-hide-thread)
</pre></div>
</div>
</div>
<div id="outline-container-sec-6-6" class="outline-3">
<h3 id="sec-6-6">Sorting the Summary Buffer</h3>
<div class="outline-text-3" id="text-6-6">
<p><b>Primary</b> sort key should be the <b>last</b> function in the list.</p>
<p>You should always include <code>gnus-thread-sort-by-number</code> in the list, probably as first (least important) element.</p>
<p>WARNING - Sorting by date is often much slower than sorting by number, and the sorting order is very similar.</p>
<p>The threads with the highest article scores in total are on top in my summary buffers. For threads with equal scores, I sort by the most recent article in a thread (older before younger, thus the not). If that still doesn't distinguish 2 threads, it's sorted by article number (that should always be included as last element to guarantee a total ordering).</p>
<p>By the way: in mail groups (except for mailing list groups) I disable scoring, so there the sorting by recency of youngest message in thread is the decision maker. I like that in older-before-younger order, because then I read older replies to an article before younger replies.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 3.10 (info "(gnus)Sorting the Summary Buffer")

  ;; sort threads in descending article order
  (setq gnus-thread-sort-functions
        '(gnus-thread-sort-by-number
          (not gnus-thread-sort-by-most-recent-date)
          ;; gnus-thread-sort-by-total-score
          ))

  ;; If needed, look at `gnus-subthread-sort-functions' for sorting
  ;; subthreads in the summary buffer.
</pre></div>
</div>
</div>
<div id="outline-container-sec-6-7" class="outline-3">
<h3 id="sec-6-7">Article Caching</h3>
<div class="outline-text-3 org-src-container" id="text-6-7">
<pre class="src src-emacs-lisp">
;;** 3.12 (info "(gnus)Article Caching")

  ;; use the cache
  (setq gnus-use-cache t)

  ;; ;; local cache
  ;; (setq gnus-cache-directory (concat gnus-directory "cache/"))

  ;; entering of articles from the cache
  (setq gnus-cache-enter-articles '(ticked dormant unread read))
                                        ; simple setup for your convenience, if
                                        ; you are using `nnimap' from home, over
                                        ; a dialup connection

  ;; removing of articles from the cache
  (setq gnus-cache-remove-articles nil)

  ;; cache your nnimap groups
  (setq gnus-cacheable-groups "^nnimap")
</pre></div>
</div>
<div id="outline-container-sec-6-8" class="outline-3">
<h3 id="sec-6-8">Article Treatment</h3>
<div class="outline-text-3 org-src-container" id="text-6-8">
<pre class="src src-emacs-lisp">
;;** 3.18 (info "(gnus)Article Treatment")

  ;; change a `\205' figure to "..."
  (add-hook 'gnus-part-display-hook 'article-treat-dumbquotes)

  ;; full shampoo of messages you read
  (defun leuven-gnus-wash-this-article ()
    "Wash an article."
    (interactive)
    (gnus-article-outlook-deuglify-article)
    (gnus-article-fill-cited-article nil '79)
    (gnus-article-capitalize-sentences)
    (message "Washed this article"))

  (define-key gnus-summary-mode-map
    (kbd "C-c w") 'leuven-gnus-wash-this-article)

  ;; what is to be considered a signature
  (setq gnus-signature-separator
        '("^-- $"                       ; the standard
          "^-- *$"                      ; a common mangling
          "^________*$"))               ; a long line of underscores is also
                                        ; popular

  ;; limit (in lines, in floating point) to what is considered a signature
  (setq gnus-signature-limit 20.0)

  (defun leuven-prefix-line ()
    "Prefix the current line with `&gt;'."
    (interactive)
    (beginning-of-line)
    (while
        (progn
          ;; repeat...
          (if (looking-at "[&gt;\n]")
              (insert "&gt;")
            (insert "&gt; "))
          (forward-line 1)
          (beginning-of-line)
          (not
           ;; ...until blank line found
           (looking-at " *$")))))

  (global-set-key (kbd "&lt;S-f5&gt;") 'leuven-prefix-line)

  ;; banners to remove
  (setq gnus-article-address-banner-alist
        '(("@yahoo\\.com" .
           "^__________________+\nDo you Yahoo!\\?\n.*\n.*\n")
          ("@hotmail\\.com\\|@msn.com" .
           "^_________________________________________________________________\n.*MSN .*\n.*\n")))

  ;; FIXME This is under test!
  ;; L'affichage des messages
  (setq gnus-article-display-hook
        '(gnus-article-hide-headers-if-wanted
          gnus-article-date-lapsed
          gnus-article-hide-pgp
          gnus-article-treat-overstrike
          gnus-article-de-quoted-unreadable
          gnus-article-strip-leading-blank-lines
          gnus-article-remove-trailing-blank-lines
          gnus-article-strip-multiple-blank-lines
          gnus-article-highlight
          gnus-article-highlight-signature
          gnus-article-emphasize
          gnus-article-fill-cited-article))
</pre></div>
</div>
<div id="outline-container-sec-6-9" class="outline-3">
<h3 id="sec-6-9">MIME Commands</h3>
<div class="outline-text-3 org-src-container" id="text-6-9">
<pre class="src src-emacs-lisp">
;;** 3.19 (info "(gnus)MIME Commands")

  ;; rewrite file names of MIME parts (delete control characters, delete
  ;; shell gotchas, handle evil white spaces)
  (setq mm-file-name-rewrite-functions
        '(mm-file-name-delete-control
          mm-file-name-delete-gotchas
          mm-file-name-trim-whitespace
          mm-file-name-collapse-whitespace
          mm-file-name-replace-whitespace))
</pre></div>
</div>
<div id="outline-container-sec-6-10" class="outline-3">
<h3 id="sec-6-10">Charsets</h3>
<div class="outline-text-3 org-src-container" id="text-6-10">
<pre class="src src-emacs-lisp">
;;** 3.20 (info "(gnus)Charsets")

  ;; permitted unencoded charsets for posting
  (setq gnus-group-posting-charset-alist
        '((message-this-is-news nil (iso-8859-15))))

  (defun leuven-show-article-as-charset ()
    (interactive)
    (message "Display in: latin-[1], latin-[9]/15, [u]tf-8, [c]p1252")
    (let ((answer (read-char)))
      (cond
       ((eq answer ?1)
        (gnus-summary-show-article-from-menu-as-charset-iso-8859-1))
       ((eq answer ?9)
        (gnus-summary-show-article-from-menu-as-charset-iso-8859-9))
       ((eq answer ?c)
        (gnus-summary-show-article-from-menu-as-charset-cp1252))
       ((eq answer ?u)
        (gnus-summary-show-article-from-menu-as-charset-utf-8))))
    (gnus-summary-rethread-current))
</pre></div>
</div>
<div id="outline-container-sec-6-11" class="outline-3">
<h3 id="sec-6-11">Various Summary Stuff</h3>
<div class="outline-text-3 org-src-container" id="text-6-11">
<pre class="src src-emacs-lisp">
;;** 3.27 (info "(gnus)Various Summary Stuff")

  ;; highlight current line in summary buffer
  (when (fboundp 'leuven--hl-line-highlight)
    (add-hook 'gnus-summary-mode-hook 'leuven--hl-line-highlight))

  ;; search forward for an article containing a given regexp
  (define-key gnus-summary-mode-map
    (kbd "s") 'gnus-summary-search-article-forward)

  ;; repeat the last search through the articles in the summary buffer
  ;; (without requiring a confirmation of the search string each time)
  (defun gnus-summary-search-article-forward-next ()
    "Repeat the last forward search."
    (interactive)
    (gnus-summary-search-article-forward gnus-last-search-regexp nil))
  ;; TODO `g-s-s-a-f-next' should be the only function to be called by the
  ;; user, whether or not the search is made for the first time or a
  ;; repetition of it

  (define-key gnus-summary-mode-map
    (kbd "M-s") 'gnus-summary-search-article-forward-next)

  ;; turn off the column number in the group buffer
  (add-hook 'gnus-summary-mode-hook
            (lambda ()
              (set (make-local-variable 'column-number-mode) nil)))
</pre></div>
<div id="outline-container-sec-6-11-1" class="outline-4">
<h4 id="sec-6-11-1"><a href="http://www.emacswiki.org/emacs/GnusStripes">Gnus Stripes</a></h4>
<div class="outline-text-4" id="text-6-11-1">
<p>The following does work, but hides the read background for read postings, as the stripe background is superimposed on my "read" background.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;;  ;; the color of the stripes is obtained by dimming the frame background color
  ;;  (defvar stripe-intensity 12
  ;;    "*intensity of the shade. Used to compute the color of the stripes.
  ;; 0 means no shading of the background color, nil means gray80")
  ;;
  ;;  ;; a command that computes the rgb code of the shaded background color
  ;;  (defun shade-color (intensity)
  ;;    "print the #rgb color of the background, dimmed according to intensity"
  ;;    (interactive "nIntensity of the shade : ")
  ;;    (apply 'format "#%02x%02x%02x"
  ;;           (mapcar (lambda (x)
  ;;                     (if (&gt; (lsh x -8) intensity)
  ;;                         (- (lsh x -8) intensity)
  ;;                       0))
  ;;                   (color-values (cdr (assoc 'background-color (frame-parameters)))))))
  ;;
  ;;  ;; the command that actually puts the stripes in the current buffer
  ;;  (defun stripe-alternate ()
  ;;    "stripes all down the current buffer"
  ;;    (interactive)
  ;;    ;; compute the color of the stripes from the value of stripe-intensity
  ;;    (if stripe-intensity
  ;;        (setq stripe-overlay-face (shade-color stripe-intensity))
  ;;      (setq stripe-overlay-face "gray80"))
  ;;    ;; put the overlay in the current buffer
  ;;    (save-excursion
  ;;      (goto-char (point-min))
  ;;      (let (stripe-overlay)
  ;;        (while (not (eobp))
  ;;          (forward-line)
  ;;          (setq stripe-overlay
  ;;                (make-overlay (line-beginning-position)
  ;;                              (line-beginning-position 2)))
  ;;          (overlay-put stripe-overlay 'face (list :background stripe-overlay-face))
  ;;          (overlay-put stripe-overlay 'priority -1)
  ;;          (forward-line)))))
  ;;
  ;;  ;; activate the stripes for the mail buffers only
  ;;  (add-hook 'gnus-summary-prepare-hook (lambda ()
  ;;                                         (with-current-buffer gnus-summary-buffer
  ;;                                           ;; (unless (gnus-news-group-p gnus-newsgroup-name)
  ;;                                             (stripe-alternate))))
  ;;  ;; )
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (message "3 Summary Buffer... Done")
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Article Buffer</h2>
<div class="outline-text-2 org-src-container" id="text-7">
<pre class="src src-emacs-lisp">
;;* 4 (info "(gnus)The Article Buffer")

  (message "4 Article Buffer...")
</pre></div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Hiding headers</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 4.1 Hiding headers

  (with-eval-after-load "gnus-art"
     ;; TODO Could be limited to news headers only
     (setq gnus-visible-headers
           (concat
           "^User-Agent:\\|^X-Spam-Level:\\|^X-Report-Spam:\\|"
           gnus-visible-headers))

     ;; when Gnus, highlight user agent
     (add-to-list
      'gnus-header-face-alist
      (list (concat
             "^"
             (regexp-opt '("User-Agent" "X-Mailer" "Newsreader" "X-Newsreader") t)
             ":.*Gnus.*")
            nil 'gnus-server-opened)))

  ;; ,----[ (info "(gnus)Choosing Commands") ]
  ;; | `G j'
  ;; | `j'
  ;; |      Ask for an article number or `Message-ID', and then go to that
  ;; |      article (`gnus-summary-goto-article').
  ;; `----

  ;; &gt; At the moment, I am appending the `Message-ID' to
  ;; &gt; `http://groups.google.com/groups?selm=' to get the target URL, but
  ;; &gt; this does not work reliably.

  ;; auxiliary article mode commands for Gnus
  (when (try-require 'rs-gnus-article-XXX)
    ;; FIXME Break my 2-column display for the mails (summary | article)

    ;; initialization
    (rs-gnus-buttons)

    ;; (defun rs-gnus-button-browse-mid (mid)
    ;;   "Browse MID on Google or Gmane."
    ;;   (message "mid=`%s'" mid)
    ;;   (browse-url (concat
    ;;                (if (string-match "\\bgmane\\." gnus-newsgroup-name)
    ;;                    "http://thread.gmane.org/31"
    ;;                  "http://groups.google.com/groups?as_umsgid=32")
    ;;                mid)))

    ;; open the article in the browser when clicking (or using `RET') on a
    ;; mid in `References' and `Message-ID' headers
    (add-to-list
     'gnus-header-button-alist
     '("^\\(References\\|Message-I[Dd]\\):" "&lt;\\([^&lt;&gt;]+\\)&gt;"
       1 (&gt;= gnus-button-message-level 0) rs-gnus-button-browse-mid 1)
     t)) ;; append!

;;** 4.2 (info "(gnus)Using MIME")

  (message "Emacs MIME...")
</pre></div>
<div class="note">
<p>Use <code>K i</code> from the summary buffer (or <code>i</code> on the MIME button in the article buffer) to insert the contents of the MIME object into the buffer (<code>gnus-mime-inline-part</code>) as <code>text/plain</code>, in order to read them directly in Gnus.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Emacs MIME</h2>
<div class="outline-text-2 org-src-container" id="text-8">
<pre class="src src-emacs-lisp">
;;* (info "(emacs-mime)Top")
</pre></div>
<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">Decoding and Viewing</h3>
<div class="outline-text-3 org-src-container" id="text-8-1">
<pre class="src src-emacs-lisp">
;;** 1 (info "(emacs-mime)Decoding and Viewing")
</pre></div>
</div>
<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">Non-MIME</h3>
<div class="outline-text-3 org-src-container" id="text-8-2">
<pre class="src src-emacs-lisp">
;;*** 1.2 (info "(emacs-mime)Non-MIME")

  ;; regexp of Emacs sources groups
  (setq mm-uu-emacs-sources-regexp "emacs")

  ;; regexp matching diff groups
  (setq mm-uu-diff-groups-regexp ".*")

  ;; regexp matching TeX groups
  (setq mm-uu-tex-groups-regexp ".*")
</pre></div>
</div>
<div id="outline-container-sec-8-3" class="outline-3">
<h3 id="sec-8-3">Display Customization</h3>
<div class="outline-text-3" id="text-8-3">
<p>You can view "text/html" parts of the current article with a WWW browser by pressing <code>K H</code> (<code>gnus-article-browse-html-article</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 1.5 (info "(emacs-mime)Display Customization")

  (with-eval-after-load "mm-decode"
    ;; ;; MIME type that will be displayed externally automatically
    ;; (add-to-list 'mm-automatic-external-display "text/html")

    ;; do not treat inline images as real attachments (display them, instead)
    (add-to-list 'mm-attachment-override-types "image/.*")
                                        ; "text/x-vcard"...

    ;; don't render HTML automatically *when plain text alternative is
    ;; available*
    (add-to-list 'mm-discouraged-alternatives "text/html")
    (add-to-list 'mm-discouraged-alternatives "text/richtext")
    (add-to-list 'mm-discouraged-alternatives "text/enriched")
    (add-to-list 'mm-discouraged-alternatives "multipart/related")

    ;; all images fit in the buffer
    (setq mm-inline-large-images t)

    ;; ;; always show HTML mails as attachments (even if they can be
    ;; ;; displayed) use `browse-url-browser-function' (firefox) to render
    ;; ;; HTML mails
    ;; (push "text/html" mm-inline-override-types)


    ;; use `w3m' browser (if installed) to render HTML-only mails
    (setq mm-text-html-renderer
          (cond ((executable-find "w3m") 'w3m) ; or `gnus-w3m'?
                (t 'html2text)))        ; Emacs built-in

    ;; recent Gnusae have a built-in HTML renderer which even (somewhat)
    ;; handles CSS
    (setq mm-text-html-renderer 'shr) ; eww-backend?
    )

  (with-eval-after-load "w3m"
     ;; (setq browse-url-browser-function 'w3m-browse-url)
     (setq mm-inline-text-html-renderer
           'mm-inline-text-html-render-with-w3m)
     (setq gnus-article-wash-function
           'gnus-article-wash-html-with-w3m)

     ;; Whenever you try to browse URLs found in articles, Gnus
     ;; (`emacs-w3m', in fact) complains that "This link is considered
     ;; unsafe...". To turn it off, frob the variables
     ;; `w3m-safe-url-regexp' and `mm-w3m-safe-url-regexp'.
     )

  ;; allow retrieving images in HTML contents with the &lt;img&gt; tags
  (setq mm-inline-text-html-with-images t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; Remove HTML tags from a buffer
  (defun leuven-wash-ugly-html ()
    "Remove ugly HTML tags."
    (interactive)
    (toggle-read-only -1)
    (save-excursion
      (goto-char (point-min))
      (while (re-search-forward "&lt;[^#][^&lt;@&gt;]*&gt;" nil t)
        (replace-match "" nil nil))
      (goto-char (point-min))
      (while (re-search-forward "&amp;gt;" nil t)
        (replace-match "&gt;" nil nil))
      (goto-char (point-min))
      (while (re-search-forward "&amp;lt;" nil t)
        (replace-match "&lt;" nil nil))

      ;; FIXME Do not simply remove accents like it does now
      (goto-char (point-min))
      (while (re-search-forward "&amp;[^;]*;" nil t)
        (replace-match "" nil nil))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 1.6 (info "(emacs-mime)Files and Directories")

  ;; default directory for saving attachments
  (setq mm-default-directory
        (cond ((or leuven--win32-p
                   leuven--cygwin-p)
               "~/")
              (t                        ; Linux
               "~/Desktop/")))

  (when (fboundp 'leuven-make-directory-yes-or-no)
    (leuven-make-directory-yes-or-no mm-default-directory))

  ;; directory for storing temporary files (opened attachments as well)
  (setq mm-tmp-directory temporary-file-directory)
</pre></div>
</div>
</div>
<div id="outline-container-sec-8-4" class="outline-3">
<h3 id="sec-8-4">Composing</h3>
<div class="outline-text-3 org-src-container" id="text-8-4">
<pre class="src src-emacs-lisp">
;;** 2 (info "(emacs-mime)Composing")

;;*** 2.4 (info "(emacs-mime)Encoding Customization")

  ;; preferred coding systems for encoding outgoing messages
  (setq mm-coding-system-priorities
        '(utf-8
          iso-latin-9
          iso-latin-1))                 ; ensure that utf-8 is chosen over
                                        ; iso-latin-9 and latin-1, if possible
</pre></div>
</div>
<div id="outline-container-sec-8-5" class="outline-3">
<h3 id="sec-8-5">Basic Functions</h3>
<div class="outline-text-3" id="text-8-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 4 (info "(emacs-mime)Basic Functions")

;;*** 4.12 (info "(emacs-mime)mailcap")

  ;; choose the right MIME type when sending an attachment
  (with-eval-after-load "mailcap"
     (add-to-list 'mailcap-mime-extensions
                  '(".doc" . "application/msword"))
     (add-to-list 'mailcap-mime-extensions
                  '(".ppt" . "application/vnd.ms-powerpoint")))
                                        ; MIME content-types keyed by file
                                        ; extensions
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; &gt; which settings do you have to see PDF attachments as text,
  ;; &gt; automagically? Does it work as well for DOC, XLS and PPT?
  ;;
  ;; not here, but I think it's customizable. You need to have the
  ;; programs installed, of course. The variable to look at is
  ;; mailcap-mime-data. It is not customizable, but see
  ;; http://www.gnus.org/manual/emacs-mime_30.html
</pre></div>
</div>
</div>
</div>
<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Back to Article Buffer</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 4.4 (info "(gnus)Customizing Articles")

  ;; (require 'gnus-art)

  ;; add buttons
  (setq gnus-treat-buttonize t)
  (setq gnus-treat-buttonize-head 'head)

  ;; do not display smileys as pictures
  (setq gnus-treat-display-smileys nil)

  ;; sound
  (setq gnus-treat-play-sounds t)
</pre></div>
<p>Toggle colouring from HTML emails:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; from Tassilo Horn, 2014-07-17
  (setq shr-color-visible-distance-min 10)
  (setq shr-color-visible-luminance-min 60)
  (setq gnus-treat-fill-article 0)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 4.6 (info "(gnus)Misc Article")

  ;; format specification for the article mode line
  (setq gnus-article-mode-line-format "%S%m")
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; make `C-c C-f' active from within messages
  (define-key gnus-article-mode-map
    (kbd "C-c C-f") 'gnus-summary-mail-forward)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (message "4 Article Buffer... Done")
</pre></div>
</div>
</div>
<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10">Composing Messages</h2>
<div class="outline-text-2 org-src-container" id="text-10">
<pre class="src src-emacs-lisp">
;;* 5 (info "(gnus)Composing Messages")

  (message "5 Composing Messages...")
</pre></div>
<div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1">Mail</h3>
<div class="outline-text-3 org-src-container" id="text-10-1">
<pre class="src src-emacs-lisp">
;;** 5.1 (info "(gnus)Mail")

  ;; Gnus requests confirmation when replying to news (unlike mail)
  (setq gnus-confirm-mail-reply-to-news t)
</pre></div>
</div>
<div id="outline-container-sec-10-2" class="outline-3">
<h3 id="sec-10-2">Posting Server</h3>
<div class="outline-text-3 org-src-container" id="text-10-2">
<pre class="src src-emacs-lisp">
;;** 5.2 (info "(gnus)Posting Server")

  ;; control the hostname sent in the first EHLO or HELO command sent to the
  ;; server (client sends `EHLO CLARK.smtpmail-local-domain')
  (setq smtpmail-local-domain
        "i-did-not-set--mail-host-address--so-tickle-me")
        ;;              ^^^^^^^^^^^^^^^^^

  ;; make the SMTP library add `@' and the specified domain name to
  ;; recipients specified in the message when they are sent using the RCPT
  ;; TO command (or when we simply enter an email address without its
  ;; domain extension)
  (setq smtpmail-sendto-domain "local")

  ;; print info in buffer *trace of SMTP session to &lt;somewhere&gt;*
  (setq smtpmail-debug-info t)          ; only to debug problems

  ;; send the SMTP VERB command (enabling verbose information from the SMTP
  ;; server)
  (setq smtpmail-debug-verb t)
</pre></div>
</div>
<div id="outline-container-sec-10-3" class="outline-3">
<h3 id="sec-10-3">Archived Messages</h3>
<div class="outline-text-3" id="text-10-3">
<p>The <code>Gcc:</code> header is about in which group to save the messages you've written.</p>
<p><code>gnus-message-archive-group</code> specifies which (if any) <code>Gcc:</code> header is inserted when a message buffer is <b>created</b>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; group in which to save the messages you've written
  (setq gnus-message-archive-group "INBOX.Sent")
</pre></div>
<p>The <code>Gcc:</code> header at the time of <b>sending</b> the message specifies where it is archived.</p>
<p>If you want to be asked for each <b>message to be sent</b>, you can change the <code>Gcc:</code> header in the <code>message-send-hook</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 5.5 (info "(gnus)Archived Messages")

  ;; the Gcc Header specifies a local mail box that receives a copy of the
  ;; sent article
  ;; "Gcc:"-chooser, from Christoph Conrad
  (defvar header-gcc-history nil)
  (defun leuven-choose-gcc()
    (interactive)
    (let* (;; if this "group" is chosen the default "Gcc" remains
           (default "INBOX")
           ;; if this "group" is chosen the default "Gcc" is deleted
           (delete "INBOX.Trash")
           ;; else the choosen group is inserted as "Gcc:"
           (groups (append gnus-newsrc-alist (list (list default 'dummy)
                                                   (list delete  'dummy))))
           (group (completing-read "Gcc: "
                                   groups
                                   nil t default 'header-gcc-history))
           (completion-ignore-case t))
      ;; input?
      (if (not (equal default group))
          (progn
            (message-remove-header "Gcc" t)
            (if (not (equal delete group))
                (message-add-header (concat "Gcc: " group)))))))

  (add-hook 'message-send-hook 'leuven-choose-gcc)
</pre></div>
<p>I use it in such a way that, in all my IMAP mail groups, mails I write automatically end up in the group I wrote from.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; automatically mark Gcc articles (i.e., sent by myself) as read
  (setq gnus-gcc-mark-as-read t)
</pre></div>
</div>
</div>
<div id="outline-container-sec-10-4" class="outline-3">
<h3 id="sec-10-4">Posting Styles</h3>
<div class="outline-text-3" id="text-10-4">
<p>Concept of "roles" in mutt.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 5.6 (info "(gnus)Posting Styles")

  ;; an alternative to `gnus-posting-styles', if you want to change accounts
  ;; on the fly while composing messages
  (autoload 'gnus-alias-determine-identity "gnus-alias" nil t)
  (add-hook 'message-setup-hook 'gnus-alias-determine-identity)

  (with-eval-after-load "gnus-alias"

    ;; ;; add gnus-alias call to message mode hook
    ;; (gnus-alias-init)

    ;; added one key binding
    (define-key message-mode-map
      (kbd "C-c p") 'gnus-alias-select-identity)

    ;; set up my identities
    (setq gnus-alias-identity-alist
          '(("John-Doe-ID"
             ""
             "John Doe &lt;johndoe@example.com&gt;"
             "John Doe"
             (("X-Url" . "http://www.example.com/~john"))
             "\nJohn\n"
             "John Doe")

            ("Jane-Doe-ID"
             ""
             "Jane Doe &lt;janedoe@example.com&gt;"
             "Jane Doe"
             (("X-Url" . "Under construction..."))
             "\nBest regards,\n  Jane\n"
             "Jane Doe")))

    ;; automatically choose an identity given the message context
    (setq gnus-alias-identity-rules
          '(("Newsgroups-Rule"
             ("newsgroups" ".*" current)
             "John-Doe-ID")

            ("John-Doe-Rule"
             ("any" "johndoe@example.com" both)
             "John-Doe-ID")

            ("Jane-Doe-Rule"
             ("any" "janedoe@example.com" both)
             "Jane-Doe-ID")))

    ;; identity to use when gnus-alias finds an unknown identity
    (setq gnus-alias-unknown-identity-rule 'error)

    ;; ;; default identity (when it isn't able to determine which identity to
    ;; ;; use)
    ;; (setq gnus-alias-default-identity "John-Doe-ID")

    ;; old identity is completely removed before the new one is added
    (setq gnus-alias-overlay-identities nil)

    ;; allow your `Return-Path' to be set properly
    (setq gnus-alias-override-user-mail-address t)

    ;; after an Identity is used, where should point be moved to?
    (setq gnus-alias-point-position 'start-of-sig)

    ;; `From' header becomes a button that you can click on
    (setq gnus-alias-use-buttonized-from t)

    ;; level of verbosity -- message output only (see `*gnus-alias debug*'
    ;; buffer, when maximum verbosity)
    (setq gnus-alias-verbosity 1)

    ;; set message envelope to content of `From'
    ;; XXX see `mail-specify-envelope-from'
    (defun leuven-set-msg-envelope-from()
      "Set `mail-envelope-from' to the value in the \"From\" field."
      (let* ((from (message-fetch-field "From" t))
             (first (1+ (string-match "&lt;" from)))
             (last (string-match "&gt;" from)))
        (setq mail-envelope-from (substring from first last))))

    ;; ;; alternative for FPZ??
    ;; (defun leuven-set-msg-envelope-from ()
    ;;   (let ((from (cadr
    ;;                (mail-extract-address-components
    ;;                 (message-field-value "from")))))
    ;;       (setq mail-envelope-from from)))

    (add-hook 'message-setup-hook 'leuven-set-msg-envelope-from)
    )
</pre></div>
</div>
<div id="outline-container-sec-10-4-1" class="outline-4">
<h4 id="sec-10-4-1">Multiple servers</h4>
<div class="outline-text-4" id="text-10-4-1">
<p>Let Gnus decide which SMTP server should be used for sending email by looking at XXX.</p>
<p>See <a href="http://www.emacswiki.org/emacs/MultipleSMTPAccounts">http://www.emacswiki.org/emacs/MultipleSMTPAccounts</a> for looking at the <code>From:</code> header line of the current post.</p>
</div>
</div>
<div id="outline-container-sec-10-4-2" class="outline-4">
<h4 id="sec-10-4-2">Headers</h4>
<div class="outline-text-4" id="text-10-4-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; add certain headers before sending messages
  (defun leuven-message-add-content ()
    ;; for Gmane address obfuscation
    (message-add-header "X-Archive: encrypt"))

  (add-hook 'message-send-hook 'leuven-message-add-content)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (message "5 Composing Messages... Done")
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11">Message</h2>
<div class="outline-text-2 org-src-container" id="text-11">
<pre class="src src-emacs-lisp">
;;* (info "(message)Top")

  ;; Message mode has become the default mail editing mode in Emacs 23.2+
  ;; (used by Gnus and RMail, at least)

  (message "Message...")
</pre></div>
<div id="outline-container-sec-11-1" class="outline-3">
<h3 id="sec-11-1">Interface</h3>
<div class="outline-text-3" id="text-11-1">
<p>&gt; Is there a way to configure multiple addresses?</p>
<p>Yes. There are a couple of variables for that. I use a code piece like the one below to set the variables.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (let ((addr '("primary.address@somewhere.invalid"
                "another.address@isp.invalid"
                "yet.another@address.invalid")))

    (setq-default
     user-mail-address (car addr)
     message-alternative-emails (regexp-opt (cdr addr) 'words)
     message-dont-reply-to-names (regexp-opt addr 'words)
     gnus-ignored-from-addresses message-dont-reply-to-names))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 1 (info "(message)Interface")

;;*** 1.1 (info "(message)New Mail Message")

  ;; prepare a mail from the current buffer
  (defun leuven-mail-current-region-or-buffer ()
    "Insert the current region or buffer into an email sending buffer."
    (interactive)
    (save-excursion
      (if (use-region-p)
          (kill-ring-save (region-beginning) (region-end))
        (kill-ring-save (point-min) (point-max)))
      (mail)
      (end-of-buffer)
      (yank)                            ; insert text
      (beginning-of-buffer)
      (next-line)
      (end-of-line)))

;;*** 1.4 (info "(message)Wide Reply")

  ;; addresses to prune (disable `Cc:' to myself) when doing wide replies
  (with-eval-after-load "message"
    (when (boundp 'gnus-ignored-from-addresses)
      (setq message-dont-reply-to-names gnus-ignored-from-addresses)))

;;*** 1.8 (info "(message)Forwarding")

  ;; ;; delimiter inserted before forwarded messages
  ;; (setq message-forward-start-separator "-----Original Message-----\n")
  ;;
  ;; ;; delimiter inserted after forwarded messages
  ;; (setq message-forward-end-separator "\n")

  ;; when forwarding mail, chop off these headers
  (setq message-forward-ignored-headers
        (concat "^\\("
                ;; FIXME Rewrite the following in a shorter way
                ;; (mapconcat 'regexp-quote
                ;;            '("Content-Class" "Content-language" "DKIM-Signature"
                ;;              "Delivered-To" "Disposition-Notification-To")
                ;;            "\\|")

                "Approved\\|Archived-At\\|Authentication-Results\\|"
                "Accept-Language\\|acceptlanguage\\|Auto-Submitted\\|"
                "BCc\\|"
                "Cancel-Lock\\|Content-Class\\|Content-language\\|"
                "DKIM-Signature\\|Delivered-To\\|"
                "Disposition-Notification-To\\|DomainKey-Signature\\|"
                "Envelope-to\\|Errors-To\\|"
                "Face\\|"
                "Importance\\|In-Reply-To\\|"
                "Lines\\|List-.*\\|"
                "Message-Id\\|"
                "NNTP-Posting-Date\\|NNTP-Posting-Host\\|"
                "Organization\\|Original-.*\\|"
                "Path\\|Precedence\\|Priority\\|"
                "Received-SPF\\|Received\\|References\\|Reply-To\\|"
                "Return-Path\\|Return-Receipt-To\\|"
                "Sender\\|Sensitivity\\|"
                "Thread-Index\\|Thread-Topic\\|"
                "User-Agent\\|"
                "X.*"
                "\\):"))

  ;; subject of article with `Fwd:' prepended to it, for forwarded messages
  (setq message-make-forward-subject-function
        'message-forward-subject-fwd)

  ;; forwarded messages will just be copied inline to the new message
  (setq message-forward-as-mime nil)
</pre></div>
</div>
</div>
<div id="outline-container-sec-11-2" class="outline-3">
<h3 id="sec-11-2">Commands</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 2 (info "(message)Commands")

;;*** 2.4 (info "(message)Insertion")

  ;; name of file containing the signature
  (setq message-signature-file "~/Mail/signatures/johndoe")
                                        ; this file must exist (otherwise, you
                                        ; get misplaced headers when switching
                                        ; between personalities (see
                                        ; `gnus-alias')
</pre></div>
<p>XXX Look at Gnushush to automatically <b>obfuscate email</b>, Message-ID, etc.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 2.11 (info "(message)Spelling")

 (add-hook 'message-setup-hook          ; or message-mode-hook?
           (lambda ()
             (flyspell-mode 1)))
</pre></div>
</div>
</div>
<div id="outline-container-sec-11-3" class="outline-3">
<h3 id="sec-11-3">Variables</h3>
<div class="outline-text-3" id="text-11-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 3 (info "(message)Variables")

;;*** 3.1 (info "(message)Message Headers")

  ;; specify how `From' headers should look
  (setq message-from-style 'angles)

;;*** 3.3 (info "(message)Mail Variables")

  ;; sending mail -- for Gnus (for `message')
  (setq message-send-mail-function 'message-smtpmail-send-it)

  ;; limit on the size of messages sent (10 MB)
  (setq message-send-mail-partially-limit (* 10 1000 1024))

;;*** 3.4 (info "(message)News Headers")

  ;; masquerade domain part of Message-ID
  (setq message-user-fqdn "example.com") ; (system-name)

  ;; tell Gnus not to generate a sender header on outgoing posts
  ;; (default behavior since Gnus 5.10.0)
  (with-eval-after-load "message"
    (add-to-list 'message-syntax-checks '(sender . disabled)))
</pre></div>
<p>XXX See <a href="http://www.emacswiki.org/emacs/AutoDictionaryMode">http://www.emacswiki.org/emacs/AutoDictionaryMode</a> for inserting a citation line in the correct language.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 3.6 (info "(message)Insertion Variables")

  ;; function for citing an original message
  ;; (stripping off the signature from the original message)
  (setq message-cite-function 'message-cite-original-without-signature)

  ;; (setq message-cite-function 'trivial-cite
  ;;       tc-normal-citemarks "&gt;|:"
  ;;       tc-fill-long-lines nil
  ;;       tc-make-attribution 'tc-fancy-attribution)

  (defun message-insert-citation-line ()
    "A replacement of the original `message-insert-citation-line'."
    (let ((from (replace-regexp-in-string
                 "[()]\\| ?[^ ]*?@[^ ]* ?" ""
                 (mail-header-from message-reply-headers))))
      (insert from " wrote:\n")))

;;*** 3.7 (info "(message)Various Message Variables")

  ;; ;; directory from which all other mail file variables are derived
  ;; (setq message-directory "~/Mail/")

  ;; remove the binding of `C-c C-v', used by Org-Babel commands
  (add-hook 'message-mode-hook
            (lambda ()
              (define-key message-mode-map
                (kbd "C-c C-v") nil)))

  ;; operates on messages you compose
  (defun leuven--message-mode-hook ()
    "Enable Org minor modes and auto-fill."

    ;; ;; prompt for and insert a mail alias
    ;; (local-set-key (kbd "M-a") 'mail-abbrev-insert-alias)

    ;; tab completion for alias in `.mailrc'
    (local-set-key (kbd "&lt;M-tab&gt;") 'mail-abbrev-complete-alias)

    ;; enable automatic word-wrap when composing messages
    (setq-default fill-column 80)
    (auto-fill-mode)

    ;; turn on the Org mode table editor (in emails)
    (turn-on-orgtbl)

    ;; turn on (the enhanced version of) orgstruct-mode
    (turn-on-orgstruct++)

    ;; ;; make `orgstruct-hijacker-command-22' rebind `M-q' to a message
    ;; ;; specific function to fill a paragraph
    ;; (setq fill-paragraph-function 'org-fill-paragraph)

    (when (try-require 'org-footnote)
      ;; default style used for footnoting is local to the Message being
      ;; written
      (set (make-local-variable 'org-footnote-auto-label) 'plain)

      ;; no tag marking the beginning of footnote section
      (set (make-local-variable
      'org-footnote-tag-for-non-org-mode-files) nil))

    ;; (when (try-require 'auto-complete)
    ;;   (auto-complete-mode))
    )

  (add-hook 'message-mode-hook 'leuven--message-mode-hook 'append)

  (add-hook 'message-send-hook 'org-footnote-normalize)

;;*** 3.9 (info "(message)Message Buffers")

  ;; kill message buffer after sending a message
  (setq message-kill-buffer-on-exit t)

  (message "Message... Done")
</pre></div>
</div>
</div>
</div>
<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12">Select Methods</h2>
<div class="outline-text-2 org-src-container" id="text-12">
<pre class="src src-emacs-lisp">
;;* 6 (info "(gnus)Select Methods")

  (message "6 Select Methods...")
</pre></div>
<div id="outline-container-sec-12-1" class="outline-3">
<h3 id="sec-12-1">Getting News</h3>
<div class="outline-text-3 org-src-container" id="text-12-1">
<pre class="src src-emacs-lisp">
;;** 6.2 (info "(gnus)Getting News")

;;*** 6.2.1 (info "(gnus)NNTP")

  ;; number of seconds to wait before an nntp connection times out
  (setq nntp-connection-timeout 5)      ; 30
</pre></div>
</div>
<div id="outline-container-sec-12-2" class="outline-3">
<h3 id="sec-12-2">Getting Mail</h3>
<div class="outline-text-3" id="text-12-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;** 6.3 (info "(gnus)Getting Mail")

;;*** 6.3.3 (info "(gnus)Splitting Mail") (in IMAP)

  ;; the registry should be installed
  (setq gnus-registry-install t)        ; for `G G' searches
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; article registry for Gnus
  (when (try-require 'gnus-registry-XXX)

    ;; use long group names (so that Gnus knows where the article is)
    (setq gnus-registry-use-long-group-names t)

    ;; unlimited number of entries in the registry
    (setq gnus-registry-max-entries nil)

    ;; enable the various registry functions
    (gnus-registry-initialize))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  ;; the first match in `nnmail-split-rule' found will be used
  (setq nnmail-crosspost nil)

  ;; name(s) of IMAP mailboxes to split mail from
  (setq nnimap-inbox '("INBOX"))        ; Gnus v5.13
  ;; (setq nnimap-split-inbox '("INBOX")) ; Ma Gnus

  ;; BBDB (Big Brother DataBase) is loaded from my `.emacs' file
  (when (try-require 'bbdb-gnus)

    ;; split function to use (sorting mails into groups using BBDB)
    (setq nnimap-split-methods 'nnimap-split-fancy)

    ;; for records which don't have `gnus-private' set, the rules in
    ;; split-fancy are invoked
    (setq bbdb/gnus-split-default-group nil)

    ;; specify how to split mail
    (setq nnimap-split-fancy            ; XXX vs `nnmail-split-fancy'?
          `(|                           ; split to the *first* match

              ;; mailing lists (in To: or Cc:)
              (to "foo@bar\\.com" "list.foo")

              ;; invoke BBDB            ; XXX with BBDB v2 and v3?
              (: (lambda ()
                   (car (bbdb/gnus-split-method))))

              ;; catch spam
              ("X-Spam-Status" "[Yy]es"
               "INBOX.Spam")

              ;; unmatched mail goes to the catch-all group (default mailbox)
              "INBOX")))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 6.3.9 (info "(gnus)Expiring Mail")

  ;; How can I purge a message from an IMAP server using Gnus?
  ;; IMAP calls it "Expunge" of deleted messages, Gnus calls it expiry of
  ;; expirable (marked 'E') messages..

  ;; groups in which to perform expiry of all read articles
  (setq gnus-total-expirable-newsgroups "\\`nnrss:")

  ;; ;; disable the expiry process started on leaving a group (for speed
  ;; ;; reason) before you leave for lunch, `M-x
  ;; ;; gnus-group-expire-all-groups'
  ;; (remove-hook 'gnus-summary-prepare-exit-hook
  ;;              'gnus-summary-expire-articles)

  ;; make the `d' key mean `delete' in mail groups, too (as in many other
  ;; modes), instead of `keep this message for archival purposes'
  (define-key gnus-summary-mode-map
    (kbd "d") 'gnus-summary-mark-as-expirable)

  ;; ;; Email pre-expiry period according to group
  ;; (setq nnmail-expiry-wait-function
  ;;       (lambda (group)
  ;;         (cond ((string= group "Gmail")      90)
  ;;               ((string= group "moley")      30)
  ;;               ((string= group "blackhole") 'immediate)
  ;;               (t                            7))))
  ;;
  ;; ;; Each time I quit the summary buffer of 'blackhole', any read mail
  ;; ;; is immediately expired


  ;; "deletion" versus "expiry"

  ;; ;; messages should be expired as soon as possible (when the mail
  ;; ;; group is left)
  ;; (setq nnmail-expiry-wait 'immediate)

  ;; 1) Only (*only*) articles that are marked as expirable are apt to be
  ;;    expired. (Yes, *only* those. Yes.)

  ;; 2) If you have made a group total-expirable, all read articles are
  ;;    apt to be expired. (Yes, only the read articles. No, not the
  ;;    unread, ticked and dormant articles. Only the read ones.)

  ;; Delete, even in IMAP terms, means "I want this message to go
  ;; away soon."  IMAP has no equivalent to Gnus' expire mark, which means
  ;; "I want this message to go away after expiry-wait days."

  ;; When you `B DEL', the message dies immediately, now and forever.
  ;; There is no recovery.
  ;; This is "delete" as in "delete it from your disk forever and ever,
  ;; never to return again." Use with caution.

  ;; If you want something to be scheduled for death, then hit `E' to mark
  ;; a message as expirable. The default expiry interval is one week, at
  ;; which point it will be deleted automatically, as though you had hit
  ;; it then with `B DEL'. Then you have 7 days to undelete the messages.

  ;; Many mailers have a concept of a "deleted items" folder but Gnus does
  ;; not have that.  It has expiry instead, so that articles due to
  ;; disappear will remain where they belong until their expiry interval
  ;; arrives.

  ;; Deleting a message is normally done via marking as expirable: you hit
  ;; `E' (not `e') to mark a message as expirable, and whenever expiry is
  ;; run (normally when you `q'uit a summary buffer), the old E messages
  ;; are deleted (old == nnmail-expiry-wait days).

  ;; 1. No expiry.  Only articles explicitly marked with 'E' from the
  ;;    summary buffer are expired.  Reading articles marks them 'R'ead.
  ;;
  ;; 2. Auto-expiry.  Only articles marked expirable are expired, but
  ;;    reading articles marks them 'E'xpirable.
  ;;
  ;; 3. Total-expiry.  Articles merely marked 'R'ead are expired, along
  ;;    with articles explicitly marked 'E'xpirable.
  ;;
  ;; Assuming you read every article, auto- and total-expiry will
  ;; eventually expire them all at the same times. It's just a question as
  ;; to whether you'd prefer to mark articles as expirable or read when
  ;; you read them. I tend to use total-expiry for everything; it has
  ;; predictable behavior if I'm switching it on and off for a group, and
  ;; I understand better how it works with scoring.

  ;; delete the article when pressing `Delete'

  ;; FIXME Does not work... This is the opposite of SPC (page down)!
  (with-eval-after-load "gnus-sum" ;; be sure to override default
    (gnus-define-keys gnus-summary-mode-map
      [delete] gnus-summary-delete-article))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;*** 6.3.11 (info "(gnus)Duplicates")

  ;; cache of old Message-IDs for every message Gnus sees
  (setq nnmail-message-id-cache-file
        (concat gnus-directory ".nnmail-cache"))

  ;; to use `nnmail-split-fancy-with-parent'
  ;; record the Message-ID of every message it sees
  (setq nnmail-treat-duplicates 'warn)  ; or `delete'

  ;; ensure that the Message-ID are still in the cache
  (setq nnmail-message-id-cache-length 5000)

  ;; record the Message-ID of moved articles
  (setq nnmail-cache-accepted-message-ids t)
</pre></div>
</div>
</div>
<div id="outline-container-sec-12-3" class="outline-3">
<h3 id="sec-12-3">Browsing the Web</h3>
<div class="outline-text-3 org-src-container" id="text-12-3">
<pre class="src src-emacs-lisp">
;;** 6.4 (info "(gnus)Browsing the Web")

  ;; use `wget' instead of `url.el' (for nnweb-type google), cause it
  ;; seems to be more reliable (about how the HTML is fetched)

  ;; use external grab program (to fetch the RSS feed, etc.)
  (setq mm-url-use-external t)

  ;; URL grab program
  ;; TODO Protect in case wget is not installed
  ;; (setq mm-url-program "wget") ; make sure you don't use the symbol 'wget

  ;; FYI, wget is run when a link from Org is not found, for example
  ;; because the mail has been moved from one group to another.

  ;; arguments for `mm-url-program'
  (setq mm-url-arguments '("-q" "-O" "-"))

  ;; how to find the parent article
  (when (try-require 'nnweb-XXX)        ; not sure it really works!?
    (setq gnus-refer-article-method
          '(
            ;; first try the current method
            current

            ;; find the Message-ID based on the registry, so that you can
            ;; safely move articles around
            ;; (nnregistry)

            (nnweb "gmane" (nnweb-type gmane))

            ;; then ask Google
            (nnweb "google" (nnweb-type google))

            ;; and finally ask `news.gmane.org' if that fails
            (nntp "news.gmane.org")
            )))
</pre></div>
</div>
<div id="outline-container-sec-12-4" class="outline-3">
<h3 id="sec-12-4">IMAP</h3>
<div class="outline-text-3 org-src-container" id="text-12-4">
<pre class="src src-emacs-lisp">
;;** 6.5 (info "(gnus)IMAP")

  ;; log commands (imap session trace) to the `*imap log*' buffer
  (setq nnimap-record-commands t)
</pre></div>
</div>
<div id="outline-container-sec-12-5" class="outline-3">
<h3 id="sec-12-5">Gnus Unplugged</h3>
<div class="outline-text-3 org-src-container" id="text-12-5">
<pre class="src src-emacs-lisp">
;;** 6.8 (info "(gnus)Gnus Unplugged")

  ;; disable the Gnus agent (used for "offline" reading)
  (setq gnus-agent nil)                 ; prevent being unable to delete some
                                        ; mails from your inbox

  (message "6 Select Methods... Done")
</pre></div>
</div>
</div>
<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13">Scoring</h2>
<div class="outline-text-2" id="text-13">
<p>You can <i>increase</i> or <i>lower</i> the score, respectively, in the global file (instead of the score file local for the group) by pressing <code>M-i a I</code> or <code>M-i a L</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;* 7 (info "(gnus)Scoring")

  (message "7 Scoring...")

  ;; ;; directory where kill and score files will be stored
  ;; (setq gnus-kill-files-directory "~/")

  ;; ;; increase score of messages that are replies to my own postings
  ;; ;; TODO only for newsgroups (and not for mails)!
  ;; (add-hook 'message-sent-hook 'gnus-score-followup-article)
  ;; (add-hook 'message-sent-hook 'gnus-score-followup-thread)

  (message "7 Scoring... Done")
</pre></div>
</div>
<div id="outline-container-sec-13-1" class="outline-3">
<h3 id="sec-13-1">From Sacha Chua</h3>
<div class="outline-text-3" id="text-13-1">
<p>Adaptive scoring means that if you kill a thread you're not particularly interested in, it lowers the score on that one, so any replies are shown with a negative score. You can also configure it to hide messages with scores below a certain threshold, so you don't even see replies.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (setq gnus-use-adaptive-scoring t)

  (setq gnus-default-adaptive-score-alist
        '((gnus-unread-mark)
          (gnus-ticked-mark (subject 10))
          (gnus-killed-mark (subject -5))
          (gnus-catchup-mark (subject -1))))
</pre></div>
<p>I also have some more rules that score things up if they mention my name or other things I'm interested in.</p>
<p>Maybe a score file with this in it?</p>
<pre class="example">
(("Body" ("sacha" 10 nil s)))
</pre>
<p>which theoretically adds a score based on that keyword, but I haven't tested it and it slows loading groups down a bit.</p>
</div>
</div>
</div>
<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14">Searching</h2>
<div class="outline-text-2" id="text-14">
<p>Basically, there's only one user-frontend function: <code>gnus-group-make-nnir-group</code> bound to <code>G G</code> in <code>*Group*</code>.</p>
<p>It comes with Gnus. You don't even need to configure anything for searching <b>IMAP</b> and <b>Gmane</b> groups.</p>
</div>
</div>
<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15">Various</h2>
<div class="outline-text-2 org-src-container" id="text-15">
<pre class="src src-emacs-lisp">
;;* 9 (info "(gnus)Various")

  (message "9 Various...")
</pre></div>
<div id="outline-container-sec-15-1" class="outline-3">
<h3 id="sec-15-1">Interactive</h3>
<div class="outline-text-3 org-src-container" id="text-15-1">
<pre class="src src-emacs-lisp">
;;** 9.2 (info "(gnus)Interactive")

  ;; don't display verbose messages and don't require confirmations
  (setq gnus-novice-user nil)
</pre></div>
</div>
<div id="outline-container-sec-15-2" class="outline-3">
<h3 id="sec-15-2">Formatting Variables</h3>
<div class="outline-text-3 org-src-container" id="text-15-2">
<pre class="src src-emacs-lisp">
;;** 9.4 (info "(gnus)Formatting Variables")

  ;; assume that fixed width fonts have characters of the same width
  (setq gnus-use-correct-string-widths nil)
</pre></div>
</div>
<div id="outline-container-sec-15-3" class="outline-3">
<h3 id="sec-15-3">Window Layout</h3>
<div class="outline-text-3 org-src-container" id="text-15-3">
<pre class="src src-emacs-lisp">
;;** 9.5 (info "(gnus)Window Layout")

  ;; add a window configuration to `gnus-buffer-configuration'
  (if (&gt; (frame-width) 160)
      (gnus-add-configuration
       '(article
         (horizontal 1.0
                     (summary 0.50 point)
                     ;; `point' positions the cursor properly
                     (article 1.0))))
    (gnus-add-configuration
     '(article
       (vertical 1.0
                 (summary 0.40 point)
                 (article 1.0)))))
</pre></div>
</div>
<div id="outline-container-sec-15-4" class="outline-3">
<h3 id="sec-15-4">Interaction with other modes</h3>
<div class="outline-text-3 org-src-container" id="text-15-4">
<pre class="src src-emacs-lisp">
;;** 9.20 Interaction with (info "(gnus)Other modes")

  ;; attach all marked files from Dired to a new Gnus message
  (autoload 'gnus-dired-mode "gnus-dired"
    "Attach dired's marked files to a gnus message composition." t)

  (autoload 'gnus-dired-attach "gnus-dired"
    "Attach dired's marked files to a gnus message composition." t)

  (with-eval-after-load "dired"

    (add-hook 'dired-mode-hook 'gnus-dired-mode)

    (define-key dired-mode-map
      (kbd "a") 'gnus-dired-attach))    ; XXX conflict with
                                        ; `dired-find-alternate-file'
</pre></div>
</div>
<div id="outline-container-sec-15-5" class="outline-3">
<h3 id="sec-15-5">Various Various</h3>
<div class="outline-text-3 org-src-container" id="text-15-5">
<pre class="src src-emacs-lisp">
;;** 9.21 (info "(gnus)Various Various")

  ;; display more messages from Gnus
  (setq gnus-verbose 10)                ; 9 = minimum for helpful debugging

  ;; display more messages from the Gnus back-ends
  (setq gnus-verbose-backends 10)

  (message "9 Various... Done")
</pre></div>
</div>
</div>
<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16">Appendices</h2>
<div class="outline-text-2 org-src-container" id="text-16">
<pre class="src src-emacs-lisp">
;;* 11 (info "(gnus)Appendices")

  (message "11 Appendices...")
</pre></div>
<div id="outline-container-sec-16-1" class="outline-3">
<h3 id="sec-16-1">History</h3>
<div class="outline-text-3 org-src-container" id="text-16-1">
<pre class="src src-emacs-lisp">
;;** 11.2 (info "(gnus)History")

  (setq canlock-password "secret")
  (setq canlock-password-for-verify "secret")
</pre></div>
</div>
<div id="outline-container-sec-16-2" class="outline-3">
<h3 id="sec-16-2">Frequently Asked Questions</h3>
<div class="outline-text-3 org-src-container" id="text-16-2">
<pre class="src src-emacs-lisp">
;;** 11.9 (info "(gnus)Frequently Asked Questions")

  ;; byte-compile the user-defined format specs (things like
  ;; `gnus-summary-line-format')
  (when (fboundp 'gnus-compile)
    (gnus-compile)) ;;  at the bottom

  (message "11 Appendices... Done")

  ;; warn that some packages were missing
  (dolist (pkg leuven--missing-packages)
    (message "(warning) Package `%s' not found" pkg))

  (message "\n")
</pre></div>
</div>
<div id="outline-container-sec-16-3" class="outline-3">
<h3 id="sec-16-3">Feature</h3>
<div class="outline-text-3 org-src-container" id="text-16-3">
<pre class="src src-emacs-lisp">
(provide 'gnus-leuven)
</pre></div>
</div>
<div id="outline-container-sec-16-4" class="outline-3">
<h3 id="sec-16-4">File Local Variables</h3>
<div class="outline-text-3 org-src-container" id="text-16-4">
<pre class="src src-emacs-lisp">
;; This is for the sake of Emacs.
;; Local Variables:
;; coding: utf-8-unix
;; eval: (when (require 'rainbow-mode nil t) (rainbow-mode))
;; flycheck-emacs-lisp-initialize-packages: t
;; flycheck-mode: nil
;; ispell-local-dictionary: "american"
;; End:

;;; gnus-leuven.el ends here
</pre></div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fabrice Niessen</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
