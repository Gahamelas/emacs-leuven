<!-- <xml version="1.0" encoding="utf-8"> -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />

  <title>Emacs Leuven</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Org-mode" />
  <meta name="author" content="Fabrice Niessen" />
  <link rel="stylesheet" type="text/css" href=
  "file:///D:/Users/fni/src/org-style/styles/bigblow/css/htmlize.css" />
  <link rel="stylesheet" type="text/css" href=
  "file:///D:/Users/fni/src/org-style/styles/bigblow/css/bigblow.css" />
  <link rel="stylesheet" type="text/css" href=
  "file:///D:/Users/fni/src/org-style/styles/bigblow/css/hideshow.css" />
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/jquery-1.9.1.min.js">
</script>
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/jquery-ui-1.10.2.min.js">
</script>
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/jquery.localscroll-min.js">
</script>
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js">
</script>
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/bigblow.js">
</script>
<script type="text/javascript" src=
"file:///D:/Users/fni/src/org-style/styles/bigblow/js/hideshow.js">
</script>
</head>

<body>
  <div id="content">
    <h1 class="title">Emacs Leuven</h1>

    <div id="table-of-contents">
      <h2>Table of Contents</h2>

      <div id="text-table-of-contents">
        <ul>
          <li><a href="#sec-1">Description</a></li>

          <li><a href="#sec-2">Header</a></li>

          <li><a href="#sec-3">Code</a></li>

          <li><a href="#sec-4">Loading Libraries of Lisp Code for
          Emacs</a></li>

          <li><a href="#sec-5">Environment</a></li>

          <li><a href="#sec-6">Debugging</a></li>

          <li>
            <a href="#sec-7">Emacs Lisp Packages</a>

            <ul>
              <li><a href="#sec-7-1">The Package Menu Buffer</a></li>

              <li><a href="#sec-7-2">Package Installation</a></li>

              <li><a href="#sec-7-3"><span class="todo nilTODO">TODO</span>
              Check Org mode version</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-8">The Organization of the Screen</a>

            <ul>
              <li><a href="#sec-8-1">The Echo Area</a></li>
            </ul>
          </li>

          <li><a href="#sec-9">Exiting Emacs</a></li>

          <li>
            <a href="#sec-10">Basic Editing Commands</a>

            <ul>
              <li><a href="#sec-10-1">Inserting Text</a></li>

              <li><a href="#sec-10-2">Moving Point Location</a></li>

              <li><a href="#sec-10-3">Basic Undoing Changes</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-11">The Minibuffer</a>

            <ul>
              <li><a href="#sec-11-1">Editing in the Minibuffer</a></li>

              <li><a href="#sec-11-2">Completion</a></li>

              <li><a href="#sec-11-3">Repeating Minibuffer Commands</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-12">Help</a>

            <ul>
              <li><a href="#sec-12-1">Help Summary</a></li>

              <li><a href="#sec-12-2">Apropos</a></li>

              <li><a href="#sec-12-3">Misc Help Commands</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-13">The Mark and the Region</a>

            <ul>
              <li><a href="#sec-13-1">Commands to Mark Textual Objects</a></li>

              <li><a href="#sec-13-2">Operating on the Region</a></li>

              <li><a href="#sec-13-3">Multiple selections</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-14">Killing and Moving Text</a>

            <ul>
              <li><a href="#sec-14-1">Deletion and Killing</a></li>

              <li>
                <a href="#sec-14-2">Yanking</a>

                <ul>
                  <li><a href="#sec-14-2-1">Yanking Earlier Kills</a></li>
                </ul>
              </li>

              <li><a href="#sec-14-3">Cutting and Pasting on Graphical
              Displays</a></li>

              <li><a href="#sec-14-4">Rectangles</a></li>

              <li><a href="#sec-14-5">CUA Bindings</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-15">Registers</a>

            <ul>
              <li><a href="#sec-15-1">Bookmarks</a></li>

              <li><a href="#sec-15-2">Ace Jump</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-16">Controlling the Display</a>

            <ul>
              <li><a href="#sec-16-1">Scrolling</a></li>

              <li><a href="#sec-16-2">Automatic Scrolling</a></li>

              <li><a href="#sec-16-3">Narrowing</a></li>

              <li><a href="#sec-16-4">Font Lock mode</a></li>

              <li><a href="#sec-16-5">Interactive Highlighting</a></li>

              <li><a href="#sec-16-6">Window Fringes</a></li>

              <li><a href="#sec-16-7">Displaying Boundaries</a></li>

              <li><a href="#sec-16-8">Useless Whitespace</a></li>

              <li><a href="#sec-16-9">Selective Display</a></li>

              <li><a href="#sec-16-10">Optional Mode Line Features</a></li>

              <li><a href="#sec-16-11">How Text Is Displayed</a></li>

              <li><a href="#sec-16-12">Displaying the Cursor</a></li>

              <li><a href="#sec-16-13">Truncation of Lines</a></li>

              <li><a href="#sec-16-14">Customization of Display</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-17">Searching and Replacement</a>

            <ul>
              <li><a href="#sec-17-1">Incremental Search (aka “Live
              Search”)</a></li>

              <li><a href="#sec-17-2">Regexp Search</a></li>

              <li><a href="#sec-17-3">Search Case</a></li>

              <li><a href="#sec-17-4">Replacement Commands</a></li>

              <li>
                <a href="#sec-17-5">Other Search-and-Loop Commands</a>

                <ul>
                  <li><a href="#sec-17-5-1">Multi-buffer occur</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-18">Commands for Fixing Typos</a>

            <ul>
              <li><a href="#sec-18-1">Checking and Correcting Spelling</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-19">Keyboard Macros</a>

            <ul>
              <li><a href="#sec-19-1">Basic Use</a></li>

              <li><a href="#sec-19-2">Naming and Saving Keyboard
              Macros</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-20">Files Handling</a>

            <ul>
              <li><a href="#sec-20-1">File Names</a></li>

              <li><a href="#sec-20-2">Visiting Files</a></li>

              <li><a href="#sec-20-3">Saving Files</a></li>

              <li><a href="#sec-20-4">Reverting a Buffer</a></li>

              <li><a href="#sec-20-5">Auto-Saving: Protection Against
              Disasters</a></li>

              <li><a href="#sec-20-6">Comparing Files</a></li>

              <li><a href="#sec-20-7">Diff Mode</a></li>

              <li><a href="#sec-20-8">Miscellaneous File Operations</a></li>

              <li><a href="#sec-20-9">Accessing Compressed Files</a></li>

              <li><a href="#sec-20-10">Auto Encryption</a></li>

              <li>
                <a href="#sec-20-11">Remote Files</a>

                <ul>
                  <li><a href="#sec-20-11-1">Ange-FTP</a></li>

                  <li><a href="#sec-20-11-2">TRAMP</a></li>

                  <li><a href="#sec-20-11-3">TEST Find file as root</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-20-12">Convenience Features for Finding Files</a>

                <ul>
                  <li><a href="#sec-20-12-1">FFAP</a></li>

                  <li><a href="#sec-20-12-2">Helm (Anything successor)</a></li>

                  <li><a href="#sec-20-12-3">Image mode</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-21">Using Multiple Buffers</a>

            <ul>
              <li><a href="#sec-21-1">Creating and Selecting Buffers</a></li>

              <li><a href="#sec-21-2">Listing Existing Buffers</a></li>

              <li><a href="#sec-21-3">Killing Buffers</a></li>

              <li><a href="#sec-21-4">Operating on Several Buffers</a></li>

              <li><a href="#sec-21-5">Convenience Features and Customization of
              Buffer Handling</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-22">Multiple Windows</a>

            <ul>
              <li><a href="#sec-22-1">Concepts of Emacs Windows</a></li>

              <li><a href="#sec-22-2">Using Other Windows</a></li>

              <li><a href="#sec-22-3">Deleting and Rearranging Windows</a></li>

              <li><a href="#sec-22-4">Displaying a Buffer in a Window</a></li>

              <li><a href="#sec-22-5">Window Handling Convenience Features and
              Customization</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-23">Frames and Graphical Displays</a>

            <ul>
              <li><a href="#sec-23-1">Mouse Commands for Editing</a></li>

              <li><a href="#sec-23-2">Creating Frames</a></li>

              <li><a href="#sec-23-3">Frame Commands</a></li>

              <li><a href="#sec-23-4">Speedbar Frames</a></li>

              <li><a href="#sec-23-5">Scroll Bars</a></li>

              <li><a href="#sec-23-6">Tool Bars</a></li>

              <li><a href="#sec-23-7">Using Dialog Boxes</a></li>

              <li><a href="#sec-23-8">Tooltips</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-24">International Character Set Support</a>

            <ul>
              <li><a href="#sec-24-1">Language Environments</a></li>

              <li><a href="#sec-24-2">Input Methods</a></li>

              <li><a href="#sec-24-3">Recognizing Coding Systems</a></li>

              <li><a href="#sec-24-4">Specifying a File’s Coding
              System</a></li>

              <li><a href="#sec-24-5">Bidirectional Editing</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-25">Major and Minor Modes</a>

            <ul>
              <li>
                <a href="#sec-25-1">How Major Modes are Chosen</a>

                <ul>
                  <li><a href="#sec-25-1-1">Choice based on the file
                  name</a></li>

                  <li><a href="#sec-25-1-2">Choice based on the interpreter
                  name</a></li>

                  <li><a href="#sec-25-1-3">Choice based on the text at the
                  start of the buffer</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-26">Indentation</a>

            <ul>
              <li><a href="#sec-26-1">Indentation Commands</a></li>

              <li><a href="#sec-26-2">Tabs vs. Spaces</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-27">Commands for Human Languages</a>

            <ul>
              <li><a href="#sec-27-1">Words</a></li>

              <li><a href="#sec-27-2">Sentences</a></li>

              <li><a href="#sec-27-3">Filling Text</a></li>

              <li><a href="#sec-27-4">Case Conversion Commands</a></li>

              <li>
                <a href="#sec-27-5">Outline Mode</a>

                <ul>
                  <li><a href="#sec-27-5-1">outline-minor-mode</a></li>

                  <li><a href="#sec-27-5-2">org-global-cycle +
                  outline-magic</a></li>

                  <li><a href="#sec-27-5-3">org</a></li>

                  <li><a href="#sec-27-5-4">org-struct-mode</a></li>

                  <li><a href="#sec-27-5-5">fold-dwim-org</a></li>
                </ul>
              </li>

              <li><a href="#sec-27-6">Boxquote</a></li>

              <li><a href="#sec-27-7">Phonetic</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-28">Org Mode (Getting Things Done)</a>

            <ul>
              <li>
                <ul>
                  <li><a href="#sec-28-0-1">Activation</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-1">Document Structure</a>

                <ul>
                  <li><a href="#sec-28-1-1">Headlines</a></li>

                  <li><a href="#sec-28-1-2">Visibility cycling</a></li>

                  <li><a href="#sec-28-1-3">2.4 Motion</a></li>

                  <li><a href="#sec-28-1-4">Structure editing</a></li>

                  <li><a href="#sec-28-1-5">Sparse trees</a></li>

                  <li><a href="#sec-28-1-6">Plain lists</a></li>
                </ul>
              </li>

              <li><a href="#sec-28-2">Tables</a></li>

              <li>
                <a href="#sec-28-3">Hyperlinks</a>

                <ul>
                  <li><a href="#sec-28-3-1">External links</a></li>

                  <li><a href="#sec-28-3-2">Handling links</a></li>

                  <li><a href="#sec-28-3-3">Link abbreviations</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-4">“TODO” Items</a>

                <ul>
                  <li><a href="#sec-28-4-1">Basic TODO functionality</a></li>

                  <li><a href="#sec-28-4-2">Extended use of TODO
                  keywords</a></li>

                  <li><a href="#sec-28-4-3">Progress logging</a></li>

                  <li><a href="#sec-28-4-4">Breaking down tasks</a></li>
                </ul>
              </li>

              <li><a href="#sec-28-5">Tags</a></li>

              <li><a href="#sec-28-6">Properties and Columns</a></li>

              <li>
                <a href="#sec-28-7">Dates and Times</a>

                <ul>
                  <li><a href="#sec-28-7-1">Creating time stamps</a></li>

                  <li>
                    <a href="#sec-28-7-2">Deadlines and scheduling</a>

                    <ul>
                      <li><a href="#sec-28-7-2-1">Inserting
                      deadline/schedule</a></li>

                      <li><a href="#sec-28-7-2-2">Repeated tasks</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-28-7-3">Clocking work time</a></li>

                  <li><a href="#sec-28-7-4">Effort estimates</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-8">Capture - Refile - Archive</a>

                <ul>
                  <li>
                    <a href="#sec-28-8-1">Capture</a>

                    <ul>
                      <li><a href="#sec-28-8-1-1"><span class=
                      "todo nilTODO">TODO</span> Ask for refile
                      location</a></li>

                      <li><a href="#sec-28-8-1-2"><span class=
                      "todo nilTODO">TODO</span> Email-to-task</a></li>

                      <li><a href="#sec-28-8-1-3">Capture from command
                      line</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-28-8-2">Attachments</a></li>

                  <li><a href="#sec-28-8-3">Protocols for external
                  access</a></li>

                  <li><a href="#sec-28-8-4">Refile and copy</a></li>

                  <li><a href="#sec-28-8-5">Archiving</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-9">Agenda Views</a>

                <ul>
                  <li><a href="#sec-28-9-1">Agenda files</a></li>

                  <li><a href="#sec-28-9-2">The agenda dispatcher</a></li>

                  <li>
                    <a href="#sec-28-9-3">The Built-in agenda views</a>

                    <ul>
                      <li><a href="#sec-28-9-3-1">Advanced Search</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-28-9-4">Presentation and sorting</a></li>

                  <li><a href="#sec-28-9-5">Agenda commands</a></li>

                  <li><a href="#sec-28-9-6">Custom agenda views</a></li>

                  <li><a href="#sec-28-9-7">Display all active tasks from the
                  current directory</a></li>

                  <li><a href="#sec-28-9-8">Exporting Agenda Views</a></li>

                  <li><a href="#sec-28-9-9">Agenda column view</a></li>

                  <li>
                    <a href="#sec-28-9-10">Not sorted</a>

                    <ul>
                      <li><a href="#sec-28-9-10-1">Mouse cursor doesn’t
                      highlight agenda lines</a></li>

                      <li><a href="#sec-28-9-10-2">Mark a task as DONE and
                      create a follow-up task</a></li>

                      <li><a href="#sec-28-9-10-3">Capture something based on
                      the agenda</a></li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-10">Markup for rich export</a>

                <ul>
                  <li><a href="#sec-28-10-1">Images and Tables</a></li>

                  <li><a href="#sec-28-10-2">Macro replacement</a></li>

                  <li><a href="#sec-28-10-3">Embedded LaTeX</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-11">Exporting</a>

                <ul>
                  <li><a href="#sec-28-11-1">Export options</a></li>

                  <li><a href="#sec-28-11-2">HTML export</a></li>

                  <li><a href="#sec-28-11-3">LaTeX and PDF export</a></li>

                  <li><a href="#sec-28-11-4">“Ignore heading + promote
                  children” tag</a></li>

                  <li><a href="#sec-28-11-5">LaTeX Beamer and PDF
                  export</a></li>

                  <li><a href="#sec-28-11-6">OpenDocument Text (ODT)</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-12">Publishing</a>

                <ul>
                  <li><a href="#sec-28-12-1">Uploading files</a></li>

                  <li><a href="#sec-28-12-2">Triggering publication</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-13">Working With Source Code</a>

                <ul>
                  <li><a href="#sec-28-13-1">Editing source code</a></li>

                  <li><a href="#sec-28-13-2">Evaluating code blocks</a></li>

                  <li><a href="#sec-28-13-3">Library of Babel</a></li>

                  <li><a href="#sec-28-13-4">Languages</a></li>

                  <li><a href="#sec-28-13-5">Prettier (or at least fancier)
                  code block delimiters</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-28-14">Miscellaneous</a>

                <ul>
                  <li><a href="#sec-28-14-1">Ispell</a></li>

                  <li><a href="#sec-28-14-2">Easy templates</a></li>

                  <li>
                    <a href="#sec-28-14-3">Speed keys</a>

                    <ul>
                      <li><a href="#sec-28-14-3-1">Convert Windows Apps key to
                      Hyper</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-28-14-4">Code evaluation and security
                  issues</a></li>

                  <li><a href="#sec-28-14-5">A cleaner outline view</a></li>

                  <li><a href="#sec-28-14-6">Interaction with other
                  packages</a></li>

                  <li><a href="#sec-28-14-7">Org-crypt</a></li>
                </ul>
              </li>

              <li><a href="#sec-28-15">Other</a></li>

              <li><a href="#sec-28-16">A.3 Adding hyperlink types</a></li>

              <li><a href="#sec-28-17">A.5 Tables and lists in arbitrary
              syntax</a></li>

              <li><a href="#sec-28-18">A.6 Dynamic blocks</a></li>

              <li>
                <a href="#sec-28-19">Org-contrib</a>

                <ul>
                  <li><a href="#sec-28-19-1">Org-effectiveness</a></li>

                  <li><a href="#sec-28-19-2">Org-notmuch</a></li>

                  <li><a href="#sec-28-19-3">Google Weather</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-29">TeX</a>

            <ul>
              <li><a href="#sec-29-1">Native TeX Mode</a></li>

              <li><a href="#sec-29-2">AUCTeX</a></li>

              <li><a href="#sec-29-3">Preview-LaTeX</a></li>

              <li><a href="#sec-29-4">RefTeX</a></li>

              <li><a href="#sec-29-5">BibTeX</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-30">SGML and HTML Modes</a>

            <ul>
              <li>
                <a href="#sec-30-1">HTML</a>

                <ul>
                  <li><a href="#sec-30-1-1">html-mode</a></li>

                  <li><a href="#sec-30-1-2">html-helper-mode</a></li>
                </ul>
              </li>

              <li><a href="#sec-30-2">XHTML</a></li>

              <li><a href="#sec-30-3">XML</a></li>

              <li><a href="#sec-30-4">Highlight the closing tag</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-31">Editing Programs</a>

            <ul>
              <li><a href="#sec-31-1">Major Modes for Programming
              Languages</a></li>

              <li><a href="#sec-31-2">Top-Level Definitions, or Defuns</a></li>

              <li><a href="#sec-31-3">Indentation for Programs</a></li>

              <li>
                <a href="#sec-31-4">Commands for Editing with Parentheses</a>

                <ul>
                  <li><a href="#sec-31-4-1">Moving in the Parenthesis
                  Structure</a></li>

                  <li><a href="#sec-31-4-2">Matching Parentheses</a></li>
                </ul>
              </li>

              <li><a href="#sec-31-5">Manipulating Comments</a></li>

              <li><a href="#sec-31-6">Documentation Lookup</a></li>

              <li><a href="#sec-31-7">Hideshow minor mode</a></li>

              <li><a href="#sec-31-8">Completion for Symbol Names</a></li>

              <li><a href="#sec-31-9">Glasses minor mode</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-32">Compiling and Testing Programs</a>

            <ul>
              <li><a href="#sec-32-1">Running Compilations under Emacs</a></li>

              <li><a href="#sec-32-2">Compilation Mode</a></li>

              <li><a href="#sec-32-3">Searching with Grep under Emacs</a></li>

              <li><a href="#sec-32-4">Finding Syntax Errors On The Fly</a></li>

              <li><a href="#sec-32-5">Running Debuggers Under Emacs</a></li>

              <li><a href="#sec-32-6">Debugging Lisp programs</a></li>

              <li><a href="#sec-32-7">Executing Lisp Expressions</a></li>

              <li><a href="#sec-32-8">Libraries of Lisp Code for Emacs</a></li>

              <li><a href="#sec-32-9">Evaluating Emacs Lisp
              Expressions</a></li>

              <li><a href="#sec-32-10">Lisp Interaction Buffers</a></li>

              <li><a href="#sec-32-11">Other</a></li>

              <li><a href="#sec-32-12"><span class="todo nilTODO">TODO</span>
              From Thierry Volpiatto</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-33">Maintaining Programs</a>

            <ul>
              <li>
                <a href="#sec-33-1">Version Control</a>

                <ul>
                  <li><a href="#sec-33-1-1">Version Control and the Mode
                  Line</a></li>

                  <li><a href="#sec-33-1-2">Features of the Log Entry
                  Buffer</a></li>

                  <li><a href="#sec-33-1-3">Examining And Comparing Old
                  Revisions</a></li>

                  <li><a href="#sec-33-1-4">VC Directory Mode</a></li>

                  <li><a href="#sec-33-1-5">Customizing VC</a></li>
                </ul>
              </li>

              <li><a href="#sec-33-2">Change Logs</a></li>

              <li>
                <a href="#sec-33-3">Tags Tables</a>

                <ul>
                  <li><a href="#sec-33-3-1">Creating Tags Tables</a></li>

                  <li><a href="#sec-33-3-2">Selecting a Tags Table</a></li>

                  <li><a href="#sec-33-3-3">Finding a Tag</a></li>

                  <li><a href="#sec-33-3-4">Select from multiple TAGS
                  files</a></li>

                  <li><a href="#sec-33-3-5">Find Emacs Lisp symbol
                  definition</a></li>
                </ul>
              </li>

              <li>
                <a href="#sec-33-4">Emacs Development Environment</a>

                <ul>
                  <li><a href="#sec-33-4-1">Collection of Emacs Development
                  Environment Tools</a></li>

                  <li><a href="#sec-33-4-2">Advanced Code Browsing</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-34">Abbrevs</a>

            <ul>
              <li>
                <a href="#sec-34-1">Controlling Abbrev Expansion</a>

                <ul>
                  <li>
                    <a href="#sec-34-1-1">Installation</a>

                    <ul>
                      <li><a href="#sec-34-1-1-1">Use YASnippet as a global
                      minor mode</a></li>

                      <li><a href="#sec-34-1-1-2">Use
                      <code>yas-minor-mode</code> on a per-buffer
                      basis</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-34-1-2">Organizing snippets</a></li>

                  <li><a href="#sec-34-1-3">Expanding snippets</a></li>

                  <li><a href="#sec-34-1-4">Writing snippets</a></li>

                  <li>
                    <a href="#sec-34-1-5">Frequently Asked Questions</a>

                    <ul>
                      <li><a href="#sec-34-1-5-1">Why is there an extra
                      newline?</a></li>

                      <li><a href="#sec-34-1-5-2">Why doesn’t TAB expand a
                      snippet?</a></li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li>
                <a href="#sec-34-2">Dynamic Abbrev Expansion</a>

                <ul>
                  <li><a href="#sec-34-2-1">Hippie-expand</a></li>

                  <li><a href="#sec-34-2-2">Auto-Complete (“IntelliSensy”
                  completion when writing code)</a></li>

                  <li><a href="#sec-34-2-3">Company mode</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-35">Dired, the Directory Editor</a>

            <ul>
              <li><a href="#sec-35-1">Entering Dired</a></li>

              <li><a href="#sec-35-2">Deleting Files with Dired</a></li>

              <li>
                <a href="#sec-35-3">Visiting Files in Dired</a>

                <ul>
                  <li><a href="#sec-35-3-1">Reuse Dired buffers</a></li>

                  <li>
                    <a href="#sec-35-3-2">Open file with default tool (open
                    directory with Windows Explorer)</a>

                    <ul>
                      <li><a href="#sec-35-3-2-1">Ask a WWW browser to display
                      file</a></li>

                      <li><a href="#sec-35-3-2-2">Many files at once (for
                      Windows)</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-35-3-3">Open file with w3m</a></li>
                </ul>
              </li>

              <li><a href="#sec-35-4">Operating on Files</a></li>

              <li><a href="#sec-35-5">Updating the Dired Buffer</a></li>

              <li><a href="#sec-35-6">Dired and <code>find</code></a></li>

              <li><a href="#sec-35-7">Editing the Dired Buffer</a></li>

              <li><a href="#sec-35-8">Viewing Image Thumbnails in
              Dired</a></li>

              <li><a href="#sec-35-9">Dired Extra</a></li>

              <li><a href="#sec-35-10">Dired+</a></li>

              <li><a href="#sec-35-11">Emulation of <code>ls</code> on
              MS-Windows</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-36">The Calendar and the Diary</a>

            <ul>
              <li><a href="#sec-36-1">Calendar Motion</a></li>

              <li><a href="#sec-36-2">Scroll Calendar</a></li>

              <li><a href="#sec-36-3">Times of Sunrise/Sunset</a></li>

              <li><a href="#sec-36-4">Diary</a></li>

              <li><a href="#sec-36-5">Appointments</a></li>

              <li><a href="#sec-36-6">Advanced Calendar/Diary Usage</a></li>

              <li><a href="#sec-36-7">Calendar framework</a></li>
            </ul>
          </li>

          <li><a href="#sec-37">Sending Mail</a></li>

          <li>
            <a href="#sec-38">Gnus</a>

            <ul>
              <li>
                <a href="#sec-38-1">BBDB</a>

                <ul>
                  <li><a href="#sec-38-1-1">Interfaces</a></li>

                  <li><a href="#sec-38-1-2">Reader-specific Features</a></li>

                  <li><a href="#sec-38-1-3">Options</a></li>

                  <li><a href="#sec-38-1-4">Utilities</a></li>
                </ul>
              </li>
            </ul>
          </li>

          <li>
            <a href="#sec-39">Document Viewing</a>

            <ul>
              <li><a href="#sec-39-1">Navigation</a></li>

              <li><a href="#sec-39-2">Conversion</a></li>

              <li><a href="#sec-39-3">XXX</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-40">Running Shell Commands from Emacs</a>

            <ul>
              <li><a href="#sec-40-1">Single Shell</a></li>

              <li><a href="#sec-40-2">Interactive Shell</a></li>

              <li>
                <a href="#sec-40-3">Shell Mode</a>

                <ul>
                  <li><a href="#sec-40-3-1">Entering commands and fixing
                  mistakes</a></li>

                  <li><a href="#sec-40-3-2">Completion of filenames</a></li>

                  <li><a href="#sec-40-3-3">Manipulating the output from the
                  last command</a></li>

                  <li><a href="#sec-40-3-4">Sending signals</a></li>
                </ul>
              </li>

              <li><a href="#sec-40-4">Shell Prompts</a></li>

              <li>
                <a href="#sec-40-5">History</a>

                <ul>
                  <li><a href="#sec-40-5-1">Command History</a></li>

                  <li><a href="#sec-40-5-2">Manipulating the transcript:
                  Viewing older commands</a></li>
                </ul>
              </li>

              <li><a href="#sec-40-6">Directory Tracking</a></li>

              <li>
                <a href="#sec-40-7">Options</a>

                <ul>
                  <li><a href="#sec-40-7-1">Paging in Shell</a></li>
                </ul>
              </li>

              <li><a href="#sec-40-8">Terminal emulator</a></li>

              <li><a href="#sec-40-9">Term Mode</a></li>

              <li><a href="#sec-40-10">Remote Host</a></li>

              <li><a href="#sec-40-11">Serial Terminal</a></li>

              <li><a href="#sec-40-12">Helper for GNU Emacs on w32</a></li>

              <li>
                <a href="#sec-40-13">Emacs Speaks Statistics (ESS)</a>

                <ul>
                  <li><a href="#sec-40-13-1">2 Installing ESS on your
                  system</a></li>

                  <li><a href="#sec-40-13-2">3 Interacting with statistical
                  programs</a></li>

                  <li><a href="#sec-40-13-3">4 Interacting with the ESS
                  process</a></li>

                  <li><a href="#sec-40-13-4">5 Sending code to the ESS
                  process</a></li>

                  <li>
                    <a href="#sec-40-13-5">7 Editing objects and functions</a>

                    <ul>
                      <li><a href="#sec-40-13-5-1">Code folding</a></li>
                    </ul>
                  </li>

                  <li>
                    <a href="#sec-40-13-6">9 Completion</a>

                    <ul>
                      <li><a href="#sec-40-13-6-1">Integration with
                      auto-complete package</a></li>
                    </ul>
                  </li>

                  <li><a href="#sec-40-13-7">10 Developing with ESS</a></li>

                  <li>
                    <a href="#sec-40-13-8">11 Other ESS features and tools</a>

                    <ul>
                      <li><a href="#sec-40-13-8-1">Describe object at
                      point</a></li>

                      <li><a href="#sec-40-13-8-2">ElDoc</a></li>

                      <li><a href="#sec-40-13-8-3">Rdired</a></li>

                      <li><a href="#sec-40-13-8-4">Interaction with Org
                      mode</a></li>

                      <li><a href="#sec-40-13-8-5">Helm</a></li>
                    </ul>
                  </li>
                </ul>
              </li>

              <li><a href="#sec-40-14">Proced</a></li>
            </ul>
          </li>

          <li><a href="#sec-41">Using Emacs Server</a></li>

          <li><a href="#sec-42">Printing Hard Copies</a></li>

          <li><a href="#sec-43">Sorting Text</a></li>

          <li><a href="#sec-44">Saving Emacs Sessions</a></li>

          <li>
            <a href="#sec-45">Hyperlinking and Navigation Features</a>

            <ul>
              <li>
                <a href="#sec-45-1">Emacs-w3m</a>

                <ul>
                  <li><a href="#sec-45-1-1">9.1 Turning Gnus into a web
                  browser!</a></li>

                  <li><a href="#sec-45-1-2">EWW (Emacs Web Browser)</a></li>
                </ul>
              </li>

              <li><a href="#sec-45-2">Google Maps</a></li>

              <li><a href="#sec-45-3">Babel translator</a></li>
            </ul>
          </li>

          <li><a href="#sec-46">Other Amusements</a></li>

          <li>
            <a href="#sec-47">Customization</a>

            <ul>
              <li><a href="#sec-47-1">Color</a></li>

              <li><a href="#sec-47-2">Color theme</a></li>

              <li><a href="#sec-47-3">Not sorted</a></li>

              <li><a href="#sec-47-4">Variables</a></li>

              <li><a href="#sec-47-5">Key Bindings</a></li>

              <li><a href="#sec-47-6">Syntax Table</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-48">Emacs Display</a>

            <ul>
              <li>
                <a href="#sec-48-1">Faces</a>

                <ul>
                  <li><a href="#sec-48-1-1">UTF-8</a></li>

                  <li><a href="#sec-48-1-2">Anti-aliasing</a></li>

                  <li><a href="#sec-48-1-3">Adjust the height of the default
                  face</a></li>
                </ul>
              </li>

              <li><a href="#sec-48-2">Images</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-49">Calc</a>

            <ul>
              <li>
                <a href="#sec-49-1">Introduction</a>

                <ul>
                  <li><a href="#sec-49-1-1">Basic Commands</a></li>

                  <li><a href="#sec-49-1-2">“Quick Calculator” Mode</a></li>
                </ul>
              </li>

              <li><a href="#sec-49-2">Embedded Mode</a></li>
            </ul>
          </li>

          <li><a href="#sec-50">IRC client for Emacs</a></li>

          <li><a href="#sec-51">Emacs and Microsoft Windows/MS-DOS</a></li>

          <li><a href="#sec-52">Profiler</a></li>

          <li><a href="#sec-53">Reporting Bugs</a></li>

          <li>
            <a href="#sec-54">Tasks</a>

            <ul>
              <li><a href="#sec-54-1"><span class="todo nilTODO">TODO</span>
              Automate reporting of style errors</a></li>
            </ul>
          </li>

          <li>
            <a href="#sec-55">Startup time</a>

            <ul>
              <li><a href="#sec-55-1">Context</a></li>

              <li><a href="#sec-55-2">Timings from my system</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <div id="outline-container-sec-1" class="outline-2">
      <h2 id="sec-1">Description</h2>

      <div class="outline-text-2" id="text-1">
        <p>Emacs can be very difficult for the beginner, as many of the default
        choices may seem (and sometimes are) ugly or awkward.</p>

        <p>But – that’s the joy of Emacs – nearly everything can be adjusted!
        Hence, this set of customizations to “short-cut” that initial
        process.</p>
      </div>
    </div>

    <div id="outline-container-sec-2" class="outline-2">
      <h2 id="sec-2">Header</h2>

      <div class="outline-text-2" id="text-2">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp" id="current-time">
(format-time-string <span class="org-string">"%Y%m%d.%H%M"</span>)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">emacs-leuven.el --- Emacs configuration file with more pleasant defaults</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Copyright (C) 1999-2014 Fabrice Niessen</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">URL: https://github.com/fniessen/emacs-leuven</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Version: 20140828.2130</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Keywords: emacs, dotfile, config</span>

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;    </span><span class=
"org-comment">___ _ __ ___   __ _  ___ ___</span>
<span class="org-comment-delimiter">;;   </span><span class=
"org-comment">/ _ \ '_ ` _ \ / _` |/ __/ __|</span>
<span class="org-comment-delimiter">;;  </span><span class=
"org-comment">|  __/ | | | | | (_| | (__\__ \</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">(_)___|_| |_| |_|\__,_|\___|___/</span>
<span class="org-comment-delimiter">;;</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">This file is NOT part of GNU Emacs.</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">This file is free software: you can redistribute it and/or</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">modify it under the terms of the GNU General Public License as</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">published by the Free Software Foundation, either version 3 of</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">the License, or (at your option) any later version.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">This file is distributed in the hope that it will be useful,</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">GNU General Public License for more details.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">You should have received a copy of the GNU General Public License</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">along with this file. If not, see <a href=
"http://www.gnu.org/licenses/">&lt;http://www.gnu.org/licenses/&gt;</a>.</span>

<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">Commentary:</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Emacs configuration file with many packages already enabled and a more</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">pleasant set of defaults.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Operating systems: supposed to work both for Windows and for Linux.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Minimal .emacs configuration file:</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(add-to-list 'load-path "/path/to/emacs-leuven/")</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(require 'emacs-leuven)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">To get more debug info about the packages getting loaded, add the following</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">line before requiring Emacs Leuven.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">;; show messages describing progress of loading Emacs Leuven</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(setq leuven-load-verbose t)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">To avoid be questioned about packages to add to your local Emacs</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">installation (though, I think you should install them), add the following</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">line before requiring Emacs Leuven.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">;; do not (try to) install extra Emacs packages</span>
<span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(setq leuven-elpa-packages nil)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">For help on the Emacs Editor, see (info "(emacs)")  &lt;== `C-x C-e' here!</span>

<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">Citations:</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">- Show me your ~/.emacs and I will tell you who you are.</span>
<span class="org-comment-delimiter">;;   </span><span class=
"org-comment">-- Bogdan Maryniuk</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">- Emacs is like a laser guided missile.  It only has to be slightly</span>
<span class="org-comment-delimiter">;;   </span><span class=
"org-comment">mis-configured to ruin your whole day.</span>
<span class="org-comment-delimiter">;;   </span><span class=
"org-comment">-- Sean McGrath</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">- While any text editor can save your files, only Emacs can save your soul.</span>
<span class="org-comment-delimiter">;;   </span><span class=
"org-comment">-- Per Abrahamsen</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-3" class="outline-2">
      <h2 id="sec-3">Code</h2>

      <div class="outline-text-2" id="text-3">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">Code:</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">This file is only provided as an example.  Customize it to your own taste!</span>

(message <span class=
"org-string">"* --[ Loading Emacs Leuven 20140828.2130]--"</span>)

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn on Common Lisp support</span>
(<span class="org-keyword">eval-when-compile</span> (<span class=
"org-keyword">require</span> '<span class=
"org-constant">cl</span>))       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">provide useful things like `</span><span class=
"org-comment"><span class="org-constant">loop</span></span><span class=
"org-comment">' and</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class="org-constant">setf</span></span><span class=
"org-comment">'</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">uptimes</span>
(<span class="org-keyword">when</span> (string-match <span class=
"org-string">"XEmacs"</span> (version))
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">XEmacs doesn't have `</span><span class=
"org-comment"><span class="org-constant">float-time</span></span><span class=
"org-comment">'</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">float-time</span> ()
    <span class="org-doc">"Convert `</span><span class="org-doc"><span class=
"org-constant">current-time</span></span><span class=
"org-doc">' to a floating point number."</span>
    (multiple-value-bind (s0 s1 s2) (current-time)
      (+ (* (float (ash 1 16)) s0) (float s1) (* 0.0000001 s2)))))

(<span class="org-keyword">defconst</span> <span class=
"org-variable-name">leuven-before-time</span> (float-time)
  <span class="org-doc">"Value of `</span><span class="org-doc"><span class=
"org-constant">float-time</span></span><span class=
"org-doc">' before loading the Emacs Leuven library."</span>)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">User Customizable Internal Variables</span>

(<span class="org-keyword">defgroup</span> <span class=
"org-type">leuven</span> nil
  <span class="org-doc">"Set of Emacs customizations (better defaults)."</span>
  <span class="org-builtin">:group</span> 'convenience
  <span class="org-builtin">:group</span> 'text)

(<span class="org-keyword">defcustom</span> <span class=
"org-variable-name">leuven-load-verbose</span> nil
  <span class=
"org-doc">"If non-nil, means show messages describing progress of loading Emacs Leuven."</span>
  <span class="org-builtin">:group</span> 'emacs-leuven
  <span class="org-builtin">:type</span> 'integer)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> (and (string-match <span class=
"org-string">"GNU Emacs"</span> (version))
           leuven-load-verbose)
  (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">message</span> (before leuven-when-was-that activate)
    <span class="org-doc">"Add time stamps to `</span><span class=
"org-doc"><span class="org-constant">message</span></span><span class=
"org-doc">' output."</span>
    (ad-set-arg 0 (concat (format-time-string <span class=
"org-string">"[%Y-%m-%d %T."</span>)
                          (substring (format-time-string <span class=
"org-string">"%N"</span>) 0 3)
                          (format-time-string <span class=
"org-string">"] "</span>)
                          (ad-get-arg 0)))))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">allow quick include/exclude of setup parts -- DO NOT EDIT the DEFVAR!</span>
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-0-environment</span> t) <span class=
"org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-0-loading-libraries</span> t) <span class=
"org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-0-debugging</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-47-packages</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-1-screen</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-6-exiting</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-7-basic</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-8-minibuffer</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-10-help</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-11-mark</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-12-killing</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-13-registers</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-14-display</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-15-search</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-16-fixit</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-17-keyboard-macros</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-18-files</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-19-buffers</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-20-windows</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-21-frames</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-22-international</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-23-major-and-minor-modes</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-24-indentation</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-25-text</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-25.9-org-mode</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-25.10-tex-mode</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-26-programs</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-27-building</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-28-maintaining</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-29-abbrevs</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-30-dired</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-31-calendar-diary</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-32-sending-mail</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-34-gnus</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-35-document-view</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-36-shell</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-37-emacs-server</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-38-printing</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-39-sorting</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-42-saving-emacs-sessions</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-45-hyperlinking</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-46-amusements</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-48-customization</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-AppG-ms-dos</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-XX-emacs-display</span> t)
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-chapter-99-debugging</span> t)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven--load-times-list</span> nil
  <span class="org-doc">"List of chapters and time to load them."</span>)

(<span class="org-keyword">defmacro</span> <span class=
"org-function-name">leuven--chapter</span> (chapterid chaptername <span class=
"org-type">&amp;rest</span> body)
  <span class=
"org-doc">"When CHAPTERID is not nil, report as CHAPTERNAME the evaluation of BODY.</span>
<span class=
"org-doc">Save execution times in the global list `</span><span class=
"org-doc"><span class=
"org-constant">leuven--load-times-list</span></span><span class=
"org-doc">'."</span>
  `(<span class="org-keyword">when</span> ,chapterid
     (<span class="org-keyword">let</span> (before-chapter-time
           this-chapter-time)
       (<span class="org-keyword">when</span> leuven-load-verbose
         (message <span class="org-string">"** %s"</span> ,chaptername))
       (setq before-chapter-time (float-time))
       (setq leuven--before-section-time (float-time)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">init section time</span>
       (<span class="org-keyword">progn</span> ,@body)
       (leuven--section (concat <span class=
"org-string">"["</span> ,chaptername <span class=
"org-string">" ends here]"</span>) 'end-of-chapter)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">add fake closing section</span>
       (setq this-chapter-time
             (format <span class=
"org-string">"%.3f"</span> (- (float-time) before-chapter-time)))
       (add-to-list 'leuven--load-times-list
                    (concat <span class=
"org-string">"| "</span> ,chaptername <span class="org-string">" "</span>
                            <span class=
"org-string">"| "</span> this-chapter-time <span class=
"org-string">" |"</span>)))))

(<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven--before-section-time</span>
  <span class="org-string">"Value of `</span><span class=
"org-string"><span class="org-constant">float-time</span></span><span class=
"org-string">' before loading some section."</span>)

(<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--section</span> (sectionname <span class=
"org-type">&amp;optional</span> end-of-chapter)
  <span class=
"org-doc">"Report under SECTIONNAME the time taken since it was last saved.</span>
<span class=
"org-doc">Last time is saved in global variable `</span><span class="org-doc"><span class="org-constant">leuven--before-section-time</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((this-section-time (- (float-time)
                              leuven--before-section-time)))
    (<span class="org-keyword">when</span> leuven-load-verbose
      (<span class=
"org-keyword">when</span> (not (equal this-section-time 0.000))
        (message <span class=
"org-string">"    Section time: %.3f s"</span> this-section-time))
      (<span class=
"org-keyword">unless</span> end-of-chapter (message <span class=
"org-string">"*** %s"</span> sectionname)))
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for next one</span>
    (setq leuven--before-section-time (float-time))))
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-4" class="outline-2">
      <h2 id="sec-4">Loading Libraries of Lisp Code for Emacs</h2>

      <div class="outline-text-2" id="text-4">
        <p>Adding the right Lisp directories to your <code>load-path</code>
        (list of directories where Emacs Lisp libraries – <code>.el</code> and
        <code>.elc</code> files – are installed) must be the very <b>first
        thing</b> in your <code>.emacs</code> file, before the first time
        packages are required, to make sure that you’re not picking up bits and
        pieces from older files (bundled with Emacs, and loaded before the path
        to the <b>newest</b> versions are set).</p>

        <p>The most important directories are the last to be added to
        <code>load-path</code> (so that they become the first of the list)!</p>

        <p>Use <code>M-x list-load-path-shadows &lt;RET&gt;</code> to display a
        list of external Emacs Lisp files that shadow Emacs builtins (listing
        potential load path problems).</p>

        <p>Some Emacs modes are over 10K lines of code (e.g.
        <code>nxml-mode</code>, <code>CEDET</code>). Many packages (e.g.
        <code>Org</code>, <code>Gnus</code>) make use of the
        <code>autoload</code> feature, so that you only need to load a single
        file that define autoloaded functions.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Loading Libraries of Lisp Code for Emacs</span>

(leuven--chapter leuven-chapter-0-loading-libraries <span class=
"org-string">"0 Loading Libraries"</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load-path enhancement</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-add-to-load-path</span> (this-directory)
    <span class=
"org-doc">"Add THIS-DIRECTORY at the beginning of the load-path, if it exists."</span>
    (<span class="org-keyword">when</span> (and this-directory
               (file-directory-p this-directory))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Add warning if directory does not exist</span>
      (<span class=
"org-keyword">let*</span> ((this-directory (expand-file-name this-directory)))

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directories containing a `</span><span class=
"org-comment"><span class="org-constant">.nosearch</span></span><span class=
"org-comment">' file (such as</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`auctex-11.87\style') should not made part of `</span><span class="org-comment"><span class="org-constant">load-path</span></span><span class="org-comment">'.</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> `</span><span class="org-comment"><span class=
"org-constant">RCS</span></span><span class=
"org-comment">' and `</span><span class="org-comment"><span class=
"org-constant">CVS</span></span><span class=
"org-comment">' directories should also be excluded.</span>
        (<span class=
"org-keyword">unless</span> (file-exists-p (concat this-directory <span class=
"org-string">"/.nosearch"</span>))
          (add-to-list 'load-path this-directory)
          (<span class="org-keyword">when</span> leuven-load-verbose
            (message <span class=
"org-string">"(Info) Added `</span><span class="org-string"><span class=
"org-constant">%s</span></span><span class=
"org-string">' to `</span><span class="org-string"><span class=
"org-constant">load-path</span></span><span class=
"org-string">'"</span> this-directory))))))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remember this directory</span>
  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">leuven--directory</span>
    (file-name-directory (or load-file-name (buffer-file-name)))
    <span class="org-doc">"Directory path of Emacs Leuven."</span>)

  (leuven-add-to-load-path
   (concat leuven--directory <span class="org-string">"site-lisp"</span>))
</pre>
        </div>

        <p><code>leuven-local-repos-directory</code> is where you put Emacs
        Git/SVN/CSV repositories.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-local-repos-directory</span> <span class=
"org-string">"~/Public/Repositories/"</span>
    <span class=
"org-doc">"Directory containing additional Emacs Lisp public repositories."</span>)

  (leuven-add-to-load-path
   (concat leuven-local-repos-directory <span class=
"org-string">"babel"</span>))
  (leuven-add-to-load-path
   (concat leuven-local-repos-directory <span class=
"org-string">"emacs-bookmark-extension"</span>))
</pre>
        </div>

        <table class="inlinetask" width="100%">
          <tr>
            <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

            <td width="100%"><b>Specify variables using
            `defcustom’</b><br /></td>
          </tr>
        </table>

        <p><code>leuven-user-lisp-directory</code> is there so that you have an
        easy way of installing <b>your own Emacs add-ons</b> (which may be
        specific to the version of Emacs you’re running). This keeps your local
        add-ons apart from distro supplied ones.</p>

        <p>It also means you can do a complete re-install of Emacs (or even
        your Linux distro) without impacting on stuff you have added by
        hand.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-user-lisp-directory</span> <span class=
"org-string">"~/.emacs.d/lisp/"</span>
    <span class=
"org-doc">"Directory containing personal additional Emacs Lisp packages."</span>)

  (leuven-add-to-load-path leuven-user-lisp-directory)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">require a feature/library if available; if not, fail silently</span>
  (<span class="org-keyword">unless</span> (fboundp 'try-require)
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">try-require</span> (feature)
      <span class="org-doc">"Attempt to load a FEATURE (or library).</span>
<span class=
"org-doc">    Return true if the library given as argument is successfully loaded.  If</span>
<span class="org-doc">    not, just print a message."</span>
      (<span class="org-keyword">condition-case</span> err
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">if</span> (stringp feature)
                (load-library feature)
              (<span class="org-keyword">require</span> <span class=
"org-constant">feature</span>))
            t)                              <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">necessary for correct behavior in</span>
                                            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">conditional expressions</span>
        (file-error
         (message <span class="org-string">"Requiring `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'... missing"</span> feature)
         nil))))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">TEMPORARY</span>
  (<span class="org-keyword">unless</span> (fboundp 'with-eval-after-load)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">wrapper around `</span><span class="org-comment"><span class=
"org-constant">eval-after-load</span></span><span class=
"org-comment">' (added in GNU Emacs 24.4)</span>
    (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">with-eval-after-load</span> (mode <span class=
"org-type">&amp;rest</span> body)
      <span class="org-doc">"`</span><span class="org-doc"><span class=
"org-constant">eval-after-load</span></span><span class=
"org-doc">' MODE evaluate BODY."</span>
      (<span class="org-keyword">declare</span> (indent defun))
      `(eval-after-load ,mode
         '(<span class="org-keyword">progn</span> ,@body))))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 0-loading-libraries ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-5" class="outline-2">
      <h2 id="sec-5">Environment</h2>

      <div class="outline-text-2" id="text-5">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(list system-configuration system-type window-system)
</pre>
        </div>

        <dl class="org-dl">
          <dt><code>system-type</code></dt>

          <dd><code>darwin</code>, <code>gnu/linux</code>,
          <code>cygwin</code>.</dd>

          <dt><code>system-configuration</code></dt>

          <dd><code>i686-pc-linux-gnu</code>, <code>i686-pc-cygwin</code>.</dd>

          <dt><code>window-system</code></dt>

          <dd><code>nil</code>, <code>w32</code>, <code>x</code>,
          <code>mac</code>. Use <code>(display-graphic-p)</code> in
          conditions.</dd>
        </dl>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Environment</span>

(leuven--chapter leuven-chapter-0-environment <span class=
"org-string">"0 Environment"</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Type of OS</span>

  (leuven--section <span class="org-string">"Type of OS"</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-ms-windows</span>
    (eq system-type 'windows-nt)
    <span class=
"org-doc">"Running a native Microsoft Windows version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-cygwin</span>
    (eq system-type 'cygwin)
    <span class="org-doc">"Running a Cygwin version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-gnu-linux</span>
    (eq system-type 'gnu/linux)
    <span class="org-doc">"Running a GNU/Linux version of Emacs."</span>)

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">MSWindows</span> (<span class=
"org-type">&amp;rest</span> body)
    (list 'if running-ms-windows
          (cons 'progn body)))

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">GNULinux</span> (<span class=
"org-type">&amp;rest</span> body)
    (list 'if running-gnu-linux
          (cons 'progn body)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Window system</span>

  (leuven--section <span class="org-string">"Window system"</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-x-window</span>
    (eq window-system 'x)
    <span class="org-doc">"Running X Window System."</span>)

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">XWindow</span> (<span class=
"org-type">&amp;rest</span> body)
    <span class=
"org-doc">"Execute any number of forms if running X Window System."</span>
    (list 'if running-x-window
          (cons 'progn body)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** MS Windows</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> The path is not correct under Cygwin Emacs (gsprint.exe not found)</span>
  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">windows-program-files-dir</span>   <span class=
"org-comment-delimiter">; </span><span class="org-comment">sys-path</span>
    (<span class="org-keyword">if</span> running-ms-windows
        (file-name-as-directory (getenv <span class=
"org-string">"PROGRAMFILES"</span>))
      <span class="org-string">"/usr/local/bin/"</span>)
    <span class=
"org-doc">"Defines the default Windows Program Files folder."</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Testing Emacs versions</span>

  (leuven--section <span class="org-string">"Emacs version"</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-gnu-emacs</span>
    (string-match <span class="org-string">"GNU Emacs"</span> (version))
    <span class="org-doc">"Running GNU Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">running-xemacs</span>
    (string-match <span class="org-string">"XEmacs"</span> (version))
    <span class="org-doc">"Running XEmacs."</span>)

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">GNUEmacs</span> (<span class=
"org-type">&amp;rest</span> body)
    <span class=
"org-doc">"Execute any number of forms if running GNU Emacs."</span>
    (list 'if running-gnu-emacs
          (cons 'progn body)))

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">GNUEmacs24</span> (<span class=
"org-type">&amp;rest</span> body)
    (list 'if (string-match <span class=
"org-string">"GNU Emacs 24"</span> (version))
          (cons 'progn body)))

  (<span class="org-keyword">defmacro</span> <span class=
"org-function-name">XEmacs</span> (<span class=
"org-type">&amp;rest</span> body)
    <span class=
"org-doc">"Execute any number of forms if running XEmacs."</span>
    (list 'if running-xemacs
          (cons 'progn body)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Testing file accessibility</span>

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--file-exists-and-executable-p</span> (file)
    <span class=
"org-doc">"Make sure the file FILE exists and is executable."</span>
    (<span class="org-keyword">if</span> file
        (<span class="org-keyword">if</span> (file-executable-p file)
            file
          (message <span class=
"org-string">"(warning) Can't find executable `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'"</span> file)
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sleep 1.5 s so that you can see the warning</span>
          (sit-for 1.5))
      (<span class="org-warning">error</span> <span class=
"org-string">"Missing argument to \"leuven--file-exists-and-executable-p\""</span>)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Init</span>

  (leuven--section <span class="org-string">"Init"</span>)

  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't load init file from `</span><span class=
"org-comment"><span class=
"org-constant">~/.xemacs/init.el</span></span><span class=
"org-comment">' (and don't offer its</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">migration)</span>
    (setq load-home-init-file t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ensure that the echo area is always visible during the early stage of</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">startup (useful in case of error)</span>
  (modify-all-frames-parameters
   '((height . 32)))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 0 ends here</span>
</pre>
        </div>

        <table class="inlinetask" width="100%">
          <tr>
            <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

            <td width="100%">
              <b>Function for finding executables</b><br />

              <p>See function <code>--find-program</code> at <a href=
              "http://www.visualco.de/src/elisp/.emacs.el.html">http://www.visualco.de/src/elisp/.emacs.el.html</a>.</p>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div id="outline-container-sec-6" class="outline-2">
      <h2 id="sec-6">Debugging</h2>

      <div class="outline-text-2" id="text-6">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Debugging</span>

(leuven--chapter leuven-chapter-0-debugging <span class=
"org-string">"0 Debugging"</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get the backtrace when uncaught errors occur</span>
  (setq debug-on-error t)               <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">will be unset at the end</span>

  (XEmacs
    (setq stack-trace-on-error t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hit `</span><span class="org-comment"><span class=
"org-constant">C-g</span></span><span class=
"org-comment">' while it's frozen to get an Emacs Lisp backtrace</span>
  (setq debug-on-quit nil)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 0 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-7" class="outline-2">
      <h2 id="sec-7">Emacs Lisp Packages</h2>

      <div class="outline-text-2" id="text-7">
        <p>Another <b>first thing</b> in your init script should be
        <code>(package-initialize)</code> so that customization of Org
        variables (for example) doesn’t auto-load the old version that came
        with Emacs.</p>

        <p>If you require something from Org mode, it must be after
        <code>package-initialize</code>.</p>
      </div>

      <div id="outline-container-sec-7-1" class="outline-3">
        <h3 id="sec-7-1">The Package Menu Buffer</h3>

        <div class="outline-text-3" id="text-7-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 47 Emacs Lisp (info "(emacs)Packages")</span>

(leuven--chapter leuven-chapter-47-packages <span class=
"org-string">"47 Emacs Lisp Packages"</span>
</pre>
          </div>

          <p>To upgrade packages after running
          <code>package-list-packages</code>, type:</p>

          <ul class="org-ul">
            <li><code>U</code> (<i>mark Upgradable packages</i>) and then</li>

            <li><code>x</code> (<i>eXecute the installs and
            deletions</i>).</li>
          </ul>

          <p>When it’s done installing all the packages, you delete the
          obsolete packages by hitting <code>y</code> (<i>Yes</i>) when
          asked.</p>
        </div>
      </div>

      <div id="outline-container-sec-7-2" class="outline-3">
        <h3 id="sec-7-2">Package Installation</h3>

        <div class="outline-text-3" id="text-7-2">
          <ul class="org-ul">
            <li>User’s Emacs Lisp packages in <code>package-user-dir</code>
            (<code>~/.emacs.d/elpa</code>)</li>

            <li>System-wide Emacs Lisp packages in
            <code>package-directory-list</code></li>
          </ul>

          <p>In Marmalade, the developers themselves do the packaging. In
          MELPA, packages are generated programmatically from upstream
          Git-based sources.</p>

          <p>Note – The Marmalade repository is not recommended by Flycheck
          (due to frequent outages).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 47.2 Package Installation</span>

  (leuven--section <span class="org-string">"47.2 Package Installation"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">simple package system for GNU Emacs</span>
  (GNUEmacs
    (<span class="org-keyword">when</span> (try-require 'package)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">archives from which to fetch</span>
      (setq package-archives
            (append '((<span class=
"org-string">"org"</span>       . <span class=
"org-string">"http://orgmode.org/elpa/"</span>)
                      (<span class=
"org-string">"melpa"</span>     . <span class=
"org-string">"http://melpa.milkbox.net/packages/"</span>)
                      <span class=
"org-comment-delimiter">;; </span><span class="org-comment">("marmalade" . "http://marmalade-repo.org/packages/")</span>
                      <span class=
"org-comment-delimiter">;; </span><span class="org-comment">("ELPA"      . "http://tromey.com/elpa/")</span>
                      )
                    package-archives))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load the latest version of all installed packages, and activate them</span>
      (package-initialize)              <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">add ALL ELPA subdirs to `</span><span class=
"org-comment"><span class="org-constant">load-path</span></span><span class=
"org-comment">'</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">and load `</span><span class="org-comment"><span class=
"org-constant">&lt;pkg&gt;-autoloads.el</span></span><span class=
"org-comment">'</span>

      (<span class="org-keyword">defcustom</span> <span class=
"org-variable-name">leuven-elpa-packages</span>
        '(ace-jump-mode auctex auto-complete bbdb bookmark+ boxquote calfw circe
          company csv-mode dictionary dired+ dired-single ess
          fill-column-indicator flycheck fuzzy git-commit-mode graphviz-dot-mode
          helm helm-R htmlize idle-require info+ interaction-log ledger-mode
          leuven-theme multiple-cursors org-mime pager rainbow-mode redo+
          sml-modeline tidy yasnippet
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">jabber multi-term paredit redshank w3m</span>
          )
        <span class=
"org-doc">"A list of packages to ensure are installed at Emacs startup."</span>
        <span class="org-builtin">:group</span> 'emacs-leuven
        <span class="org-builtin">:type</span> '(repeat (string)))

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--missing-elpa-packages</span> ()
        <span class=
"org-doc">"List packages to install which are neither built-in nor already installed."</span>
        (<span class="org-keyword">let</span> (missing-elpa-packages)
          (<span class="org-keyword">dolist</span> (pkg leuven-elpa-packages)
            (<span class=
"org-keyword">unless</span> (or (package-installed-p pkg)
                        (locate-library (symbol-name pkg)))
              (push pkg missing-elpa-packages)))
          missing-elpa-packages))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">propose to install all the packages specified in `</span><span class="org-comment"><span class="org-constant">leuven-elpa-packages</span></span><span class="org-comment">'</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">which are missing</span>
      (<span class=
"org-keyword">let</span> ((missing-elpa-packages (leuven--missing-elpa-packages)))
        (<span class="org-keyword">when</span> missing-elpa-packages
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">download once the ELPA archive description</span>
          (package-refresh-contents)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Ensure that the list of packages is</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">up-to-date.  Otherwise, new packages</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">(not present in the cache of the ELPA</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">contents) won't install.</span>
          (<span class="org-keyword">dolist</span> (pkg missing-elpa-packages)
            (<span class=
"org-keyword">if</span> (yes-or-no-p (format <span class=
"org-string">"Install ELPA package `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'? "</span> pkg))
                (<span class="org-keyword">ignore-errors</span>
                  (package-install pkg))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">must be run after initializing</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">package-initialize</span></span><span class=
"org-comment">'</span>
              (message (concat <span class=
"org-string">"Customize `</span><span class="org-string"><span class=
"org-constant">leuven-elpa-packages</span></span><span class=
"org-string">' to ignore "</span>
                               <span class=
"org-string">"the `</span><span class="org-string"><span class=
"org-constant">%s</span></span><span class=
"org-string">' package at next startup..."</span>) pkg)
              (sit-for 1.5)))))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't truncate package names in Emacs package list</span>
      (add-hook 'package-menu-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (setq tabulated-list-format
                        [(<span class=
"org-string">"Package"</span> 28 package-menu--name-predicate)
                         (<span class="org-string">"Version"</span> 14 nil)
                         (<span class=
"org-string">"Status"</span>  10 package-menu--status-predicate)
                         (<span class=
"org-string">"Description"</span> 0 nil)])
                  (tabulated-list-init-header)))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 47 ends here</span>
</pre>
          </div>

          <p><code>Idle-require</code> must be loaded <b>after</b>
          <code>package-initialize</code>, and should not be cancelable; hence,
          we put it out of a “chapter”.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">if</span> (try-require 'idle-require)

      (<span class="org-keyword">progn</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">idle time in seconds after which autoload functions will be loaded</span>
        (setq idle-require-idle-delay 5)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time in seconds between automatically loaded functions</span>
        (setq idle-require-load-break 2))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fail-safe for `</span><span class="org-comment"><span class=
"org-constant">idle-require</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">idle-require</span> (feature <span class=
"org-type">&amp;optional</span> file noerror)
      (try-require feature)))

  (add-hook 'after-init-hook
            (<span class="org-keyword">lambda</span> ()
              (<span class=
"org-keyword">when</span> (fboundp 'idle-require-mode)
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">starts loading</span>
                (idle-require-mode 1))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-7-3" class="outline-3">
        <h3 id="sec-7-3"><span class="todo TODO">TODO</span> Check Org mode
        version</h3>

        <div class="outline-text-3" id="text-7-3">
          <p>The following block checks for the Org mode version, and warns the
          user if not equal to 8 or more.</p>

          <p>Though, it does load the full Org mode right from the start…</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">version info</span>
(<span class=
"org-keyword">let</span> ((org-install-dir (file-name-directory (locate-library <span class="org-string">"org-loaddefs"</span>)))
      (org-dir (file-name-directory (locate-library <span class=
"org-string">"org"</span>)))) <span class=
"org-comment-delimiter">; </span><span class="org-comment">org.(el|elc)</span>
  (message <span class="org-string">"Org mode version %s (org @ %s)"</span>
           (org-version)
           (<span class=
"org-keyword">if</span> (string= org-dir org-install-dir)
               org-install-dir
             (concat <span class=
"org-string">"mixed installation! "</span> org-install-dir <span class=
"org-string">" and "</span> org-dir)
             (sit-for 1.5))))

(<span class="org-keyword">unless</span> (string-match <span class=
"org-string">"^8"</span> (org-version))
  (message (concat <span class=
"org-string">"This version of Org mode is no longer supported.  "</span>
                   <span class=
"org-string">"Please upgrade to 8 or later"</span>))
  (sit-for 1.5))
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-8" class="outline-2">
      <h2 id="sec-8">The Organization of the Screen</h2>

      <div class="outline-text-2" id="text-8">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 1 The Organization of the (info "(emacs)Screen")</span>

(leuven--chapter leuven-chapter-1-screen <span class=
"org-string">"1 The Organization of the Screen"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-8-1" class="outline-3">
        <h3 id="sec-8-1">The Echo Area</h3>

        <div class="outline-text-3" id="text-8-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 1.2 The (info "(emacs)Echo Area")</span>

  (leuven--section <span class="org-string">"1.2 (emacs) The Echo Area"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't truncate the message log buffer when it becomes large</span>
  (setq message-log-max t)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 1 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-9" class="outline-2">
      <h2 id="sec-9">Exiting Emacs</h2>

      <div class="outline-text-2" id="text-9">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 6 (info "(emacs)Exiting") Emacs</span>

(leuven--chapter leuven-chapter-6-exiting <span class=
"org-string">"6 Exiting Emacs"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">quit with Alt + F4</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;M-f4&gt;"</span>) 'save-buffers-kill-terminal)

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 6 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-10" class="outline-2">
      <h2 id="sec-10">Basic Editing Commands</h2>

      <div class="outline-text-2" id="text-10">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 7 (info "(emacs)Basic") Editing Commands</span>

(leuven--chapter leuven-chapter-7-basic <span class=
"org-string">"7 Basic Editing Commands"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-10-1" class="outline-3">
        <h3 id="sec-10-1">Inserting Text</h3>

        <div class="outline-text-3" id="text-10-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 7.1 (info "(emacs)Inserting Text")</span>

  (leuven--section <span class="org-string">"7.1 (emacs)Inserting Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enter characters by their code in octal (for `C-q NNN &lt;RET&gt;')</span>
  (setq read-quoted-char-radix 8)       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">16 for hexadecimal (for Unicode char)</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-10-2" class="outline-3">
        <h3 id="sec-10-2">Moving Point Location</h3>

        <div class="outline-text-3" id="text-10-2">
          <dl class="org-dl">
            <dt>M-r</dt>

            <dd>
              <p><code>move-to-window-line</code>.</p>
            </dd>

            <dt><code>M-g g</code></dt>

            <dd>
              <p>Move point to the beginning of line number <i>N</i>
              (<code>goto-line</code>).</p>

              <p>Under XEmacs, this was bound by default to <code>M-g</code>.
              But we cannot do that in GNU Emacs as <code>M-g</code> is a
              prefix key here…</p>
            </dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 7.2 (info "(emacs)Moving Point") Location</span>

  (leuven--section <span class=
"org-string">"7.2 (emacs)Moving Point Location"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't add newlines to end of buffer when scrolling</span>
  (setq next-line-add-newlines nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">print the current buffer line number</span>
  (global-set-key
    (kbd <span class="org-string">"M-G"</span>) 'what-line)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-10-3" class="outline-3">
        <h3 id="sec-10-3">Basic Undoing Changes</h3>

        <div class="outline-text-3" id="text-10-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 7.4 (info "(emacs)Basic Undo")ing Changes</span>

  (leuven--section <span class=
"org-string">"7.4 (emacs)Basic Undoing Changes"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">undo some previous changes</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f11&gt;"</span>) 'undo)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">redo the most recent undo</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"redo+"</span>)
    (autoload 'redo <span class="org-string">"redo+"</span> <span class=
"org-doc">"Redo the the most recent undo."</span> t)
    (global-set-key
      (kbd <span class="org-string">"&lt;S-f11&gt;"</span>) 'redo))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 7 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-11" class="outline-2">
      <h2 id="sec-11">The Minibuffer</h2>

      <div class="outline-text-2" id="text-11">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 8 The (info "(emacs)Minibuffer")</span>

(leuven--chapter leuven-chapter-8-minibuffer <span class=
"org-string">"8 The Minibuffer"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">how long to display an echo-area message when the minibuffer is active</span>
  (setq minibuffer-message-timeout 0.5)
</pre>
        </div>
      </div>

      <div id="outline-container-sec-11-1" class="outline-3">
        <h3 id="sec-11-1">Editing in the Minibuffer</h3>

        <div class="outline-text-3" id="text-11-1">
          <p>If the output is short enough to display in the echo area (which
          is determined by the variables <code>resize-mini-windows</code> and
          <code>max-mini-window-height</code>), it is shown in echo area.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.3 (info "(emacs)Minibuffer Edit")ing</span>

  (leuven--section <span class=
"org-string">"8.3 (emacs)Minibuffer Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minibuffer and echo area windows resize vertically as necessary to fit</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the text displayed in them</span>
  (setq resize-mini-windows t)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-11-2" class="outline-3">
        <h3 id="sec-11-2">Completion</h3>

        <div class="outline-text-3" id="text-11-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.4 (info "(emacs)Completion")</span>

  (leuven--section <span class="org-string">"8.4 (emacs)Completion"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't consider case significant in completion (GNU Emacs default)</span>
  (XEmacs
    (setq completion-ignore-case t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ignore case when reading a file name</span>
  (setq read-file-name-completion-ignore-case t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ignore case when reading a buffer name</span>
  (setq read-buffer-completion-ignore-case t)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">provide the same facility of `ls --color' inside Emacs</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"dircolors"</span>)
    (autoload 'dircolors <span class="org-string">"dircolors"</span> nil t)
    (add-hook 'completion-list-mode-hook 'dircolors))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-11-3" class="outline-3">
        <h3 id="sec-11-3">Repeating Minibuffer Commands</h3>

        <div class="outline-text-3" id="text-11-3">
          <p>Use <code>M-x list-command-history</code> to display the entire
          command history, showing all the commands <code>C-x &lt;ESC&gt;
          &lt;ESC&gt;</code> can repeat, most recent first.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 8 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-12" class="outline-2">
      <h2 id="sec-12">Help</h2>

      <div class="outline-text-2" id="text-12">
        <p>In general, the following functions are very interesting for finding
        useful functions and documentation.</p>

        <dl class="org-dl">
          <dt><code>apropos-documentation</code> (<code>C-h d</code>)</dt>

          <dd><b>Show symbols whose documentation contains matches for
          PATTERN.</b> For example, <code>C-h d yank properties
          &lt;RET&gt;</code>.</dd>

          <dt><code>describe-function</code> (<code>C-h f</code>)</dt>

          <dd>Used with TAB completion to show documentation of functions.</dd>

          <dt><code>elisp-index-search</code> (<code>C-h E</code> in Emacs
          Leuven)</dt>

          <dd>Look up documentation on broad Emacs Lisp topics (in the indices
          of the Emacs Lisp Reference Manual).</dd>

          <dt><code>info-lookup-symbol</code> (<code>C-h S</code>, or
          <code>C-f1</code> in Emacs Leuven)</dt>

          <dd><b>Bring the relevant section from the manual, which describes
          the topic in more detail.</b></dd>
        </dl>

        <p>With all prefix keys, if you follow them with <code>C-h</code>
        (<code>h</code> for help), a list of key bindings in that prefix map is
        displayed. This is automatic and is one of the self-documenting
        features of Emacs.</p>

        <p>Try, for example <code>C-x C-h</code> or <code>C-c C-x C-h</code> to
        see what it does. I do use it to remind myself of rarely used rectangle
        commands: <code>C-x r C-h</code>.</p>

        <p>FYI, <code>catman</code> create the database files that are used by
        <code>apropos</code> or <code>man -k</code>.</p>

        <p>Note about PHP documentation lookup – PHP Mode has a nice feature to
        lookup the function’s definition in PHP’s manual in your web browser
        (<code>M-x php-search-documentation</code> or <code>C-c C-f</code>).
        You can combine it with Emacs-w3m to get the relevant manual page
        without leaving Emacs.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 10 (info "(emacs)Help")</span>

(leuven--chapter leuven-chapter-10-help <span class=
"org-string">"10 Help"</span>
</pre>
        </div>

        <p><b>Close</b> the help buffer by pressing <code>Q</code>.</p>
      </div>

      <div id="outline-container-sec-12-1" class="outline-3">
        <h3 id="sec-12-1">Help Summary</h3>

        <div class="outline-text-3" id="text-12-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.1 (info "(emacs)Help Summary")</span>

  (leuven--section <span class="org-string">"10.1 (emacs)Help Summary"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">find convenient unbound keystrokes (undefined key bindings)</span>
  (autoload 'describe-unbound-keys <span class="org-string">"unbound"</span>
    <span class=
"org-doc">"Display a list of unbound keystrokes of complexity no greater than MAX."</span> t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">avoid the description of all minor modes</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">describe-major-mode</span> ()
    <span class="org-doc">"Describe only `</span><span class=
"org-doc"><span class="org-constant">major-mode</span></span><span class=
"org-doc">'."</span>
    (interactive)
    (describe-function major-mode))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">look up subject in (the indices of the) Emacs Lisp manual</span>
  (global-set-key
    (kbd <span class="org-string">"C-h E"</span>) 'elisp-index-search)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-12-2" class="outline-3">
        <h3 id="sec-12-2">Apropos</h3>

        <div class="outline-text-3" id="text-12-2">
          <p>You can ask what pertains to a given topic by typing <code>M-x
          apropos &lt;RET&gt; pattern &lt;RET&gt;</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.4 (info "(emacs)Apropos")</span>

  (leuven--section <span class="org-string">"10.4 (emacs)Apropos"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"apropos"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check all variables and non-interactive functions as well</span>
    (setq apropos-do-all t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show variables whose name matches the pattern</span>
  (GNUEmacs
    (global-set-key
      (kbd <span class="org-string">"C-h A"</span>) 'apropos-variable))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-12-3" class="outline-3">
        <h3 id="sec-12-3">Misc Help Commands</h3>

        <div class="outline-text-3" id="text-12-3">
          <p>The <code>*Messages*</code> buffer is called the "
          <b>Message-Log</b>” on XEmacs (note the initial space). To display
          the message log, execute the command <code>M-x
          show-message-log</code>.</p>

          <p><code>update-info-dir</code></p>

          <p>The utility <code>install-info</code> is used to maintain the
          <code>info/dir</code> file.</p>

          <p><code>C-h K</code> goes to the node in the Emacs manual describing
          the command bound to a key.</p>

          <p>In a manual, these key bindings will make your life easier:</p>

          <dl class="org-dl">
            <dt><code>^</code></dt>

            <dd>Move “up” from this node.</dd>

            <dt><code>]</code></dt>

            <dd>Go forward one node, considering all nodes as forming one
            sequence.</dd>

            <dt><code>l</code></dt>

            <dd>Move back in history to the last node you were at.</dd>

            <dt><code>L</code></dt>

            <dd>Go to menu of visited nodes.</dd>

            <dt><code>i</code></dt>

            <dd><b>Search for a topic in this manual’s Index</b> and go to
            index entry.</dd>

            <dt>s</dt>

            <dd><b>Search for a regexp</b> and select node it’s found in.</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.8 (info "(emacs)Misc Help")</span>

  (leuven--section <span class="org-string">"10.8 (emacs)Misc Help"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enter Info documentation browser</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f1&gt;"</span>) 'info)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display symbol definitions, as found in the relevant manual</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(for AWK, C, Emacs Lisp, LaTeX, M4, Makefile, Sh and other languages that</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">have documentation in Info)</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;C-f1&gt;"</span>) 'info-lookup-symbol)
</pre>
          </div>

          <p>When Info is called, the variable <code>Info-directory-list</code>
          is populated from:</p>

          <ol class="org-ol">
            <li>the <code>INFOPATH</code> environment variable, or (if
            unset)</li>

            <li>the <code>Info-default-directory-list</code> variable –
            non-existent directories will be removed when copied to
            <code>Info-directory-list</code></li>
          </ol>

          <p>The best would be to set the <code>INFOPATH</code> environment
          variable so that you see the same manuals outside of Emacs, in the
          same shell from which you invoke Emacs.</p>

          <p>However, as EmacsW32 doesn’t see that Cygwin environment variable
          (it would well work with a Windows environment variable), I prefer to
          try and put the Windows configuration inside the Emacs configuration
          files.</p>

          <p>Normally, <code>Info-directory-list</code> is not intended to be
          settable by the user. But we must do so if we want to force our Info
          manuals before the standard ones (from Emacs).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"info"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of directories to search for Info documentation files (in the order</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">they are listed)</span>
    (<span class="org-keyword">when</span> running-ms-windows
      (setq Info-directory-list
            `(,(expand-file-name
                (concat (file-name-directory (locate-library <span class=
"org-string">"org"</span>))
                        <span class="org-string">"../doc/"</span>))
              <span class="org-string">"c:/cygwin/usr/share/info/"</span>
              ,@Info-directory-list)))
</pre>
          </div>

          <p><code>Info+</code> fontifies entries for reference items
          (functions, macros, commands, special forms, constants, options,
          other variables), and that includes their parameters, even those on
          continuation lines.</p>

          <p>With <code>Info+</code>, you can also merge an Info node with its
          subnodes into the same buffer, by calling
          <code>Info-merge-subnodes</code> (bound to <code>+</code>).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    (GNUEmacs
      (<span class="org-keyword">when</span> (try-require 'info+)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show breadcrumbs in the header line</span>
        (setq Info-breadcrumbs-in-header-flag t)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show breadcrumbs in the mode line</span>
        (setq Info-breadcrumbs-in-mode-line-mode nil)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">some info related functions</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(to insert links such as `(info "(message)Insertion Variables")')</span>
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"rs-info"</span>)
      (autoload 'rs-info-insert-current-node <span class=
"org-string">"rs-info"</span>
        <span class=
"org-doc">"Insert reference to current Info node using STYPE in buffer."</span> t)
      (autoload 'rs-info-boxquote <span class="org-string">"rs-info"</span>
        <span class=
"org-doc">"Yank text (from an info node), box it and use current info node as title."</span> t)
      (autoload 'rs-info-reload <span class="org-string">"rs-info"</span>
        <span class="org-doc">"Reload current info node."</span> t)
      (autoload 'rs-info-insert-node-for-variable <span class=
"org-string">"rs-info"</span>
        <span class=
"org-doc">"Insert a custom style info node for the top level form at point."</span> t)
      (<span class="org-keyword">defalias</span> '<span class=
"org-function-name">boxquote-info</span> 'rs-info-boxquote))
    )
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get a Unix manual page of the item under point</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;S-f1&gt;"</span>) 'man-follow)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"man"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make the manpage the current buffer in the current window</span>
    (setq Man-notify-method 'pushy))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">alias man to woman</span>
  (<span class="org-keyword">defalias</span> '<span class=
"org-function-name">man</span> 'woman)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">decode and browse Unix man-pages "W.o. (without) Man"</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"woman"</span>
    (<span class="org-keyword">defalias</span> '<span class=
"org-function-name">man</span> 'woman))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 10 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-13" class="outline-2">
      <h2 id="sec-13">The Mark and the Region</h2>

      <div class="outline-text-2" id="text-13">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 11 The (info "(emacs)Mark") and the Region</span>

(leuven--chapter leuven-chapter-11-mark <span class=
"org-string">"11 The Mark and the Region"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-13-1" class="outline-3">
        <h3 id="sec-13-1">Commands to Mark Textual Objects</h3>

        <div class="outline-text-3" id="text-13-1">
          <dl class="org-dl">
            <dt><code>M-@</code></dt>

            <dd>Set mark after end of next <b>word</b> (<code>mark-word</code>)
            without moving point.</dd>

            <dt><code>C-M-@</code></dt>

            <dd>Set mark after end of following <b>balanced expression</b>
            (<code>mark-sexp</code>) without moving point.</dd>
          </dl>
        </div>
      </div>

      <div id="outline-container-sec-13-2" class="outline-3">
        <h3 id="sec-13-2">Operating on the Region</h3>

        <div class="outline-text-3" id="text-13-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">inserting text while the mark is active causes the text in the region to be</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">deleted first</span>
  (delete-selection-mode 1)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-13-3" class="outline-3">
        <h3 id="sec-13-3">Multiple selections</h3>

        <div class="outline-text-3" id="text-13-3">
          <p>You can <a href="http://www.emacsrocks.com/e13.html">watch an
          intro to multiple-cursors at Emacs Rocks</a>.</p>

          <p>In other editors:</p>

          <ul class="org-ul">
            <li><a href=
            "https://docs.c9.io/multiple_cursors.html">https://docs.c9.io/multiple_cursors.html</a></li>

            <li><a href=
            "http://komodoide.com/screencasts/watch/87286656-multiple-selections/">
            http://komodoide.com/screencasts/watch/87286656-multiple-selections/</a></li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">multiple cursors for Emacs</span>
(<span class="org-keyword">when</span> (<span class=
"org-keyword">require</span> '<span class=
"org-constant">multiple-cursors</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a cursor to each (continuous) line in the current region</span>
  (global-set-key (kbd <span class=
"org-string">"C-S-c C-S-c"</span>) 'mc/edit-lines)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a cursor and region at the next part of the buffer forwards that</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">matches the current region</span>
  (global-set-key (kbd <span class=
"org-string">"C-&gt;"</span>) 'mc/mark-next-like-this)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a cursor and region at the next part of the buffer backwards that</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">matches the current region</span>
  (global-set-key (kbd <span class=
"org-string">"C-&lt;"</span>) 'mc/mark-previous-like-this)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mark all parts of the buffer that matches the current region</span>
  (global-set-key (kbd <span class=
"org-string">"C-c C-&lt;"</span>) 'mc/mark-all-like-this))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 11 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-14" class="outline-2">
      <h2 id="sec-14">Killing and Moving Text</h2>

      <div class="outline-text-2" id="text-14">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 12 (info "(emacs)Killing") and Moving Text</span>

(leuven--chapter leuven-chapter-12-killing <span class=
"org-string">"12 Killing and Moving Text"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-14-1" class="outline-3">
        <h3 id="sec-14-1">Deletion and Killing</h3>

        <div class="outline-text-3" id="text-14-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.1 (info "(emacs)Deletion and Killing")</span>

  (leuven--section <span class=
"org-string">"12.1 (emacs)Deletion and Killing"</span>)

  (GNUEmacs
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">old ([2012-09-07 Fri] remove "compile" after "activate")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add the ability to copy or cut the current line without marking it</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(no active region) -- idea stolen from SlickEdit</span>
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">kill-ring-save</span> (before leuven-slick-copy activate)
      <span class=
"org-doc">"When called with no active region, copy the current line instead."</span>
      (interactive
       (<span class=
"org-keyword">if</span> (use-region-p) (list (region-beginning) (region-end))
         (message <span class="org-string">"Copied the current line"</span>)
         (list (line-beginning-position)
               (line-beginning-position 2)))))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">kill-region</span> (before leuven-slick-cut activate)
      <span class=
"org-doc">"When called with no active region, kill the current line instead."</span>
      (interactive
       (<span class=
"org-keyword">if</span> (use-region-p) (list (region-beginning) (region-end))
         (list (line-beginning-position)
               (line-beginning-position 2))))))

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">new</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defadvice kill-ring-save (around leuven-slick-copy activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"When called interactively with no active region, copy a single line instead."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(if (or (use-region-p) (not (called-interactively-p 'any)))</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">ad-do-it</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(kill-new (buffer-substring (line-beginning-position)</span>
    <span class=
"org-comment-delimiter">;;                                 </span><span class=
"org-comment">(line-beginning-position 2)))</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(message "Copied line")))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defadvice kill-region (around leuven-slick-cut activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"When called interactively with no active region, kill a single line instead."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(if (or (use-region-p) (not (called-interactively-p 'any)))</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">ad-do-it</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(kill-new (filter-buffer-substring (line-beginning-position)</span>
    <span class=
"org-comment-delimiter">;;                                        </span><span class="org-comment">(line-beginning-position 2) t))))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun yank-line (string)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Insert STRING above the current line."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(beginning-of-line)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(unless (= (elt string (1- (length string))) ?\n)</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(save-excursion (insert "\n")))</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(insert string))</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> perf 2.00 s requiring bytecomp and warnings...</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-14-2" class="outline-3">
        <h3 id="sec-14-2">Yanking</h3>

        <div class="outline-text-3" id="text-14-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.2 (info "(emacs)Yanking")</span>

  (leuven--section <span class="org-string">"12.2 (emacs)Yanking"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-indentation of pasted code in the listed programming modes (fall back</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">to default, non-indented yanking by preceding the yanking command `</span><span class="org-comment"><span class="org-constant">C-y</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">with `</span><span class="org-comment"><span class=
"org-constant">C-u</span></span><span class="org-comment">')</span>
  (<span class="org-keyword">dolist</span> (command '(yank yank-pop))
    (eval `(<span class=
"org-keyword">defadvice</span> ,command (after leuven-indent-region activate)
             (and (not current-prefix-arg)
                  (derived-mode-p 'prog-mode)
                  (<span class=
"org-keyword">let</span> ((mark-even-if-inactive transient-mark-mode))
                    (indent-region (region-beginning) (region-end) nil))))))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-14-2-1" class="outline-4">
          <h4 id="sec-14-2-1">Yanking Earlier Kills</h4>

          <div class="outline-text-4" id="text-14-2-1">
            <p>Interactively insert items from kill ring with <code>M-x
            helm-show-kill-ring</code> (see <a href=
            "#sec-20-12-2">Helm</a>).</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-14-3" class="outline-3">
        <h3 id="sec-14-3">Cutting and Pasting on Graphical Displays</h3>

        <div class="outline-text-3" id="text-14-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.3 (info "(emacs)Cut and Paste")</span>

  (leuven--section <span class=
"org-string">"12.3 (emacs)Cut and Paste on Graphical Displays"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">copy/paste with Gnome desktop</span>
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; cutting and pasting uses the clipboard</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq x-select-enable-clipboard t) ; default in Emacs 24</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make cut, copy and paste (keys and menu bar items) use the clipboard</span>
    (menu-bar-enable-clipboard))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-14-4" class="outline-3">
        <h3 id="sec-14-4">Rectangles</h3>

        <div class="outline-text-3" id="text-14-4">
          <p>To kill the text of the “region-rectangle”, use <code>C-x r
          k</code> (<code>kill-rectangle</code>). Or just “delete” the
          rectangle (without “killing” it) with <code>C-x r d</code>.</p>

          <p>To copy a (series of) Org column(s) while avoiding the use of
          registers:</p>

          <ol class="org-ol">
            <li>select the region-rectangle,</li>

            <li>use the command <code>copy-rectangle-as-kill</code> (bound to
            <code>C-x r M-w</code>), then</li>

            <li>paste the copied rectangle by doing <code>yank-rectangle</code>
            (<code>C-x r y</code>).</li>
          </ol>

          <p>To do the same with registers:</p>

          <ol class="org-ol">
            <li>select the region-rectangle,</li>

            <li>use <code>C-x r r R</code> to copy the rectangle to the
            register named <code>R</code>,</li>

            <li>use <code>C-x r i R</code> to insert the rectangle that is
            being held in the register named <code>R</code>.</li>
          </ol>

          <p>To shift cells up/down within a column of an Org table while
          leaving remaining columns intact, use <code>kill-rectangle</code> and
          <code>yank-rectangle</code>.</p>

          <p>To delete whitespace in each of the lines on the specified
          rectangle, use <code>M-x delete-whitespace-rectangle</code>.</p>

          <p>Use <code>C-x r t STRING &lt;RET&gt;</code> to replace each line
          of a region-rectangle with a given string.</p>

          <div class="note">
            <p>On the Emacs trunk, you can do: <code>C-x SPC</code> &lt;…move
            around…&gt; <code>DEL</code> to delete the rectangle and <code>C-x
            SPC</code> &lt;…move around…&gt; <code>C-t</code> to invoke
            <code>string-rectangle</code>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-14-5" class="outline-3">
        <h3 id="sec-14-5">CUA Bindings</h3>

        <div class="outline-text-3" id="text-14-5">
          <p>CUA mode sets up key bindings used in many other applications
          (<code>C-x</code>, <code>C-c</code>, <code>C-v</code> and
          <code>C-z</code>).</p>

          <p>The <code>C-x</code> and <code>C-c</code> keys only do cut and
          copy when the region is active, so in most cases, they do not
          conflict with the normal function of these prefix keys.</p>

          <p>If you really need to perform a command which starts with one of
          the prefix keys even when the region is active, you have three
          options:</p>

          <ul class="org-ul">
            <li>press the prefix key twice very quickly (within 0.2
            seconds),</li>

            <li>press the prefix key and the following key within 0.2 seconds,
            or</li>

            <li>use the Shift key with the prefix key, i.e. <code>C-S-x</code>
            or <code>C-S-c</code>.</li>
          </ul>

          <p>You can customize <code>cua-enable-cua-keys</code> to completely
          disable the CUA bindings, or
          <code>cua-prefix-override-inhibit-delay</code> to change the prefix
          fallback behavior.</p>

          <p>CUA mode also provides enhanced rectangle support with visible
          rectangle highlighting. Check out <a href=
          "http://www.vimeo.com/1168225?pg=embed&amp;sec=1168225">Emacs Column
          Editing on Vimeo</a>.</p>

          <ul class="org-ul">
            <li><code>&lt;C-RET&gt;</code> runs the command
            <code>cua-set-rectangle-mark</code></li>

            <li><code>M-n</code> runs the command
            <code>cua-sequence-rectangle</code></li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 12 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-15" class="outline-2">
      <h2 id="sec-15">Registers</h2>

      <div class="outline-text-2" id="text-15">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 13 (info "(emacs)Registers")</span>

(leuven--chapter leuven-chapter-13-registers <span class=
"org-string">"13 Registers"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; Enable position saving through shortcuts.</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; Save current position with  Ctrl-F1 Ctrl-F2 Ctrl-F3 and Ctrl-F4</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [C-f1] (lambda () (interactive) (point-to-register ?1)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [C-f2] (lambda () (interactive) (point-to-register ?2)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [C-f3] (lambda () (interactive) (point-to-register ?3)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [C-f4] (lambda () (interactive) (point-to-register ?4)))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun jump-to-register-other (reg)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(other-window 1)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(jump-to-register reg)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(hilit-recenter (/ (window-height) 2)))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun jump-to-register-here (reg)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(jump-to-register reg)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(hilit-recenter (/ (window-height) 2)))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; Move to saved position with F1 F2 F3 and F4</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [f1] (lambda () (interactive) (jump-to-register-here ?1)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [f2] (lambda () (interactive) (jump-to-register-here ?2)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [f3] (lambda () (interactive) (jump-to-register-here ?3)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key [f4] (lambda () (interactive) (jump-to-register-here ?4)))</span>
</pre>
        </div>

        <p>Jump between configuration files</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(global-set-key (kbd <span class="org-string">"C-j"</span>) 'jump-to-register)

(set-register ?a (cons 'file <span class=
"org-string">"/sudo::/etc/apt/sources.list"</span>))
(set-register ?b (cons 'file <span class="org-string">"~/News/KILL"</span>))
(set-register ?C (cons 'file <span class=
"org-string">"/sudo::/etc/default/console-setup"</span>))
(set-register ?c (cons 'file <span class=
"org-string">"~/.irssi/config"</span>))
(set-register ?d (cons 'file <span class="org-string">"~/.emacs-dired"</span>))
<span class="org-comment-delimiter">; </span><span class=
"org-comment">etc.</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-15-1" class="outline-3">
        <h3 id="sec-15-1">Bookmarks</h3>

        <div class="outline-text-3" id="text-15-1">
          <p>Bookmarks are <b>persistent</b> and they have <b>names</b>; not
          <i>markers</i>. Bookmarked positions can also be <b>relocated</b>
          (found) if they move slightly because of text changes.</p>

          <p>To navigate to a bookmark (linking to a file or directory), just
          press <code>C-x r b</code>. You’ll be prompted for the bookmark name,
          and it will open that file or directory.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 13.7 (info "(emacs)Bookmarks")</span>

  (leuven--section <span class="org-string">"13.7 (emacs)Bookmarks"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"bookmark"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">where to save the bookmarks</span>
    (setq bookmark-default-file <span class=
"org-string">"~/.emacs.d/bookmarks.bmk"</span>)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! a .txt extension would load Org at</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! the time `</span><span class="org-comment"><span class=
"org-constant">bookmark</span></span><span class=
"org-comment">' is required!</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">each command that sets a bookmark will also save your bookmarks</span>
    (setq bookmark-save-flag 1)
</pre>
          </div>

          <p>Visible bookmarks in buffer.</p>

          <p><b>Bookmark+</b> offers everything that <code>bm.el</code> offers,
          and quite a bit more.</p>

          <ul class="org-ul">
            <li>You can bookmark arbitrary sets of files, from any
            locations.</li>

            <li>You can bookmark Dired buffers (which, again, can actually list
            arbitrary files, not even necessarily in the same directory).
            Markings, subdir inclusions, and omissions are all recorded, and
            restored when you access the bookmark.</li>

            <li>You can tag bookmarks or files, using arbitrary strings as
            tags. You can do this programmatically and interactively, by
            regexp, name, or Dired markings. Tags give you a great way to
            define sets of bookmarks or files – sets that can overlap etc. They
            serve to categorize, but they can do more than that. You can use
            tags to, in effect, merge projects, split projects, define
            subprojects, and so on.</li>
          </ul>

          <p>Key bindings:</p>

          <dl class="org-dl">
            <dt><code>C-x p RET</code></dt>

            <dd><b>Set</b> (or delete) a <b>bookmark</b> at point.</dd>

            <dt><code>C-x p C-down</code></dt>

            <dd>Cycle to the <b>next</b> highlighted <b>bookmark</b> in the
            current buffer.</dd>

            <dt><code>C-x p C-up</code></dt>

            <dd>Cycle to the <b>previous</b> highlighted <b>bookmark</b> in the
            current buffer.</dd>

            <dt><code>C-x (4) j h</code></dt>

            <dd>Jump to a highlighted bookmark (in another window).</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">extensions to standard library `</span><span class=
"org-comment"><span class="org-constant">bookmark.el</span></span><span class=
"org-comment">'</span>
    (<span class="org-keyword">when</span> (try-require 'bookmark+)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically highlight bookmarks when set</span>
      (setq bmkp-auto-light-when-set 'any-bookmark)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically highlight bookmarks when jumped to</span>
      (setq bmkp-auto-light-when-jump 'any-bookmark)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't propertize bookmark names to hold full bookmark data</span>
      (setq bmkp-propertize-bookmark-names-flag nil)))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">we will often be going back and forth</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">between using Bookmark+ and using</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">vanilla Emacs</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-15-2" class="outline-3">
        <h3 id="sec-15-2">Ace Jump</h3>

        <div class="outline-text-3" id="text-15-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">quickly jump to a position in the current view</span>
  (<span class="org-keyword">when</span> (try-require 'ace-jump-mode)
    (define-key global-map (kbd <span class=
"org-string">"C-c SPC"</span>) 'ace-jump-mode))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 13 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-16" class="outline-2">
      <h2 id="sec-16">Controlling the Display</h2>

      <div class="outline-text-2" id="text-16">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 14 Controlling the (info "(emacs)Display")</span>

(leuven--chapter leuven-chapter-14-display <span class=
"org-string">"14 Controlling the Display"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-16-1" class="outline-3">
        <h3 id="sec-16-1">Scrolling</h3>

        <div class="outline-text-3" id="text-16-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.1 (info "(emacs)Scrolling")</span>

  (leuven--section <span class="org-string">"14.1 (emacs)Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keep screen position of point when scrolling</span>
  (setq scroll-preserve-screen-position t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">better scrolling in Emacs (doing a &lt;PageDown&gt; followed by a &lt;PageUp&gt; will</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">place the point at the same place)</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"pager"</span>)
    (autoload 'pager-page-up <span class="org-string">"pager"</span>
      <span class=
"org-doc">"Like scroll-down, but moves a fixed amount of lines."</span> t)
    (autoload 'pager-page-down <span class="org-string">"pager"</span>
      <span class=
"org-doc">"Like scroll-up, but moves a fixed amount of lines."</span> t)

    (global-set-key
      (kbd <span class="org-string">"&lt;prior&gt;"</span>) 'pager-page-up)
    (global-set-key
      (kbd <span class="org-string">"&lt;next&gt;"</span>) 'pager-page-down))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-2" class="outline-3">
        <h3 id="sec-16-2">Automatic Scrolling</h3>

        <div class="outline-text-3" id="text-16-2">
          <p>“Smooth” (civilized) scrolling.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.3 (info "(emacs)Auto Scrolling")</span>

  (leuven--section <span class=
"org-string">"14.3 (emacs)Auto Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scroll only one line at a time (redisplay will never recenter point)</span>
  (setq scroll-conservatively 10000)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">or `</span><span class="org-comment"><span class=
"org-constant">most-positive-fixnum</span></span><span class=
"org-comment">'</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of lines of margin at the top and bottom of a window</span>
  (setq scroll-margin 1) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">or 3?        ; also for `</span><span class=
"org-comment"><span class=
"org-constant">isearch-forward</span></span><span class="org-comment">'</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scrolling down looks much better</span>
  (setq auto-window-vscroll nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-3" class="outline-3">
        <h3 id="sec-16-3">Narrowing</h3>

        <div class="outline-text-3" id="text-16-3">
          <dl class="org-dl">
            <dt><code>C-x n n</code></dt>

            <dd><b>Narrow</b> down to between point and mark.</dd>

            <dt><code>C-x n d</code></dt>

            <dd><b>Narrow</b> down to the current <b>defun</b>.</dd>

            <dt><code>C-x n s</code></dt>

            <dd><b>Narrow</b> buffer to the current <b>subtree</b> (bound in
            Org mode).</dd>

            <dt><code>C-x n w</code></dt>

            <dd><b>Widen</b> to make the entire buffer accessible again.</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.5 (info "(emacs)Narrowing")</span>

  (leuven--section <span class="org-string">"14.5 (emacs)Narrowing"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable the use of the command `</span><span class=
"org-comment"><span class=
"org-constant">narrow-to-region</span></span><span class=
"org-comment">' without confirmation</span>
  (put 'narrow-to-region 'disabled nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-4" class="outline-3">
        <h3 id="sec-16-4">Font Lock mode</h3>

        <div class="outline-text-3" id="text-16-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.12 (info "(emacs)Font Lock")</span>

  (leuven--section <span class="org-string">"14.12 (emacs)Font Lock"</span>)

  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">stop showing that annoying progress bar when fontifying</span>
    (setq progress-feedback-use-echo-area nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Font Lock mode</span>
    (font-lock-mode))
</pre>
          </div>

          <p>All text-based major modes run <code>text-mode-hook</code>, and
          all programming language modes run <code>prog-mode-hook</code>, prior
          to running their own mode hooks.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight </span><span class="org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class=
"org-comment"> notes</span>
  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-highlight-keywords</span>
    <span class="org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string"><span class="org-leuven-highlight">FIXME</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string"><span class="org-leuven-highlight">BUG</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>
    <span class="org-doc">"Patterns to highlight."</span>)

  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-highlight-keywords-in-org</span>
    <span class="org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string"><span class="org-leuven-highlight">FIXME</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string"><span class="org-leuven-highlight">BUG</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>
    <span class="org-doc">"Patterns to highlight (for Org mode only).</span>
<span class=
"org-doc">  The goal is to ensure no conflict with the Org mode </span><span class="org-doc"><span class="org-leuven-highlight">TODO</span></span><span class="org-doc"> keyword."</span>)

  (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-highlight-face</span>
    '((t (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#CC0000"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FFFF88"</span>)))
    <span class="org-doc">"Face for making </span><span class=
"org-doc"><span class="org-leuven-highlight">FIXME</span></span><span class=
"org-doc"> and other warnings stand out."</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add highlighting keywords for selected major modes only</span>
  (<span class="org-keyword">dolist</span> (mode '(fundamental-mode
                  text-mode))
    (font-lock-add-keywords mode
     `((,leuven-highlight-keywords 1 'leuven-highlight-face prepend))
     'end))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add highlighting keywords for Org mode only</span>
  (<span class="org-keyword">dolist</span> (mode '(org-mode))
    (font-lock-add-keywords mode
     `((,leuven-highlight-keywords-in-org 1 'leuven-highlight-face prepend))
     'end))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add highlighting keywords for selected major modes *and* all major modes</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">derived from them</span>
  (<span class="org-keyword">dolist</span> (hook '(prog-mode-hook
                  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">text-mode-hook     ; avoid Org</span>
                  css-mode-hook         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[parent: fundamental]</span>
                  latex-mode-hook
                  shell-mode-hook       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[parent: fundamental]</span>
                  ssh-config-mode-hook))
    (add-hook hook
     (<span class="org-keyword">lambda</span> ()
       (font-lock-add-keywords nil      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">in the current buffer</span>
        `((,leuven-highlight-keywords 1 'leuven-highlight-face prepend)) 'end))))
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment">                      0                        t          t</span>
</pre>
          </div>

          <p>See doc of <code>font-lock-keywords</code> and
          <code>font-lock-add-keywords</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">just-in-time fontification</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"jit-lock"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">stealth fontification should show status messages</span>
    (setq jit-lock-stealth-verbose t))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">colorize color names in buffers</span>
  (GNUEmacs
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"rainbow-mode"</span>)
      (autoload 'rainbow-mode <span class="org-string">"rainbow-mode"</span>
        <span class=
"org-doc">"Colorize strings that represent colors."</span> t)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-5" class="outline-3">
        <h3 id="sec-16-5">Interactive Highlighting</h3>

        <div class="outline-text-3" id="text-16-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.13 (info "(emacs)Highlight Interactively") by Matching</span>

  (leuven--section <span class=
"org-string">"14.13 (emacs)Highlight Interactively by Matching"</span>)
</pre>
          </div>

          <p>You can use <b>Hi Lock</b> (part of Emacs) to highlight a regexp
          (identical tokens) throughout a buffer.</p>

          <dl class="org-dl">
            <dt><code>M-x hi-lock-mode &lt;RET&gt;</code></dt>

            <dd>Enable or disable Hi Lock mode.</dd>

            <dt><code>C-x w h REGEXP &lt;RET&gt; &lt;RET&gt;</code></dt>

            <dd>Highlight text that matches REGEXP.</dd>

            <dt><code>C-x w l REGEXP &lt;RET&gt; &lt;RET&gt;</code></dt>

            <dd>Highlight entire lines containing a match for REGEXP.</dd>

            <dt><code>C-x w r REGEXP &lt;RET&gt;</code></dt>

            <dd>Unhighlight REGEXP.</dd>
          </dl>

          <p>It is complementary to the features of the library
          <b>Highlight</b> (from Drew Adams):</p>

          <dl class="org-dl">
            <dt><code>hlt-highlight-regexp-region</code></dt>

            <dd>Highlight a REGEXP throughout the region.</dd>

            <dt><code>hlt-unhighlight-region</code></dt>

            <dd>Unhighlight the region.</dd>
          </dl>

          <p>Comparison:</p>

          <ul class="org-ul">
            <li>Hi Lock uses text properties, Highlight can use either text
            properties or overlays (= default, see option
            <code>hlt-use-overlays-flag</code>). When overlays are used,
            copying and pasting text will not also paste the highlighting.</li>

            <li>Hi Lock highlights new text as you type it.</li>

            <li>Highlight lets you navigate among highlights:
            <code>hlt-next-highlight</code>,
            <code>hlt-previous-highlight</code>.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Hi Lock mode for all buffers</span>
    (global-hi-lock-mode 1)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-highlight-current-word</span> ()
      <span class=
"org-doc">"Highlight the word that point is on throughout the buffer.</span>
<span class=
"org-doc">    If already highlighted, unhighlight the word at point."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((cword (current-word t)))
        (<span class="org-keyword">when</span> cword
          (<span class=
"org-keyword">if</span> (not (equal (get-text-property (point) 'face) 'highlight))
              (highlight-regexp (regexp-quote cword) 'highlight)
            (unhighlight-regexp (regexp-quote cword))))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">emulation of Vim's `*' search</span>
    (global-set-key
      (kbd <span class=
"org-string">"C-*"</span>) 'leuven-highlight-current-word))
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%">
                <b>Use rainbow colors for word highlighting</b><br />

                <p>Use <code>highlight-symbol</code> which chooses rainbow
                colors automatically and makes it much easier to follow some
                key variables through a block of code.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div id="outline-container-sec-16-6" class="outline-3">
        <h3 id="sec-16-6">Window Fringes</h3>

        <div class="outline-text-3" id="text-16-6">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (window-system)
    (try-require 'git-gutter))

  (setq git-gutter:disabled-modes '(asm-mode image-mode))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">update frequency: uncomment this when Emacs/GitGutter slows.</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq git-gutter:update-threshold 1)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq git-gutter:update-hooks '(after-save-hook after-revert-hook))</span>

  (setq git-gutter:hide-gutter t)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Hide gutter if there are no changes</span>
  (setq git-gutter:diff-option <span class=
"org-string">"-w"</span>) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Pass option to 'git diff' command: -w: ignore all spaces</span>
  (setq git-gutter:verbosity 0)           <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Log/Message Level</span>

  (global-git-gutter-mode +1)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-7" class="outline-3">
        <h3 id="sec-16-7">Displaying Boundaries</h3>

        <div class="outline-text-3" id="text-16-7">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.15 (info "(emacs)Displaying Boundaries")</span>

  (leuven--section <span class=
"org-string">"14.15 (emacs)Displaying Boundaries"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">visually indicate buffer boundaries and scrolling in the fringe</span>
  (setq indicate-buffer-boundaries t)   <span class=
"org-comment-delimiter">; </span><span class="org-comment">'left</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-8" class="outline-3">
        <h3 id="sec-16-8">Useless Whitespace</h3>

        <div class="outline-text-3" id="text-16-8">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.16 (info "(emacs)Useless Whitespace")</span>

  (leuven--section <span class=
"org-string">"14.16 (emacs)Useless Whitespace"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight trailing whitespaces in all modes</span>
  (setq-default show-trailing-whitespace t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">nuke all trailing whitespaces in the buffer</span>
  (add-hook 'before-save-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">except for Message mode where "-- " is the signature separator</span>
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(for when using emacsclient to compose emails and doing C-x #)</span>
              (<span class=
"org-keyword">unless</span> (eq major-mode 'message-mode)
                (delete-trailing-whitespace))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">visually indicate empty lines after the buffer end in the fringe</span>
  (setq-default indicate-empty-lines t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; control highlighting of non-ASCII space and hyphen chars, using the</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; `</span><span class="org-comment"><span class=
"org-constant">nobreak-space</span></span><span class=
"org-comment">' or `</span><span class="org-comment"><span class=
"org-constant">escape-glyph</span></span><span class=
"org-comment">' face respectively</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq nobreak-char-display t)      ; default</span>
</pre>
          </div>

          <p>When Whitespace mode is on, it takes care of highlighting some
          special characters over the default mechanism of
          <code>nobreak-char-display</code> and
          <code>show-trailing-whitespace</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">whitespace mode</span>
    (add-hook 'text-mode-hook 'whitespace-mode)

    (add-hook 'prog-mode-hook 'whitespace-mode)

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"whitespace"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">which kind of blank is visualized</span>
      (setq whitespace-style
            '(face trailing tabs
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">lines-tail</span>
              indentation::space space-mark tab-mark))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">column beyond which the line is highlighted</span>
      (setq whitespace-line-column 80)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mappings for displaying characters</span>
      (setq whitespace-display-mappings
            '((space-mark ?\u00A0 [?\u2423] [?.]) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">nbsp - open box (bottom square bracket)</span>
              (space-mark ?\u202F [?\u00B7] [?.]) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">narrow nbsp - centered dot</span>
              (tab-mark ?\t [?\u00BB ?\t] [?\\ ?\t]))) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">tab - left quote mark</span>
      ))
</pre>
          </div>

          <p>Example : VPATH=
          /home/jt/src/cygwin/cygwin-packages/1.7/python-2.6.8-2/python-2.6.8-2/src/Python-2.6.8
          LDLAST= SGI_ABI= PYTHON_OBJS= \ Python/pythonrun.o \ Python/random.o
          \ Python/structmember.o</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; show zero-width spaces</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(font-lock-add-keywords nil</span>
  <span class="org-comment-delimiter">;;  </span><span class=
"org-comment">`((,(format "\\(%c\\)" ?\u200B) ; #\ZERO_WIDTH_SPACE</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(1 (progn (compose-region (match-beginning 1) (match-end 1)</span>
  <span class=
"org-comment-delimiter">;;                               </span><span class=
"org-comment">?\u2B1B ; #\BLACK_LARGE_SQUARE</span>
  <span class=
"org-comment-delimiter">;;                               </span><span class=
"org-comment">'decompose-region)</span>
  <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">nil)))))</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-9" class="outline-3">
        <h3 id="sec-16-9">Selective Display</h3>

        <div class="outline-text-3" id="text-16-9">
          <p>Emacs has the ability to <b>hide lines indented more than a given
          number of columns</b>. You can use this to get an overview of a part
          of a program.</p>

          <p>To hide lines with at least 1 column of indentation (replacing
          them by an ellipsis), type <code>C-1 C-x $</code> (or <code>C-x
          $</code> and give it <code>1</code> as depth argument). It gives a
          quick overview any source file.</p>

          <p>To make all lines visible again, type <code>C-x $</code> with no
          argument.</p>

          <p>See also <b>Outline Mode</b> for another way to hide part of the
          text in a buffer.</p>
        </div>
      </div>

      <div id="outline-container-sec-16-10" class="outline-3">
        <h3 id="sec-16-10">Optional Mode Line Features</h3>

        <div class="outline-text-3" id="text-16-10">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.18 (info "(emacs)Optional Mode Line") Features</span>

  (leuven--section <span class=
"org-string">"14.18 (emacs)Optional Mode Line Features"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show the column number in each mode line</span>
  (column-number-mode 1)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use inactive face for mode line in non-selected windows</span>
  (setq mode-line-in-non-selected-windows t)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show buffer position like a scroll bar in mode line</span>
  (<span class="org-keyword">when</span> (try-require 'sml-modeline)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mode line indicator total length</span>
    (setq sml-modeline-len 10)

    (sml-modeline-mode))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-11" class="outline-3">
        <h3 id="sec-16-11">How Text Is Displayed</h3>

        <div class="outline-text-3" id="text-16-11">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.19 How (info "(emacs)Text Display")ed</span>

  (leuven--section <span class=
"org-string">"14.19 (emacs)How Text Displayed"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-dos2unix</span> ()
    <span class=
"org-doc">"Convert a plain text file in DOS format to Unix format."</span>
    (interactive)
    (<span class="org-keyword">save-excursion</span>
      (goto-char (point-min))
      (<span class="org-keyword">while</span> (search-forward <span class=
"org-string">"\r"</span> nil t)
        (replace-match <span class="org-string">""</span>))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-unix2dos</span> ()
    <span class=
"org-doc">"Convert a plain text file in Unix format to DOS format."</span>
    (interactive)
    (<span class="org-keyword">save-excursion</span>
      (goto-char (point-min))
      (<span class="org-keyword">while</span> (search-forward <span class=
"org-string">"\n"</span> nil t)
        (replace-match <span class="org-string">"\r\n"</span>))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-12" class="outline-3">
        <h3 id="sec-16-12">Displaying the Cursor</h3>

        <div class="outline-text-3" id="text-16-12">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.20 The (info "(emacs)Cursor Display")</span>

  (leuven--section <span class=
"org-string">"14.20 (emacs)The Cursor Display"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cursor to use</span>
  (setq-default cursor-type 'bar)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cursor of the selected window blinks</span>
  (XEmacs
    (blink-cursor-mode))

  (GNUEmacs
    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-default-cursor-color</span> <span class=
"org-string">"black"</span>
      <span class="org-doc">"Default cursor color."</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">using cursor color to indicate some modes (read-only, overwrite and</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert modes)</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--set-cursor-color-according-to-mode</span> ()
      <span class=
"org-doc">"Change cursor color according to some minor modes."</span>
      (<span class="org-keyword">let</span> ((color (<span class=
"org-keyword">if</span> buffer-read-only
                       <span class="org-string">"purple1"</span>
                     (<span class="org-keyword">if</span> overwrite-mode
                         <span class="org-string">"red"</span>
                       <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">normal insert mode</span>
                       leuven-default-cursor-color))))
        (set-cursor-color color)))

    (add-hook 'post-command-hook 'leuven--set-cursor-color-according-to-mode))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-13" class="outline-3">
        <h3 id="sec-16-13">Truncation of Lines</h3>

        <div class="outline-text-3" id="text-16-13">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.21 (info "(emacs)Line Truncation")</span>

  (leuven--section <span class=
"org-string">"14.21 (emacs)Line Truncation"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">switch wrap mode from "wrap long lines to next screen line" (continued</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">line) to "non-wrap", or vice-versa</span>
  (global-set-key
    (kbd <span class="org-string">"C-c t"</span>) 'toggle-truncate-lines)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">respect the value of `</span><span class=
"org-comment"><span class=
"org-constant">truncate-lines</span></span><span class=
"org-comment">' in all windows less than the full</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">width of the frame</span>
  (setq truncate-partial-width-windows nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-16-14" class="outline-3">
        <h3 id="sec-16-14">Customization of Display</h3>

        <div class="outline-text-3" id="text-16-14">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.23 (info "(emacs)Display Custom")ization</span>

  (leuven--section <span class=
"org-string">"14.23 (emacs)Display Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">echo what I'm typing *immediately*</span>
  (setq echo-keystrokes 0.1)
</pre>
          </div>

          <p>Display pressed keyboard shortcuts on screen during presentations
          or screencasts.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">exhaustive log of interactions with Emacs (display keystrokes, etc.)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"interaction-log"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; maximum number of lines to keep in the *Emacs Log* buffer</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ilog-log-max 10)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable logging of keys, commands, file loads and messages</span>
    (interaction-log-mode 1)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hotkey for showing the log buffer</span>
    (global-set-key
      (kbd <span class="org-string">"C-h C-l"</span>)
      (<span class="org-keyword">lambda</span> ()
        (interactive)
        (display-buffer ilog-buffer-name))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 14 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-17" class="outline-2">
      <h2 id="sec-17">Searching and Replacement</h2>

      <div class="outline-text-2" id="text-17">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 15 (info "(emacs)Search")ing and Replacement</span>

(leuven--chapter leuven-chapter-15-search <span class=
"org-string">"15 Searching and Replacement"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-17-1" class="outline-3">
        <h3 id="sec-17-1">Incremental Search (aka “Live Search”)</h3>

        <div class="outline-text-3" id="text-17-1">
          <p>Have a look at the “Standard Isearch Keys” on <a href=
          "http://www.emacswiki.org/emacs/IncrementalSearch">http://www.emacswiki.org/emacs/IncrementalSearch</a></p>

          <p>Isearch has a binding which deletes all the non-matching
          characters from the search string: <code>C-g</code> (not a very
          intuitive binding, because it’s usually associated with aborting
          operations, not with correcting things).</p>

          <p>If you hit <code>M-e</code> (to edit the search string), the
          cursor is moved to the mismatch position.</p>

          <p>Since Emacs 24.3:</p>

          <ul class="org-ul">
            <li><code>M-s _</code> starts a symbol (identifier) incremental
            search.</li>

            <li><code>M-s _</code> in Isearch toggles symbol search mode.</li>

            <li><code>M-s c</code> in Isearch toggles search
            case-sensitivity.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.1 (info "(emacs)Incremental Search")</span>

  (leuven--section <span class=
"org-string">"15.1 (emacs)Incremental Search"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Error when selecting search string from kill ring (`</span><span class="org-comment"><span class="org-constant">M-p</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; always exit searches at the beginning of the expression found</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'isearch-mode-end-hook 'isearch-goto-match-beginning)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun isearch-goto-match-beginning ()</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Use with isearch hook to end search at first char of match."</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(when isearch-forward (goto-char isearch-other-end)))</span>

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; incremental search/query-replace will open the contents</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq search-invisible 'open)       ; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't re-hide an invisible match right away</span>
    (setq isearch-hide-immediately nil)) <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scrolling commands are allowed during incremental search (without</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">canceling Isearch mode)</span>
  (setq isearch-allow-scroll t)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fuzzy matching utilities (a must-have)</span>
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"fuzzy"</span>)

      (add-hook 'isearch-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (<span class="org-keyword">require</span> '<span class=
"org-constant">fuzzy</span>)))

      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"fuzzy"</span>
        (turn-on-fuzzy-isearch))))
</pre>
          </div>

          <div class="note">
            <p>When search-invisible is t, perform-replace can replace matches
            in any invisible text, but does not display it when prompting the
            user for confirmation.</p>

            <p>When search-invisible is ‘open, perform-replace can replace
            matches only in hidden text (invisible through an overlay), and
            displays it when prompting the user.</p>

            <p>We lack a way to reveal truly invisible text when performing a
            search and replace. The URL of a bracket link in Org is an example
            of such truly invisible text.</p>

            <p>Juri’s solution to add ‘open-all could also be used in
            perform-replace to let the user see truly invisible matches before
            replacing them.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-17-2" class="outline-3">
        <h3 id="sec-17-2">Regexp Search</h3>

        <div class="outline-text-3" id="text-17-2">
          <p>Emacs uses basic regular expressions, which means that the
          extended regexp operators have to be escaped. This means you have to
          use <code>\(</code>, <code>\|</code>, and <code>\)</code> instead of
          <code>(</code>, <code>|</code>, and <code>)</code>.</p>

          <p>You can build regexps with visual feedback by using:</p>

          <ul class="org-ul">
            <li><code>M-x re-builder</code> or</li>

            <li><code>M-x regex-tool</code> (by John Wiegley)</li>
          </ul>

          <p>Optimize regexps with <code>regexp-opt.el</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.5 (info "(emacs)Regexp Search")</span>

  (leuven--section <span class="org-string">"15.4 (emacs)Regexp Search"</span>)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use regexps by default (allows searching across line breaks)</span>
  (global-set-key
    (kbd <span class="org-string">"C-s"</span>) 'isearch-forward-regexp)
  (global-set-key
    (kbd <span class="org-string">"C-r"</span>) 'isearch-backward-regexp)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">shift the meaning of `</span><span class=
"org-comment"><span class="org-constant">C-M-s/r</span></span><span class=
"org-comment">' with `</span><span class="org-comment"><span class=
"org-constant">C-s/r</span></span><span class="org-comment">'</span>
  (global-set-key
    (kbd <span class="org-string">"C-M-s"</span>) 'isearch-forward)
  (global-set-key
    (kbd <span class="org-string">"C-M-r"</span>) 'isearch-backward)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-17-3" class="outline-3">
        <h3 id="sec-17-3">Search Case</h3>

        <div class="outline-text-3" id="text-17-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.9 (info "(emacs)Search Case")</span>

  (leuven--section <span class="org-string">"15.8 (emacs)Search Case"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">searches should ignore case by default (in all buffers that do not</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">override this)</span>
  (setq-default case-fold-search t)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-17-4" class="outline-3">
        <h3 id="sec-17-4">Replacement Commands</h3>

        <div class="outline-text-3" id="text-17-4">
          <p>Pass the string or the regexp directly to
          <code>query-replace</code>, so you can’t mangle it on the way, by
          pressing <code>M-%</code> while at the <code>I-search:</code>
          prompt.</p>
        </div>
      </div>

      <div id="outline-container-sec-17-5" class="outline-3">
        <h3 id="sec-17-5">Other Search-and-Loop Commands</h3>

        <div class="outline-text-3" id="text-17-5">
          <p><code>M-x flush-lines</code> (or
          <code>delete-matching-lines</code>) deletes each line that contains a
          match for REGEXP.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.11 (info "(emacs)Other Repeating Search") Commands</span>

  (leuven--section <span class=
"org-string">"15.10 (emacs)Other Repeating Search Commands"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-isearch-occur</span> ()
    <span class="org-doc">"Invoke `</span><span class="org-doc"><span class=
"org-constant">occur</span></span><span class=
"org-doc">' from within `</span><span class="org-doc"><span class=
"org-constant">isearch</span></span><span class="org-doc">'."</span>
    (interactive)
    (<span class=
"org-keyword">let</span> ((case-fold-search isearch-case-fold-search))
      (occur
       (<span class="org-keyword">if</span> isearch-regexp
           isearch-string
         (regexp-quote isearch-string)))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate `</span><span class="org-comment"><span class=
"org-constant">occur</span></span><span class=
"org-comment">' easily while at the `</span><span class=
"org-comment"><span class="org-constant">I-search:</span></span><span class=
"org-comment">' prompt</span>
  (define-key isearch-mode-map
    (kbd <span class="org-string">"C-o"</span>) 'leuven-isearch-occur)
</pre>
          </div>

          <p>Occur Edit mode applies edits made in <code>*Occur*</code> buffers
          to the original buffers. It is bound to <code>e</code> in Occur
          mode.</p>
        </div>

        <div id="outline-container-sec-17-5-1" class="outline-4">
          <h4 id="sec-17-5-1">Multi-buffer occur</h4>

          <div class="outline-text-4" id="text-17-5-1">
            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Have a look at <a href=
                "http://www.emacswiki.org/emacs/color-moccur.el">http://www.emacswiki.org/emacs/color-moccur.el</a>
                for searching regexp in buffer</b><br /></td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"color-moccur"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">multi-buffer occur (grep) mode</span>
    (mapc (function
           (<span class="org-keyword">lambda</span> (x)
             (autoload x <span class=
"org-string">"color-moccur"</span> nil t)))
          '(moccur
            dmoccur
            dired-do-moccur
            Buffer-menu-moccur
            grep-buffers
            search-buffers
            occur-by-moccur
            isearch-moccur
            moccur-grep
            moccur-grep-find)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">multi-buffer occur (grep) mode</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"color-moccur"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">input word splited by space</span>
    (setq moccur-split-word t))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 15 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-18" class="outline-2">
      <h2 id="sec-18">Commands for Fixing Typos</h2>

      <div class="outline-text-2" id="text-18">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 16 Commands for (info "(emacs)Fixit") Typos</span>

(leuven--chapter leuven-chapter-16-fixit <span class=
"org-string">"16 Commands for Fixing Typos"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-18-1" class="outline-3">
        <h3 id="sec-18-1">Checking and Correcting Spelling</h3>

        <div class="outline-text-3" id="text-18-1">
          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"></td>

              <td width="100%">
                <b>Install <a href=
                "http://ftp.gnu.org/gnu/aspell/w32/Aspell-0-50-3-3-Setup.exe">GNU
                Aspell 0.50.3</a> on Windows (more dictionaries than Cygwin
                Aspell)</b><br />

                <ul class="org-ul">
                  <li>Install <a href=
                  "http://ftp.gnu.org/gnu/aspell/w32/Aspell-en-0.50-2-3.exe">Aspell
                  English dictionary-0.50-2</a></li>

                  <li>Add <code>C:\Program Files (x86)\Aspell\bin</code> to the
                  System <code>PATH</code></li>
                </ul>
              </td>
            </tr>
          </table>

          <p>GNU <b>Aspell</b> is better than <b>Ispell</b>:</p>

          <ul class="org-ul">
            <li>It does recognize words with apostrophes (l’avion)… but it is
            slower.</li>

            <li>It can handle UTF-8 documents far better than Ispell can.</li>
          </ul>

          <p>See <a href=
          "https://github.com/rolandwalker/flyspell-lazy">Flyspell-lazy</a> if
          you are experiencing performance issues with Emacs’ built-in
          <code>flyspell-mode</code>.</p>

          <p>When spellchecking a buffer, the <code>A</code> command accepts an
          incorrect word, and adds it to the <b>file word list</b>
          (<code>ispell-add-per-file-word-list</code>).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 16.4 Checking and Correcting (info "(emacs)Spelling")</span>

  (leuven--section <span class=
"org-string">"16.4 (emacs)Checking and Correcting Spelling"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">spelling checker program</span>
  (setq ispell-program-name             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">defined in ispell.el</span>
        (or (executable-find <span class="org-string">"aspell"</span>)
            (executable-find <span class="org-string">"ispell"</span>)
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">nil                      ; [default: "ispell"]</span>
            ))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check if `</span><span class="org-comment"><span class=
"org-constant">ispell-program-name</span></span><span class=
"org-comment">' seems correct</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">ispell-check-program-name</span> ()
    <span class="org-doc">"Ensure that `</span><span class=
"org-doc"><span class=
"org-constant">ispell-program-name</span></span><span class=
"org-doc">' is defined and non-nil."</span>
    (interactive)
    (and (boundp 'ispell-program-name)
         ispell-program-name))

  (<span class="org-keyword">when</span> (ispell-check-program-name)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">ispell-region-or-buffer</span> ()
      <span class=
"org-doc">"Interactively check the current region or buffer for spelling errors."</span>
      (interactive)
      (<span class="org-keyword">if</span> mark-active
          (<span class="org-keyword">if</span> (&lt; (mark) (point))
              (ispell-region (mark) (point))
              (ispell-region (point) (mark)))
          (ispell-buffer)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key bindings (or `C-c i' prefix key binding?)</span>
    (global-set-key
      (kbd <span class="org-string">"C-$"</span>) 'ispell-region-or-buffer)
    (global-set-key
      (kbd <span class="org-string">"C-M-$"</span>) 'ispell-change-dictionary)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; default dictionary to use (if `</span><span class=
"org-comment"><span class=
"org-constant">ispell-local-dictionary</span></span><span class=
"org-comment">' is nil, that</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; is if there is no local dictionary to use in the buffer)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ispell-dictionary "american") ; see `</span><span class=
"org-comment"><span class=
"org-constant">sentence-end-double-space</span></span><span class=
"org-comment">'</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable on-the-fly spell checking</span>
    (add-hook 'org-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class=
"org-keyword">if</span> (or (eq (aref (buffer-name) 0) ?\s) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">buffer starting with " *"</span>
                        (and (boundp 'org-babel-exp-reference-buffer)
                             org-babel-exp-reference-buffer)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">export buffer</span>
                    (message <span class=
"org-string">"DON'T TURN ON Flyspell mode in `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'"</span> (buffer-name))
                  (message <span class=
"org-string">"Turn on Flyspell mode in `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'"</span> (buffer-name))
                  (flyspell-mode))))
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Enable Flyspell in other modes deriving from
              Text (HTML, etc.)</b><br /></td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable on-the-fly spell checking</span>
    (add-hook 'text-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (message <span class=
"org-string">"Turn on Flyspell mode in `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'"</span> (buffer-name))
                (flyspell-mode)))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-export-as</span> (around leuven-org-export-as activate)
      <span class=
"org-doc">"Turn off Text mode hooks (Flyspell, etc.) when exporting current Org buffer."</span>
      (<span class="org-keyword">let</span> (text-mode-hook)
        ad-do-it))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prevent Flyspell from finding mistakes in the code, well in comments and</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">strings</span>
    (add-hook 'prog-mode-hook 'flyspell-prog-mode)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ispell"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save the personal dictionary without confirmation</span>
      (setq ispell-silently-savep t)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">extensions and extra switches to pass to the `</span><span class=
"org-comment"><span class="org-constant">ispell</span></span><span class=
"org-comment">' program</span>
      (<span class="org-keyword">cond</span>
</pre>
          </div>

          <p>Tell <code>aspell</code> to speed up, though this reduces somewhat
          the quality of its suggestions. According to the <code>aspell</code>
          documentation:</p>

          <ul class="org-ul">
            <li>“ultra” is the fastest suggestion mode, which is still twice as
            slow as <code>ispell</code>.</li>

            <li>If your machine is fast enough, a better option might be to try
            “fast” mode, which is twice as slow as “ultra”, but more
            accurate.</li>

            <li>The “normal” mode, which is the <code>aspell</code> default, is
            even more accurate, but is reportedly 10 times slower than “fast”
            mode.</li>
          </ul>

          <p>Use the <code>-C</code> option which will
          ConsiderCamelCaseToBeCorrect.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
       ((string-match <span class=
"org-string">"aspell"</span> ispell-program-name)
        (setq ispell-extra-args '(<span class=
"org-string">"--sug-mode=ultra"</span> <span class="org-string">"-C"</span>))
        (setq ispell-really-aspell t)
        (setq ispell-really-hunspell nil))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
       ((string-match <span class=
"org-string">"ispell"</span> ispell-program-name)
        (setq ispell-extra-args '())
        (setq ispell-really-aspell nil)
        (setq ispell-really-hunspell nil)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; solve the problem of words separated by `-' flagged as</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; erroneous by removing the `-' from the value of otherchars</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(if (fboundp 'ispell-get-decoded-string)</span>
      <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(defun ispell-get-otherchars ()</span>
      <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(replace-regexp-in-string "-" "" (ispell-get-decoded-string 3))))</span>
</pre>
          </div>

          <p>Add language indicator.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      (setq-default mode-line-format
                    (cons
                     '(<span class="org-builtin">:eval</span>
                       (<span class=
"org-keyword">let</span> ((dict (and (<span class=
"org-keyword">featurep</span> '<span class="org-constant">ispell</span>)
                                        (not buffer-read-only)
                                        (or ispell-local-dictionary
                                            ispell-dictionary
                                            <span class=
"org-string">"--"</span> <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">default dictionary</span>
                                            ))))
                         (and dict
                              (propertize (concat <span class=
"org-string">" "</span> (substring dict 0 2))
                                          'face 'mode-line-highlight))))
                     (default-value 'mode-line-format)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      )
</pre>
          </div>

          <p>Note – Each time you cycle to another window (<code>C-x o</code>),
          the <b>Ispell process</b> gets <b>killed</b> and a <b>new Ispell
          process</b> is <b>started</b>, if the language in the next window is
          different from the language in the current window…</p>

          <p><code>flyspell-auto-correct-word</code> is bound to
          <code>C-.</code>. Press it one time to correct the word under the
          cursor. If several spellings are possible, they appear in the
          minibuffer. Just keep hitting <code>C-.</code> to replace the word
          with the successive suggestions.</p>

          <p><code>flyspell-goto-next-error</code> is bound to “C-,”. Press it
          to go to the next previously detected error.</p>

          <p><code>flyspell-correct-word-before-point</code> is bound to
          <code>C-c $</code>. Press it to <b>pop up a menu</b> of possible
          corrections for misspelled word before point.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't use `</span><span class="org-comment"><span class=
"org-constant">M-TAB</span></span><span class=
"org-comment">' to auto-correct the current word (only use `</span><span class=
"org-comment"><span class="org-constant">C-.</span></span><span class=
"org-comment">')</span>
    (setq flyspell-use-meta-tab nil)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> M-TAB is still bound to `</span><span class="org-comment"><span class="org-constant">flyspell-auto-correct-word</span></span><span class="org-comment">' when this</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">chunk of code is placed within (with-eval-after-load "flyspell"...)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"flyspell"</span>

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't consider that a word repeated twice is an error</span>
     (setq flyspell-mark-duplications-flag nil)

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fix the "enabling flyspell mode gave an error" bug</span>
     (setq flyspell-issue-welcome-flag nil)

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; don't print messages for every word (when checking the entire buffer)</span>
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; as it causes a (small) slowdown</span>
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq flyspell-issue-message-flag nil)</span>

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">dash character (`-') is considered as a word delimiter</span>
     (setq-default flyspell-consider-dash-as-word-delimiter-flag t)
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">'("francais" "deutsch8" "norsk")</span>

     (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-flyspell-toggle-dictionary</span> ()
       <span class=
"org-doc">"Toggle the local dictionary between French and US English."</span>
       (interactive)
       (<span class="org-keyword">let</span> ((dict (or ispell-local-dictionary
                       ispell-dictionary)))
         (setq dict (<span class=
"org-keyword">if</span> (string= dict <span class=
"org-string">"francais"</span>) <span class=
"org-string">"american"</span> <span class="org-string">"francais"</span>))
         (message <span class="org-string">"Switched to %S"</span> dict)
         (sit-for 0.5)
         (ispell-change-dictionary dict)
         (force-mode-line-update)
         (<span class="org-keyword">when</span> flyspell-mode
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(flyspell-delete-all-overlays)</span>
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">if above is executed, the advised `</span><span class=
"org-comment"><span class=
"org-constant">org-mode-flyspell-verify</span></span><span class=
"org-comment">'</span>
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">won't work anymore</span>
           (flyspell-buffer))))

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key bindings</span>
     (global-set-key
       (kbd <span class="org-string">"C-$"</span>) 'flyspell-buffer)
     (global-set-key
       (kbd <span class=
"org-string">"C-M-$"</span>) 'leuven-flyspell-toggle-dictionary)

     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">spell-check your XHTML (by adding `</span><span class=
"org-comment"><span class=
"org-constant">nxml-text-face</span></span><span class=
"org-comment">' to the list of</span>
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faces corresponding to text in programming-mode buffers)</span>
     (add-to-list 'flyspell-prog-text-faces 'nxml-text-face)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">client for rfc2229 dictionary servers</span>
  (<span class="org-keyword">when</span> (try-require <span class=
"org-string">"dictionary-autoloads"</span>)

    (global-set-key
      (kbd <span class="org-string">"C-c d s"</span>) 'dictionary-search)
    (global-set-key
      (kbd <span class=
"org-string">"C-c d l"</span>) 'dictionary-lookup-definition)
    (global-set-key
      (kbd <span class="org-string">"C-c d m"</span>) 'dictionary-match-words)

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"dictionary"</span>

      (global-dictionary-tooltip-mode 1)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; server contacted for searching the dictionary</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq dictionary-server "localhost")</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; connect via a HTTP proxy (using the CONNECT command)</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq dictionary-use-http-proxy t)</span>
      <span class="org-comment-delimiter">;;</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; name of the HTTP proxy to use</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq dictionary-proxy-server "hellman") ; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span>
      <span class="org-comment-delimiter">;;</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; port of the proxy server</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq dictionary-proxy-port 8080) ; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use proxy</span>
      (setq url-proxy-services          <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! Emacs expects just hostname and port</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! in `</span><span class="org-comment"><span class=
"org-constant">url-proxy-services</span></span><span class=
"org-comment">',</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! NOT prefixed with "http://"</span>
            `((<span class=
"org-string">"http"</span>     . ,(getenv <span class=
"org-string">"http_proxy"</span>))
              (<span class=
"org-string">"ftp"</span>      . ,(getenv <span class=
"org-string">"http_proxy"</span>))
              (<span class="org-string">"no_proxy"</span> . <span class=
"org-string">"^.*example.com"</span>)))
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable proxy for some hosts</span>
    ))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> excellent!</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-answers-define</span> ()
    <span class="org-doc">"Look up the word under cursor in a browser."</span>
    (interactive)
    (browse-url
     (concat <span class=
"org-string">"http://www.answers.com/main/ntquery?s="</span> (find-tag-default))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-lookup-word-definition-in-w3m</span> ()
    <span class="org-doc">"Look up the word's definition in a emacs-w3m.</span>
<span class=
"org-doc">  If a region is active (a phrase), lookup that phrase."</span>
    (interactive)
    (<span class="org-keyword">let</span> (word
          url)
      (setq word
            (<span class="org-keyword">if</span> (use-region-p)
                (buffer-substring-no-properties (region-beginning)
                                                (region-end))
              (find-tag-default)))
      (setq word (replace-regexp-in-string <span class=
"org-string">" "</span> <span class="org-string">"%20"</span> word))
      (setq url (concat <span class=
"org-string">"http://www.answers.com/main/ntquery?s="</span> word))
      (w3m-browse-url url)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 16 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-19" class="outline-2">
      <h2 id="sec-19">Keyboard Macros</h2>

      <div class="outline-text-2" id="text-19">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 17 (info "(emacs)Keyboard Macros")</span>

(leuven--chapter leuven-chapter-17-keyboard-macros <span class=
"org-string">"17 Keyboard Macros"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-19-1" class="outline-3">
        <h3 id="sec-19-1">Basic Use</h3>

        <div class="outline-text-3" id="text-19-1">
          <dl class="org-dl">
            <dt><code>&lt;S-f8&gt;</code></dt>

            <dd>Start recording your keyboard macro.</dd>

            <dt><code>&lt;S-f8&gt;</code> again</dt>

            <dd>Stop recording it.</dd>

            <dt><code>&lt;f8&gt;</code></dt>

            <dd>Call the keyboard macro.</dd>
          </dl>

          <p>If you want to check the result each time before repeating, type
          <code>&lt;f8&gt; e e...</code>.</p>

          <p>If you want to repeat only N times, type <code>C-u N
          &lt;f8&gt;</code>.</p>

          <p>If you want to repeat forever or until error, type <code>C-u 0
          &lt;f8&gt;</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 17.1 (info "(emacs)Basic Keyboard Macro") Use</span>

  (leuven--section <span class=
"org-string">"17.1 (emacs)Basic Keyboard Macro Use"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-kmacro-turn-on-recording</span> ()
    <span class=
"org-doc">"Start recording a keyboard macro and toggle functionality of key binding."</span>
    (interactive)
    (global-set-key
      (kbd <span class=
"org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-off-recording)
    (kmacro-start-macro nil))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-kmacro-turn-off-recording</span> ()
    <span class=
"org-doc">"Stop recording a keyboard macro and toggle functionality of key binding."</span>
    (interactive)
    (global-set-key
      (kbd <span class=
"org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-on-recording)
    (kmacro-end-macro nil))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">start/stop recording a keyboard macro</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-on-recording)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">execute the most recent keyboard macro</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f8&gt;"</span>) 'kmacro-call-macro)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-19-2" class="outline-3">
        <h3 id="sec-19-2">Naming and Saving Keyboard Macros</h3>

        <div class="outline-text-3" id="text-19-2">
          <dl class="org-dl">
            <dt><code>&lt;C-f8&gt;</code></dt>

            <dd>Give the keyboard macro a name (to invoke it under that
            name).</dd>
          </dl>

          <p>Assign the last macro to a free key binding of your choice with
          <code>kmacro-bind-to-key</code> (bound to <code>C-x C-k
          b</code>).</p>

          <p>To <b>save a named keyboard macro</b> (with its key binding) for
          future use, switch to your <code>.emacs</code> buffer, and run
          <code>C-u M-x insert-kbd-macro</code> (if you leave out the
          <code>C-u</code>, then it will just insert the macro definition
          without the <code>global-set-key</code> sequence).</p>

          <p>You can add <code>(interactive)</code> to make it a command, so
          that you can use it with <code>M-x</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 17.5 Name and (info "(emacs)Save Keyboard Macro")s</span>

  (leuven--section <span class=
"org-string">"17.5 (emacs)Name and Save Keyboard Macros"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">assign a name to the last keyboard macro defined</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;C-f8&gt;"</span>) 'kmacro-name-last-macro)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 17 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-20" class="outline-2">
      <h2 id="sec-20">Files Handling</h2>

      <div class="outline-text-2" id="text-20">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 18 (info "(emacs)Files") Handling</span>

(leuven--chapter leuven-chapter-18-files <span class=
"org-string">"18 Files Handling"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-20-1" class="outline-3">
        <h3 id="sec-20-1">File Names</h3>

        <div class="outline-text-3" id="text-20-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.1 (info "(emacs)File Names")</span>

  (leuven--section <span class="org-string">"18.1 (emacs)File Names"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; name of default directory</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq default-directory (concat (getenv "HOME") "/"))</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-2" class="outline-3">
        <h3 id="sec-20-2">Visiting Files</h3>

        <div class="outline-text-3" id="text-20-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.2 (info "(emacs)Visiting") Files</span>

  (leuven--section <span class=
"org-string">"18.2 (emacs)Visiting Files"</span>)

  (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">find-file</span> (around leuven-find-file activate)
    <span class=
"org-doc">"Open the file named FILENAME and report time spent."</span>
    (<span class="org-keyword">let</span> ((filename (ad-get-arg 0))
          (find-file-time-start (float-time)))
      (message <span class=
"org-string">"(Info) Finding file %s..."</span> filename)
      ad-do-it
      (message <span class=
"org-string">"(Info) Found file %s in %.2f s"</span> filename
               (- (float-time) find-file-time-start))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">visit a file</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'find-file)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-3" class="outline-3">
        <h3 id="sec-20-3">Saving Files</h3>

        <div class="outline-text-3" id="text-20-3">
          <p>You can define a <b>shadow file</b> group to automatically upload
          local files to a remote location.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.3 (info "(emacs)Saving") Files</span>

  (leuven--section <span class="org-string">"18.3 (emacs)Saving Files"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make your changes permanent</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f2&gt;"</span>) 'save-buffer)
</pre>
          </div>

          <p>Builtin file version control of Emacs.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make numbered backups</span>
  (setq version-control t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save backup files (i.e., `</span><span class=
"org-comment"><span class="org-constant">foo~</span></span><span class=
"org-comment">' or `</span><span class="org-comment"><span class=
"org-constant">foo.~i~</span></span><span class=
"org-comment">') in one central location</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(instead of in the local directory)</span>
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">filenames matching a regexp are backed up in the corresponding</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directory</span>
    (setq backup-directory-alist
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Emacs will `</span><span class="org-comment"><span class=
"org-constant">make-directory</span></span><span class=
"org-comment">' it, if necessary</span>
          '((<span class="org-string">".*"</span> . <span class=
"org-string">"~/.emacs.d/backups/"</span>)))) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">regexp =&gt; directory mappings</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; number of oldest versions to keep when a new numbered backup is made</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq kept-old-versions 0)            ; [default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of newest versions to keep when a new numbered backup is made</span>
  (setq kept-new-versions 5)            <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't ask me about deleting excess backup versions</span>
  (setq delete-old-versions t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always use copying to create backup files (don't clobber symlinks)</span>
  (setq backup-by-copying t)
</pre>
          </div>

          <p>Customize saving of files.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ensure a file ends in a newline when it is saved</span>
  (setq require-final-newline t)
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Do this only for text and Fundamental modes, because I could</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">edit binary files (see `</span><span class=
"org-comment"><span class=
"org-constant">mode-require-final-newline</span></span><span class=
"org-comment">')</span>
</pre>
          </div>

          <p>Update time stamps (and copyright notice) automatically.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">update time stamps every time you save a buffer</span>
  (add-hook 'before-save-hook 'time-stamp)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maintain last change time stamps (`Time-stamp: &lt;&gt;' occurring within</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the first 8 lines) in files edited by Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"time-stamp"</span>

   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format of the string inserted by `M-x time-stamp':</span>
   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`YYYY-MM-DD Day HH:MM' (see `</span><span class=
"org-comment"><span class=
"org-constant">system-time-locale</span></span><span class=
"org-comment">' for non-numeric</span>
   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">formatted items of time)</span>
   (setq-default time-stamp-format <span class=
"org-string">"%:y-%02m-%02d %3a %02H:%02M"</span>))

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">update the copyright notice to indicate the current year</span>
    (add-hook 'before-save-hook 'copyright-update))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-4" class="outline-3">
        <h3 id="sec-20-4">Reverting a Buffer</h3>

        <div class="outline-text-3" id="text-20-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.4 (info "(emacs)Reverting") a Buffer</span>

  (leuven--section <span class=
"org-string">"18.4 (emacs)Reverting a Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">replace current buffer text with the text of the visited file on disk</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-revert-buffer-without-query</span> ()
    <span class="org-doc">"Unconditionally revert current buffer."</span>
    (interactive)
    (revert-buffer t t)                 <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">ignore-auto(-save), noconfirm</span>
    (message <span class=
"org-string">"Buffer is up to date with file on disk"</span>))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key binding</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;C-f12&gt;"</span>) 'leuven-revert-buffer-without-query)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-5" class="outline-3">
        <h3 id="sec-20-5">Auto-Saving: Protection Against Disasters</h3>

        <div class="outline-text-3" id="text-20-5">
          <p>How to get Emacs to auto-save to your local disk
          (<code>#file#</code>).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.6 (info "(emacs)Auto Save"): Protection Against Disasters</span>

  (leuven--section <span class=
"org-string">"18.6 (emacs)Auto Save: Protection Against Disasters"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-save every 100 input events</span>
  (setq auto-save-interval 100)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[default: 300]</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-save after 10 seconds idle time</span>
  (setq auto-save-timeout 10)           <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 30]</span>
</pre>
          </div>

          <p>Disable backups and auto-save only in the current buffer with
          <code>M-x sensitive-mode</code>:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">define-minor-mode</span> <span class=
"org-function-name">sensitive-mode</span>
    <span class="org-doc">"For sensitive files like password lists.</span>
<span class=
"org-doc">  It disables backup creation and auto saving in the current buffer.</span>

<span class=
"org-doc">  With no argument, this command toggles the mode.  Non-null prefix argument</span>
<span class=
"org-doc">  turns on the mode.  Null prefix argument turns off the mode."</span>
    nil                                 <span class=
"org-comment-delimiter">; </span><span class="org-comment">initial value</span>
    <span class=
"org-string">" Sensitive"</span>                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">indicator for the mode line</span>
    nil                                 <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">minor mode bindings</span>
    (<span class="org-keyword">if</span> (symbol-value sensitive-mode)
        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable backups</span>
          (set (make-local-variable 'backup-inhibited) t)
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable auto-save</span>
          (<span class="org-keyword">if</span> auto-save-default
              (auto-save-mode -1)))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">resort to default value of backup-inhibited</span>
      (kill-local-variable 'backup-inhibited)
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">resort to default auto save setting</span>
      (<span class="org-keyword">if</span> auto-save-default
          (auto-save-mode 1))))
</pre>
          </div>

          <p>You should enable it for all <code>.vcf</code> and
          <code>.gpg</code> files.</p>

          <p>Make the message “<i>FILENAME has auto save data</i>”
          unmissable:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defface</span> <span class=
"org-variable-name">recover-this-file</span>
    '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:background</span> <span class="org-string">"#FF3F3F"</span>)))
    <span class=
"org-doc">"Face for buffers visiting files with auto save data."</span>
    <span class="org-builtin">:group</span> 'files)

  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven--recover-this-file</span> nil
    <span class=
"org-doc">"If non-nil, an overlay indicating that the visited file has auto save data."</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--recover-this-file</span> ()
    (<span class="org-keyword">let</span> ((<span class=
"org-warning">warn</span> (not buffer-read-only)))
      (<span class="org-keyword">when</span> (and warn
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">no need to warn if buffer is auto-saved under the name of</span>
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the visited file</span>
                 (not (and buffer-file-name
                           auto-save-visited-file-name))
                 (file-newer-than-file-p (or buffer-auto-save-file-name
                                             (make-auto-save-file-name))
                                         buffer-file-name))
        (set (make-local-variable 'leuven--recover-this-file)
             (make-overlay (point-min) (point-max)))
        (overlay-put leuven--recover-this-file
                     'face 'recover-this-file))))

  (add-hook 'find-file-hook 'leuven--recover-this-file)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-6" class="outline-3">
        <h3 id="sec-20-6">Comparing Files</h3>

        <div class="outline-text-3" id="text-20-6">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.9 (info "(emacs)Comparing Files")</span>

  (leuven--section <span class=
"org-string">"18.9 (emacs)Comparing Files"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default to unified diffs</span>
  (setq diff-switches <span class="org-string">"-u"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">compare text in current window with text in next window</span>
  (global-set-key
    (kbd <span class="org-string">"C-="</span>) 'compare-windows)
</pre>
          </div>

          <p>You can use <code>M-x smerge-mode</code> to edit a file with
          conflict markers (output from the <code>diff3</code> program). Smerge
          does not automatically select regions but provides convenient key
          bindings to navigate between conflicts and to choose the A or B
          variant.</p>
        </div>
      </div>

      <div id="outline-container-sec-20-7" class="outline-3">
        <h3 id="sec-20-7">Diff Mode</h3>

        <div class="outline-text-3" id="text-20-7">
          <p>In Diff mode, I can <b>select a hunk and apply it (in
          reverse)</b>. Nice following <code>C-x v =</code> to show what’s
          changed, and decide to reverse a change.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.10 (info "(emacs)Diff Mode")</span>

  (leuven--section <span class="org-string">"18.10 (emacs)Diff Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mode for viewing/editing context diffs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"diff-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight the changes with better granularity</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-diff-make-fine-diffs</span> ()
      <span class="org-doc">"Enable Diff Auto-Refine mode."</span>
      (interactive)
      (<span class=
"org-keyword">let</span> (diff-auto-refine-mode)      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">avoid refining the hunks redundantly ...</span>
        (<span class="org-keyword">condition-case</span> nil
            (<span class="org-keyword">save-excursion</span>
              (goto-char (point-min))
              (<span class="org-keyword">while</span> (not (eobp))
                (diff-hunk-next)
                (diff-refine-hunk)))    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">... when this does it.</span>
          (<span class="org-warning">error</span> nil))
        (run-at-time 0.0 nil
                     (<span class="org-keyword">lambda</span> ()
                       (<span class=
"org-keyword">if</span> (eq major-mode 'diff-mode)
                           <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">put back the cursor only if still in a Diff buffer</span>
                           <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">after the delay</span>
                           (goto-char (point-min)))))))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--diff-make-fine-diffs-if-necessary</span> ()
      <span class=
"org-doc">"Auto-refine only the regions of 14,000 bytes or less."</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check for auto-refine limit</span>
      (<span class="org-keyword">unless</span> (&gt; (buffer-size) 14000)
        (leuven-diff-make-fine-diffs)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (fboundp 'advice-add)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(advice-add 'vc-diff :after</span>
    <span class="org-comment-delimiter">;;    </span><span class=
"org-comment">(lambda (&amp;rest _)</span>
    <span class="org-comment-delimiter">;;      </span><span class=
"org-comment">(leuven--diff-make-fine-diffs-if-necessary))))</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> I tried this simpler form, but does not work.</span>
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">vc-diff</span> (after leuven-vc-diff activate)
      <span class=
"org-doc">"Push the auto-refine function after `</span><span class=
"org-doc"><span class="org-constant">vc-diff</span></span><span class=
"org-doc">'."</span>
      (leuven--diff-make-fine-diffs-if-necessary))

    )
</pre>
          </div>

          <p>To compare 2 text files, you can also use Ediff if the following
          command works.</p>
          <pre class="example">
M-: (executable-find "diff") RET
</pre>

          <p>In Ediff, press:</p>

          <ul class="org-ul">
            <li><code>?</code> to get help</li>

            <li><code>|</code> to change from vertical window layout to
            horizontal window layout, and vice versa</li>

            <li><code>a</code> or <code>b</code> key to merge the code from A
            to B or from B to A</li>

            <li><code>ra</code> or <code>rb</code> to revert your change</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; Ediff, a comprehensive visual interface to diff &amp; patch</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; setup for Ediff's menus and autoloads</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'ediff-hook)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">already loaded (by Emacs?)</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ediff"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ignore space</span>
    (setq ediff-diff-options (concat ediff-diff-options <span class=
"org-string">" -w"</span>))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">add new options after the default ones</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">skip over difference regions that differ only in white space and line</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">breaks</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq-default ediff-ignore-similar-regions  t)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> Make another key binding (than `E') with that value in a let-bind</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sometimes grab the mouse and put it in the control frame</span>
    (setq ediff-grab-mouse 'maybe)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">do everything in one frame</span>
    (setq ediff-window-setup-function 'ediff-setup-windows-plain)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">split the window (horizontally or vertically) depending on the frame</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">width</span>
    (setq ediff-split-window-function
          (<span class="org-keyword">lambda</span> (<span class=
"org-type">&amp;optional</span> arg)
            (<span class="org-keyword">if</span> (&gt; (frame-width) 160)
                (split-window-horizontally arg)
              (split-window-vertically
               arg)))))
</pre>
          </div>

          <p>For <b>comparing two directories</b>, you can use
          <code>ediff-directories</code> or <a href=
          "http://meldmerge.org/">Meld</a>.</p>

          <p><code>ediff-directories</code> combined with the key sequence “= h
          x” shows you only the files which differ.</p>

          <p>It is not recursive, but it gives you also subdirectory pairs to
          compare. Just hit <code>RET</code> on such a pair.</p>

          <p>As bonus, it even works for remote directories.</p>

          <p><b>CAUTION --</b> <code>ediff-directories</code> does not list
          files in one directory with no corresponding files in the other
          directory.</p>
        </div>
      </div>

      <div id="outline-container-sec-20-8" class="outline-3">
        <h3 id="sec-20-8">Miscellaneous File Operations</h3>

        <div class="outline-text-3" id="text-20-8">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.11 (info "(emacs)Misc File Ops")</span>

  (leuven--section <span class=
"org-string">"18.11 (emacs)Misc File Ops"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use the system's Trash (when it is available)</span>
  (setq delete-by-moving-to-trash t)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-9" class="outline-3">
        <h3 id="sec-20-9">Accessing Compressed Files</h3>

        <div class="outline-text-3" id="text-20-9">
          <ul class="org-ul">
            <li>Display the <b>contents</b> of the archive</li>

            <li><b>View or edit</b> the actual files contained withing the
            archive</li>
          </ul>

          <p>Using the Emacs Dired utility, you can compress or uncompress
          marked files (using <code>gzip</code>) by pressing
          <code>Z</code>.</p>

          <p>If you want to create one <b>archive</b> file from marked files,
          you can use:</p>
          <pre class="example">
! tar -cf out.tar *
</pre>

          <p>And if you actually want to <b>compress</b> the resulting archive,
          use one of the two commands:</p>
          <pre class="example">
! tar -cZf out.tar.Z
! tar -czf out.tar.gz
</pre>
        </div>
      </div>

      <div id="outline-container-sec-20-10" class="outline-3">
        <h3 id="sec-20-10">Auto Encryption</h3>

        <div class="outline-text-3" id="text-20-10">
          <p>History:</p>

          <ol class="org-ol">
            <li>
              <p>mailcrypt</p>
            </li>

            <li>
              <p>PGG</p>
            </li>

            <li>
              <p>EasyPG (= epg) is a GnuPG interface for Emacs.</p>

              <p>It allows you to encrypt/decrypt files within Emacs. When you
              use <code>C-x C-f</code> to access an encrypted file, Emacs
              prompts you for the passphrase and then decrypts the file before
              displaying it. When you save the file, Emacs automatically
              encrypts it again with that same key.</p>

              <p>It has two aspects:</p>

              <ul class="org-ul">
                <li>
                  <p>convenient tools which allow to use GnuPG from Emacs
                  (EasyPG Assistant), and</p>
                </li>

                <li>
                  <p>a fully functional interface library to GnuPG (EasyPG
                  Library).</p>

                  <table class="inlinetask" width="100%">
                    <tr>
                      <td valign="top"><b><span class=
                      "todo TODO">TODO</span></b></td>

                      <td width="100%">
                        <b>Fetch the key automatically</b><br />

                        <p>Set the <code>keyserver</code> entry in the
                        <code>~/.gnupg/gpg.conf</code> file properly.</p>
                      </td>
                    </tr>
                  </table>
                </li>
              </ul>
            </li>
          </ol>

          <p>What is PGP/MIME, what is OpenPGP, and how Gnus handles them?</p>

          <ul class="org-ul">
            <li>PGP/MIME is a standard, which mml2015* implements using
            ep[ag]-*.</li>

            <li>OpenPGP is a standard, which ep[ag]-* implements.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the EasyPG Assistant, transparent file encryption</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"epa-file"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">stop EasyPG from asking for the recipient used for encrypting files</span>
    (setq epa-file-encrypt-to <span class=
"org-string">"johndoe@example.com"</span>)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">if no one is selected (""), symmetric encryption will always be</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">performed</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cache passphrase for symmetric encryption (VERY important)</span>
    (setq epa-file-cache-passphrase-for-symmetric-encryption t)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Not to sound paranoid.  But if you want caching, it's recommended to</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use *public-key encryption* instead of symmetric encryption.</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">gpg-agent</span></span><span class=
"org-comment">' is the preferred way to do this.</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prompt for the password in the Emacs minibuffer (instead of using a</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">graphical password prompt for GPG)</span>
    (setenv <span class="org-string">"GPG_AGENT_INFO"</span> nil))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-11" class="outline-3">
        <h3 id="sec-20-11">Remote Files</h3>

        <div class="outline-text-3" id="text-20-11">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.14 (info "(emacs)Remote Files")</span>

  (leuven--section <span class="org-string">"18.14 (emacs)Remote Files"</span>)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-20-11-1" class="outline-4">
          <h4 id="sec-20-11-1">Ange-FTP</h4>

          <div class="outline-text-4" id="text-20-11-1">
            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>Check out why network share aren’t accessible</b><br />

                  <p>I should be able to open <i>/CAUCHY/fsd</i>…</p>
                </td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** Ange-FTP</span>

  (leuven--section <span class="org-string">"Ange-FTP"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">transparent FTP support</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ange-ftp"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">try to use passive mode in ftp, if the client program supports it</span>
    (setq ange-ftp-try-passive-mode t)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">needed for Ubuntu</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-20-11-2" class="outline-4">
          <h4 id="sec-20-11-2">TRAMP</h4>

          <div class="outline-text-4" id="text-20-11-2">
            <p>(other protocols than just FTP)</p>

            <p><code>/method:user@host:/path/file</code></p>

            <p>Examples:</p>

            <ul class="org-ul">
              <li><code>C-x C-f /ssh:user@host:/home/user/.bashrc</code></li>

              <li><code>C-x C-f /plink:user@host:/home/user/.bashrc</code>
              (from Windows)</li>

              <li><code>C-x C-f /sudo:root@localhost:/etc/group</code></li>
            </ul>

            <p>Also <code>M-x find-dired</code>, <code>rgrep</code>,
            <code>lgrep</code>, <code>compile -</code> properly work with TRAMP
            (run on remote server and show result in your Emacs).</p>

            <p>Note – `sshfs’ can give me the same functionality as TRAMP: it
            is like a personal NFS (another mounted file system) over SSH. If
            you can SSH to a server, you can probably do `sshfs’.</p>

            <p>&gt; I’m in shell mode, logged in on another machine over ssh,
            and I want to do &gt; some ‘crontab -e’ editing on that machine.
            But that will bring up a new &gt; editor, which is whatever you set
            in your EDITOR env variable, and both vi &gt; and emacs cannot be
            used in this dumb shell. How can I edit the crontab in &gt; my
            emacs session?</p>

            <p>Create the crontab on the remote machine, open it using TRAMP
            from your machine, edit and save and then reinstall it. That or
            simply enable X forwarding so running emacs on the remote bring up
            Emacs gtk/x on your main machine editing your cron file on the
            remote.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** TRAMP - Transparent Remote Access, Multiple Protocols</span>

  (leuven--section <span class="org-string">"TRAMP"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"tramp"</span>         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">the autoloads are predefined</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 4 (info "(tramp)Configuration") of TRAMP for use</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.6 Selecting a (info "(tramp)Default Method")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default transfer method</span>
    (setq tramp-default-method          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[default: "scp"]</span>
          (<span class="org-keyword">cond</span> (running-ms-windows
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(issues with Cygwin `</span><span class=
"org-comment"><span class="org-constant">ssh</span></span><span class=
"org-comment">' which does not cooperate</span>
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">with Emacs processes -&gt; use `</span><span class=
"org-comment"><span class="org-constant">plink</span></span><span class=
"org-comment">' from PuTTY, it</span>
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">definitely does work under Windows)</span>
                 <span class="org-comment-delimiter">;;</span>
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`C-x C-f /plink:user@host:/some/directory/file'</span>
                 <span class="org-string">"plink"</span>)
                (t
                 <span class="org-string">"ssh"</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">You might try out the `</span><span class=
"org-comment"><span class="org-constant">rsync</span></span><span class=
"org-comment">' method, which saves the remote</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">files quite a bit faster than SSH.  It's based on SSH, so it</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">works the same, just saves faster.</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(nconc (cadr (assq 'tramp-login-args (assoc "ssh" tramp-methods)))</span>
    <span class="org-comment-delimiter">;;        </span><span class=
"org-comment">'(("bash" "-i")))</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setcdr (assq 'tramp-remote-sh (assoc "ssh" tramp-methods))</span>
    <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">'("bash -i"))</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.9 Connecting to a remote host using (info "(tramp)Multi-hops")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">new proxy system (introduced with Tramp 2.1, instead of the old</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"multi-hop" filename syntax) to edit files on a remote server by</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">going via another server</span>
    (<span class=
"org-keyword">when</span> (boundp 'tramp-default-proxies-alist)
      (add-to-list 'tramp-default-proxies-alist
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"final host" "user" "proxy in the middle"</span>
                   '(<span class=
"org-string">"10.10.13.123"</span> <span class="org-string">"\\`root\\'"</span> <span class="org-string">"/ssh:%h:"</span>)))
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Opening `</span><span class="org-comment"><span class=
"org-constant">/sudo:10.10.13.123:</span></span><span class=
"org-comment">' would connect first `</span><span class=
"org-comment"><span class="org-constant">10.10.13.123</span></span><span class=
"org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">via `</span><span class="org-comment"><span class=
"org-constant">ssh</span></span><span class=
"org-comment">' under your account name, and perform `sudo -u root' on</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">that host afterwards.  It is important to know that the given</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">method is applied on the host which has been reached so far.  The</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">trick is to think from the end.</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">/ssh:user1@host|sudo:user2@host:</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.12 (info "(tramp)Password handling") for several connections</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">how many seconds passwords are cached</span>
    (setq password-cache-expiry 60)     <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 16]</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.15 (info "(tramp)Remote shell setup") hints</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">string used for end of line in rsh connections</span>
    (setq tramp-rsh-end-of-line         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[default: "\n"]</span>
          (<span class=
"org-keyword">cond</span> (running-ms-windows <span class=
"org-string">"\n"</span>)
                (t <span class="org-string">"\r"</span>)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.16 (info "(tramp)Auto-save and Backup") configuration</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faster auto saves</span>
    (setq tramp-auto-save-directory temporary-file-directory)
</pre>
            </div>

            <p>The usual way to debug Tramp is to set
            <code>tramp-verbose</code> to 6. This will produce a debug buffer,
            which you can show at <code>tramp-devel@gnu.org</code>.</p>

            <p>The best way to report a Tramp bug is to call <code>M-x
            tramp-bug</code>; this prepares an email, including several trace
            information for analysis.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 9 How to Customize (info "(tramp)Traces and Profiles")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">debugging Tramp</span>
    (setq tramp-verbose 6)              <span class=
"org-comment-delimiter">; </span><span class="org-comment">[maximum: 10]</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"turn off" the effect of `</span><span class=
"org-comment"><span class=
"org-constant">backup-directory-alist</span></span><span class=
"org-comment">' for TRAMP</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">files</span>
    (add-to-list 'backup-directory-alist
                 (cons tramp-file-name-regexp nil))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make Emacs beep after reading from or writing to the remote host</span>
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">tramp-handle-write-region</span> <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
      (after leuven-tramp-write-beep-advice activate)
      <span class="org-doc">"Make Tramp beep after writing a file."</span>
      (interactive)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">tramp-handle-do-copy-or-rename-file</span> <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
      (after leuven-tramp-copy-beep-advice activate)
      <span class="org-doc">"Make Tramp beep after copying a file."</span>
      (interactive)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">tramp-handle-insert-file-contents</span>
      (after leuven-tramp-insert-beep-advice activate)
      <span class=
"org-doc">"Make Tramp beep after inserting contents of a file."</span>
      (interactive)
      (beep))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-20-11-3" class="outline-4">
          <h4 id="sec-20-11-3">TEST Find file as root</h4>

          <div class="outline-text-4" id="text-20-11-3">
            <p>You can just do <code>C-x C-f
            /sudo:user@localhost:/foo/bar/baz.txt &lt;RET&gt;</code>.</p>

            <p>Because I’m lazy, I have a hack (from Tassilo Horn): if I try to
            open a file for which I don’t have permissions for, I’m queried if
            I want to open it as root using the <code>sudo</code> tramp
            method.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-find-file-sudo-header-warning</span> ()
      <span class=
"org-doc">"*Display a warning in header line of the current buffer."</span>
      (<span class="org-keyword">let*</span> ((warning <span class=
"org-string">"WARNING: EDITING FILE WITH ROOT PRIVILEGES!"</span>)
             (space (+ 6 (- (frame-width) (length warning))))
             (bracket (make-string (/ space 2) ?-))
             (warning (concat bracket warning bracket)))
        (setq header-line-format
              (propertize warning 'face 'header-line))))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-find-file-sudo</span> (filename)
      <span class="org-doc">"Open FILENAME with root privileges."</span>
      (interactive <span class="org-string">"F"</span>)
      (set-buffer (find-file (concat <span class=
"org-string">"/sudo::"</span> filename)))
      (leuven-find-file-sudo-header-warning))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class=
"org-comment"> already an existing defadvice around find-file!!</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defadvice find-file (around leuven-find-file activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Open FILENAME using tramp's sudo method if it's read-only."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(if (and (file-exists-p (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;            </span><span class=
"org-comment">(not (file-writable-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class=
"org-comment">(not (file-remote-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class=
"org-comment">(y-or-n-p (concat "File "</span>
    <span class=
"org-comment-delimiter">;;                              </span><span class=
"org-comment">(ad-get-arg 0)</span>
    <span class=
"org-comment-delimiter">;;                              </span><span class=
"org-comment">" is read-only.  Open it as root? ")))</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(leuven-find-file-sudo (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">ad-do-it))</span>

    )
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-20-12" class="outline-3">
        <h3 id="sec-20-12">Convenience Features for Finding Files</h3>

        <div class="outline-text-3" id="text-20-12">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 18.17 (info "(emacs)File Conveniences")</span>

  (leuven--section <span class=
"org-string">"18.17 (emacs)File Conveniences"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">filenames excluded from the recent list</span>
  (setq recentf-exclude                 <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! has to be set before your require</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! `</span><span class="org-comment"><span class=
"org-constant">recentf</span></span><span class="org-comment">'</span>
        '(
          <span class=
"org-string">"~$"</span>                          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Emacs (and others) backup</span>
          <span class="org-string">"\\.aux$"</span> <span class=
"org-string">"\\.log$"</span> <span class=
"org-string">"\\.toc$"</span> <span class=
"org-comment-delimiter">; </span><span class="org-comment">LaTeX</span>
          <span class="org-string">"/tmp/"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">setup a menu of recently opened files</span>
  (GNUEmacs
    (idle-require 'recentf))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"recentf"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum number of items that will be saved</span>
    (setq recentf-max-saved-items 100)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">just 20 is too recent</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">file to save the recent list into</span>
    (setq recentf-save-file <span class=
"org-string">"~/.emacs.d/.recentf"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when using Tramp) turn off the cleanup feature of `</span><span class="org-comment"><span class="org-constant">recentf</span></span><span class="org-comment">'</span>
    (setq recentf-auto-cleanup 'never)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">disable before we start recentf!</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save file names relative to my current home directory</span>
    (setq recentf-filename-handlers '(abbreviate-file-name))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable `</span><span class="org-comment"><span class=
"org-constant">recentf</span></span><span class="org-comment">' mode</span>
    (recentf-mode 1))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-20-12-1" class="outline-4">
          <h4 id="sec-20-12-1">FFAP</h4>

          <div class="outline-text-4" id="text-20-12-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"FFAP"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">visit a file</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'find-file-at-point)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">find file (or URL) at point</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ffap"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function called to fetch an URL</span>
    (setq ffap-url-fetcher 'browse-url))
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">could be `</span><span class="org-comment"><span class=
"org-constant">browse-url-emacs</span></span><span class=
"org-comment">' or `</span><span class="org-comment"><span class=
"org-constant">w3m-browse-url</span></span><span class="org-comment">'</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-20-12-2" class="outline-4">
          <h4 id="sec-20-12-2"><a id="ID-59418189-b87e-45a2-b128-5cbdc8a16430"
          name="ID-59418189-b87e-45a2-b128-5cbdc8a16430"></a>Helm (Anything
          successor)</h4>

          <div class="outline-text-4" id="text-20-12-2">
            <p>For Helm documentation, see the <a href=
            "https://github.com/emacs-helm/helm/wiki">Emacs-helm wiki</a> and
            the <a href=
            "https://github.com/thierryvolpiatto/emacs-tv-config/blob/master/init-helm-thierry.el">
            Helm configuration file of Thierry Volpiatto</a>!</p>

            <p>With <code>helm-M-x</code>, to pass prefix arguments to the
            command you want to run, you have to type <code>C-u</code>
            <b>after</b> typing <code>M-x</code>.</p>

            <p>In Helm, generally, look at the mode line; you will see
            <code>C-c ?:Help</code>, it is your friend: hit it for more
            info.</p>

            <ul class="org-ul">
              <li>
                <p>Narrow the list by typing some patterns (use the <b>space as
                separator</b> for multiple patterns),</p>
              </li>

              <li>
                <p>Select an element with <code>&lt;Up&gt;</code> /
                <code>&lt;Down&gt;</code> / <code>&lt;PageUp&gt;</code> /
                <code>&lt;PageDown&gt;</code> / <code>C-p</code> /
                <code>C-n</code> / <code>C-v</code> / <code>M-v</code>,</p>
              </li>

              <li>
                <p>Choose with <code>&lt;RET&gt;</code>.</p>
              </li>

              <li>
                <p><code>C-z</code> executes an action without quitting the
                Helm session (persistent action):</p>

                <p>For <code>helm-find-files</code>:</p>

                <ul class="org-ul">
                  <li>
                    <p>On a regular file,</p>

                    <ol class="org-ol">
                      <li>First hit on <code>C-z</code> expands the file
                      name</li>

                      <li>Second hit opens the file and displays its contents
                      in the other window</li>

                      <li>Third hit kills the buffer (unless it was already
                      open before starting helm session).</li>
                    </ol>
                  </li>

                  <li>
                    <p>On image files (<code>.jpg</code>, etc..)</p>

                    <ol class="org-ol">
                      <li>Second hit (or <code>C-u C-z</code>) displays the
                      image in the other window</li>

                      <li>If you then turn on <code>helm-follow-mode</code>
                      (<code>C-c C-f</code>), you turn on Helm in <b>image
                      browser</b> (i.e., use <code>C-n/p</code> or
                      <code>arrows/down/up</code>).</li>

                      <li>You can rotate image with <code>M-l/r</code> (these
                      are persistent actions too).</li>
                    </ol>
                  </li>
                </ul>
              </li>
            </ul>

            <p>Kill your buffers with <code>C-u C-z</code> one by one.</p>

            <p>To go back to the <b>previous element</b> of the minibuffer
            history, use <code>M-p</code>.</p>

            <p>As a starting point for all <b>searches in buffers and
            files</b>, use <code>helm-buffers-list</code> and
            <code>helm-find-files</code>: you can launch
            <code>helm-multi-occur</code> and <code>helm-do-grep</code> from
            there.</p>

            <p>You can also use the <code>@</code> prefix to <b>search buffer
            contents</b>.</p>

            <p>To mark all candidates in a Helm buffer, use <code>M-a</code>
            (<code>helm-mark-all</code>) or <code>M-m</code>
            (<code>helm-toggle-all-marks</code>).</p>

            <p>Locate for <b>Windows</b> users: you have to install <a href=
            "http://www.voidtools.com/download.php">Everything</a> with its
            command line interface <code>es.exe</code>.</p>

            <p>Switch to <code>*Helm Log*</code> buffer with <code>M-x
            helm-open-last-log</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (GNUEmacs

    (leuven--section <span class="org-string">"Helm"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open Helm (QuickSilver-like candidate-selection framework)</span>
    (<span class="org-keyword">when</span> (try-require 'helm-config)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">various functions for Helm (Shell history, etc.)</span>
      (<span class="org-keyword">require</span> '<span class=
"org-constant">helm-misc</span>)

      (<span class="org-keyword">when</span> (and running-ms-windows
                 (executable-find <span class="org-string">"es"</span>))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">we could check for it in</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">(concat (getenv "USERPROFILE") "/Downloads")</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sort locate results by full path</span>
        (setq helm-locate-command <span class=
"org-string">"es -s %s %s"</span>))

      (global-set-key
        (kbd <span class=
"org-string">"&lt;f3&gt;"</span>) 'helm-for-files)   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">better than `</span><span class="org-comment"><span class=
"org-constant">helm-find-files</span></span><span class="org-comment">'</span>

      (global-set-key
        (kbd <span class="org-string">"M-x"</span>) 'helm-M-x)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">buffers only</span>
      (global-set-key
        (kbd <span class="org-string">"C-x b"</span>) 'helm-buffers-list)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-helm-org-prog-menu</span> ()
        <span class=
"org-doc">"Jump to a place in the buffer using an Index menu.</span>
<span class="org-doc">      For Org mode buffers, show Org headlines.</span>
<span class=
"org-doc">      For programming mode buffers, show functions, variables, etc."</span>
        (interactive)
        (<span class="org-keyword">if</span> (derived-mode-p 'org-mode)
            (helm-org-headlines)
          (helm-imenu)))

      (global-set-key
        (kbd <span class=
"org-string">"&lt;f4&gt;"</span>) 'leuven-helm-org-prog-menu) <span class=
"org-comment-delimiter">; </span><span class="org-comment">awesome</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">and `C-c =' (like in RefTeX)?</span>

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-helm-grep-org-files</span> ()
        <span class="org-doc">"Launch grep on Org files in `</span><span class=
"org-doc"><span class="org-constant">~/org</span></span><span class=
"org-doc">'."</span>
        (interactive)
        (<span class=
"org-keyword">let</span> ((files (helm-walk-directory <span class=
"org-string">"~/org"</span>
                                          <span class=
"org-builtin">:path</span> 'full
                                          <span class=
"org-builtin">:directories</span> nil
                                          <span class=
"org-builtin">:match</span> <span class="org-string">".*\\.</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">org</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">txt</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">$"</span>
                                          <span class=
"org-builtin">:skip-subdirs</span> t)))
          (helm-do-grep-1 files)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate (a better version of) `</span><span class=
"org-comment"><span class="org-constant">occur</span></span><span class=
"org-comment">' easily globally</span>
      (global-set-key
        (kbd <span class="org-string">"C-o"</span>) 'helm-occur)

      (global-set-key
        (kbd <span class="org-string">"C-x r l"</span>) 'helm-bookmarks)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">install from https://github.com/thierryvolpiatto/emacs-bmk-ext</span>
      (global-set-key
        (kbd <span class="org-string">"C-x r b"</span>) 'helm-bookmark-ext)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; prefix key for all Helm commands in the global map</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq helm-command-prefix-key "C-c C-f") ; [default: "C-x c"]</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use the *current window* (no popup) to show the candidates</span>
      (setq helm-full-frame nil)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always display `</span><span class="org-comment"><span class=
"org-constant">helm-buffer</span></span><span class=
"org-comment">' in current window</span>
      (setq helm-split-window-default-side 'same)

      (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-separator</span>
        '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"slate gray"</span>)))
        <span class="org-doc">"Face used to display state NEW."</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">candidates separator of `</span><span class=
"org-comment"><span class="org-constant">multiline</span></span><span class=
"org-comment">' source</span>
      (setq helm-candidate-separator
            (propertize <span class=
"org-string">"--separator-------------------------------"</span>
                        'face 'leuven-separator))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">suppress displaying sources which are out of screen at first</span>
      (setq helm-quick-update t)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time that the user has to be idle for, before candidates from</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">DELAYED sources are collected</span>
      (setq helm-idle-delay 0.1)        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">useful for sources involving heavy</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">operations, so that candidates from</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">the source are not retrieved</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">unnecessarily if the user keeps typing</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time that the user has to be idle for, before ALL candidates</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">are collected (&gt;= `</span><span class=
"org-comment"><span class=
"org-constant">helm-idle-delay</span></span><span class="org-comment">')</span>
      (setq helm-input-idle-delay 0.1)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">also effective for NON-DELAYED sources</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; don't save history information to file</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(remove-hook 'kill-emacs-hook 'helm-adaptive-save-history)</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show only basename of candidates in `</span><span class=
"org-comment"><span class=
"org-constant">helm-find-files</span></span><span class="org-comment">'</span>
      (setq helm-ff-transformer-show-only-basename nil)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't truncate buffer names</span>
      (setq helm-buffer-max-length nil)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save command even when it fails</span>
      (setq helm-M-x-always-save-history t)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">helm-toggle-debug</span> ()
        <span class="org-doc">"Toggle Helm debug on/off."</span>
        (interactive)
        (setq helm-debug (not helm-debug))
        (message <span class="org-string">"Helm debug %s"</span> (<span class=
"org-keyword">if</span> helm-debug
                                     <span class="org-string">"enabled"</span>
                                   <span class=
"org-string">"disabled"</span>)))))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"helm"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; enable generic Helm completion (for all functions in Emacs that use</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; `</span><span class="org-comment"><span class=
"org-constant">completing-read</span></span><span class=
"org-comment">' or `</span><span class="org-comment"><span class=
"org-constant">read-file-name</span></span><span class=
"org-comment">' and friends)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(helm-mode 1)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; enable adaptative sorting in all sources</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(helm-adaptative-mode 1)</span>
    )
</pre>
            </div>

            <ul class="org-ul">
              <li><code>volatile</code> means your candidates are recomputed
              each time you enter a character in pattern (cached candidates are
              not reused). Async sources are by essence volatile.</li>

              <li><code>delayed</code> means your candidates are computed after
              <code>helm-input-idle-delay</code> seconds.</li>

              <li><code>no-matchplugin</code> means to not use the multi regexp
              matching provided by <code>helm-match-plugin.el</code>.</li>
            </ul>
          </div>
        </div>

        <div id="outline-container-sec-20-12-3" class="outline-4">
          <h4 id="sec-20-12-3">Image mode</h4>

          <div class="outline-text-4" id="text-20-12-3">
            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>auto-image-file-mode in find-file-hook for
                performance reasons!?</b><br /></td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"Image mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show image files as images (not as semi-random bits)</span>
  (GNUEmacs
    (add-hook 'find-file-hook 'auto-image-file-mode))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 18 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-21" class="outline-2">
      <h2 id="sec-21">Using Multiple Buffers</h2>

      <div class="outline-text-2" id="text-21">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 19 Using Multiple (info "(emacs)Buffers")</span>

(leuven--chapter leuven-chapter-19-buffers <span class=
"org-string">"19 Using Multiple Buffers"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-21-1" class="outline-3">
        <h3 id="sec-21-1">Creating and Selecting Buffers</h3>

        <div class="outline-text-3" id="text-21-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 19.1 Creating and (info "(emacs)Select Buffer")</span>

  (leuven--section <span class="org-string">"19.1 (emacs)Select Buffer"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">switch-or-start</span> (function buffer)
    <span class=
"org-doc">"If the BUFFER is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, invoke the FUNCTION."</span>
    (<span class=
"org-keyword">if</span> (equal (buffer-name (current-buffer)) buffer)
        (bury-buffer)
      (<span class="org-keyword">if</span> (get-buffer buffer)
          (switch-to-buffer buffer)
        (funcall function))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">switch-or-find-file</span> (file)
    <span class=
"org-doc">"If the FILE is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, open it."</span>
    (<span class="org-keyword">when</span> (file-exists-p file)
      (<span class="org-keyword">if</span> (and (buffer-file-name)
               (string= (expand-file-name file)
                        (expand-file-name (buffer-file-name))))
          (bury-buffer)
        (find-file file))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-21-2" class="outline-3">
        <h3 id="sec-21-2">Listing Existing Buffers</h3>

        <div class="outline-text-3" id="text-21-2">
          <ul class="org-ul">
            <li>The <code>C</code> (current) column has a <code>.</code> for
            the buffer from which you came.</li>

            <li>The <code>R</code> (read-only) column has a <code>%</code> if
            the buffer is read-only.</li>

            <li>The <code>M</code> (modified) column has a <code>*</code> if it
            is modified.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 19.2 (info "(emacs)List Buffers")</span>

  (leuven--section <span class="org-string">"19.2 (emacs)List Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">rebind `C-x C-b'</span>
  (global-set-key
    (kbd <span class="org-string">"C-x C-b"</span>) 'electric-buffer-list)
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">buffer-menu</span></span><span class=
"org-comment">' moves point in the window which lists your buffers</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">electric-buffer-list</span></span><span class=
"org-comment">' pops up a buffer describing the set of buffers</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">operate on buffers like Dired</span>
  (global-set-key
    (kbd <span class="org-string">"C-x C-b"</span>) 'ibuffer)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ibuffer"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completely replaces `</span><span class=
"org-comment"><span class="org-constant">list-buffer</span></span><span class=
"org-comment">'</span>
    (<span class="org-keyword">defalias</span> '<span class=
"org-function-name">ibuffer-list-buffers</span> 'list-buffer)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show the names of filter groups which are empty</span>
    (setq ibuffer-show-empty-filter-groups nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">filtering groups</span>
    (setq ibuffer-saved-filter-groups
          '((<span class="org-string">"default"</span>
             (<span class="org-string">"Chat"</span>
              (mode . circe-mode))
             (<span class="org-string">"Org"</span>
              (or
               (mode . diary-mode)
               (mode . org-mode)
               (mode . org-agenda-mode)))
             (<span class="org-string">"LaTeX"</span>
              (or
               (mode . latex-mode)
               (mode . LaTeX-mode)
               (mode . bibtex-mode)
               (mode . reftex-mode)))
             (<span class="org-string">"Gnus &amp; News"</span>
              (or
               (mode . message-mode)
               (mode . bbdb-mode)
               (mode . mail-mode)
               (mode . gnus-group-mode)
               (mode . gnus-summary-mode)
               (mode . gnus-article-mode)
               (name . <span class="org-string">"^</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">\\.bbdb</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">dot-bbdb</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">$"</span>)
               (name . <span class="org-string">"^\\.newsrc-dribble$"</span>)
               (mode . newsticker-mode)))
             (<span class="org-string">"Files"</span>
              (filename . <span class="org-string">".*"</span>))
             (<span class="org-string">"Dired"</span>
              (mode . dired-mode))
             (<span class="org-string">"Shell"</span>
              (mode . shell-mode))
             (<span class="org-string">"Version Control"</span>
              (or
               (mode . svn-status-mode)
               (mode . svn-log-edit-mode)
               (name . <span class="org-string">"^\\*svn-"</span>)
               (name . <span class="org-string">"^\\*vc\\*$"</span>)
               (name . <span class="org-string">"^\\*Annotate"</span>)
               (name . <span class="org-string">"^\\*git-"</span>)
               (name . <span class="org-string">"^\\*vc-"</span>)))
             (<span class="org-string">"Emacs"</span>
              (or
               (name . <span class="org-string">"^\\*scratch\\*$"</span>)
               (name . <span class="org-string">"^\\*Messages\\*$"</span>)
               (name . <span class="org-string">"^TAGS</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">&lt;[0-9]+&gt;</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">?$"</span>)
               (name . <span class="org-string">"^\\*Occur\\*$"</span>)
               (name . <span class="org-string">"^\\*grep\\*$"</span>)
               (name . <span class="org-string">"^\\*Compile-Log\\*$"</span>)
               (name . <span class="org-string">"^\\*Backtrace\\*$"</span>)
               (name . <span class="org-string">"^\\*Process List\\*$"</span>)
               (name . <span class="org-string">"^\\*gud\\*$"</span>)
               (name . <span class="org-string">"^\\*Kill Ring\\*$"</span>)
               (name . <span class="org-string">"^\\*Completions\\*$"</span>)
               (name . <span class="org-string">"^\\*tramp"</span>)
               (name . <span class="org-string">"^\\*compilation\\*$"</span>)))
             (<span class="org-string">"Emacs Source"</span>
              (mode . emacs-lisp-mode))
             (<span class="org-string">"Documentation"</span>
              (or
               (mode . Info-mode)
               (mode . apropos-mode)
               (mode . woman-mode)
               (mode . help-mode)
               (mode . Man-mode))))))

    (add-hook 'ibuffer-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (ibuffer-switch-to-saved-filter-groups <span class=
"org-string">"default"</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">order the groups so the order is: [Default], [agenda], [emacs]</span>
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">ibuffer-generate-filter-groups</span>
      (after leuven-reverse-ibuffer-groups activate)
      (setq ad-return-value (nreverse ad-return-value))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-21-3" class="outline-3">
        <h3 id="sec-21-3">Killing Buffers</h3>

        <div class="outline-text-3" id="text-21-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 19.4 (info "(emacs)Kill Buffer")</span>

  (leuven--section <span class="org-string">"19.4 (emacs)Kill Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">kill buffer without confirmation (if not modified)</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-kill-this-buffer-without-query</span> ()
    <span class=
"org-doc">"Kill the current buffer without confirmation (if not modified)."</span>
    (interactive)
    (kill-buffer nil))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key binding</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;S-f12&gt;"</span>) 'leuven-kill-this-buffer-without-query)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-21-4" class="outline-3">
        <h3 id="sec-21-4">Operating on Several Buffers</h3>

        <div class="outline-text-3" id="text-21-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 19.5 (info "(emacs)Several Buffers")</span>

  (leuven--section <span class=
"org-string">"19.5 (emacs)Several Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">put the current buffer at the end of the list of all buffers</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;f12&gt;"</span>) 'bury-buffer)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">conflict when GDB'ing Emacs under</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">Win32</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-21-5" class="outline-3">
        <h3 id="sec-21-5">Convenience Features and Customization of Buffer
        Handling</h3>

        <div class="outline-text-3" id="text-21-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 19.7 (info "(emacs)Buffer Convenience") and Customization of Buffer Handling</span>

  (leuven--section <span class=
"org-string">"19.7 (emacs)Buffer Convenience and Customization of Buffer Handling"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unique buffer names dependent on file name</span>
  (try-require 'uniquify)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"uniquify"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">style used for uniquifying buffer names with parts of directory</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name</span>
    (setq uniquify-buffer-name-style 'forward)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">distinguish directories by adding extra separator</span>
    (setq uniquify-trailing-separator-p t))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 19 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-22" class="outline-2">
      <h2 id="sec-22">Multiple Windows</h2>

      <div class="outline-text-2" id="text-22">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 20 Multiple (info "(emacs)Windows")</span>

(leuven--chapter leuven-chapter-20-windows <span class=
"org-string">"20 Multiple Windows"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-22-1" class="outline-3">
        <h3 id="sec-22-1">Concepts of Emacs Windows</h3>

        <div class="outline-text-3" id="text-22-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 20.1 (info "(emacs)Basic Window")</span>

  (leuven--section <span class="org-string">"20.1 (emacs)Basic Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn off this horrible tab thingy in XEmacs</span>
  (XEmacs
    (<span class="org-keyword">when</span> (boundp 'default-gutter-visible-p)
      (set-specifier default-gutter-visible-p nil)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-22-2" class="outline-3">
        <h3 id="sec-22-2">Using Other Windows</h3>

        <div class="outline-text-3" id="text-22-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 20.3 (info "(emacs)Other Window")</span>

  (leuven--section <span class="org-string">"20.3 (emacs)Other Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cycle through all windows on current frame</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;f6&gt;"</span>) 'other-window)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">reverse operation of `C-x o' (or `</span><span class=
"org-comment"><span class="org-constant">f6</span></span><span class=
"org-comment">')</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;S-f6&gt;"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (other-window -1)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-22-3" class="outline-3">
        <h3 id="sec-22-3">Deleting and Rearranging Windows</h3>

        <div class="outline-text-3" id="text-22-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 20.5 (info "(emacs)Change Window")</span>

  (leuven--section <span class="org-string">"20.5 (emacs)Change Window"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-delete-other-windows</span> ()
    <span class=
"org-doc">"Cycle between 1 window, 2 vertically and 2 horizontally split windows."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((splitter
           (<span class=
"org-keyword">if</span> (= (car (window-edges (selected-window)))
                  (car (window-edges (next-window))))
               'split-window-horizontally
             'split-window-vertically)))
      (<span class="org-keyword">cond</span> ((= (count-windows) 1)
             (delete-other-windows)
             (split-window-vertically)
             (set-window-buffer (next-window) (nth 2 (buffer-list))))
            ((and (&gt; (count-windows) 1)
                  (equal splitter 'split-window-horizontally))
             (delete-other-windows)
             (funcall splitter)
             (set-window-buffer (next-window) (nth 2 (buffer-list))))
            ((and (&gt; (count-windows) 1)
                  (equal splitter 'split-window-vertically))
             (delete-other-windows)))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">delete all windows in the selected frame except the selected window</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;f5&gt;"</span>) 'leuven-delete-other-windows)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">swap 2 windows</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-swap-windows</span> ()
    <span class="org-doc">"If you have 2 windows, swap them."</span>
    (interactive)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class=
"org-string">"You need exactly 2 windows to swap them."</span>))
          (t
           (<span class=
"org-keyword">let*</span> ((wind-1 (first (window-list)))
                  (wind-2 (second (window-list)))
                  (buf-1 (window-buffer wind-1))
                  (buf-2 (window-buffer wind-2))
                  (start-1 (window-start wind-1))
                  (start-2 (window-start wind-2)))
             (set-window-buffer wind-1 buf-2)
             (set-window-buffer wind-2 buf-1)
             (set-window-start wind-1 start-2)
             (set-window-start wind-2 start-1)))))

  (global-set-key
    (kbd <span class="org-string">"C-c ~"</span>) 'leuven-swap-windows)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-toggle-window-split</span> ()
    <span class="org-doc">"Toggle between vertical and horizontal split.</span>
<span class=
"org-doc">  Vertical split shows more of each line, horizontal split shows more lines.</span>
<span class=
"org-doc">  This code only works for frames with exactly two windows."</span>
    (interactive)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class=
"org-string">"You need exactly 2 windows to toggle the window split."</span>))
          (t
           (<span class=
"org-keyword">let*</span> ((this-win-buffer (window-buffer))
                  (next-win-buffer (window-buffer (next-window)))
                  (this-win-edges (window-edges (selected-window)))
                  (next-win-edges (window-edges (next-window)))
                  (this-win-2nd (not (and (&lt;= (car this-win-edges)
                                              (car next-win-edges))
                                          (&lt;= (cadr this-win-edges)
                                              (cadr next-win-edges)))))
                  (splitter
                   (<span class="org-keyword">if</span> (= (car this-win-edges)
                          (car (window-edges (next-window))))
                       'split-window-horizontally
                     'split-window-vertically)))
             (delete-other-windows)
             (<span class=
"org-keyword">let</span> ((first-win (selected-window)))
               (funcall splitter)
               (<span class=
"org-keyword">if</span> this-win-2nd (other-window 1))
               (set-window-buffer (selected-window) this-win-buffer)
               (set-window-buffer (next-window) next-win-buffer)
               (select-window first-win)
               (<span class=
"org-keyword">if</span> this-win-2nd (other-window 1)))))))

  (global-set-key
    (kbd <span class="org-string">"C-c |"</span>) 'leuven-toggle-window-split)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-22-4" class="outline-3">
        <h3 id="sec-22-4">Displaying a Buffer in a Window</h3>

        <div class="outline-text-3" id="text-22-4">
          <p>Splits screen vertically if the width of the window is large
          enough.</p>

          <p>See <a href=
          "http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs">
          http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs</a>
          for alternative code…</p>

          <p>See as well <code>split-window-preferred-function</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 20.6 (info "(emacs)Displaying Buffers")</span>

  (leuven--section <span class="org-string">"20.6 (emacs)Pop Up Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't allow splitting windows vertically</span>
  (setq split-height-threshold nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minimum width for splitting windows horizontally</span>
  (setq split-width-threshold 160)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-22-5" class="outline-3">
        <h3 id="sec-22-5">Window Handling Convenience Features and
        Customization</h3>

        <div class="outline-text-3" id="text-22-5">
          <p>Use <code>M-x scroll-all-mode</code> to scroll all visible windows
          together in parallel.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 20 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-23" class="outline-2">
      <h2 id="sec-23">Frames and Graphical Displays</h2>

      <div class="outline-text-2" id="text-23">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 21 (info "(emacs)Frames") and Graphical Displays</span>

(leuven--chapter leuven-chapter-21-frames <span class=
"org-string">"21 Frames and Graphical Displays"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-23-1" class="outline-3">
        <h3 id="sec-23-1">Mouse Commands for Editing</h3>

        <div class="outline-text-3" id="text-23-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.1 (info "(emacs)Mouse Commands")</span>

  (leuven--section <span class=
"org-string">"21.1 (emacs)Mouse Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scroll one line at a time</span>
  (setq mouse-wheel-scroll-amount
        '(1
          ((shift) . 1)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-2" class="outline-3">
        <h3 id="sec-23-2">Creating Frames</h3>

        <div class="outline-text-3" id="text-23-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.6 (info "(emacs)Creating Frames")</span>

  (leuven--section <span class=
"org-string">"21.6 (emacs)Creating Frames"</span>)
</pre>
          </div>

          <ol class="org-ol">
            <li>Resize the frame to the size you want</li>

            <li>Enter <code>(frame-parameters)</code> in the
            <code>*scratch*</code> buffer</li>

            <li>Evaluate the form: place the cursor after the closing paren,
            and type <code>C-j</code>, so that the output goes right into the
            <code>*scratch*</code> buffer</li>
          </ol>

          <p>By putting customizations <code>default-frame-alist</code> in your
          init file, you can control the appearance of <b>all the frames</b>
          Emacs creates, including the initial one.</p>

          <p><code>initial-frame-alist</code> is just for overriding properties
          for the first frame.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (display-graphic-p)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">put Emacs exactly where you want it, every time it starts up</span>
    (setq initial-frame-alist
          '((top . 0)
            (left . 0)))

    (GNUEmacs
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-detect the screen dimensions and compute the height of Emacs</span>
      (add-to-list 'default-frame-alist
                   (cons 'height
                         (/ (- (x-display-pixel-height) 106)
                            (frame-char-height)))))

    (XEmacs
      (set-frame-position (buffer-dedicated-frame) 0 0)
      (set-frame-width (buffer-dedicated-frame) 80)
      (set-frame-height (buffer-dedicated-frame) 42)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">title bar display of visible frames</span>
  (setq frame-title-format
        (format <span class="org-string">"Emacs %s%s of %s - PID: %d"</span>
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(capitalize (symbol-name system-type))</span>
                emacs-version
                (<span class=
"org-keyword">if</span> (and (boundp 'emacs-repository-version)
                         emacs-repository-version)
                    (concat <span class="org-string">" (r"</span>
                            (replace-regexp-in-string <span class=
"org-string">" .*"</span> <span class="org-string">""</span>
                                                      emacs-repository-version)
                            <span class="org-string">")"</span>)
                  <span class="org-string">""</span>)
                (format-time-string <span class=
"org-string">"%Y-%m-%d"</span> emacs-build-time)
                (emacs-pid)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">detach-window</span> ()
    <span class=
"org-doc">"Close current window and re-open it in new frame."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((current-buffer (window-buffer)))
      (delete-window)
      (select-frame (make-frame))
      (set-window-buffer (selected-window) current-buffer)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-3" class="outline-3">
        <h3 id="sec-23-3">Frame Commands</h3>

        <div class="outline-text-3" id="text-23-3">
          <dl class="org-dl">
            <dt><code>toggle-frame-fullscreen</code></dt>

            <dd>Toggle fullscreen mode of the selected frame. <b>Ignore window
            manager screen decorations.</b></dd>

            <dt><code>toggle-frame-maximized</code></dt>

            <dd>Toggle maximization state of the selected frame. Respect window
            manager screen decorations.</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.7 (info "(emacs)Frame Commands")</span>

  (leuven--section <span class=
"org-string">"21.7 (emacs)Frame Commands"</span>)

  (XWindow
   (<span class="org-keyword">defun</span> <span class=
"org-function-name">toggle-fullscreen</span> ()
     <span class=
"org-doc">"Toggle between full screen and partial screen display on X11."</span>
     (interactive)
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">WM must support EWMH</span>
     <span class="org-comment-delimiter">;; </span><span class=
"org-comment">http://standards.freedesktop.org/wm-spec/wm-spec-latest.html</span>
     (x-send-client-message nil 0 nil <span class=
"org-string">"_NET_WM_STATE"</span> 32
                            '(2 <span class=
"org-string">"_NET_WM_STATE_FULLSCREEN"</span> 0)))

   (global-set-key
     (kbd <span class="org-string">"C-c z"</span>) 'toggle-fullscreen))

  (GNUEmacs
    (<span class="org-keyword">when</span> running-ms-windows
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">w32-maximize-frame</span> ()
        <span class="org-doc">"Maximize the current frame."</span>
        (interactive)
        (w32-send-sys-command 61488)
        (global-set-key
          (kbd <span class="org-string">"C-c z"</span>) 'w32-restore-frame))

      (global-set-key
        (kbd <span class="org-string">"C-c z"</span>) 'w32-maximize-frame)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">w32-restore-frame</span> ()
        <span class="org-doc">"Restore a minimized frame."</span>
        (interactive)
        (w32-send-sys-command 61728)
        (global-set-key
          (kbd <span class="org-string">"C-c z"</span>) 'w32-maximize-frame))))
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Try to use the name
              <code>toggle-fullscreen</code> for Windows as well</b><br /></td>
            </tr>
          </table>

          <p>See <code>(display-pixel-width)</code>:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set the new height, allowing for title bars</span>
  (setq lframe-width (- (/ (x-display-pixel-width) (frame-char-width)) 8))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set the new height, allowing for title bars</span>
  (setq lframe-height (- (/ (x-display-pixel-height) (frame-char-height)) 5))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-4" class="outline-3">
        <h3 id="sec-23-4">Speedbar Frames</h3>

        <div class="outline-text-3" id="text-23-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.9 (info "(emacs)Speedbar")</span>

  (leuven--section <span class=
"org-string">"21.9 (emacs)Speedbar Frames"</span>)

  (<span class="org-keyword">unless</span> (locate-library <span class=
"org-string">"helm-config"</span>) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">helm is better than speedbar!</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">jump to speedbar frame</span>
    (global-set-key (kbd <span class=
"org-string">"&lt;f4&gt;"</span>) 'speedbar-get-focus))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">everything browser (into individual source files), or Dired on</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">steroids</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"speedbar"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of spaces used for indentation</span>
    (setq speedbar-indentation-width 2)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add new extensions for speedbar tagging (allow to expand/collapse</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sections, etc.) -- do this BEFORE firing up speedbar?</span>
    (speedbar-add-supported-extension
     '(<span class="org-string">".bib"</span> <span class=
"org-string">".css"</span> <span class="org-string">".jpg"</span> <span class=
"org-string">".js"</span> <span class="org-string">".nw"</span> <span class=
"org-string">".org"</span> <span class="org-string">".php"</span> <span class=
"org-string">".png"</span> <span class="org-string">".R"</span> <span class=
"org-string">".tex"</span> <span class="org-string">".txt"</span>
       <span class="org-string">".w"</span> <span class=
"org-string">"README"</span>))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind the arrow keys in the speedbar tree</span>
    (define-key speedbar-mode-map
      (kbd <span class=
"org-string">"&lt;right&gt;"</span>) 'speedbar-expand-line)
    (define-key speedbar-mode-map
      (kbd <span class=
"org-string">"&lt;left&gt;"</span>) 'speedbar-contract-line)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">parameters to use when creating the speedbar frame in Emacs</span>
    (setq speedbar-frame-parameters '((width . 30)
                                      (height . 45)
                                      (foreground-color . <span class=
"org-string">"blue"</span>)
                                      (background-color . <span class=
"org-string">"white"</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">speedbar in the current frame (vs in a new frame)</span>
    (<span class=
"org-keyword">when</span> (and (not (locate-library <span class=
"org-string">"helm-config"</span>))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">helm is better than speedbar!</span>
               (locate-library <span class="org-string">"sr-speedbar"</span>))

      (autoload 'sr-speedbar-toggle <span class=
"org-string">"sr-speedbar"</span> nil t)
      (global-set-key (kbd <span class=
"org-string">"&lt;f4&gt;"</span>) 'sr-speedbar-toggle)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-5" class="outline-3">
        <h3 id="sec-23-5">Scroll Bars</h3>

        <div class="outline-text-3" id="text-23-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.12 (info "(emacs)Scroll Bars")</span>

  (leuven--section <span class="org-string">"21.12 (emacs)Scroll Bars"</span>)

  (<span class="org-keyword">if</span> (and (display-graphic-p)
           (fboundp 'sml-modeline-mode))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn scroll bar off</span>
      (scroll-bar-mode -1)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">position of the vertical scroll bar</span>
    (setq-default vertical-scroll-bar 'right))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-6" class="outline-3">
        <h3 id="sec-23-6">Tool Bars</h3>

        <div class="outline-text-3" id="text-23-6">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.15 (info "(emacs)Tool Bars")</span>

  (leuven--section <span class="org-string">"21.15 (emacs)Tool Bars"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn tool bar off</span>
  (<span class="org-keyword">when</span> (display-graphic-p)
    (GNUEmacs
      (tool-bar-mode -1))
    (XEmacs
      (set-specifier default-toolbar-visible-p nil)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-7" class="outline-3">
        <h3 id="sec-23-7">Using Dialog Boxes</h3>

        <div class="outline-text-3" id="text-23-7">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.16 Using (info "(emacs)Dialog Boxes")</span>

  (leuven--section <span class=
"org-string">"21.16 (emacs)Using Dialog Boxes"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't use dialog boxes to ask questions</span>
  (setq use-dialog-box nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't use a file dialog to ask for files</span>
  (setq use-file-dialog nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-23-8" class="outline-3">
        <h3 id="sec-23-8">Tooltips</h3>

        <div class="outline-text-3" id="text-23-8">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 21.17 (info "(emacs)Tooltips")</span>

  (leuven--section <span class="org-string">"21.17 (emacs)Tooltips"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable Tooltip mode (use the echo area for help and GUD tooltips)</span>
  (tooltip-mode -1)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 21 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-24" class="outline-2">
      <h2 id="sec-24">International Character Set Support</h2>

      <div class="outline-text-2" id="text-24">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 22 (info "(emacs)International") Character Set Support</span>

(leuven--chapter leuven-chapter-22-international <span class=
"org-string">"22 International Character Set Support"</span>
</pre>
        </div>

        <p>For any user who needs symbols that are not in the 7-bit ASCII set,
        our recommendation is to move to Unicode UTF-8. That is the only
        encoding that is the same across all platforms and operating systems
        that support it.</p>

        <p>To open (or save) a file in UTF-8, you can press <code>C-x
        &lt;RET&gt; c utf-8 &lt;RET&gt;</code>
        (<code>universal-coding-system-argument</code>) before the <code>C-x
        C-f</code> (or <code>C-x C-s</code>).</p>

        <p>To help you find all the chars you need to replace by escape
        sequences, you can use <code>C-u C-s [^[:ascii:]]</code>.</p>

        <p>To check your locale settings, you can have a look to what Emacs
        produce (in a mail buffer) under “Important settings” when you type
        <code>M-x report-emacs-bug &lt;RET&gt; foo &lt;RET&gt;</code>:</p>

        <p><b>Important settings</b>:</p>

        <ul class="org-ul">
          <li>value of <code>$LC_ALL</code>: <code>nil</code></li>

          <li>value of <code>$LC_COLLATE</code>: <code>nil</code></li>

          <li>value of <code>$LC_CTYPE</code>: <code>nil</code></li>

          <li>value of <code>$LC_MESSAGES</code>: <code>nil</code></li>

          <li>value of <code>$LC_MONETARY</code>: <code>nil</code></li>

          <li>value of <code>$LC_NUMERIC</code>: <code>nil</code></li>

          <li>value of <code>$LC_TIME</code>: <code>nil</code></li>

          <li>value of <code>$LANG</code>: <code>en_US.UTF-8</code></li>

          <li>value of <code>$XMODIFIERS</code>: <code>nil</code></li>

          <li><code>locale-coding-system</code>: <code>utf-8-unix</code></li>

          <li><code>default-enable-multibyte-characters</code>:
          <code>t</code></li>
        </ul>
      </div>

      <div id="outline-container-sec-24-1" class="outline-3">
        <h3 id="sec-24-1">Language Environments</h3>

        <div class="outline-text-3" id="text-24-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 22.3 (info "(emacs)Language Environments")</span>

  (leuven--section <span class=
"org-string">"22.3 (emacs)Language Environments"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">specify your character-set locale</span>
  (setenv <span class="org-string">"LANG"</span> <span class=
"org-string">"en_US.utf8"</span>)          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">for svn not to report warnings</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">system locale to use for formatting time values</span>
  (setq system-time-locale <span class=
"org-string">"C"</span>)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">make sure that the weekdays in the</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">time stamps of your Org mode files</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">and in the agenda appear in English</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq system-time-locale (getenv "LANG"))</span>
  <span class=
"org-comment-delimiter">;;                                       </span><span class="org-comment">; for weekdays in your locale settings</span>
</pre>
          </div>

          <p>One could use:</p>

          <ul class="org-ul">
            <li><code>LC_ALL</code>,</li>

            <li><code>LC_COLLATE=C</code> (or
            <code>LC_COLLATE=POSIX</code>),</li>

            <li><code>LC_CTYPE</code>,</li>

            <li><code>LC_ALL</code> or</li>

            <li><code>LANG</code></li>
          </ul>

          <p>but this won’t work for a Windows binary (well for the Cygwin
          version of Emacs).</p>
        </div>
      </div>

      <div id="outline-container-sec-24-2" class="outline-3">
        <h3 id="sec-24-2">Input Methods</h3>

        <div class="outline-text-3" id="text-24-2">
          <p><code>M-x describe-coding-system &lt;RET&gt;
          &lt;RET&gt;</code></p>

          <p>To see all the non-ASCII characters you can type with the
          <code>C-x 8</code> prefix, type <code>C-x 8 C-h</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 22.4 (info "(emacs)Input Methods")</span>

  (leuven--section <span class="org-string">"22.4 (emacs)Input Methods"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get 8-bit characters in terminal mode (Cygwin Emacs)</span>
  (set-input-mode (car (current-input-mode))
                  (nth 1 (current-input-mode))
                  0)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-24-3" class="outline-3">
        <h3 id="sec-24-3">Recognizing Coding Systems</h3>

        <div class="outline-text-3" id="text-24-3">
          <p>In GNU Emacs, when you specify the coding explicitly in the file,
          that overrides <code>file-coding-system-alist</code>.</p>

          <p>XXX Declare PDF files as binary</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 22.7 (info "(emacs)Recognize Coding") Systems</span>

  (leuven--section <span class=
"org-string">"22.7 (emacs)Recognize Coding Systems"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default coding system (for new files),</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">also moved to the front of the priority list for automatic detection</span>
  (GNUEmacs
   (prefer-coding-system 'utf-8-unix))  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Unix flavor for code blocks executed</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">via Org-babel</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-24-4" class="outline-3">
        <h3 id="sec-24-4">Specifying a File’s Coding System</h3>

        <div class="outline-text-3" id="text-24-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 22.8 (info "(emacs)Specify Coding") System of a File</span>

  (leuven--section <span class=
"org-string">"22.8 (emacs)Specify Coding System of a File"</span>)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">to copy and paste to and from Emacs through the clipboard (with</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">coding system conversion)</span>
    (<span class="org-keyword">cond</span> (running-ms-windows
           (set-selection-coding-system 'compound-text-with-extensions))
          (t
           (set-selection-coding-system 'utf-8))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-24-5" class="outline-3">
        <h3 id="sec-24-5">Bidirectional Editing</h3>

        <div class="outline-text-3" id="text-24-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 22.20 (info "(emacs)Bidirectional Editing")</span>

  (leuven--section <span class=
"org-string">"22.20 (emacs)Bidirectional Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faster scrolling (if you never expect to have to display bidirectional</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scripts, such as Arabic and Hebrew)</span>
  (setq-default bidi-paragraph-direction 'left-to-right)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 22 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-25" class="outline-2">
      <h2 id="sec-25">Major and Minor Modes</h2>

      <div class="outline-text-2" id="text-25">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 23 (info "(emacs)Modes")</span>

(leuven--chapter leuven-chapter-23-major-and-minor-modes <span class=
"org-string">"23 Major and Minor Modes"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-25-1" class="outline-3">
        <h3 id="sec-25-1">How Major Modes are Chosen</h3>

        <div class="outline-text-3" id="text-25-1">
          <p>See “Syntax of Regexps”:</p>

          <ul class="org-ul">
            <li><code>\'</code> matches end of string</li>

            <li><code>$</code> matches end of line</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 23.3 (info "(emacs)Choosing Modes")</span>

  (leuven--section <span class=
"org-string">"23.3 (emacs)Choosing File Modes"</span>)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-25-1-1" class="outline-4">
          <h4 id="sec-25-1-1">Choice based on the file name</h4>

          <div class="outline-text-4" id="text-25-1-1">
            <p>Instead of superseding the binding in
            <code>auto-mode-alist</code>, you can replace it (brute force) with
            <code>(setcdr (rassq 'old-mode auto-mode-alist)
            'new-mode)</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of filename patterns</span>
  (setq auto-mode-alist
        (append '((<span class=
"org-string">"\\.log\\'"</span>       . text-mode)
                  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">("\\.[tT]e[xX]\\'" . latex-mode)</span>
                  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">("\\.cls\\'"       . LaTeX-mode)</span>
                  (<span class=
"org-string">"\\.cgi\\'"</span>       . perl-mode)
                  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">("[mM]akefile"     . makefile-mode)</span>
                  (<span class=
"org-string">".ssh/config\\'"</span>  . ssh-config-mode)
                  (<span class=
"org-string">"sshd?_config\\'"</span> . ssh-config-mode)
                  ) auto-mode-alist))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">major mode for fontifiying ssh config files</span>
  (autoload 'ssh-config-mode <span class="org-string">"ssh-config-mode"</span>
    <span class=
"org-doc">"Major mode for fontifiying ssh config files."</span> t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ledger</span>
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.dat\\'"</span> . ledger-mode))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">major mode for editing comma-separated value files</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"csv-mode"</span>)

    (autoload 'csv-mode <span class="org-string">"csv-mode"</span>
      <span class=
"org-doc">"Major mode for editing comma-separated value files."</span> t)

    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.csv\\'"</span> . csv-mode))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">field separators: a list of *single-character* strings</span>
    (setq csv-separators '(<span class="org-string">","</span> <span class=
"org-string">";"</span>)))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-25-1-2" class="outline-4">
          <h4 id="sec-25-1-2">Choice based on the interpreter name</h4>

          <div class="outline-text-4" id="text-25-1-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of interpreters specified in the first line (starts with `#!')</span>
  (push '(<span class=
"org-string">"expect"</span> . tcl-mode) interpreter-mode-alist)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-25-1-3" class="outline-4">
          <h4 id="sec-25-1-3">Choice based on the text at the start of the
          buffer</h4>

          <div class="outline-text-4" id="text-25-1-3">
            <p>For a list of buffer beginnings, see
            <code>magic-mode-alist</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; load generic modes which support e.g. batch files</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'generic-x)</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 23 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-26" class="outline-2">
      <h2 id="sec-26">Indentation</h2>

      <div class="outline-text-2" id="text-26">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 24 (info "(emacs)Indentation")</span>

(leuven--chapter leuven-chapter-24-indentation <span class=
"org-string">"24 Indentation"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-26-1" class="outline-3">
        <h3 id="sec-26-1">Indentation Commands</h3>

        <div class="outline-text-3" id="text-26-1">
          <dl class="org-dl">
            <dt><code>M-m</code></dt>

            <dd><code>back-to-indentation</code>.</dd>

            <dt><code>C-M-\</code></dt>

            <dd>runs the command <code>indent-region</code> (which does the job
            of the imaginary command <code>unsuck-html-layout</code> in
            <code>html-mode</code>).</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 24.1 (info "(emacs)Indentation Commands") and Techniques</span>

  (leuven--section <span class=
"org-string">"24.1 (emacs)Indentation Commands and Techniques"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">indent-whole-buffer</span> ()
    (interactive)
    (<span class="org-keyword">save-excursion</span>
      (mark-whole-buffer)
      (indent-for-tab-command)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-26-2" class="outline-3">
        <h3 id="sec-26-2">Tabs vs. Spaces</h3>

        <div class="outline-text-3" id="text-26-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 24.3 TABs vs. (info "(emacs)Just Spaces")</span>

  (leuven--section <span class=
"org-string">"24.3 TABs vs. (emacs)Just Spaces"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">indentation can't insert TABs</span>
  (setq-default indent-tabs-mode nil)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 24 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-27" class="outline-2">
      <h2 id="sec-27">Commands for Human Languages</h2>

      <div class="outline-text-2" id="text-27">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 25 Commands for (info "(emacs)Text") Human Languages</span>

(leuven--chapter leuven-chapter-25-text <span class=
"org-string">"25 Commands for Human Languages"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-27-1" class="outline-3">
        <h3 id="sec-27-1">Words</h3>

        <div class="outline-text-3" id="text-27-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.1 (info "(emacs)Words")</span>

  (leuven--section <span class="org-string">"25.1 (emacs)Words"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">GNU Emacs default for killing back to the beginning of a word</span>
  (XEmacs
    (global-set-key
      (kbd <span class=
"org-string">"&lt;C-backspace&gt;"</span>) 'backward-kill-word))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-27-2" class="outline-3">
        <h3 id="sec-27-2">Sentences</h3>

        <div class="outline-text-3" id="text-27-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.2 (info "(emacs)Sentences")</span>

  (leuven--section <span class="org-string">"25.2 (emacs)Sentences"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; a single space does end a sentence</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq-default sentence-end-double-space nil) ; see `</span><span class="org-comment"><span class="org-constant">ispell-dictionary</span></span><span class="org-comment">'</span>
</pre>
          </div>

          <p>The default value of <code>sentence-end-double-space</code> is
          good for French as well, as we put two spaces after a
          interrogation/question mark. That way, those two spaces won’t be
          transformed into one…</p>
        </div>
      </div>

      <div id="outline-container-sec-27-3" class="outline-3">
        <h3 id="sec-27-3">Filling Text</h3>

        <div class="outline-text-3" id="text-27-3">
          <p>There are several <b>non-break space</b> characters required for
          French punctuation:</p>

          <ul class="org-ul">
            <li>
              <p><b>No-break thin space</b> (<code>202F</code>), known in
              Unicode as “Narrow No-Break Space”, required before
              <code>?</code>, <code>!</code> and <code>;</code>.</p>
            </li>

            <li>
              <p><b>No-break space</b> (<code>00A0</code>), required before
              <code>:</code> and <code>»</code>, and required after
              <code>«</code>.</p>

              <p>It can be inserted with <code>S-SPC</code>:</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-nbsp-command</span> ()
  <span class="org-doc">"Insert the no-break space character 00A0."</span>
  (interactive)
  (insert-char ?\u00A0))

(global-set-key
  (kbd <span class="org-string">"S-SPC"</span>) 'leuven-nbsp-command)
</pre>
              </div>
            </li>
          </ul>

          <p>They could be used to avoid breaking at certain bad places.</p>

          <p>Another solution to avoid that is to add
          <code>fill-french-nobreak-p</code> to
          <code>fill-nobreak-predicate</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.5 (info "(emacs)Filling") Text</span>

  (leuven--section <span class="org-string">"25.5 (emacs)Filling Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">line-wrapping beyond that column (when pressing `</span><span class="org-comment"><span class="org-constant">M-q</span></span><span class="org-comment">')</span>
  (setq-default fill-column 80)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(un-)fill paragraph</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-fill-paragraph</span> (<span class=
"org-type">&amp;optional</span> arg)
    <span class="org-doc">"`</span><span class="org-doc"><span class=
"org-constant">M-q</span></span><span class=
"org-doc">' runs the command `</span><span class="org-doc"><span class=
"org-constant">fill-paragraph</span></span><span class="org-doc">'.</span>
<span class=
"org-doc">  `C-u M-q' runs \"unfill-paragraph\": it takes a multi-line paragraph and</span>
<span class="org-doc">  converts it into a single line of text."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((fill-column (<span class=
"org-keyword">if</span> arg
                           (point-max)
                         fill-column)))
      (fill-paragraph nil)))

  (global-set-key (kbd <span class=
"org-string">"M-q"</span>) 'leuven-fill-paragraph)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prevent breaking lines just before a punctuation mark such as `?' or `:'</span>
  (add-hook 'fill-nobreak-predicate 'fill-french-nobreak-p)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate Auto Fill for all text mode buffers</span>
  (add-hook 'text-mode-hook 'auto-fill-mode)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">graphically indicate the fill column</span>
  (<span class=
"org-keyword">when</span> (try-require 'fill-column-indicator-<span class=
"org-leuven-highlight">XXX</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">color used to draw the fill-column rule</span>
    (setq fci-rule-color <span class="org-string">"#FFE0E0"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show the fill-column rule as dashes</span>
    (setq fci-rule-use-dashes t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ratio of dash length to line height</span>
    (setq fci-dash-pattern 0.5)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable fci-mode as a global minor mode</span>
    (<span class="org-keyword">define-globalized-minor-mode</span> <span class=
"org-function-name">global-fci-mode</span> fci-mode
      (<span class="org-keyword">lambda</span> () (fci-mode 1)))
    (global-fci-mode 1))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-replace-nbsp-by-spc</span> ()
    <span class="org-doc">"Replace all nbsp by normal spaces."</span>
    (interactive <span class="org-string">"*"</span>)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">save-restriction</span>
        (<span class="org-keyword">save-match-data</span>
          (<span class="org-keyword">progn</span>
            (goto-char (point-min))
            (<span class=
"org-keyword">while</span> (re-search-forward <span class=
"org-string">"[  ]"</span> nil t)
              (replace-match <span class="org-string">" "</span> nil nil)))))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-good-old-fill-paragraph</span> ()
    (interactive)
    (<span class="org-keyword">let</span> ((fill-paragraph-function nil)
          (adaptive-fill-function nil))
      (fill-paragraph)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-smart-punctuation-apostrophe</span> ()
    <span class=
"org-doc">"Replace second apostrophe by backquote in front of symbol."</span>
    (interactive)
    (<span class="org-keyword">cond</span>
     ((or (bolp) (not (looking-back <span class="org-string">"'"</span>)))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert just one '</span>
      (self-insert-command 1))
     ((<span class="org-keyword">save-excursion</span>
        (backward-char)
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Skip symbol backwards.</span>
        (and (not (zerop (skip-syntax-backward <span class=
"org-string">"w_"</span>)))
             (not (looking-back <span class="org-string">"`"</span>))
             (or (insert-and-inherit <span class="org-string">"`"</span>) t))))
     (t
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert `' around following symbol</span>
      (delete-char -1)
      (<span class="org-keyword">unless</span> (looking-back <span class=
"org-string">"`"</span>) (insert-and-inherit <span class=
"org-string">"`"</span>))
      (<span class="org-keyword">save-excursion</span>
        (skip-syntax-forward <span class="org-string">"w_"</span>)
        (<span class="org-keyword">unless</span> (looking-at <span class=
"org-string">"'"</span>) (insert-and-inherit <span class=
"org-string">"'"</span>))))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-smart-punctuation-quotation-mark</span> ()
    <span class=
"org-doc">"Replace two following double quotes by French quotes."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((dict (or ispell-local-dictionary
                    ispell-dictionary)))
      (<span class="org-keyword">if</span> (and (string= dict <span class=
"org-string">"francais"</span>)
               (eq (char-before) ?\")
               (or (not (equal mode-name <span class=
"org-string">"Org"</span>))
                   (not (member (org-element-type (org-element-at-point))
                                '(src-block keyword table dynamic-block)))))
          (<span class="org-keyword">progn</span>
            (backward-delete-char 1)
            (insert <span class="org-string">"«  »"</span>)
            (backward-char 2))
        (insert <span class="org-string">"\""</span>))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-smart-punctuation</span> ()
    <span class="org-doc">"Replace second apostrophe or quotation mark."</span>
    (interactive)
    (local-set-key [39] 'leuven-smart-punctuation-apostrophe)
    (local-set-key <span class=
"org-string">"\""</span> 'leuven-smart-punctuation-quotation-mark))

  (add-hook 'text-mode-hook 'leuven-smart-punctuation)
  (add-hook 'message-mode-hook 'leuven-smart-punctuation)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-27-4" class="outline-3">
        <h3 id="sec-27-4">Case Conversion Commands</h3>

        <div class="outline-text-3" id="text-27-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.6 (info "(emacs)Case") Conversion Commands</span>

  (leuven--section <span class=
"org-string">"25.6 (emacs)Case Conversion Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable the use of the commands `</span><span class=
"org-comment"><span class=
"org-constant">downcase-region</span></span><span class=
"org-comment">' and `</span><span class="org-comment"><span class=
"org-constant">upcase-region</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">without confirmation</span>
  (put 'downcase-region 'disabled nil)
  (put 'upcase-region 'disabled nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-27-5" class="outline-3">
        <h3 id="sec-27-5"><a id="ID-42ad895e-c049-4710-a877-5014a7f6acfc" name=
        "ID-42ad895e-c049-4710-a877-5014a7f6acfc"></a>Outline Mode</h3>

        <div class="outline-text-3" id="text-27-5">
          <p>Outline is line-oriented and does not distinguish
          end-of-block.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.8 (info "(emacs)Outline Mode")</span>

  (leuven--section <span class="org-string">"25.8 (emacs)Outline Mode"</span>)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-27-5-1" class="outline-4">
          <h4 id="sec-27-5-1">outline-minor-mode</h4>

          <div class="outline-text-4" id="text-27-5-1">
            <p>Though Outline minor mode has NOTHING to do with folding of code
            as such, some people have the following code in their
            <code>ruby-mode-hook</code> to enable code folding using
            <code>outline-minor-mode</code> + <code>outline-magic</code>.</p>
            <pre class="example">
(outline-minor-mode 1)
(set (make-local-variable 'outline-regexp) "^[ \t]*\\(?:def\\|class\\|module\\)\\|^[ \t]*###==")
</pre>

            <p>Outline minor mode is also used to collapse Lisp code (i.e., to
            see in the buffer just the definition of a function instead of the
            whole body).</p>

            <p>See also the library <a href="#sec-31-7">hs-minor-mode</a>.</p>

            <p>You can use <code>org-cycle</code> in other modes, with
            <code>outline-minor-mode</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">outline mode commands for Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"outline"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind the outline minor mode functions to an easy to remember prefix</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key (more accessible than the horrible prefix `C-c @')</span>
    (setq outline-minor-mode-prefix (kbd <span class=
"org-string">"C-c C-o"</span>)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">like in nXML mode</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; make other `</span><span class="org-comment"><span class=
"org-constant">outline-minor-mode</span></span><span class=
"org-comment">' files (LaTeX, etc.) feel the Org</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; mode outline navigation (written by Carsten Dominik)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (try-require 'outline-magic)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(add-hook 'outline-minor-mode-hook</span>
    <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(lambda ()</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(kbd "&lt;S-tab&gt;") 'outline-cycle)</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(kbd "&lt;M-left&gt;") 'outline-promote)</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(kbd "&lt;M-right&gt;") 'outline-demote)</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(kbd "&lt;M-up&gt;") 'outline-move-subtree-up)</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(kbd "&lt;M-down&gt;") 'outline-move-subtree-down))))</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; extra support for outline minor mode</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'out-xtra)</span>


    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org-style folding for a `</span><span class=
"org-comment"><span class="org-constant">.emacs</span></span><span class=
"org-comment">' (and much more)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> This should be in an `</span><span class="org-comment"><span class="org-constant">eval-after-load</span></span><span class="org-comment">' of Org, so that</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">org-level-N</span></span><span class=
"org-comment">' are defined when used</span>

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--outline-regexp</span> ()
      <span class=
"org-doc">"Calculate the outline regexp for the current mode."</span>
      (<span class=
"org-keyword">let</span> ((comment-starter (replace-regexp-in-string
                              <span class=
"org-string">"[[:space:]]+"</span> <span class=
"org-string">""</span> comment-start)))
        (<span class=
"org-keyword">when</span> (string= comment-start <span class=
"org-string">";"</span>)
          (setq comment-starter <span class="org-string">";;"</span>))
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(concat "^" comment-starter "\\*+")))</span>
        (concat <span class=
"org-string">"^"</span> comment-starter <span class="org-string">"[*]+ "</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fontify the whole line for headings (with a background color)</span>
    (setq org-fontify-whole-heading-line t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--outline-minor-mode-hook</span> ()
      (setq outline-regexp (leuven--outline-regexp))
      (<span class=
"org-keyword">let*</span> ((org-fontify-whole-headline-regexp <span class=
"org-string">""</span>) <span class=
"org-comment-delimiter">; </span><span class="org-comment">"\n?")</span>
             (heading-1-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{1\\} </span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">.*"</span> org-fontify-whole-headline-regexp <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>))
             (heading-2-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{2\\} </span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">.*"</span> org-fontify-whole-headline-regexp <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>))
             (heading-3-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{3\\} </span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">.*"</span> org-fontify-whole-headline-regexp <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>))
             (heading-4-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{4,\\} </span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">.*"</span> org-fontify-whole-headline-regexp <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>)))
        (font-lock-add-keywords nil
         `((,heading-1-regexp 1 'org-level-1 t)
           (,heading-2-regexp 1 'org-level-2 t)
           (,heading-3-regexp 1 'org-level-3 t)
           (,heading-4-regexp 1 'org-level-4 t)))))

    (add-hook 'outline-minor-mode-hook
              'leuven--outline-minor-mode-hook)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Add the following as the top line of your `</span><span class=
"org-comment"><span class="org-constant">.emacs</span></span><span class=
"org-comment">':</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">; -*- mode: emacs-lisp; eval: (outline-minor-mode 1); -*-</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Now you can add `;;' and `;;*', etc. as headings in your `</span><span class="org-comment"><span class="org-constant">.emacs</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">and cycle using `</span><span class="org-comment"><span class=
"org-constant">&lt;S-tab&gt;</span></span><span class=
"org-comment">', `</span><span class="org-comment"><span class=
"org-constant">&lt;M-left&gt;</span></span><span class=
"org-comment">' and `</span><span class="org-comment"><span class=
"org-constant">&lt;M-right&gt;</span></span><span class=
"org-comment">' will collapse</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">or expand all headings respectively.  I am guessing you mean to make</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">segments such as `;; SHORTCUTS' and `;; VARIABLES', this will do</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">that, but not too much more.</span>
    )
</pre>
            </div>

            <p>For Emacs Lisp, Stefan Monnier additionally uses:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (add-hook 'outline-minor-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class=
"org-keyword">when</span> (and outline-minor-mode (derived-mode-p 'emacs-lisp-mode))
                  (hide-sublevels 1000))))
</pre>
            </div>

            <p>which starts outline-minor-mode by hiding all the bodies of
            functions. He also uses <code>reveal-mode</code> which
            automatically unhides the bodies when you try to move the cursor
            into them (so you don’t need to remember the key sequences to use
            for opening/closing elements).</p>
          </div>
        </div>

        <div id="outline-container-sec-27-5-2" class="outline-4">
          <h4 id="sec-27-5-2">org-global-cycle + outline-magic</h4>

          <div class="outline-text-4" id="text-27-5-2">
            <p>The visibility-cycling features are written in a way that they
            are independent of the outline setup. The following setup provides
            standard Org mode functionality (headline folding and unfolding) in
            <code>outline-minor-mode</code> on <code>&lt;C-tab&gt;</code> and
            <code>&lt;S-tab&gt;</code>. We use <code>&lt;C-tab&gt;</code>
            instead of <code>&lt;tab&gt;</code>, because
            <code>&lt;tab&gt;</code> usually has mode-specific tasks.</p>

            <p>Note that for <code>&lt;C-tab&gt;</code> to work, the cursor
            needs to be on a headline (the line where the ellipsis shows).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'outline-minor-mode-hook</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(define-key outline-minor-mode-map [(control tab)] 'org-cycle)</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(define-key outline-minor-mode-map [(shift tab)] 'org-global-cycle))) ; backtab?</span>
</pre>
            </div>

            <p>Now doing</p>

            <p>M-x find-library RET ox.el RET</p>

            <p>S-TAB (one or more times)</p>

            <p>will give you a give quick overview of all the function
            names.</p>

            <p>Or check out <code>outline-magic.el</code>, which does this and
            also provides <b>promotion and demotion</b> functionality.</p>
          </div>
        </div>

        <div id="outline-container-sec-27-5-3" class="outline-4">
          <h4 id="sec-27-5-3">org</h4>

          <div class="outline-text-4" id="text-27-5-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (global-set-key
    (kbd <span class=
"org-string">"&lt;S-tab&gt;"</span>) 'org-cycle) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">that works (but on level 1+)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Look at org-cycle-global and local below, they work better, but</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">still on level 1+</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Replace it by a function which alternatively does `</span><span class="org-comment"><span class="org-constant">hide-body</span></span><span class="org-comment">' and</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">show-all</span></span><span class="org-comment">'</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-27-5-4" class="outline-4">
          <h4 id="sec-27-5-4">org-struct-mode</h4>

          <div class="outline-text-4" id="text-27-5-4">
            <p>&gt; Experienced users use outline-minor-mode - It takes time to
            getting used to &gt; it.</p>

            <p>You can also use <code>orgstruct-mode</code>, a minor mode that
            comes with <code>org-mode</code>.</p>

            <p><code>org-global-cycle</code> (!= <code>org-cycle-global</code>)
            now works fine in buffers using <code>orgstruct-mode</code>.</p>

            <p>As for handling “large” files, I use this:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">from Bastien</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> 2010-06-21 Conflicts with outline-minor-mode bindings</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a hook to use `</span><span class="org-comment"><span class=
"org-constant">orgstruct-mode</span></span><span class=
"org-comment">' in Emacs Lisp buffers</span>
  (add-hook 'emacs-lisp-mode-hook 'orgstruct-mode)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-cycle-global</span> ()
    (interactive)
    (org-cycle t))

  (global-set-key                       <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class=
"org-comment"> ok on Emacs Lisp, not on LaTeX</span>
    (kbd <span class=
"org-string">"C-M-]"</span>) 'org-cycle-global)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">&lt;S-tab&gt;?</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun org-cycle-local ()</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(save-excursion</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(move-beginning-of-line nil)</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(org-cycle)))</span>

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-cycle-local</span> ()
    (interactive)
    (<span class="org-keyword">ignore-errors</span>
      (end-of-defun)
      (beginning-of-defun))
    (org-cycle))

  (global-set-key                       <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class=
"org-comment"> ok on Emacs Lisp, not on LaTeX</span>
    (kbd <span class="org-string">"M-]"</span>) 'org-cycle-local)

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">C-M-] and M-] fold the whole buffer or the current defun.</span>
</pre>
            </div>

            <p>I made a video to demonstrate it quickly: <a href=
            "https://vimeo.com/55570133">navigating-emacs</a>.</p>

            <p>This helps me survive in files like <code>org.el</code> and
            <code>org-agenda.el</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-27-5-5" class="outline-4">
          <h4 id="sec-27-5-5">fold-dwim-org</h4>

          <div class="outline-text-4" id="text-27-5-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; unified user interface for Emacs folding modes, bound to Org</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; key-strokes</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(GNUEmacs</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(try-require 'fold-dwim-org))</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">25.8.2</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;M-f6&gt;"</span>) 'visible-mode)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-27-6" class="outline-3">
        <h3 id="sec-27-6">Boxquote</h3>

        <div class="outline-text-3" id="text-27-6">
          <p>Use Unicode characters.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs-goodies-el)boxquote")</span>

  (leuven--section <span class=
"org-string">"(emacs-goodies-el)boxquote"</span>)

  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"boxquote"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">quote text with a semi-box</span>
    (autoload 'boxquote-region <span class="org-string">"boxquote"</span>
      <span class=
"org-doc">"Draw a box around the left hand side of a region bounding START and END."</span> t)

    (global-set-key
      (kbd <span class="org-string">"C-c q"</span>) 'boxquote-region)

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"boxquote"</span>
      (setq boxquote-top-and-tail <span class="org-string">"────"</span>)
      (setq boxquote-title-format <span class="org-string">" %s"</span>)
      (setq boxquote-top-corner    <span class="org-string">"  ╭"</span>)
      (setq boxquote-side          <span class="org-string">"  │ "</span>)
      (setq boxquote-bottom-corner <span class="org-string">"  ╰"</span>)))
</pre>
          </div>

          <p>In Gnus, you can mark some region with enclosing tags by pressing
          <code>C-c M-m</code> (<code>message-mark-inserted-region</code>) or
          by clicking on <code>&lt;menu-bar&gt; &lt;Message&gt; &lt;Insert
          Region Marked&gt;</code>.</p>
          <pre class="example">
--8&lt;---------------cut here---------------start-------------&gt;8---
...
...
...
--8&lt;---------------cut here---------------end---------------&gt;8---
</pre>
        </div>
      </div>

      <div id="outline-container-sec-27-7" class="outline-3">
        <h3 id="sec-27-7">Phonetic</h3>

        <div class="outline-text-3" id="text-27-7">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "phonetic")</span>

  (leuven--section <span class="org-string">"phonetic"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">phonetic spelling</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"phonetic"</span>)
    (autoload 'phonetize-region <span class="org-string">"phonetic"</span>
      <span class=
"org-doc">"Translate the region according to the phonetic alphabet."</span> t))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 25 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-28" class="outline-2">
      <h2 id="sec-28"><a id="ID-737b836b-ac1f-4120-94ca-c9e0282268f0" name=
      "ID-737b836b-ac1f-4120-94ca-c9e0282268f0"></a>Org Mode (Getting Things
      Done)</h2>

      <div class="outline-text-2" id="text-28">
        <ul class="org-ul">
          <li>40 variables most frequently customized in Org <a href=
          "http://orgmode.org/worg/org-configs/org-customization-survey.html">http://orgmode.org/worg/org-configs/org-customization-survey.html</a></li>

          <li>Org config examples <a href=
          "http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs">http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs</a></li>
        </ul>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 25.9 Org Mode</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">(info "(org)Top") outline-based notes management and organizer</span>

(leuven--chapter leuven-chapter-25.9-org-mode <span class=
"org-string">"25.9 Getting Things Done (with Org mode)"</span>
</pre>
        </div>

        <p>After all the configuration has been done, you can easily manage
        your daily work and tasks with Org mode.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 1 (info "(org)Introduction")</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 1.2 (info "(org)Installation")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">autoload functions</span>
  (GNUEmacs
    (<span class="org-keyword">unless</span> (try-require 'org-loaddefs)
      (try-require 'org-install)))      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">obsolete since Emacs 24.3</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">getting started</span>
  (GNUEmacs
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.txt\\'"</span> . org-mode))
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.org\\'"</span> . org-mode))
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.org_archive\\'"</span> . org-mode)))

  (define-key global-map
    (kbd <span class="org-string">"C-c l"</span>) 'org-store-link)
  (define-key global-map
    (kbd <span class="org-string">"C-c c"</span>) 'org-capture)
  (define-key global-map
    (kbd <span class="org-string">"C-c a"</span>) 'org-agenda)
  (define-key global-map
    (kbd <span class="org-string">"C-c b"</span>) 'org-switchb)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">using links outside Org</span>
  (global-set-key
    (kbd <span class="org-string">"C-c L"</span>) 'org-insert-link-global)
  (global-set-key
    (kbd <span class="org-string">"C-c O"</span>) 'org-open-at-point-global)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the Org mode manual in Info mode</span>
    (define-key global-map
      (kbd <span class=
"org-string">"C-h o"</span>) 'org-info))         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">not autoloaded</span>
</pre>
        </div>

        <p>These variables need to be set before Org mode is loaded.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">These variables need to be set before org.el is loaded...</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">face to be used by `</span><span class="org-comment"><span class=
"org-constant">font-lock</span></span><span class=
"org-comment">' for highlighting in Org mode Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">buffers, and tags to be used to convert emphasis fontifiers for HTML</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">export</span>
  (setq org-emphasis-alist              <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">remove the strike-through emphasis</span>
        '((<span class="org-string">"*"</span> bold <span class=
"org-string">"&lt;b&gt;"</span> <span class="org-string">"&lt;/b&gt;"</span>)
          (<span class="org-string">"/"</span> italic <span class=
"org-string">"&lt;i&gt;"</span> <span class="org-string">"&lt;/i&gt;"</span>)
          (<span class="org-string">"_"</span> underline <span class=
"org-string">"&lt;span style=\"text-decoration:underline;\"&gt;"</span> <span class="org-string">"&lt;/span&gt;"</span>)
          (<span class="org-string">"="</span> org-verbatim <span class=
"org-string">"&lt;code&gt;"</span> <span class=
"org-string">"&lt;/code&gt;"</span> verbatim)
          (<span class="org-string">"~"</span> org-code <span class=
"org-string">"&lt;code&gt;"</span> <span class=
"org-string">"&lt;/code&gt;"</span> verbatim)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-emphasis-alist</span>
  <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">'(("&amp;" (:weight ultra-bold :foreground "#000000" :background "#FBFF00"))</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">;; ("?" (:box t))</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">("!" (:weight ultra-bold :foreground "#B40000")) ; = alert in some Wikis</span>
</pre>
        </div>

        <p><code>org-emphasis-alist</code> has a <code>:set</code> handler
        <code>org-set-emph-re</code> which will do the job of setting up the
        regexps. I don’t want to call <code>org-set-emph-re</code> directly,
        instead I set <code>org-emphasis-alist</code> to itself and let the
        customize interface call the handler for me.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">allow both single and double quotes in the border</span>
    (setcar (nthcdr 2 org-emphasis-regexp-components) <span class=
"org-string">" \t\r\n,"</span>)
    (custom-set-variables `(org-emphasis-alist ',org-emphasis-alist)))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">single character alphabetical bullets (a, b, c, ..., X, Y, Z) are allowed</span>
  (setq org-list-allow-alphabetical t)
</pre>
        </div>

        <p>If you use <code>org-emphasis-alist</code> to do simple
        highlighting, you should better use <a href=
        "http://www.emacswiki.org/emacs/AddKeywords">font-lock-add-keywords</a>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">libraries that should (always) be loaded along with `</span><span class="org-comment"><span class="org-constant">org.el</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(loaded when opening the first Org file)</span>
  (setq org-modules nil)
</pre>
        </div>

        <p>Original value was:</p>

        <ul class="org-ul">
          <li><code>org-bbdb</code></li>

          <li><code>org-bibtex</code></li>

          <li><code>org-docview</code></li>

          <li><code>org-gnus</code></li>

          <li><code>org-info</code></li>

          <li><code>org-jsinfo</code></li>

          <li><code>org-irc</code></li>

          <li><code>org-mew</code></li>

          <li><code>org-mhe</code></li>

          <li><code>org-rmail</code></li>

          <li><code>org-vm</code></li>

          <li><code>org-w3m</code></li>

          <li><code>org-wl</code></li>
        </ul>

        <p>When you have <code>org-id</code> in <code>org-modules</code>,
        unique <b>ID’s</b> are generated when you link to a task (using
        <code>org-id-get-create</code>) — instead of links containing
        <b>headline text</b>.</p>

        <p>ID’s are saved in <code>~/.emacs.d/.org-id-locations</code> on my
        system (see <code>org-id-locations-file</code>).</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set the RESET_CHECK_BOXES and LIST_EXPORT_BASENAME properties in items as</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">needed</span>
  (add-to-list 'org-modules 'org-checklist)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">globally unique ID for Org mode entries (see `</span><span class=
"org-comment"><span class=
"org-constant">org-store-link</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(takes care of automatically creating unique targets for internal</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">links, see `C-h v org-id-link-to-org-use-id &lt;RET&gt;')</span>
  (add-to-list 'org-modules 'org-id)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">support for links to Gnus groups and messages from within Org mode</span>
  (add-to-list 'org-modules 'org-gnus)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">habit tracking code for Org mode</span>
  (add-to-list 'org-modules 'org-habit)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make sure to turn `</span><span class="org-comment"><span class=
"org-constant">org-info</span></span><span class=
"org-comment">' on in order to link to info nodes</span>
  (add-to-list 'org-modules 'org-info)
</pre>
        </div>

        <table class="inlinetask" width="100%">
          <tr>
            <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

            <td width="100%">
              <b>Look at other modules</b><br />

              <ul class="org-ul">
                <li><code>org-eval</code></li>

                <li><code>org-eval-light</code></li>

                <li><code>org-exp-bibtex</code></li>

                <li><code>org-exp-blocks</code> (supported by the new exporter
                out of the box)</li>

                <li><code>org-man</code></li>

                <li><code>org-mouse</code></li>

                <li><code>org-mtags</code></li>

                <li><code>org-panel</code></li>

                <li><code>org-R</code></li>
              </ul>
            </td>
          </tr>
        </table>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(local-set-key</span>
              <span class="org-comment-delimiter">;;  </span><span class=
"org-comment">(kbd "M-n") 'outline-next-visible-heading)</span>
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(local-set-key</span>
              <span class="org-comment-delimiter">;;  </span><span class=
"org-comment">(kbd "M-p") 'outline-previous-visible-heading)</span>

              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; create a binding for `</span><span class=
"org-comment"><span class=
"org-constant">org-show-subtree</span></span><span class="org-comment">'</span>
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(org-defkey org-mode-map</span>
              <span class=
"org-comment-delimiter">;;             </span><span class=
"org-comment">(kbd "C-c C-S-s") 'org-show-subtree)</span>
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(org-defkey org-mode-map</span>
              <span class=
"org-comment-delimiter">;;             </span><span class=
"org-comment">(kbd "C-c s") 'org-show-subtree)</span>

              (local-set-key
                (kbd <span class="org-string">"C-c h"</span>) 'hide-other)

              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">table</span>
              (local-set-key
                (kbd <span class=
"org-string">"C-M-w"</span>) 'org-table-copy-region)
              (local-set-key
                (kbd <span class=
"org-string">"C-M-y"</span>) 'org-table-paste-rectangle)
              (local-set-key
                (kbd <span class=
"org-string">"C-M-l"</span>) 'org-table-sort-lines)

              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove the binding of `C-c SPC' (in Org tables), used by Ace Jump</span>
              (local-set-key
                (kbd <span class="org-string">"C-c SPC"</span>) nil)))
</pre>
        </div>
      </div>

      <div id="outline-container-sec-28-0-1" class="outline-4">
        <h4 id="sec-28-0-1">Activation</h4>

        <div class="outline-text-4" id="text-28-0-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Introduction"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 1.3 (info "(org)Activation")</span>

    (leuven--section <span class="org-string">"1.3 (org)Activation"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert the first line setting Org mode in empty files</span>
    (setq org-insert-mode-line-in-empty-file t))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-1" class="outline-3">
        <h3 id="sec-28-1">Document Structure</h3>

        <div class="outline-text-3" id="text-28-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 2 (info "(org)Document Structure")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Document Structure"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">improve display of the ellipsis</span>
    (set-face-attribute 'org-ellipsis nil
                        <span class="org-builtin">:box</span> '(<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#999999"</span>)
                        <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"#999999"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FFF8C0"</span>
                        <span class="org-builtin">:underline</span> nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ellipsis to use in the Org mode outline</span>
    (setq org-ellipsis
          (<span class=
"org-keyword">if</span> (char-displayable-p ?\u25B7) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">white right-pointing triangle</span>
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">this test takes ~ 0.40s; hence, wrapped in eval-after-load</span>
              <span class=
"org-string">" \u25B7"</span>                 <span class=
"org-comment-delimiter">; </span><span class="org-comment">string</span>
            'org-ellipsis)))            <span class=
"org-comment-delimiter">; </span><span class="org-comment">face</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">&lt;RET&gt; follows links (except in tables, where you must use `C-c C-o')</span>
  (setq org-return-follows-link t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">blank lines</span>
  (setq org-blank-before-new-entry
        '(<span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert  a blank line before new heading</span>
          (heading . t)

          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">try to make an intelligent decision whether to insert a</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">blank line or not before a new item</span>
          (plain-list-item . auto)))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-1-1" class="outline-4">
          <h4 id="sec-28-1-1">Headlines</h4>

          <div class="outline-text-4" id="text-28-1-1">
            <p><code>C-e</code> goes <b>right before</b> the end of the
            invisible region and <code>TAB</code> will unfold as expected, both
            in a folded subtree or in a folded drawer.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Headlines")</span>

  (leuven--section <span class="org-string">"2.2 (org)Headlines"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; `</span><span class="org-comment"><span class=
"org-constant">C-a</span></span><span class=
"org-comment">' and `</span><span class="org-comment"><span class=
"org-constant">C-e</span></span><span class=
"org-comment">' behave specially in headlines and items</span>
  (setq org-special-ctrl-a/e 'reversed)
</pre>
            </div>

            <p>The package <code>org-inlinetask.el</code> (for <b>tasks
            independent of outline hierarchy</b>) installs the key binding
            <code>C-c C-x t</code> to insert a new <b>inline task</b>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Headlines"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert an inline task (independent of outline hierarchy)</span>
    (<span class=
"org-keyword">when</span> (try-require 'org-inlinetask) <span class=
"org-comment-delimiter">; </span><span class="org-comment">needed</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">initial state (</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> keyword) of inline tasks</span>
      (setq org-inlinetask-default-state <span class=
"org-string">"</span><span class="org-string"><span class=
"org-leuven-highlight">TODO</span></span><span class="org-string">"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">template for inline tasks in HTML exporter</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-html-format-inlinetask</span> (todo todo-type priority title
                                                 tags contents)
        <span class=
"org-doc">"Format an inline task element for HTML export."</span>
        (<span class="org-keyword">let</span> ((todo-kw
               (<span class="org-keyword">if</span> todo
                   (format <span class=
"org-string">"&lt;span class=\"%s %s\"&gt;%s&lt;/span&gt; "</span> todo-type todo todo)
                 <span class="org-string">""</span>))
              (full-title-w/o-todo-kw
               (concat
                (<span class=
"org-keyword">when</span> priority (format <span class=
"org-string">"[#%c] "</span> priority))
                title
                (<span class="org-keyword">when</span> tags
                  (concat <span class=
"org-string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>
                          <span class=
"org-string">"&lt;span class=\"tag\"&gt;"</span>
                          (mapconcat (<span class=
"org-keyword">lambda</span> (tag)
                                       (concat <span class=
"org-string">"&lt;span class= \""</span> tag <span class=
"org-string">"\"&gt;"</span> tag
                                               <span class=
"org-string">"&lt;/span&gt;"</span>))
                                     tags
                                     <span class=
"org-string">"&amp;nbsp;"</span>)
                          <span class="org-string">"&lt;/span&gt;"</span>)))))
          (concat <span class=
"org-string">"&lt;table class=\"inlinetask\" width=\"100%\"&gt;"</span>
                    <span class="org-string">"&lt;tr&gt;"</span>
                      <span class=
"org-string">"&lt;td valign=\"top\"&gt;&lt;b&gt;"</span> todo-kw <span class=
"org-string">"&lt;/b&gt;&lt;/td&gt;"</span>
                      <span class=
"org-string">"&lt;td width=\"100%\"&gt;&lt;b&gt;"</span> full-title-w/o-todo-kw <span class="org-string">"&lt;/b&gt;&lt;br /&gt;"</span>
                        (or contents <span class=
"org-string">""</span>) <span class="org-string">"&lt;/td&gt;"</span>
                    <span class="org-string">"&lt;/tr&gt;"</span>
                  <span class="org-string">"&lt;/table&gt;"</span>)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function called to format an inlinetask in HTML code</span>
      (setq org-html-format-inlinetask-function
            'leuven--org-html-format-inlinetask)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">template for inline tasks in LaTeX exporter</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-latex-format-inlinetask</span> (todo todo-type priority title
                                                  tags contents)
        <span class=
"org-doc">"Format an inline task element for LaTeX export."</span>
        (<span class=
"org-keyword">let*</span> ((tags-string (format <span class=
"org-string">":%s:"</span> (mapconcat 'identity tags <span class=
"org-string">":"</span>)))
               (opt-color
                (<span class="org-keyword">if</span> tags
                    (<span class=
"org-keyword">cond</span> ((string-match <span class=
"org-string">":info:"</span> tags-string)
                           <span class="org-string">"color=yellow!40"</span>)
                          ((string-match <span class=
"org-string">":warning:"</span> tags-string)
                           <span class="org-string">"color=orange!40"</span>)
                          ((string-match <span class=
"org-string">":error:"</span> tags-string)
                           <span class="org-string">"color=red!40"</span>)
                          (t <span class="org-string">""</span>))
                  <span class="org-string">""</span>))
               (full-title
                (concat
                 (<span class="org-keyword">when</span> todo
                   (format <span class=
"org-string">"{\\color{red}\\textbf{\\textsf{\\textsc{%s}}}} "</span>
                           todo))
                 (<span class="org-keyword">when</span> priority
                   (format <span class=
"org-string">"\\textsf{\\framebox{\\#%c}} "</span> priority))
                 title
                 (<span class="org-keyword">when</span> tags
                   (format <span class="org-string">"\\hfill{}:%s:"</span>
                           (mapconcat 'identity tags <span class=
"org-string">":"</span>)))))
               (opt-rule
                (<span class="org-keyword">if</span> contents
                    <span class=
"org-string">"\\\\ \\rule[.3em]{\\textwidth}{0.2pt}\n"</span>
                  <span class="org-string">""</span>))
               (opt-contents
                (or contents <span class="org-string">""</span>)))
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">this requires the `</span><span class="org-comment"><span class=
"org-constant">todonotes</span></span><span class=
"org-comment">' package</span>
          (format (concat <span class=
"org-string">"\\todo[inline,caption={},%s]{\n"</span>
                          <span class="org-string">"  %s\n"</span>
                          <span class="org-string">"  %s"</span>
                          <span class="org-string">"  %s"</span>
                          <span class="org-string">"}"</span>)
                  opt-color
                  full-title
                  opt-rule
                  opt-contents)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function called to format an inlinetask in LaTeX code</span>
      (setq org-latex-format-inlinetask-function
            'leuven--org-latex-format-inlinetask))

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "org" ends here</span>
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Have a solution for base article, report,
                book (w/o todonotes)</b><br /></td>
              </tr>
            </table>
          </div>
        </div>

        <div id="outline-container-sec-28-1-2" class="outline-4">
          <h4 id="sec-28-1-2">Visibility cycling</h4>

          <div class="outline-text-4" id="text-28-1-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Visibility cycling")</span>

  (leuven--section <span class=
"org-string">"2.3 (org)Visibility cycling"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">do not switch to OVERVIEW at startup</span>
  (setq org-startup-folded nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">inhibit startup when preparing agenda buffers -- agenda optimization</span>
  (setq org-agenda-inhibit-startup t)
</pre>
            </div>

            <p>Display outline path in mode line:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'org-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(lambda()</span>
  <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(add-to-list 'mode-line-format</span>
  <span class=
"org-comment-delimiter">;;                          </span><span class=
"org-comment">'(:eval (org-propertize</span>
  <span class=
"org-comment-delimiter">;;                                   </span><span class="org-comment">(org-display-outline-path nil t " / " t)</span>
  <span class=
"org-comment-delimiter">;;                                   </span><span class="org-comment">'face 'mode-line-emphasis</span>
  <span class=
"org-comment-delimiter">;;                                   </span><span class="org-comment">'help-echo "Outline path")) t)))</span>
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>Fix Error during redisplay</b><br />

                  <p>(eval (org-propertize (org-display-outline-path nil t " /
                  " t) (quote face) (quote mode-line-emphasis) (quote
                  help-echo) “Outline path”)) signaled (wrong-type-argument
                  stringp nil)</p>
                </td>
              </tr>
            </table>

            <p>Note that <b>Imenu</b> does display the current Org subtree in
            the mode line, not the full outline path.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-1-3" class="outline-4">
          <h4 id="sec-28-1-3">2.4 Motion</h4>

          <div class="outline-text-4" id="text-28-1-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Motion")</span>

  (leuven--section <span class="org-string">"2.4 (org)Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">outline-node based navigation similar to the behavior of paredit-mode in</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Lisp files</span>
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              (local-set-key
               (kbd <span class=
"org-string">"C-M-n"</span>) 'outline-next-visible-heading)
              (local-set-key
               (kbd <span class=
"org-string">"C-M-p"</span>) 'outline-previous-visible-heading)
              (local-set-key
               (kbd <span class=
"org-string">"C-M-u"</span>) 'outline-up-heading)))
</pre>
            </div>

            <p>Move through an Org file like <code>cd</code> on a file system
            with <code>org-goto</code>: <code>C-c C-j /foo/bar/baz
            &lt;RET&gt;</code></p>

            <p>vs <code>C-u C-c C-j</code></p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">headlines in the current buffer are offered via completion</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(interface also used by the `</span><span class=
"org-comment"><span class="org-constant">refile</span></span><span class=
"org-comment">' command)</span>
  (setq org-goto-interface 'outline-path-completion)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-reveal</span> (<span class=
"org-type">&amp;optional</span> all-siblings)
      <span class="org-doc">"Show all siblings of current level.</span>
<span class=
"org-doc">    `C-u C-c C-r' does the same as default Org mode: show all hidden siblings."</span>
      (interactive <span class="org-string">"P"</span>)
      (<span class="org-keyword">if</span> all-siblings
          (org-reveal t)
        (org-show-siblings)))

    (define-key org-mode-map
      (kbd <span class="org-string">"C-c C-r"</span>) 'leuven-org-reveal))
</pre>
            </div>

            <p>See also <i>Sparse trees</i> for behavior when revealing a
            location.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-1-4" class="outline-4">
          <h4 id="sec-28-1-4">Structure editing</h4>

          <div class="outline-text-4" id="text-28-1-4">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Structure editing")</span>

  (leuven--section <span class=
"org-string">"2.5 (org)Structure editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; </span><span class="org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class=
"org-comment"> Choose the right value!</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-M-RET-may-split-line nil)</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-1-5" class="outline-4">
          <h4 id="sec-28-1-5"><a id="ID-a9fe61b7-cdbd-478e-a4af-da9e122fb2d9"
          name="ID-a9fe61b7-cdbd-478e-a4af-da9e122fb2d9"></a>Sparse trees</h4>

          <div class="outline-text-4" id="text-28-1-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Sparse trees")</span>

  (leuven--section <span class="org-string">"2.6 (org)Sparse trees"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show full hierarchy when revealing a location</span>
  (setq org-show-hierarchy-above t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show following heading when revealing a location</span>
  (setq org-show-following-heading nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show all sibling headings when revealing a location</span>
  (setq org-show-siblings nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show the entry below a headline when revealing a location</span>
  (setq org-show-entry-below t)
  (setq org-show-entry-below '((org-goto . t)))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-1-6" class="outline-4">
          <h4 id="sec-28-1-6">Plain lists</h4>

          <div class="outline-text-4" id="text-28-1-6">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(org)Plain lists")</span>

  (leuven--section <span class="org-string">"2.7 (org)Plain lists"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum indentation for the second line of a description list</span>
  (setq org-description-max-indent 3)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't make tab cycle visibility on plain list items</span>
  (setq org-cycle-include-plain-lists nil) <span class=
"org-comment-delimiter">;; </span><span class="org-comment">'integrate?</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">an empty line does not end all plain list levels</span>
  (setq org-list-empty-line-terminates-plain-lists nil)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-2" class="outline-3">
        <h3 id="sec-28-2">Tables</h3>

        <div class="outline-text-3" id="text-28-2">
          <p>See <a href=
          "http://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">Org
          as a spreadsheet system: a short introduction</a>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 3 (info "(org)Tables")</span>

  (setq org-table-use-standard-references 'from)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 3.1 The (info "(org)Built-in table editor")</span>

  (leuven--section <span class=
"org-string">"3.1 The (org)Built-in table editor"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default export parameters for `</span><span class=
"org-comment"><span class=
"org-constant">org-table-export</span></span><span class="org-comment">'</span>
  (setq org-table-export-default-format <span class=
"org-string">"orgtbl-to-csv"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 3.5 (info "(org)The spreadsheet")</span>

  (leuven--section <span class="org-string">"3.5 (org)The spreadsheet"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-table"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">some Calc mode settings for use in `</span><span class=
"org-comment"><span class="org-constant">calc-eval</span></span><span class=
"org-comment">' for table formulas</span>
    (setcar (cdr (memq 'calc-float-format org-calc-default-modes))
            '(float 12)))               <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 8]</span>
</pre>
          </div>

          <p>To <b>update all tables</b> in a file, use
          <code>org-table-recalculate-buffer-tables</code> if the dependencies
          are only backwards.</p>

          <p>If you have dependencies in both directions, to iterate all tables
          in a file, in order to converge table-to-table dependencies, use
          <code>org-table-iterate-buffer-tables</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-28-3" class="outline-3">
        <h3 id="sec-28-3">Hyperlinks</h3>

        <div class="outline-text-3" id="text-28-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 4 (info "(org)Hyperlinks")</span>
</pre>
          </div>

          <p>If you insert a <a href="http:///">http:///</a> link containing
          equal signs (such as <a href=
          "http://test/test?name=me">http://test/test?name=me</a>), the
          verbatim link being inserted in the Org document has the equal signs
          escaped, unless you have:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't hexify URL when creating a link</span>
  (setq org-url-hexify-p nil)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-3-1" class="outline-4">
          <h4 id="sec-28-3-1">External links</h4>

          <div class="outline-text-4" id="text-28-3-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Hyperlinks"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open non-existing files</span>
    (setq org-open-non-existing-files t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function and arguments to call for following `</span><span class=
"org-comment"><span class="org-constant">mailto</span></span><span class=
"org-comment">' links</span>
    (setq org-link-mailto-program '(compose-mail <span class=
"org-string">"%a"</span> <span class="org-string">"%s"</span>)))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">support for links to Gnus groups and messages from within Org mode</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">create web links to Google groups or Gmane (instead of Gnus</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">messages)</span>
    (setq org-gnus-prefer-web-links t))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-3-2" class="outline-4">
          <h4 id="sec-28-3-2">Handling links</h4>

          <div class="outline-text-4" id="text-28-3-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">global identifiers for Org-mode entries</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-id"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">storing a link to an Org file will use entry IDs</span>
    (setq org-id-link-to-org-use-id
          'create-if-interactive-and-no-custom-id))
</pre>
            </div>

            <p>PDF viewer? See <code>org-file-apps</code>. Just change to your
            favorite viewer. And make sure that you’re calling
            <code>org-return</code> to open (it’s bound to
            <code>C-m</code>).</p>

            <p>If I inline an image in an Org file, I can toggle its display
            with <code>C-c C-x C-v</code> and resize it to a specific
            width.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Handling links"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">4.4 show inline images when loading a new Org file</span>
    (setq org-startup-with-inline-images t) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">invokes org-display-inline-images</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">4.4 try to get the width from an #+ATTR.* keyword and fall back on the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">original width if none is found</span>
    (setq org-image-actual-width nil)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-3-3" class="outline-4">
          <h4 id="sec-28-3-3">Link abbreviations</h4>

          <div class="outline-text-4" id="text-28-3-3">
            <p>Link abbreviations provide a quick way of linking to resources
            that are frequently referenced, so that you can type just the key
            term instead of the complete URL.</p>

            <p>Here is an example: every time you need to use <a href=
            "http://www.google.com/search?q=searchterms">http://www.google.com/search?q=searchterms</a>,
            you can just type <code>[[google:searchterms]]</code> or
            <code>[[google:searchterms][description]]</code> instead.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">shortcut links</span>
    (setq org-link-abbrev-alist
          '((<span class="org-string">"cache"</span> .
             <span class=
"org-string">"http://www.google.com/search?q=cache:%s"</span>)
            (<span class="org-string">"dictionary"</span> .
             <span class=
"org-string">"http://www.dict.org/bin/Dict?Database=*&amp;Form=Dict1&amp;Strategy=*&amp;Query=%s"</span>)
            (<span class="org-string">"google"</span> .
             <span class=
"org-string">"http://www.google.com/search?q=%s"</span>)
            (<span class="org-string">"googlegroups"</span> .
             <span class=
"org-string">"http://groups.google.com/groups?q=%s"</span>)
            (<span class="org-string">"googlemaps"</span> .
             <span class=
"org-string">"http://maps.google.com/maps?q=%s"</span>)
            (<span class="org-string">"imdb"</span> .
             <span class="org-string">"http://us.imdb.com/Title?%s"</span>)
            (<span class="org-string">"openstreetmap"</span> .
             <span class=
"org-string">"http://nominatim.openstreetmap.org/search?q=%s&amp;polygon=1"</span>)
            (<span class="org-string">"wpen"</span> .
             <span class="org-string">"http://en.wikipedia.org/wiki/%s"</span>)
            (<span class="org-string">"wpfr"</span> .
             <span class=
"org-string">"http://fr.wikipedia.org/wiki/%s"</span>))))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-4" class="outline-3">
        <h3 id="sec-28-4">“TODO” Items</h3>

        <div class="outline-text-3" id="text-28-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 5 (info "(org)</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Items")</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-4-1" class="outline-4">
          <h4 id="sec-28-4-1">Basic TODO functionality</h4>

          <div class="outline-text-4" id="text-28-4-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.1 (info "(org)</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> basics") functionality</span>

  (leuven--section <span class="org-string">"5.1 (org)</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> basics functionality"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">5.1 select a </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> state and bypass any logging associated with that</span>
  (setq org-treat-S-cursor-todo-selection-as-state-change nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">some commands act upon headlines in the active region</span>
  (setq org-loop-over-headlines-in-active-region 'start-level)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-4-2" class="outline-4">
          <h4 id="sec-28-4-2">Extended use of TODO keywords</h4>

          <div class="outline-text-4" id="text-28-4-2">
            <p>We use statuses to <b>create a workflow</b> for tasks.</p>

            <p>The statuses we use are a simple as possible to work well in the
            context of work.</p>

            <p>We use the following 4-letter status keywords:</p>

            <dl class="org-dl">
              <dt><code>TODO</code></dt>

              <dd>Approved task, to be done.</dd>

              <dt><code>STRT</code></dt>

              <dd>Some progress has already been done on the task.</dd>

              <dt><code>WAIT</code></dt>

              <dd>Task delegated to someone else. Or waiting for some external
              event to be able to work on the task.</dd>

              <dt><code>SDAY</code></dt>

              <dd>Task to be approved (and eventually done) in the future.</dd>

              <dt><code>DONE</code></dt>

              <dd>Task is completed.</dd>

              <dt><code>CANX</code></dt>

              <dd>Task is declined (but kept documented, instead of being
              deleted).</dd>
            </dl>

            <p>There is just 1 exception (made on purpose) to the 4-letter
            scheme:</p>

            <dl class="org-dl">
              <dt><code>NEW</code></dt>

              <dd>Proposed task, idea or wish, <b>not approved yet</b>.
              Draft.</dd>
            </dl>

            <p>One could add a <code>CLSD</code> or <code>VRFD</code> state for
            bug fixes, for example, which need to be verified before really
            closing the task.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.2 Use of (info "(org)</span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> extensions")</span>

  (leuven--section <span class=
"org-string">"5.2 Use of (org)</span><span class="org-string"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-string"> extensions"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> entry keyword sequences (+ fast access keys and specifiers</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for state change logging)</span>
  (setq org-todo-keywords
        '((sequence <span class=
"org-string">"NEW(n!)"</span>           <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">proposal, idea (under review)</span>
                    <span class="org-string">"</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string">(t!)"</span>          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">open, not (yet) started</span>
                    <span class=
"org-string">"STRT(s!)"</span>          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">in progress, working on, doing</span>
                    <span class=
"org-string">"WAIT(w!)"</span>          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">on hold, assigned, feedback</span>
                    <span class=
"org-string">"SDAY(y!)"</span>          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">someday, maybe, perhaps, wish</span>
                    <span class="org-string">"|"</span>
                    <span class=
"org-string">"DONE(d!)"</span>          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">completed, closed, resolved</span>
                    <span class=
"org-string">"CANX(x!)"</span>)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">wontfix, rejected</span>

          (sequence <span class=
"org-string">"QTE(q!)"</span>           <span class=
"org-comment-delimiter">; </span><span class="org-comment">planning</span>
                    <span class=
"org-string">"QTD(Q!)"</span>           <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">awaiting approval</span>
                    <span class="org-string">"|"</span>
                    <span class=
"org-string">"APP(A!)"</span>           <span class=
"org-comment-delimiter">; </span><span class="org-comment">approved</span>
                    <span class=
"org-string">"REJ(R!)"</span>)          <span class=
"org-comment-delimiter">; </span><span class="org-comment">rejected</span>

          (sequence <span class="org-string">"OPENPO(O!)"</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"CLSDPO(C!)"</span>)))
</pre>
            </div>

            <p><code>SDAY</code> is <b>not</b> a completion state (in order not
            to be struck through).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faces for specific </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> keywords</span>
    (setq org-todo-keyword-faces
          '((<span class="org-string">"NEW"</span>  . leuven-org-created-kwd)
            (<span class="org-string">"</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string">"</span> . org-todo)
            (<span class=
"org-string">"STRT"</span> . leuven-org-in-progress-kwd)
            (<span class=
"org-string">"WAIT"</span> . leuven-org-waiting-for-kwd)
            (<span class="org-string">"SDAY"</span> . leuven-org-someday-kwd)
            (<span class="org-string">"DONE"</span> . org-done)
            (<span class="org-string">"CANX"</span> . org-done)

            (<span class="org-string">"QTE"</span> . leuven-org-quote-kwd)
            (<span class="org-string">"QTD"</span> . leuven-org-quoted-kwd)
            (<span class="org-string">"APP"</span> . leuven-org-approved-kwd)
            (<span class="org-string">"REJ"</span> . leuven-org-rejected-kwd)

            (<span class="org-string">"OPENPO"</span> . leuven-org-openpo-kwd)
            (<span class=
"org-string">"CLSDPO"</span> . leuven-org-closedpo-kwd)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org standard faces</span>
    (set-face-attribute 'org-todo nil
                        <span class=
"org-builtin">:weight</span> 'bold <span class=
"org-builtin">:box</span> '(<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#D8ABA7"</span>)
                        <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"#D8ABA7"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FFE6E4"</span>)

    (set-face-attribute 'org-done nil
                        <span class=
"org-builtin">:weight</span> 'bold <span class=
"org-builtin">:box</span> '(<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#BBBBBB"</span>)
                        <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"#BBBBBB"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#F0F0F0"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org non-standard faces</span>
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-created-kwd</span>
      '((t (<span class="org-builtin">:weight</span> normal <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#EEE9C3"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#1A1A1A"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FDFCD8"</span>)))
      <span class="org-doc">"Face used to display state NEW."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-in-progress-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#D9D14A"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#D9D14A"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FCFCDC"</span>)))
      <span class="org-doc">"Face used to display state STRT."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-waiting-for-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#89C58F"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#89C58F"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#E2FEDE"</span>)))
      <span class="org-doc">"Face used to display state WAIT."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-someday-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#9EB6D4"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#9EB6D4"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#E0EFFF"</span>)))
      <span class="org-doc">"Face used to display state SDAY."</span>)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-quote-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#FC5158"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-quoted-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#55BA80"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#55BA80"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#DFFFDF"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-approved-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#969696"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#969696"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-rejected-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#42B5FF"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#42B5FF"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#D3EEFF"</span>)))
      <span class="org-doc">"Face used to display state REJECTED."</span>)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-openpo-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#FC5158"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>)))
      <span class="org-doc">"Face used to display OPEN purchase order."</span>)
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-closedpo-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#969696"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#969696"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>)))
      <span class=
"org-doc">"Face used to display CLOSED purchase order."</span>))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">block switching entries to DONE if</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">1) there are undone child entries, or</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">2) the parent has an `</span><span class=
"org-comment"><span class="org-constant">:ORDERED:</span></span><span class=
"org-comment">' property and there are prior</span>
  <span class="org-comment-delimiter">;;    </span><span class=
"org-comment">siblings not yet done</span>
  (setq org-enforce-todo-dependencies t)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">5.2.7 don't dim blocked tasks in the agenda display -- agenda optimization</span>
  (setq org-agenda-dim-blocked-tasks nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class=
"org-comment"> not sure about this one</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">block switching the parent to DONE if</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">there are unchecked checkboxes</span>
  (setq org-enforce-todo-checkbox-dependencies t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-4-3" class="outline-4">
          <h4 id="sec-28-4-3">Progress logging</h4>

          <div class="outline-text-4" id="text-28-4-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.3 (info "(org)Progress logging")</span>

  (leuven--section <span class="org-string">"5.3 (org)Progress logging"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 5.3.1 don't insert a CLOSED time stamp each time a </span><span class="org-comment"><span class="org-leuven-highlight">TODO</span></span><span class="org-comment"> entry is marked DONE</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-log-done nil)</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">5.3.2 the notes will be ordered according to time</span>
  (setq org-log-states-order-reversed nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">5.3.2 insert state change notes and time stamps into a LOGBOOK drawer</span>
  (setq org-log-into-drawer t)          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">should be the DEFAULT!</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">~5.3.2 heading for state change added to entries</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Progress logging"</span>)

    (setcdr (assq 'state org-log-note-headings)
            <span class=
"org-string">"State %-12S  -&gt;  %-12s %t"</span>)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">"State old -&gt; new + timestamp"</span>
</pre>
            </div>

            <p>Warning! The docstring of <code>org-log-note-headings</code>
            mentions that “in fact, it is <b>not a good idea to change the
            `state’ entry</b>, because agenda log mode depends on the format of
            these entries.”</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-habit"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show habits for future days</span>
    (setq org-habit-show-habits-only-for-today nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use character "heavy check mark" to show completed days on which</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">a task was done</span>
    (setq org-habit-completed-glyph ?\u2714)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use character "heavy quadruple dash vertical" to identify today</span>
    (setq org-habit-today-glyph ?\u250B))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-4-4" class="outline-4">
          <h4 id="sec-28-4-4">Breaking down tasks</h4>

          <div class="outline-text-4" id="text-28-4-4">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.5 (info "(org)Breaking down tasks")</span>

  (leuven--section <span class=
"org-string">"5.5 (org)Breaking down tasks"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically change a </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> entry to DONE when all children are done</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-summary-todo</span> (n-done n-not-done)
    <span class=
"org-doc">"Switch entry to DONE when all subentries are done, to </span><span class="org-doc"><span class="org-leuven-highlight">TODO</span></span><span class="org-doc"> otherwise."</span>
    (<span class=
"org-keyword">let</span> (org-log-done org-log-states)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">turn off logging</span>
      (org-todo (<span class=
"org-keyword">if</span> (= n-not-done 0) <span class=
"org-string">"DONE"</span> <span class="org-string">"</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string">"</span>))))

  (add-hook 'org-after-todo-statistics-hook 'org-summary-todo)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-5" class="outline-3">
        <h3 id="sec-28-5">Tags</h3>

        <div class="outline-text-3" id="text-28-5">
          <p>Context (place, time or particular resources for doing a task) and
          people are something best implemented with tags.</p>

          <p>By convention, <b>user-defined tags are written in lowercase</b>;
          built-in tags with special meaning are written with all capitals.</p>

          <p><code>org-use-tag-inheritance</code> can be setup to a regular
          expression, for example so that all tags starting with <code>@</code>
          or <code>#</code> will be excluded from inheritance with:</p>
          <pre class="example">
(setq org-use-tag-inheritance "^[^@#]")
</pre>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 6 (info "(org)Tags")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">column to which tags should be indented in a headline</span>
  (setq org-tags-column -80)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">6.2 list of tags ("contexts") allowed in Org mode files</span>
  (setq org-tag-alist '((<span class="org-builtin">:startgroup</span> . nil)
                         (<span class="org-string">"personal"</span>  . ?p)
                         (<span class="org-string">"work"</span>      . ?w)
                        (<span class="org-builtin">:endgroup</span> . nil)
                        (<span class="org-string">"call"</span>        . ?c)
                        (<span class="org-string">"errands"</span>     . ?e)
                        (<span class="org-string">"finance"</span>     . ?f)
                        (<span class="org-string">"mail"</span>        . ?m)

                        (<span class="org-string">"notbillable"</span> . ?B)
                        (<span class="org-string">"now"</span>         . ?N)
                        <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">("reading" . ?r)</span>
                        <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">("proj" . ?P)</span>

                        (<span class=
"org-string">"ARCHIVE"</span>     . ?a) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">speed command + action in task list</span>
                        (<span class="org-string">"crypt"</span>       . ?C)
                        (<span class="org-string">"FLAGGED"</span>     . ??)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faces for specific tags</span>
  (setq org-tag-faces
        '((<span class="org-string">"refile"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#A9876E"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#FCEEB3"</span>
          (<span class="org-string">"personal"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#5C88D3"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#BBDDFF"</span>
          (<span class="org-string">"work"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#699761"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#C1D996"</span>
          (<span class="org-string">"FLAGGED"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#C15F4E"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#EDC6C8"</span>
          (<span class="org-string">"now"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#000000"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#FFEA80"</span>
          (<span class="org-string">"notbillable"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#8774AF"</span>))     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:background "#DED0EA"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">6.2 exit fast tag selection after first change (toggle this with `</span><span class="org-comment"><span class="org-constant">C-c</span></span><span class="org-comment">')</span>
  (setq org-fast-tag-selection-single-key t)
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Extend the following function to take
              <code>filetags</code> into account</b><br /></td>
            </tr>
          </table>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Check whether this function removes tags of
              DIRECT parent</b><br /></td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove redundant tags of headlines (from David Maus)</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-remove-redundant-tags</span> ()
    <span class=
"org-doc">"Remove redundant tags of headlines in current buffer.</span>
<span class=
"org-doc">  A tag is considered redundant if it is local to a headline and inherited by</span>
<span class="org-doc">  a parent headline."</span>
    (interactive)
    (<span class="org-keyword">when</span> (eq major-mode 'org-mode)
      (<span class="org-keyword">save-excursion</span>
        (org-map-entries
         (<span class="org-keyword">lambda</span> ()
           (<span class="org-keyword">let</span> ((alltags (split-string
                           (or (org-entry-get (point) <span class=
"org-string">"ALLTAGS"</span>) <span class="org-string">""</span>)
                           <span class="org-string">":"</span>))
                 local inherited tag)
             (<span class="org-keyword">dolist</span> (tag alltags)
               (<span class=
"org-keyword">if</span> (get-text-property 0 'inherited tag)
                   (push tag inherited)
                 (push tag local)))
             (<span class="org-keyword">dolist</span> (tag local)
               (<span class="org-keyword">when</span> (member tag inherited)
                 (org-toggle-tag tag 'off)))))
         t nil))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; always offer completion for all tags of all agenda files</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-complete-tags-always-offer-all-agenda-tags t)</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-6" class="outline-3">
        <h3 id="sec-28-6">Properties and Columns</h3>

        <div class="outline-text-3" id="text-28-6">
          <p>By convention, <b>user-defined properties are capitalized</b>;
          built-in properties with special meaning are written with all
          capitals.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 7 (info "(org)Properties and Columns")</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 7.1 (info "(org)Property syntax")</span>

  (leuven--section <span class="org-string">"7.1 (org)Property syntax"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of property/value pairs that can be inherited by any entry</span>
  (setq org-global-properties
        '((<span class="org-string">"Effort_ALL"</span> .
           <span class=
"org-string">"0 0:10 0:30 1:00 2:00 3:00 4:00 5:00 6:00 8:00"</span>
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"0d 1d 2d 3d 4d 5d 6d 7d 8d 10d"</span>
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"0 1:00 4:00 1d 2d 1w 2w"</span>
           )))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-7" class="outline-3">
        <h3 id="sec-28-7">Dates and Times</h3>

        <div class="outline-text-3" id="text-28-7">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 8 (info "(org)Dates and Times")</span>

  (leuven--section <span class="org-string">"8 (org)Dates and Times"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insinuate appt if Org mode is loaded</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Dates and Times"</span>)

    (try-require 'appt))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-7-1" class="outline-4">
          <h4 id="sec-28-7-1">Creating time stamps</h4>

          <div class="outline-text-4" id="text-28-7-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.2 (info "(org)Creating timestamps")</span>

  (leuven--section <span class=
"org-string">"8.2 (org)Creating time stamps"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prefer the future for incomplete dates</span>
  (setq org-read-date-prefer-future 'time)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; advise `</span><span class="org-comment"><span class=
"org-constant">org-read-date</span></span><span class=
"org-comment">' to bury the calendar buffer after selecting</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; a date, so it is out of the way</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defadvice org-read-date</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(after leuven-bury-calendar-after-org-read-date</span>
  <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">(&amp;optional with-time to-time from-string prompt</span>
  <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">default-time default-input) protect)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Bury the *Calendar* buffer after reading a date."</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(bury-buffer "*Calendar*"))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(ad-activate 'org-read-date)</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of minutes to round time stamps to</span>
  (setq org-time-stamp-rounding-minutes '(1 1))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-7-2" class="outline-4">
          <h4 id="sec-28-7-2">Deadlines and scheduling</h4>

          <div class="outline-text-4" id="text-28-7-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.3 (info "(org)Deadlines and scheduling")</span>

  (leuven--section <span class=
"org-string">"8.3 (org)Deadlines and scheduling"</span>)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">information to record when the scheduling date is modified</span>
  (setq org-log-reschedule nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">information to record when the deadline date is modified</span>
  (setq org-log-redeadline 'time)
</pre>
            </div>
          </div>

          <div id="outline-container-sec-28-7-2-1" class="outline-5">
            <h5 id="sec-28-7-2-1">Inserting deadline/schedule</h5>

            <div class="outline-text-5" id="text-28-7-2-1">
              <p>Schedule it with <code>C-c C-s</code>:</p>

              <dl class="org-dl">
                <dt>RET</dt>

                <dd>Today.</dd>

                <dt>+1d RET</dt>

                <dd>Tomorrow.</dd>

                <dt>+1w RET</dt>

                <dd>Next week.</dd>

                <dt>+4w RET</dt>

                <dd>Next “month”.</dd>
              </dl>

              <p>Remove scheduling date with <code>C-u C-c C-s</code>.</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of days before expiration during which a deadline becomes active</span>
  (setq org-deadline-warning-days 7)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">skip deadline prewarning (up to 7 days before the actual deadline)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">when entry is also scheduled</span>
  (setq org-agenda-skip-deadline-prewarning-if-scheduled 7)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show deadlines when the corresponding item is done</span>
  (setq org-agenda-skip-deadline-if-done t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">skip scheduling line if same entry shows because of deadline</span>
  (setq org-agenda-skip-scheduled-if-deadline-is-shown t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show scheduled items in agenda when they are done</span>
  (setq org-agenda-skip-scheduled-if-done t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">~8.3 don't select item by time stamp or -range if it is DONE</span>
  (setq org-agenda-skip-timestamp-if-done t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; show all days between the first and the last date</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-timeline-show-empty-dates t)</span>
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-28-7-2-2" class="outline-5">
            <h5 id="sec-28-7-2-2">Repeated tasks</h5>

            <div class="outline-text-5" id="text-28-7-2-2">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> state to which a repeater should return the repeating task</span>
  (setq org-todo-repeat-to-state <span class="org-string">"</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string">"</span>)
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-7-3" class="outline-4">
          <h4 id="sec-28-7-3">Clocking work time</h4>

          <div class="outline-text-4" id="text-28-7-3">
            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>Resume clocks when opening the first Org file</b><br />

                  <p>Alternative to requiring org-clock in every Emacs
                  session.</p>
                </td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.4 (info "(org)Clocking work time")</span>

  (leuven--section <span class=
"org-string">"8.4 (org)Clocking work time"</span>)

  (global-set-key
    (kbd <span class="org-string">"C-c C-x C-i"</span>) 'org-clock-in)
  (global-set-key
    (kbd <span class="org-string">"C-c C-x C-j"</span>) 'org-clock-goto)
  (global-set-key
    (kbd <span class="org-string">"C-c C-x C-o"</span>) 'org-clock-out)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the time clocking code for Org mode</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(require 'org-clock)               ;! needed for trying to automatically</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! re-clock at Emacs startup</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> Under test!</span>
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              (<span class="org-keyword">require</span> '<span class=
"org-constant">org-clock</span>)
              (setq org-clock-persist t)
              (org-clock-persistence-insinuate)))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-clock"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 8.4 save both the running clock and the entire clock history when Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; is closed, and resume it next time Emacs is started up</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-clock-persist t)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 8.4 set up hooks for clock persistence</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(org-clock-persistence-insinuate)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">resume clocking task on clock-in if the clock is open</span>
    (setq org-clock-in-resume t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of clock tasks to remember in history: 1-9A-Z</span>
    (setq org-clock-history-length 35)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.4.2 include the current clocking task time in clock reports</span>
    (setq org-clock-report-include-clocking-task t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.4.2 format string used when creating CLOCKSUM lines and when generating a</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time duration (avoid showing days)</span>
    (setq org-time-clocksum-format
          '(<span class="org-builtin">:hours</span> <span class=
"org-string">"%d"</span> <span class=
"org-builtin">:require-hours</span> t <span class=
"org-builtin">:minutes</span> <span class=
"org-string">":%02d"</span> <span class=
"org-builtin">:require-minutes</span> t))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">some clocktable functions cannot</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">digest day formats (e.g.,</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">org-clock-time%)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 8.4.2 use fractional times</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-time-clocksum-use-fractional t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format string for the total time cells</span>
    (setq org-clock-total-time-cell-format <span class=
"org-string">"%s"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format string for the file time cells</span>
    (setq org-clock-file-time-cell-format <span class="org-string">"%s"</span>)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-clock-in-interrupted-task</span> ()
      <span class=
"org-doc">"Clock back into the task that has been interrupted, if there is one."</span>
      (interactive)
      (<span class=
"org-keyword">if</span> (and (not org-clock-resolving-clocks-due-to-idleness)
               (marker-buffer org-clock-marker)
               (marker-buffer org-clock-interrupted-task))
          (org-with-point-at org-clock-interrupted-task
            (org-clock-in nil))
        (org-clock-out)))

    (global-set-key
      (kbd <span class=
"org-string">"C-c C-x C-q"</span>) 'leuven-org-clock-in-interrupted-task)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.4.3 resolve open clocks if the user is idle more than 120 minutes</span>
    (setq org-clock-idle-time 120)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-switch-to-started</span> (kwd)
      <span class="org-doc">"Switch task state to STRT.</span>
<span class="org-doc">    Skip normal headlines and capture tasks."</span>
      (<span class="org-keyword">if</span> (and kwd
               (not (string-equal kwd <span class="org-string">"STRT"</span>))
               (not (and (boundp 'org-capture-mode) org-capture-mode)))
          <span class="org-string">"STRT"</span>
        nil))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.4.3 set task to todo state STRT while clocking it</span>
    (setq org-clock-in-switch-to-state 'leuven--org-switch-to-started)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">clock won't be stopped when the clocked entry is marked DONE</span>
    (setq org-clock-out-when-done nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time included for the mode line clock is all time clocked into this</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">task today</span>
    (setq org-clock-mode-line-total 'today)
    (setq org-clock-mode-line-total 'all)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get an alert (notification) when your planned time is over</span>
    (setq org-clock-sound <span class=
"org-string">"~/Public/Music/Sounds/alarm.wav"</span>)
    <span class="org-comment-delimiter">;;</span><span class=
"org-comment">! Use start-process to have an external program play the sound to</span>
    <span class="org-comment-delimiter">;;</span><span class=
"org-comment">! avoid ignored keystrokes until after the sound plays (start-process</span>
    <span class="org-comment-delimiter">;;</span><span class=
"org-comment">! "ding" nil "play" "~/Public/Music/Sounds/alarm.wav")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove the clock line when the resulting time is 0:00</span>
    (setq org-clock-out-remove-zero-time-clocks t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; when clocking into a task with a clock entry which has not been</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; closed, resume the clock from that point</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-clock-in-resume t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ask the user if they wish to clock out before killing Emacs</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-query-clock-out</span> ()
      <span class="org-doc">"Ask the user before clocking out.</span>
<span class=
"org-doc">    This is a useful function for adding to `</span><span class=
"org-doc"><span class=
"org-constant">kill-emacs-query-functions</span></span><span class=
"org-doc">'."</span>
      (<span class="org-keyword">if</span> (and (<span class=
"org-keyword">featurep</span> '<span class="org-constant">org-clock</span>)
               (funcall 'org-clocking-p)
               (y-or-n-p <span class=
"org-string">"You are currently clocking time, clock out? "</span>))
          (org-clock-out)
        t))                             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">only fails on keyboard quit or error</span>

    (add-hook 'kill-emacs-query-functions 'leuven--org-query-clock-out)

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "org-clock" ends here</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-7-4" class="outline-4">
          <h4 id="sec-28-7-4">Effort estimates</h4>

          <div class="outline-text-4" id="text-28-7-4">
            <p>If you have an <code>Effort</code> property defined, the
            <b>estimated time</b> is also shown in the mode line, against the
            <b>actual time</b> spent (reported through <b>time
            clocking</b>).</p>

            <p>When clocking in, ask for a time estimate if the property is not
            yet defined.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 8.5 (info "(org)Effort estimates")</span>

  (leuven--section <span class="org-string">"8.5 (org)Effort estimates"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add an effort estimate on the fly when clocking in</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-ask-effort</span> ()
    <span class="org-doc">"Ask for an effort estimate when clocking in."</span>
    (<span class=
"org-keyword">unless</span> (org-entry-get (point) <span class="org-string">"Effort"</span>)
      (<span class="org-keyword">let</span> ((effort
             (completing-read
              <span class="org-string">"Estimated time (H:MM): "</span>
              (org-entry-get-multivalued-property (point) <span class=
"org-string">"Effort"</span>))))
        (<span class="org-keyword">unless</span> (equal effort <span class=
"org-string">""</span>)
          (org-set-property <span class=
"org-string">"Effort"</span> effort)))))

  (add-hook 'org-clock-in-prepare-hook 'leuven--org-ask-effort)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-8" class="outline-3">
        <h3 id="sec-28-8">Capture - Refile - Archive</h3>

        <div class="outline-text-3" id="text-28-8"></div>

        <div id="outline-container-sec-28-8-1" class="outline-4">
          <h4 id="sec-28-8-1">Capture</h4>

          <div class="outline-text-4" id="text-28-8-1">
            <p>The ultimate capture tool to <b>quickly add</b> tasks or
            notes.</p>

            <p>Structure:</p>

            <ul class="org-ul">
              <li>Contacts</li>

              <li>Calendar</li>

              <li>Tasks</li>

              <li>Notes</li>

              <li>Journal</li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 9 (info "(org)Capture - Refile - Archive")</span>

  (leuven--section <span class="org-string">"9.1 (org)Capture"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.1.2 directory with Org files</span>
  (setq org-directory
        (directory-file-name            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">this function removes the final slash</span>
         (<span class="org-keyword">cond</span> ((file-directory-p <span class=
"org-string">"~/org/"</span>) <span class="org-string">"~/org/"</span>)
               (t <span class="org-string">"~/"</span>))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.1.2 default target for storing notes</span>
  (setq org-default-notes-file          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">inbox for collecting [default: "~/.notes"]</span>
        (concat org-directory <span class="org-string">"/refile.org"</span>))
</pre>
            </div>

            <p><code>%</code>-escapes:</p>

            <dl class="org-dl">
              <dt>%a</dt>

              <dd>Annotation (<b>link</b>).</dd>

              <dt>%i</dt>

              <dd>Initial content (<b>selected text</b>).</dd>

              <dt>%?</dt>

              <dd>Cursor position.</dd>

              <dt>%^T</dt>

              <dd>Prompt for a date and time.</dd>

              <dt>%^G</dt>

              <dd>Prompt for tags with completion on tags in all agenda
              files.</dd>

              <dt>%t</dt>

              <dd>Time stamp (date only).</dd>

              <dt>%<sup>prompt</sup></dt>

              <dd>Prompt the user for a string.</dd>

              <dt>%[file]</dt>

              <dd>Insert the contents of the file.</dd>

              <dt>%U</dt>

              <dd>Inactive time stamp with date and time.</dd>
            </dl>

            <p>Use <code>:jump-to-captured</code> to tell capture to jump to
            the note after storing it.</p>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Look at
                <code>:kill-buffer</code></b><br /></td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.1.2 templates for the creation of capture buffers</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">("Receipt"   ?r "** %^{BriefDesc} %U %^g\n%?"   "~/Personal/finances.org")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fast note taking in Org mode (the ultimate capture tool)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-capture"</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"t"</span> <span class=
"org-string">"Task"</span> entry
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Tasks"</span>)
                   <span class="org-string">"* NEW %^{Task}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"T"</span> <span class=
"org-string">"Task in current file"</span> entry
                   (file+headline
                    (buffer-file-name (org-capture-get <span class=
"org-builtin">:original-buffer</span>))
                    <span class="org-string">"Tasks"</span>)
                   <span class="org-string">"* </span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> %?</span>
<span class="org-string">  %U %a %n"</span>
                   <span class="org-builtin">:prepend</span> t) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"a"</span> <span class=
"org-string">"Appt"</span> entry
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Calendar"</span>)
                   <span class="org-string">"* %^{Appointment}%?</span>
<span class="org-string">%^T</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Prompt only for date, not time...</span>
</pre>
            </div>
          </div>

          <div id="outline-container-sec-28-8-1-1" class="outline-5">
            <h5 id="sec-28-8-1-1"><span class="todo TODO">TODO</span> Ask for
            refile location</h5>

            <div class="outline-text-5" id="text-28-8-1-1">
              <p>Find a location for refiling on capture.</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"Z"</span> <span class=
"org-string">"Refile me!"</span> entry
                   (function leuven-find-location)
                   <span class="org-string">"** </span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> Put this in some other file\n\n"</span>
                   <span class="org-builtin">:prepend</span> t) t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-find-location</span> ()
      <span class=
"org-doc">"Find my CollectBox file and some headline in the current buffer."</span>
      (find-file org-default-notes-file)
      (goto-char (point-min))
      (helm-org-headlines)
      (org-forward-heading-same-level 1))
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-28-8-1-2" class="outline-5">
            <h5 id="sec-28-8-1-2"><span class="todo TODO">TODO</span>
            Email-to-task</h5>

            <div class="outline-text-5" id="text-28-8-1-2">
              <p>Instantly <b>create tasks</b> and notes <b>from emails</b>,
              with a <b>link</b> back <b>to the emails</b>.</p>

              <p>The following rules will apply to interpret an email to a
              task:</p>

              <dl class="org-dl">
                <dt>Email subject</dt>

                <dd>
                  <p>Task name.</p>
                </dd>

                <dt>Person in the <code>From:</code> field</dt>

                <dd>
                  <p>Task creator.</p>
                </dd>

                <dt>Person(s) in the <code>To:</code> field</dt>

                <dd>
                  <p>Task assignee(s).</p>
                </dd>

                <dt>Email body (or selected region)</dt>

                <dd>
                  <p>Inserted into the task’s description.</p>
                </dd>

                <dt>Email attachment(s)</dt>

                <dd>
                  <p>Inserted as task’s attachment(s).</p>

                  <p>XXX Wouldn’t it be great if files attached to email can be
                  quickly added to the tasks or projects you create?</p>
                </dd>
              </dl>

              <p>Additional parameters can be included via the commands you
              use:</p>

              <dl class="org-dl">
                <dt>Create a TODO Action</dt>

                <dd>Create a new action.</dd>

                <dt>Create a TODO Action Remind 3</dt>

                <dd>Create a new action. Set reminder in 3 days.</dd>

                <dt>Create a TODO Action Due Date 7</dt>

                <dd>Create a new action. Set due date in 7 days.</dd>

                <dt>Create a TODO Action of an existing Project</dt>

                <dd>Attach it to something that we’re already working on.</dd>

                <dt>Create a WAIT Item</dt>

                <dd>Create a new “Waiting For” item, eventually with an
                “Assignee” property.</dd>

                <dt>Create a SDAY Item</dt>

                <dd>Create a new “Someday” item.</dd>

                <dt>Create a Reference Item</dt>

                <dd>Create a new “Reference” item.</dd>
              </dl>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"m"</span> <span class=
"org-string">"Email processing..."</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mt"</span> <span class=
"org-string">"Create a </span><span class="org-string"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-string"> Action + edit"</span> entry
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Email"</span>) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* </span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> %^{Creating action}%? (from %:fromname)</span>
<span class="org-string">   %:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From %a"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mr"</span> <span class=
"org-string">"Create a </span><span class="org-string"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-string"> Action Remind 3"</span> entry
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Email"</span>) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* </span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> %:subject%? (from %:fromname)</span>
<span class=
"org-string">   SCHEDULED: %(org-insert-time-stamp (org-read-date nil t \"+3d\") nil nil nil nil \"\")</span>
<span class="org-string">   %:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From %a"</span>
                   <span class="org-builtin">:empty-lines</span> 1 <span class=
"org-builtin">:immediate-finish</span> t) t)
</pre>
              </div>

              <p>The property <code>:immediate-finish</code>, when set,
              immediately files the item without further prompt (skipping
              <code>C-c C-c</code>); very handy for quick storing of
              emails.</p>

              <p>With the clock options, <code>org-capture</code> automatically
              clocks in. When pressing <code>C-c C-c</code>, it clocks out.</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"p"</span> <span class=
"org-string">"Phone call"</span> entry
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Phone calls"</span>)
                   <span class="org-string">"* %?"</span>
                   <span class="org-builtin">:empty-lines</span> 1 <span class=
"org-builtin">:clock-in</span> t <span class=
"org-builtin">:clock-resume</span> t) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"i"</span> <span class=
"org-string">"interruption"</span> entry
                   (file ,org-default-notes-file)
                   <span class="org-string">"A TEMPLATE HERE"</span>
                   <span class="org-builtin">:clock-in</span> t <span class=
"org-builtin">:clock-resume</span> t) t)
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">thought</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"n"</span> <span class=
"org-string">"Note"</span> entry
                   (file+headline ,(concat org-directory <span class=
"org-string">"/notes.org"</span>) <span class="org-string">"Notes"</span>)
                   <span class="org-string">"* %^{Thought}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">shopping list (stuff to buy)</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"b"</span> <span class=
"org-string">"Buy"</span> checkitem
                   (file+headline ,org-default-notes-file <span class=
"org-string">"Shopping"</span>)) t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a note to the currently clocked task</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"c"</span> <span class=
"org-string">"Clock sibling"</span> entry
                   (clock)
                   <span class="org-string">"* %^{Title}</span>
<span class="org-string">  %U</span>
<span class="org-string">%a</span>

<span class="org-string">%i"</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"j"</span> <span class=
"org-string">"Journal"</span> entry
                   (file+datetree ,(concat org-directory <span class=
"org-string">"/journal.org"</span>))
                   <span class="org-string">"* %T %?</span>

<span class="org-string">  %U</span>

<span class="org-string">%i</span>

<span class="org-string">From %a"</span>
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"* %^{Title}\n  :PROPERTIES:\n  :on: %T\n  :END:\n  %?\n  %x"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"S"</span> <span class=
"org-string">"secure"</span> entry
                   (file+datetree+prompt <span class=
"org-string">"~/org/notes/secure.org.gpg"</span>)
                   <span class=
"org-string">"* %(format-time-string \"%H:%M\") %^{Entry} %^G</span>
<span class="org-string">%i%?"</span>) t)
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">("w" "org-protocol" entry</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(file ,org-default-notes-file)</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">"* </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Review %c</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">%U"</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">:immediate-finish t :clock-in t :clock-resume t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">("web-clippings" ?w</span>
    <span class="org-comment-delimiter">;;  </span><span class=
"org-comment">"* %^{Title} %^g \n  :PROPERTIES:\n  :date: %^t\n  :link: %^{link}\n  :END:\n\n %x %?"</span>
    <span class="org-comment-delimiter">;;  </span><span class=
"org-comment">"~/org/data.org" "Web Clippings")</span>
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"w"</span> <span class=
"org-string">"Default template"</span> entry
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">org-protocol-default-template-key</span></span><span class=
"org-comment">'</span>
                   (file+headline ,(concat org-directory <span class=
"org-string">"/capture.org"</span>) <span class="org-string">"Notes"</span>)
                   <span class="org-string">"* %^{Title}%?</span>
<span class="org-string">  %u</span>

<span class="org-string">%i</span>

<span class="org-string">From %c"</span>
                   <span class="org-builtin">:empty-lines</span> 1 <span class=
"org-builtin">:immediate-finish</span> t) t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default `</span><span class="org-comment"><span class=
"org-constant">org-capture-templates</span></span><span class=
"org-comment">' key to use</span>
    (setq org-protocol-default-template-key <span class=
"org-string">"w"</span>)
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-28-8-1-3" class="outline-5">
            <h5 id="sec-28-8-1-3">Capture from command line</h5>

            <div class="outline-text-5" id="text-28-8-1-3">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">make-capture-frame</span> ()
      <span class="org-doc">"Create a new frame and run `</span><span class=
"org-doc"><span class="org-constant">org-capture</span></span><span class=
"org-doc">'."</span>
      (interactive)
      (make-frame '((name . <span class="org-string">"capture"</span>)
                    (width . 80)
                    (height . 10)))
      (select-frame-by-name <span class="org-string">"capture"</span>)
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; setup buffer to wrap</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq truncate-lines nil</span>
      <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">word-wrap t)</span>
      (org-capture))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make the frame contain a single window (by default, `</span><span class="org-comment"><span class="org-constant">org-capture</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">splits the window)</span>
    (add-hook 'org-capture-mode-hook 'delete-other-windows)

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-capture-finalize</span>
      (after leuven-delete-capture-finalize-frame activate)
      <span class=
"org-doc">"Advise org-capture-finalize to close the frame (if it is the capture frame)."</span>
      (<span class="org-keyword">if</span> (equal <span class=
"org-string">"capture"</span> (frame-parameter nil 'name))
          (delete-frame)))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-capture-destroy</span>      <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
      (after leuven-delete-capture-destroy-frame activate)
      <span class=
"org-doc">"Advise capture-destroy to close the frame (if it is the capture frame)."</span>
      (<span class="org-keyword">if</span> (equal <span class=
"org-string">"capture"</span> (frame-parameter nil 'name))
          (delete-frame)))

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "org-capture" ends here</span>
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-sh">
emacsclient -n -e <span class="org-string">'(make-capture-frame)'</span>
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-8-2" class="outline-4">
          <h4 id="sec-28-8-2">Attachments</h4>

          <div class="outline-text-4" id="text-28-8-2">
            <p>Use the following for conveniently accessing your data.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">bug when C-c C-l</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 4.6 shortcut links</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-to-list 'org-link-abbrev-alist '(("att" . org-attach-expand-link)))</span>
</pre>
            </div>

            <p>Instead of modifying <code>org-link-abbrev-alist</code>, you can
            also use</p>
            <pre class="example">
#+LINK: att %(org-attach-expand-link)
</pre>

            <p>in your Org buffers.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-8-3" class="outline-4">
          <h4 id="sec-28-8-3">Protocols for external access</h4>

          <div class="outline-text-4" id="text-28-8-3">
            <p>Open Org source (and Capture) from Firefox.</p>

            <p>Have a look at <a href="http://vimeo.com/5662410">Store links in
            Emacs Org using org-protocol.el</a>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"9.4 (org)Protocols"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.4 capture from Firefox (to store links and text)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-protocol"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">map online URL to an existing working file</span>
    (add-to-list 'org-protocol-project-alist
                 '(<span class=
"org-string">"Worg at http://orgmode.org/worg/"</span>
                   <span class="org-builtin">:online-suffix</span> <span class=
"org-string">".html"</span>
                   <span class=
"org-builtin">:working-suffix</span> <span class="org-string">".org"</span>
                   <span class="org-builtin">:base-url</span> <span class=
"org-string">"http://orgmode.org/worg/"</span>
                   <span class=
"org-builtin">:working-directory</span> <span class=
"org-string">"~/Public/Repositories/worg/"</span>) t))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-8-4" class="outline-4">
          <h4 id="sec-28-8-4">Refile and copy</h4>

          <div class="outline-text-4" id="text-28-8-4">
            <p>Once a date has been scheduled, move the task to the appropriate
            category, by using the refile note command <code>C-c C-w</code>.
            This lets me select (with completion) the header under which the
            entry will be placed.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Refile"</span>)

    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-org-refile-extra-files</span>
      (<span class="org-keyword">if</span> (file-exists-p <span class=
"org-string">"~/org/notes/"</span>)
          (directory-files <span class=
"org-string">"~/org/notes/"</span> t <span class=
"org-string">"^[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string">\\.#].*\\.</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">txt</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">org</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">$"</span>)
        nil)
      <span class=
"org-doc">"List of extra files to be used as targets for refile commands."</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.5 any headline with level &lt;= 3 is a target</span>
    (setq org-refile-targets
          `((nil
             <span class=
"org-builtin">:maxlevel</span> . 4)             <span class=
"org-comment-delimiter">; </span><span class="org-comment">current file</span>
            (,(append org-agenda-files leuven-org-refile-extra-files)
             <span class="org-builtin">:maxlevel</span> . 2)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cache refile targets to speed up the process</span>
    (setq org-refile-use-cache t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.5 provide refile targets as paths, including the file name</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(without directory) as level 1 of the path</span>
    (setq org-refile-use-outline-path 'file)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.5 allow to create new nodes (must be confirmed by the user) as</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">refile targets</span>
    (setq org-refile-allow-creating-parent-nodes 'confirm)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">refile only within the current buffer</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-refile-within-current-buffer</span> ()
      <span class=
"org-doc">"Move the entry at point to another heading in the current buffer."</span>
      (interactive)
      (<span class=
"org-keyword">let</span> ((org-refile-targets '((nil <span class=
"org-builtin">:maxlevel</span> . 4))))
        (org-refile)))
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Add a smart key binding</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">exclude DONE state tasks from refile targets</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">bh/verify-refile-target</span> ()
      <span class="org-doc">"Exclude </span><span class="org-doc"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-doc"> keywords with a DONE state from refile targets."</span>
      (not (member (nth 2 (org-heading-components)) org-done-keywords)))

    (setq org-refile-target-verify-function 'bh/verify-refile-target)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-8-5" class="outline-4">
          <h4 id="sec-28-8-5">Archiving</h4>

          <div class="outline-text-4" id="text-28-8-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (leuven--section <span class="org-string">"9.6 (org)Archiving"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">9.6.1 subtrees should be archived in the current file</span>
    (setq org-archive-location <span class="org-string">"::* Archive"</span>)

    )
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-9" class="outline-3">
        <h3 id="sec-28-9">Agenda Views</h3>

        <div class="outline-text-3" id="text-28-9">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"10 (org)Agenda Views"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 10 (info "(org)Agenda Views")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">multiple same-day time stamps in entry make multiple agenda lines</span>
    (setq org-agenda-skip-additional-timestamps-same-entry nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show outline path in echo area after line motion (though, may bring</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">some slowness)</span>
    (setq org-agenda-show-outline-path t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.0 restore the window configuration when exiting the agenda</span>
    (setq org-agenda-restore-windows-after-quit t)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; speed up agenda by avoiding to update some text properties</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-agenda-ignore-drawer-properties '(effort category)) ; org.el</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-9-1" class="outline-4">
          <h4 id="sec-28-9-1">Agenda files</h4>

          <div class="outline-text-4" id="text-28-9-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.1 (info "(org)Agenda files")</span>

    (leuven--section <span class="org-string">"10.1 (org)Agenda files"</span>)

    (<span class="org-keyword">when</span> (boundp 'org-agenda-files)
      (message <span class=
"org-string">"(Info) Found %s entries in `</span><span class=
"org-string"><span class=
"org-constant">org-agenda-files</span></span><span class="org-string">'"</span>
               (length org-agenda-files))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(sit-for 0.5)</span>
      )
</pre>
            </div>

            <p>Avoid any possibility of getting a customized version of
            <code>org-agenda-files</code> added at the end of your
            <code>.emacs</code> file.</p>
            <pre class="example">
(add-hook 'org-mode-hook
          (lambda ()
            (org-defkey org-mode-map
                        (kbd "C-c [") 'undefined)
            (org-defkey org-mode-map
                        (kbd "C-c ]") 'undefined)))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-9-2" class="outline-4">
          <h4 id="sec-28-9-2">The agenda dispatcher</h4>

          <div class="outline-text-4" id="text-28-9-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.2 (info "(org)Agenda dispatcher")</span>

    (leuven--section <span class=
"org-string">"10.2 (org)Agenda dispatcher"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable sticky agenda: `q' key will bury agenda buffers (instead of</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">killing)</span>
    (setq org-agenda-sticky t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-3" class="outline-4">
          <h4 id="sec-28-9-3">The Built-in agenda views</h4>

          <div class="outline-text-4" id="text-28-9-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.3 The (info "(org)Built-in agenda views")</span>

    (leuven--section <span class=
"org-string">"10.3 (org)Built-in agenda views"</span>)
</pre>
            </div>

            <p>Press <code>C-c a a</code> to jump you to this week’s task page
            from anywhere.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default duration for appointments that only have a starting time</span>
    (setq org-agenda-default-appointment-duration nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; duration of an appointment will add to day effort</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-agenda-columns-add-appointments-to-effort-sum t)</span>
</pre>
            </div>

            <p><code>C-c a t</code> should show <b>all</b> the
            <code>TODO</code> items… but…</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show dated entries in the global `</span><span class=
"org-comment"><span class="org-constant">todo</span></span><span class=
"org-comment">' list</span>
    (setq org-agenda-todo-ignore-with-date nil)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">!! tricky setting</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show entries with a time stamp in the global `</span><span class=
"org-comment"><span class="org-constant">todo</span></span><span class=
"org-comment">' list</span>
    (setq org-agenda-todo-ignore-timestamp nil)
</pre>
            </div>

            <p>Don’t tell me about stuff that isn’t due yet: tasks scheduled in
            the future should no longer show up in global todo or tags searches
            until that date arrives – at which point it will be in all
            lists.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.2 don't show scheduled entries in the global `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list</span>
    (setq org-agenda-todo-ignore-scheduled 'future)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">!! tricky setting</span>
    (setq org-agenda-todo-ignore-scheduled nil)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.2 don't show entries scheduled in the future in the global</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">todo</span></span><span class=
"org-comment">' list (until they are within the warning period)</span>
    (setq org-agenda-todo-ignore-deadlines 'near)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">!! tricky setting</span>
    (setq org-agenda-todo-ignore-deadlines nil)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.2 check also the sublevels of a </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> entry for </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> entries,</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">resulting in potentially much longer `</span><span class=
"org-comment"><span class="org-constant">todo</span></span><span class=
"org-comment">' lists</span>
    (setq org-agenda-todo-list-sublevels t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.3 honor `</span><span class="org-comment"><span class=
"org-constant">todo</span></span><span class=
"org-comment">' list `</span><span class="org-comment"><span class=
"org-constant">org-agenda-todo-ignore...</span></span><span class=
"org-comment">' options also</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">in the `</span><span class="org-comment"><span class=
"org-constant">tags-todo</span></span><span class="org-comment">' list</span>
    (setq org-agenda-tags-todo-honor-ignore-options t)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; highlight current line (may bring some slowness)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'org-agenda-mode-hook 'hl-line-mode)</span>
</pre>
            </div>
          </div>

          <div id="outline-container-sec-28-9-3-1" class="outline-5">
            <h5 id="sec-28-9-3-1">Advanced Search</h5>

            <div class="outline-text-5" id="text-28-9-3-1">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.5 list of extra files to be searched by text search commands</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(C-c a s)</span>
    (setq org-agenda-text-search-extra-files nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment">org.el</span>

    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-org-search-extra-files</span> nil
      <span class=
"org-doc">"List of extra files to be searched by custom search commands (`R s' and `R S')."</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn on individual word search (for Google addicts)</span>
    (setq org-agenda-search-view-always-boolean t
          org-agenda-search-view-search-words-only t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">match part of a word</span>
    (setq org-agenda-search-view-force-full-words nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't search headline for a time-of-day</span>
    (setq org-agenda-search-headline-for-time nil)
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.6 how to identify stuck projects</span>
    (setq org-stuck-projects
          '(<span class=
"org-string">"+LEVEL=2/-DONE"</span>            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">identify a project</span>
            (<span class="org-string">"</span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string">"</span> <span class=
"org-string">"STRT"</span>)             <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> keywords</span>
            nil <span class=
"org-string">""</span>))                    <span class=
"org-comment-delimiter">; </span><span class="org-comment">tags, regexp</span>
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-4" class="outline-4">
          <h4 id="sec-28-9-4">Presentation and sorting</h4>

          <div class="outline-text-4" id="text-28-9-4">
            <p>See <a href=
            "http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61">
            http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61</a></p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.4 (info "(org)Presentation and sorting")</span>

    (leuven--section <span class=
"org-string">"10.4 (org)Presentation and sorting"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.4 format specifications for the prefix of items in the agenda views</span>
    (setq org-agenda-prefix-format
          '((agenda   . <span class=
"org-string">" %-11s%i %?-12t"</span>) <span class=
"org-comment-delimiter">; </span><span class="org-comment">agenda</span>
            (timeline . <span class=
"org-string">" % s"</span>)         <span class=
"org-comment-delimiter">; </span><span class="org-comment">timeline</span>
            (todo     . <span class=
"org-string">" %i %-12:c"</span>)   <span class=
"org-comment-delimiter">; </span><span class="org-comment">todo, alltodo</span>
            (tags     . <span class=
"org-string">" %i %-12:c"</span>)   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">tags, tags-todo, stuck</span>
            (search   . <span class=
"org-string">" %i %-12:c"</span>))) <span class=
"org-comment-delimiter">; </span><span class="org-comment">search</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">text preceding scheduled items in the agenda view</span>
    (setq org-agenda-scheduled-leaders
          '(<span class="org-string">"Scheduled  "</span>
            <span class="org-string">"           "</span>))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">text preceding item pulled into the agenda by inactive time stamps</span>
    (setq org-agenda-inactive-leader <span class="org-string">"["</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">text preceding deadline items in the agenda view</span>
    (setq org-agenda-deadline-leaders
          '(<span class="org-string">"Deadline   "</span>
            <span class=
"org-string">"In %d d"</span>                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">or "%d d left"</span>
            <span class="org-string">"%d d ago"</span>))

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "org-agenda" ends here</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faces for showing deadlines in the agenda</span>
    (setq org-agenda-deadline-faces
          '((1.0001 . leuven-org-deadline-overdue)
            (0.9999 . leuven-org-deadline-today)
            (0.8571 . leuven-org-deadline-tomorrow) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">= 6/7, see `</span><span class="org-comment"><span class=
"org-constant">org-deadline-warning-days</span></span><span class=
"org-comment">'</span>
            (0.0000 . leuven-org-deadline-future)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">see http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org non-standard faces</span>
    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-deadline-overdue</span>
      '((t (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#F22659"</span>)))
      <span class=
"org-doc">"Face used to highlight tasks whose due date is in the past."</span>)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-deadline-today</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"#4F4A3D"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FFFFCC"</span>)))
      <span class=
"org-doc">"Face used to highlight tasks whose due date is today."</span>)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-deadline-tomorrow</span>
      '((t (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#34AD00"</span>)))
      <span class=
"org-doc">"Face used to highlight tasks whose due date is tomorrow."</span>)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">leuven-org-deadline-future</span>
      '((t (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#34AD00"</span>)))
      <span class=
"org-doc">"Face used to highlight tasks whose due date is for later."</span>))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 10.4 column to shift tags to (in agenda items)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-agenda-tags-column -132)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">right-justify tags in the agenda buffer</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-agenda-right-justify-tags</span> ()
      <span class=
"org-doc">"Justify the tags to the right border of the agenda window."</span>
      (<span class=
"org-keyword">let</span> ((org-agenda-tags-column (- 2 (window-width))))
        (org-agenda-align-tags)))
    (add-hook 'org-agenda-finalize-hook 'leuven--org-agenda-right-justify-tags)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">type "(" in agenda and todo buffers to show category name and task</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">length for each task</span>
    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven--org-agenda-show-tasks-details</span> nil)
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-agenda-toggle-tasks-details</span> ()
      <span class=
"org-doc">"Hide/show tasks details (category and time estimate) in agenda views."</span>
      (interactive)
      (<span class=
"org-keyword">if</span> leuven--org-agenda-show-tasks-details
          (<span class="org-keyword">progn</span>
            (setq leuven--org-agenda-show-tasks-details nil)
            (setq org-agenda-prefix-format
                  '((agenda    . <span class=
"org-string">" %-11s%i %?-12t"</span>)
                    (timeline  . <span class="org-string">" % s"</span>)
                    (todo      . <span class="org-string">" "</span>)
                    (search    . <span class="org-string">" "</span>)
                    (tags      . <span class="org-string">" "</span>))))
        (setq leuven--org-agenda-show-tasks-details t)
        (setq org-agenda-prefix-format
              '((agenda   . <span class=
"org-string">" %-11s%i %-12:c%?-12t%7e "</span>)
                (timeline . <span class="org-string">" % s"</span>)
                (todo     . <span class="org-string">" %i %-12:c"</span>)
                (search   . <span class="org-string">" %i %-12:c"</span>)
                (tags     . <span class="org-string">" %i %-12:c"</span>))))
      (org-agenda-redo))

    (define-key org-agenda-mode-map
      (kbd <span class=
"org-string">"("</span>) 'leuven-org-agenda-toggle-tasks-details))
</pre>
            </div>

            <p>Show the time grid in the daily agenda but not in the weekly
            agenda, except for today’s date:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.4.2 settings for time grid for agenda display</span>
  (setq org-agenda-time-grid '((daily remove-match)
                               <span class="org-string">""</span>
                               (0800 1000 1200 1400 1600 1800 2000)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">string for the current time marker in the agenda</span>
  (setq org-agenda-current-time-string <span class=
"org-string">"Right now"</span>)
</pre>
            </div>

            <p><code>time-up</code> will only be applied to those items have a
            time stamp for the day in question, so that other sorting
            parameters will not be outranked by <code>time-up</code> for the
            rest of the entries.</p>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>refile.org should come first</b><br />

                  <p>Current workaround: added <code>#+CATEGORY: @refile</code>
                  at the end of that file (the <code>@</code> symbol is
                  alphabetically before the letters)</p>
                </td>
              </tr>
            </table>

            <p>Agenda view: put related tasks together, then by priority.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.4.3 sorting structure for the agenda items of a single day</span>
  (setq org-agenda-sorting-strategy   <span class=
"org-comment-delimiter">; </span><span class="org-comment">custom value</span>
        '((agenda time-up category-up priority-down effort-down)
          (todo category-up priority-down effort-down)
          (tags category-up priority-down effort-down)
          (search category-up)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-sort-agenda-notime-is-late nil)</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show agenda in the current window, keeping all other windows</span>
  (setq org-agenda-window-setup 'current-window)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-5" class="outline-4">
          <h4 id="sec-28-9-5">Agenda commands</h4>

          <div class="outline-text-4" id="text-28-9-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.5 (info "(org)Agenda commands")</span>

  (leuven--section <span class="org-string">"10.5 (org)Agenda commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get a compact view during follow mode in the agenda</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--compact-follow</span> ()
    <span class=
"org-doc">"Make the view compact, then show the necessary minimum."</span>
    (<span class="org-keyword">ignore-errors</span>
      (<span class="org-keyword">save-excursion</span>
        (<span class="org-keyword">while</span> (org-up-heading-safe))
        (hide-subtree)))
    (<span class="org-keyword">let</span> ((org-show-siblings nil)
          (org-show-hierarchy-above t))
      (org-reveal))
    (<span class="org-keyword">save-excursion</span>
      (org-back-to-heading t)
      (show-children)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> When this is enabled, clicking on a clock line from `v c'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(log check) does not jump to the right line</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'org-agenda-after-show-hook 'leuven--compact-follow)</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 number of days to include in overview display</span>
  (setq org-agenda-span 'day)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always start the overview on the current day</span>
  (setq org-agenda-start-on-weekday nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format string for displaying dates in the daily/weekly agenda</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">and in the timeline</span>
  (setq org-agenda-format-date
        (concat                         <span class=
"org-comment-delimiter">; </span><span class="org-comment">"\n"</span>
                <span class="org-string">"%Y-%m-%d"</span> <span class=
"org-string">" %a "</span>
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(make-string (1- (window-width)) (string-to-char "_"))))</span>
                (make-string 65 (string-to-char <span class=
"org-string">" "</span>))
                <span class="org-string">"_"</span>
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(make-string 1 ?\u25AE)</span>
                ))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 only show clocked entries in agenda log mode (no closed</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">entries, no state changes)</span>
  (setq org-agenda-log-mode-items '(clock))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 parameters for the clocktable in clockreport mode</span>
  (setq org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> nil <span class=
"org-builtin">:maxlevel</span> 3 <span class=
"org-builtin">:fileskip0</span> t))
  (setq org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> t <span class=
"org-builtin">:maxlevel</span> 3 <span class=
"org-builtin">:fileskip0</span> t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 definition of what constitutes a clocking problem (overlapping</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">clock entries, clocking gaps)</span>
  (setq org-agenda-clock-consistency-checks
        '(<span class="org-builtin">:max-duration</span> <span class=
"org-string">"10:00"</span>
          <span class="org-builtin">:min-duration</span> 0
          <span class="org-builtin">:max-gap</span> <span class=
"org-string">"0:00"</span>
          <span class="org-builtin">:gap-ok-around</span> (<span class=
"org-string">"4:00"</span>)
          <span class="org-builtin">:default-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#AAEE77"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"black"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#BFFA9E"</span>))
          <span class="org-builtin">:gap-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#BBDDFF"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"black"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#D0EDFF"</span>))))
</pre>
            </div>

            <p>If you press <code>E</code>, it will <b>show</b> the <b>first
            notes</b> about the tasks.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 text prepended to the entry text in agenda buffers</span>
  (setq org-agenda-entry-text-leaders <span class=
"org-string">"               │ "</span>)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 file to which to add new entries with the `i' key in agenda and</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">calendar (org.el)</span>
  (setq org-agenda-diary-file <span class=
"org-string">"~/org/diary.org"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5? keep filters from one agenda view to the next</span>
  (setq org-agenda-persistent-filter t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">faces for specific Priorities (#A, #B and #C)</span>
  (setq org-priority-faces
        '((?A . (<span class="org-builtin">:weight</span> bold <span class=
"org-builtin">:foreground</span> <span class=
"org-string">"#5F3731"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#EFC4C0"</span>))
          (?B . (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#475443"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#D5E1D0"</span>))
          (?C . (<span class="org-builtin">:foreground</span> <span class=
"org-string">"#2D373F"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#C9DBE3"</span>))))
</pre>
            </div>

            <p>Contextual auto-exclusion for tags in the Agenda view. For
            example, I use the following tags for <code>TODO</code>:</p>

            <dl class="org-dl">
              <dt>Phone</dt>

              <dd>Needs a phone.</dd>

              <dt>Errands</dt>

              <dd>Done in town.</dd>

              <dt>Home</dt>

              <dd>Done at home.</dd>
            </dl>

            <p>Now, it’s quite easy for my computer to figure out which of
            these are possible, based on my location:</p>

            <dl class="org-dl">
              <dt>Phone</dt>

              <dd>Am I outside of normal calling hours?</dd>

              <dt>Errands</dt>

              <dd>Am I outside of business hours?</dd>

              <dt>Home</dt>

              <dd>Does my IP address begin with 192.168?</dd>
            </dl>

            <p>I can now define the function
            <code>leuven--org-auto-exclude-function</code> to auto-exclude
            based on this type of context information.</p>

            <p>All I have to do is type <code>/ &lt;RET&gt;</code> in the
            agenda view now, and it excludes based on my machine’s current
            temporal and physical context.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.5 Commands in the agenda buffer</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--weekday-p</span> ()
    <span class=
"org-doc">"Return t if current day is between Monday and Friday."</span>
    (<span class="org-keyword">let</span> ((dow (nth 6 (decode-time))))
      (and (&gt; dow 0)
           (&lt; dow 6))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--working-p</span> ()
    <span class=
"org-doc">"Return t if current time is inside normal working hours.</span>
<span class="org-doc">  Currently: 08:30-12:30 and 13:30-17:30."</span>
    (<span class="org-keyword">let*</span> ((time (decode-time))
           (hour (nth 2 time))
           (mins (nth 1 time)))
      (and (leuven--weekday-p)
           (or (or (and (= hour 8) (&gt;= mins 30))
                   (and (&lt; 8 hour) (&lt; hour 12))
                   (and (= hour 12) (&lt;= mins 30)))
               (or (and (= hour 13) (&gt;= mins 30))
                   (and (&lt; 13 hour) (&lt; hour 17))
                   (and (= hour 17) (&lt;= mins 30)))))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--calling-hours-p</span> ()
    <span class=
"org-doc">"Return t if current time is inside normal calling hours.</span>
<span class="org-doc">  Currently: 08:00-21:59."</span>
    (<span class="org-keyword">let*</span> ((hour (nth 2 (decode-time))))
      (and (&lt;= 8 hour) (&lt;= hour 21))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (and (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (<span class="org-keyword">with-temp-buffer</span>
             (call-process <span class=
"org-string">"/sbin/ifconfig"</span> nil t nil <span class=
"org-string">"en0"</span> <span class="org-string">"inet"</span>)
             (goto-char (point-min))
             (not (re-search-forward <span class=
"org-string">"inet 192\\.168\\.9\\."</span> nil t))))
          ((or (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (<span class="org-keyword">let</span> ((hour (nth 2 (decode-time))))
             (or (&lt; hour 8) (&gt; hour 21)))))
         (concat <span class="org-string">"-"</span> tag)))

  <span class="org-comment-delimiter">;;</span><span class=
"org-comment">! ensure that `</span><span class="org-comment"><span class=
"org-constant">:refile:</span></span><span class=
"org-comment">' tags never will be excluded!</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (and (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (leuven--working-p))
          ((string= tag <span class="org-string">"work"</span>)
           (not (leuven--working-p)))
          ((or (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (not (leuven--calling-hours-p))))
         (concat <span class="org-string">"-"</span> tag)))

  (setq org-agenda-auto-exclude-function 'leuven--org-auto-exclude-function)
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>We should ensure that appointments don’t disappear when
                  filtering late at nite</b><br />

                  <ul class="org-ul">
                    <li>Look at appointments tagged <code>errands</code></li>

                    <li>Filter at 23:00 with <code>/ &lt;RET&gt;</code></li>

                    <li>Appointments such as “going to the doctor” will be
                    removed from the agenda view…</li>
                  </ul>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div id="outline-container-sec-28-9-6" class="outline-4">
          <h4 id="sec-28-9-6">Custom agenda views</h4>

          <div class="outline-text-4" id="text-28-9-6">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make the block agenda more compact (no agenda span name, no week</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number, no separator line)</span>
  (setq org-agenda-compact-blocks t)
  (setq org-agenda-compact-blocks nil)

  (setq org-agenda-block-separator
        #(<span class=
"org-string">"____________________________________________________________________________________________________________________________________"</span>
          0 132 (face (<span class=
"org-builtin">:foreground</span> <span class="org-string">"#59ACE2"</span>)))) <span class="org-comment-delimiter">; </span><span class="org-comment">lighter version with #C0E2F4</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(make-string 132 (string-to-char "_"))</span>
</pre>
            </div>

            <p>Links to common agenda views:</p>

            <ul class="org-ul">
              <li><a href="(org-agenda%20nil">(org-agenda nil "a")</a></li>

              <li><a href="(org-agenda%20nil">Show Waiting Tasks</a></li>

              <li><a href="(org-agenda%20nil">Show Projects</a></li>
            </ul>

            <p>You can as well use your agenda and use <code>/</code> to limit
            the view to what you want (<code>C-c a a / TAG</code>).</p>

            <p>Commands:</p>

            <ul class="org-ul">
              <li><a href="ls%20-l">ls -l</a></li>

              <li><a href="pwd">pwd</a></li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.6 (info "(org)Custom agenda views")</span>

  (leuven--section <span class=
"org-string">"10.6 (org)Custom agenda views"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-agenda"</span>
    (<span class="org-keyword">let</span> ((leuven-org-agenda-views
           <span class=
"org-string">"~/src/emacs-leuven/org-custom-agenda-views.el"</span>))
      (<span class=
"org-keyword">when</span> (file-exists-p leuven-org-agenda-views)
        (load-file leuven-org-agenda-views))))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "org-agenda" ends here</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-7" class="outline-4">
          <h4 id="sec-28-9-7">Display all active tasks from the current
          directory</h4>

          <div class="outline-text-4" id="text-28-9-7">
            <p>The function <code>leuven-org-todo-list-current-dir</code> will
            display your tasks from the current directory (including from local
            files <code>TODO.org</code> and <code>BUGS.org</code>, for
            example).</p>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Add recursive option to show all tasks from
                subdir</b><br /></td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-todo-list-current-dir</span> ()
    <span class=
"org-doc">"Produce a view from all Org files in the current directory."</span>
    (interactive)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class=
"org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory))
           (org-agenda-files (directory-files dname t <span class=
"org-string">"\\.</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">org</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">txt</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">$"</span>))
           (org-agenda-sorting-strategy '(todo-state-up priority-down))
           (org-agenda-overriding-header
            (format <span class="org-string">"List of </span><span class=
"org-string"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-string"> items restricted to directory\n%s"</span> dname))
           (org-agenda-sticky nil))
      (message <span class=
"org-string">"%s..."</span> org-agenda-overriding-header)
      (org-todo-list)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> list" without asking for a directory</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;C-f3&gt;"</span>) 'leuven-org-todo-list-current-dir)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-8" class="outline-4">
          <h4 id="sec-28-9-8">Exporting Agenda Views</h4>

          <div class="outline-text-4" id="text-28-9-8">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.7 (info "(org)Exporting Agenda Views")</span>

  (leuven--section <span class=
"org-string">"10.7 (org)Exporting Agenda Views"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.7 alist of variable/value pairs that should be active during agenda</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">export</span>
  (setq org-agenda-exporter-settings
        '((ps-number-of-columns 1)      <span class=
"org-comment-delimiter">; </span><span class="org-comment">2?</span>
          (ps-landscape-mode t)
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(org-agenda-add-entry-text-maxlines 5)</span>
          (htmlize-output-type 'css)))
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>htmlize-output-type is duplicated lots of
                times!</b><br /></td>
              </tr>
            </table>
          </div>
        </div>

        <div id="outline-container-sec-28-9-9" class="outline-4">
          <h4 id="sec-28-9-9">Agenda column view</h4>

          <div class="outline-text-4" id="text-28-9-9">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 10.8 (info "(org)Agenda column view")</span>

  (leuven--section <span class=
"org-string">"10.8 (org)Agenda column view"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.8 default column format, if no other format has been defined</span>
  (setq org-columns-default-format
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"%65ITEM(Task) %DEADLINE(Due Date) %PRIORITY %6CLOCKSUM(Spent) %6Effort(Estim.){:}")</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"%1BLOCKED %4</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> %CATEGORY %5Effort{:} %50ITEM %20TAGS %21ALLTAGS")</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"%65ITEM(Task) %4</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> %PRIORITY %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"%65ITEM(Task) %4</span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> %PRIORITY %20TAGS %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"%40ITEM(Task) %17Effort(Estimated Effort){:} %CLOCKSUM"</span>
        <span class=
"org-string">"%60ITEM(Details) %5PRIORITY(Prio) %14SCHEDULED(Scheduled) %15TAGS(Context) %7</span><span class="org-string"><span class="org-leuven-highlight">TODO</span></span><span class="org-string">(To Do) %6CLOCKSUM(Clock) %5Effort(Effort){:} "</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">DUPLICATE Obey `</span><span class="org-comment"><span class=
"org-constant">eval</span></span><span class=
"org-comment">' variables -- RISKY!</span>
  (setq enable-local-eval t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-9-10" class="outline-4">
          <h4 id="sec-28-9-10">Not sorted</h4>

          <div class="outline-text-4" id="text-28-9-10"></div>

          <div id="outline-container-sec-28-9-10-1" class="outline-5">
            <h5 id="sec-28-9-10-1">Mouse cursor doesn’t highlight agenda
            lines</h5>

            <div class="outline-text-5" id="text-28-9-10-1">
              <p>XXX Does this work?</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
  (add-hook 'org-agenda-finalize-hook
            (<span class="org-keyword">lambda</span> ()
              (remove-text-properties (point-min) (point-max)
                                      '(mouse-face t))))
</pre>
              </div>

              <table class="inlinetask" width="100%">
                <tr>
                  <td valign="top"><b><span class=
                  "todo TODO">TODO</span></b></td>

                  <td width="100%"><b>Adding “:tangle yes” on the above code
                  block results in partial tangling!</b><br /></td>
                </tr>
              </table>
            </div>
          </div>

          <div id="outline-container-sec-28-9-10-2" class="outline-5">
            <h5 id="sec-28-9-10-2">Mark a task as DONE and create a follow-up
            task</h5>

            <div class="outline-text-5" id="text-28-9-10-2">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-agenda"</span>

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-agenda-mark-done-and-add-followup</span> ()
      <span class="org-doc">"Mark the current </span><span class=
"org-doc"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-doc"> as done and add another task after it.</span>
<span class=
"org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class=
"org-doc">this with to-do items than with projects or headings."</span>
      (interactive)
      (org-agenda-todo <span class="org-string">"DONE"</span>)
      (org-agenda-switch-to)
      (org-capture 0 <span class="org-string">"t"</span>))

    (define-key org-agenda-mode-map
      <span class=
"org-string">"Z"</span> 'leuven-org-agenda-mark-done-and-add-followup)
</pre>
              </div>

              <p>Source: Sacha Chua.</p>
            </div>
          </div>

          <div id="outline-container-sec-28-9-10-3" class="outline-5">
            <h5 id="sec-28-9-10-3">Capture something based on the agenda</h5>

            <div class="outline-text-5" id="text-28-9-10-3">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-agenda-new</span> ()
      <span class=
"org-doc">"Create a new note or task at the current agenda item.</span>
<span class=
"org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class=
"org-doc">this with to-do items than with projects or headings."</span>
      (interactive)
      (org-agenda-switch-to)
      (org-capture 0))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; new key assignment (overrides `</span><span class=
"org-comment"><span class=
"org-constant">org-agenda-next-item</span></span><span class=
"org-comment">')</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(define-key org-agenda-mode-map</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"N" 'leuven-org-agenda-new)</span>
  )
</pre>
              </div>

              <p>Source: Sacha Chua.</p>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-10" class="outline-3">
        <h3 id="sec-28-10">Markup for rich export</h3>

        <div class="outline-text-3" id="text-28-10">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 11 (info "(org)Markup")</span>

  (leuven--section <span class="org-string">"11 (org)Markup"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a face to #+begin_quote and #+begin_verse blocks</span>
    (setq org-fontify-quote-and-verse-blocks t))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Markup"</span>)

    <span class="org-comment-delimiter">;;</span><span class=
"org-comment">??? change the face of a headline (as an additional information) if it is</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">marked DONE (to face `</span><span class=
"org-comment"><span class=
"org-constant">org-headline-done</span></span><span class=
"org-comment">')</span>
    (setq org-fontify-done-headline t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">11.1 hide the emphasis marker characters</span>
    (setq org-hide-emphasis-markers t)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">impact on table alignment!</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-10-1" class="outline-4">
          <h4 id="sec-28-10-1">Images and Tables</h4>

          <div class="outline-text-4" id="text-28-10-1">
            <p>Automatic screenshot insertion.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-insert-image-or-take-screenshot</span> (name)
      <span class=
"org-doc">"Insert a link to an already existing image, or else to a screenshot.</span>
<span class=
"org-doc">    The screenshot is either taken to the given non-existing file name,</span>
<span class=
"org-doc">    or added into the given directory, defaulting to the current one."</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment">: Should limit to '("pdf" "jpeg" "jpg" "png" "ps" "eps")</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">which is org-export-latex-inline-image-extensions.</span>
      (interactive <span class="org-string">"GImage name? "</span>)
      (<span class="org-keyword">when</span> (file-directory-p name)
        (setq name (concat
                    (make-temp-name
                     (expand-file-name
                      (concat (file-name-as-directory name)
                              (subst-char-in-string
                               <span class="org-string">"."</span> <span class=
"org-string">"-"</span>
                               (file-name-sans-extension
                                (file-name-nondirectory
                                 (buffer-file-name)))))))
                    <span class="org-string">".png"</span>)))
      (<span class="org-keyword">unless</span> (file-exists-p name)
        (<span class="org-keyword">if</span> (file-writable-p name)
            (<span class="org-keyword">progn</span>
              (message <span class=
"org-string">"Taking screenshot into %s"</span> name)
              (call-process <span class=
"org-string">"import"</span> nil nil nil name)
              (message <span class=
"org-string">"Taking screenshot...done"</span>))
          (<span class="org-warning">error</span> <span class=
"org-string">"Cannot create image file"</span>)))
      (insert (concat <span class="org-string">"[["</span> name <span class=
"org-string">"]]"</span>))
      (org-display-inline-images))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-10-2" class="outline-4">
          <h4 id="sec-28-10-2">Macro replacement</h4>

          <div class="outline-text-4" id="text-28-10-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hide the brackets marking macro calls</span>
    (setq org-hide-macro-markers t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-macro-insert</span> ()
      (interactive)
      (<span class=
"org-keyword">let*</span> ((macros (org-macro--collect-macros))
             (macro (completing-read <span class=
"org-string">"Insert macro: "</span> (mapcar 'car macros)))
             (args (string-match <span class=
"org-string">"$[[:digit:]]"</span> (cdr (assoc macro macros))))
             pos)
        (insert (format  <span class="org-string">"{{{%s"</span> macro))
        (<span class="org-keyword">when</span> args (insert <span class=
"org-string">"("</span>) (setq pos (point)) (insert <span class=
"org-string">")"</span>))
        (insert <span class="org-string">"}}}"</span>)
        (<span class="org-keyword">when</span> pos (goto-char pos)))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-10-3" class="outline-4">
          <h4 id="sec-28-10-3">Embedded LaTeX</h4>

          <div class="outline-text-4" id="text-28-10-3">
            <p>To get one entity in the middle of a word, use <code>{}</code>,
            i.e. some <code>w\entity{}rd</code> (new exporter only).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">11.7.1 define user entities to produce special characters</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-entities"</span>

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"ok"</span>
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">\definecolor{checkmark}{HTML}{1FAC21}</span>
                   <span class=
"org-string">"{\\color{checkmark}\\ding{51}}"</span> nil
                   <span class=
"org-string">"&lt;font color='green'&gt;&amp;#x2714;&lt;/font&gt;"</span>
                   <span class="org-string">"OK"</span>
                   <span class="org-string">"OK"</span> <span class=
"org-string">"✔"</span>))

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"nok"</span>
                   <span class="org-comment-delimiter">;; </span><span class=
"org-comment">\usepackage{pifont}</span>
                   <span class=
"org-string">"{\\color{red}\\ding{55}}"</span> nil
                   <span class=
"org-string">"&lt;font color='red'&gt;&amp;#x2718;&lt;/font&gt;"</span>
                   <span class="org-string">"NOK"</span>
                   <span class="org-string">"NOK"</span> <span class=
"org-string">"✘"</span>)))
</pre>
            </div>

            <p>To list all available entities, run <code>M-x
            org-entities-help</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">11.7.2 interpret "_" and "^" for display when braces are used</span>
  (setq org-use-sub-superscripts '{})

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 11.7.3 convert LaTeX fragments to images when exporting to HTML (using MathJax)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-export-with-latex t)</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight LaTeX and related syntax</span>
  (setq org-highlight-latex-and-related '(latex script entities))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show entities as UTF8 characters</span>
  (setq org-pretty-entities t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; pretty entity display doesn't include formatting sub/superscripts</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-pretty-entities-include-sub-superscripts nil)</span>
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-11" class="outline-3">
        <h3 id="sec-28-11">Exporting</h3>

        <div class="outline-text-3" id="text-28-11">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 12 (info "(org)Exporting")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind the exporter dispatcher to a key sequence</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Exporting"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">libraries in this list will be loaded once the export framework is needed</span>
    (setq org-export-backends '(ascii html icalendar latex odt))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(define-key org-mode-map</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(kbd "C-c C-e") 'org-export-dispatch)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> temporary (until Org 8 is bundled within Emacs)</span>
    (define-key org-mode-map
      (kbd <span class="org-string">"C-c C-e"</span>)
      (<span class="org-keyword">lambda</span> (<span class=
"org-type">&amp;optional</span> arg)
        (interactive <span class="org-string">"P"</span>)
        (<span class="org-keyword">if</span> (fboundp 'org-export-dispatch)
            (funcall 'org-export-dispatch arg)
          (message (concat <span class=
"org-string">"This version of Org mode is no longer supported.  "</span>
                           <span class=
"org-string">"Please upgrade to 8 or later"</span>))
          (sit-for 1.5)))))
</pre>
          </div>

          <p>For Org buffers, add an enhanced version of
          <code>save-buffer</code> which does:</p>

          <ol class="org-ol">
            <li>Save buffer (updating dynamic blocks and tables)</li>

            <li>Execute the code blocks, and save another time</li>

            <li>Tangle code blocks, if any to be tangled</li>

            <li>Export to HTML and PDF, if such files already exist</li>

            <li>Call <code>send-patch</code>?</li>
          </ol>

          <p>Notes:</p>

          <ul class="org-ul">
            <li>Use the asynchronous export (if possible, so that I don’t loose
            time, or let it open to the value of that var)?</li>

            <li>Different behaviors can be obtained with <code>C-u</code> (or
            <code>C-u C-u</code>)</li>
          </ul>

          <p>Why not adding a recursive functionality as well (in Emacs Lisp
          too), to be launched from Dired?</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-save-buffer-and-do-related</span> ()
      <span class=
"org-doc">"Save buffer, execute/tangle code blocks, and export to HTML/PDF."</span>
      (interactive)
      (<span class="org-keyword">let*</span> ((orgfile (buffer-file-name))
             (base-name (file-name-base orgfile))
             (htmlfile (concat base-name <span class=
"org-string">".html"</span>))
             (pdffile (concat base-name <span class=
"org-string">".pdf"</span>)))
        (save-buffer)                     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">see other commands in</span>
                                          <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">before-save-hook</span></span><span class=
"org-comment">':</span>
                                          <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">org-update-all-dblocks</span></span><span class=
"org-comment">'</span>
                                          <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">org-table-iterate-buffer-tables</span></span><span class=
"org-comment">'</span>
        (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
          (org-babel-execute-buffer)
          (<span class="org-keyword">let</span> ((before-save-hook nil))
            (save-buffer))
          (org-babel-tangle)
          (<span class="org-keyword">when</span> (file-exists-p htmlfile)
            (<span class=
"org-keyword">if</span> (file-newer-than-file-p orgfile htmlfile)
                (org-html-export-to-html)
              (message <span class=
"org-string">"HTML is up to date with Org file"</span>)))
          (<span class="org-keyword">when</span> (file-exists-p pdffile)
            (<span class=
"org-keyword">if</span> (file-newer-than-file-p orgfile pdffile)
                (<span class="org-keyword">if</span> (string-match <span class=
"org-string">"^#\\+BEAMER_THEME: "</span> (buffer-string))
                    (org-beamer-export-to-pdf)
                  (org-latex-export-to-pdf))
              (message <span class=
"org-string">"PDF is up to date with Org file"</span>)))
          (beep))))

    (define-key org-mode-map
      (kbd <span class=
"org-string">"&lt;f9&gt;"</span>) 'org-save-buffer-and-do-related))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-11-1" class="outline-4">
          <h4 id="sec-28-11-1">Export options</h4>

          <div class="outline-text-4" id="text-28-11-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.2 (info "(org)Export options")</span>

  (leuven--section <span class="org-string">"12.2 (org)Export options"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org generic export engine</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">12.3 don't insert a time stamp into the exported file</span>
    (setq org-export-time-stamp-file nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">13.1.5 export all drawers (including properties)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-export-with-drawers t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default language of HTML export (see `</span><span class=
"org-comment"><span class=
"org-constant">org-export-language-setup</span></span><span class=
"org-comment">' </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class="org-comment">)</span>
    (setq org-export-default-language <span class="org-string">"en"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">include priority cookies in export</span>
    (setq org-export-with-priority t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate smart quotes during export (convert " to \og, \fg in French)</span>
    (setq org-export-with-smart-quotes t) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">curly quotes in HTML</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">interpret "_" and "^" for export when braces are used</span>
    (setq org-export-with-sub-superscripts '{})

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">allow #+BIND to define local variable values for export</span>
    (setq org-export-allow-bind-keywords t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; exported stuff will not be pushed onto the kill ring</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-export-copy-to-kill-ring nil) ; new default since 2014-04-17</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; export and publishing commands will run in background</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-export-in-background t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; use a non-intrusive export dispatcher</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-export-dispatch-use-expert-ui t)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">export snippet translations</span>
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"l"</span> . <span class=
"org-string">"latex"</span>))
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"b"</span> . <span class=
"org-string">"beamer"</span>))

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "ox" ends here</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">execute buffer when exporting it (see some thread with Eric Schulte,</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">end of December 2010)</span>
  <span class="org-comment-delimiter">;;;;;;;;;; </span><span class=
"org-comment">(add-hook 'org-export-first-hook 'org-babel-execute-buffer)</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-11-2" class="outline-4">
          <h4 id="sec-28-11-2">HTML export</h4>

          <div class="outline-text-4" id="text-28-11-2">
            <p>To get a start for your CSS file, use the command <code>M-x
            org-export-htmlize-generate-css</code> to extract class
            definitions.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.5 (info "(org)HTML export")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org HTML export engine</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox-html"</span>

    (setq org-html-checkbox-type 'unicode)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">output type to be used by htmlize when formatting code snippets</span>
    (setq org-html-htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; URL pointing to a CSS file defining text colors for htmlized Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; buffers</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-org-htmlized-css-url "style.css")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">XML declaration</span>
    (setq org-html-xml-declaration
          '((<span class="org-string">"html"</span> . <span class=
"org-string">"&lt;!-- &lt;xml version=\"1.0\" encoding=\"%s\"&gt; --&gt;"</span>)
            (<span class="org-string">"was-html"</span> . <span class=
"org-string">"&lt;?xml version=\"1.0\" encoding=\"%s\"?&gt;"</span>)
            (<span class="org-string">"php"</span> . <span class=
"org-string">"&lt;?php echo \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"%s\\\" ?&gt;\"; ?&gt;"</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">coding system for HTML export</span>
    (setq org-html-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format for the HTML postamble</span>
    (setq org-html-postamble
          <span class=
"org-string">"  &lt;div id=\"footer\"&gt;&lt;div id=\"copyright\"&gt;\n    Copyright &amp;copy; %d %a\n  &lt;/div&gt;&lt;/div&gt;"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">13.1.5 don't include the JavaScript snippets in exported HTML files</span>
    (setq org-html-head-include-scripts nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">12.5.9 turn inclusion of the default CSS style off</span>
    (setq org-html-head-include-default-style nil)
</pre>
            </div>

            <p><a href="http://tidy.sourceforge.net/">HTML Tidy</a> is a HTML
            linter. Please see <a href=
            "http://www.htmlpedia.org/wiki/HTML_Tidy">List of the Tidy
            errors</a>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check that `</span><span class="org-comment"><span class=
"org-constant">tidy</span></span><span class=
"org-comment">' is in PATH, and that configuration file exists</span>
    (<span class="org-keyword">when</span> (and (executable-find <span class=
"org-string">"tidy"</span>)
               (file-exists-p <span class=
"org-string">"~/.tidyrc"</span>)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">tidy-config</span>

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--export-html-final-filter</span> (contents backend info)
        (<span class="org-keyword">if</span> (not (eq backend 'html)) contents
          (message <span class="org-string">"Tidy'fying..."</span>)
          (<span class="org-keyword">let*</span> ((new-contents
                  (<span class="org-keyword">with-temp-buffer</span>
                    (insert contents)
                    (shell-command-on-region (point-min) (point-max)
                                             <span class=
"org-string">"tidy -config ~/.tidyrc"</span>
                                             t t <span class=
"org-string">"*Tidy errors*"</span>)
                    (buffer-string))))
            (message <span class="org-string">"Tidy'fying... Done"</span>)
            new-contents)))

      (add-to-list 'org-export-filter-final-output-functions
                   'leuven--export-html-final-filter))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">HTML checkbox output</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--checkbox-filter</span> (item backend info)
        (<span class=
"org-keyword">when</span> (org-export-derived-backend-p backend 'html)
          (replace-regexp-in-string
           <span class="org-string">"\\`.*</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">&lt;code&gt;\\[</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">X</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">&amp;#xa0;</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">-</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">\\]&lt;/code&gt;</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">.*$"</span>
           (<span class="org-keyword">lambda</span> (rep)
             (<span class=
"org-keyword">let</span> ((check (match-string 2 rep)))
               (<span class=
"org-keyword">cond</span> ((equal check <span class="org-string">"X"</span>) <span class="org-string">"&amp;#x2611;"</span>)
                     ((equal check <span class=
"org-string">"-"</span>) <span class="org-string">"&amp;#x2610;"</span>)
                     (t <span class="org-string">"&amp;#x2610;"</span>))))
           item
           nil nil 1)))
      (add-to-list 'org-export-filter-item-functions
                   'leuven--checkbox-filter)

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "ox-html" ends here</span>
</pre>
            </div>

            <p>Emacs 23+ users: in order to avoid “Invalid face” errors, you
            need to use the version made available by Carsten Dominik in
            <code>org-mode/contrib/lisp</code> directory.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs-goodies-el)htmlize")</span>

  (leuven--section <span class="org-string">"(emacs-goodies-el)htmlize"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">HTML-ize font-lock buffers</span>
  (autoload 'htmlize-buffer <span class="org-string">"htmlize"</span>
    <span class=
"org-doc">"Convert BUFFER to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-region <span class="org-string">"htmlize"</span>
    <span class=
"org-doc">"Convert the region to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-file <span class="org-string">"htmlize"</span>
    <span class=
"org-doc">"Load FILE, fontify it, convert it to HTML, and save the result."</span> t)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"htmlize"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">output type of generated HTML</span>
    (setq htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">override output type `</span><span class=
"org-comment"><span class="org-constant">inline-css</span></span><span class=
"org-comment">' used for htmlizing a region</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">htmlize-region-for-paste</span> (beg end)
      <span class=
"org-doc">"Htmlize the region and return just the HTML as a string.</span>
<span class="org-doc">    This forces the `</span><span class=
"org-doc"><span class="org-constant">css</span></span><span class=
"org-doc">' style and only returns the HTML body, but without the</span>
<span class=
"org-doc">    BODY tag.  This should make it useful for inserting the text to another HTML</span>
<span class="org-doc">    buffer."</span>
      (<span class=
"org-keyword">let*</span> ((htmlize-output-type 'css)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">was `</span><span class="org-comment"><span class=
"org-constant">inline-css</span></span><span class="org-comment">'</span>
             (htmlbuf (htmlize-region beg end)))
        (<span class="org-keyword">unwind-protect</span>
            (<span class="org-keyword">with-current-buffer</span> htmlbuf
              (buffer-substring
               (plist-get htmlize-buffer-places 'content-start)
               (plist-get htmlize-buffer-places 'content-end)))
          (kill-buffer htmlbuf))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">charset declared by the resulting HTML documents</span>
    (setq htmlize-html-charset <span class="org-string">"utf-8"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">non-ASCII characters (codes in the 128-255 range) are copied to</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">HTML without modification -- if your HTML is in Unicode</span>
    (setq htmlize-convert-nonascii-to-entities nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key binding</span>
    (global-set-key
      (kbd <span class="org-string">"M-P"</span>) 'htmlize-buffer)

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "htmlize" ends here</span>
</pre>
            </div>

            <p>To get around PostScript problems, you can write the buffer to
            your browser and then print from there, and in color.</p>

            <p>This adds a Quick Print option to your menu bar (under
            File).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">quick print preview (to Web browser) with `</span><span class=
"org-comment"><span class=
"org-constant">htmlize-view-buffer</span></span><span class=
"org-comment">'</span>
  (GNUEmacs
    (autoload 'htmlize-view-buffer <span class=
"org-string">"htmlize-view"</span>
      <span class=
"org-doc">"Convert buffer to html preserving faces and view in web browser."</span> t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">same key binding as Org export to HTML (open in browser)</span>
    (global-set-key
      (kbd <span class="org-string">"C-c C-e h o"</span>) 'htmlize-view-buffer)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">view current buffer as html in web browser</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"htmlize-view"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add "Quick Print" entry to file menu</span>
      (htmlize-view-add-to-files-menu)))
</pre>
            </div>

            <p>Now, you can print from the browser in (complete) Unicode, using
            your system’s capabilities.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-11-3" class="outline-4">
          <h4 id="sec-28-11-3">LaTeX and PDF export</h4>

          <div class="outline-text-4" id="text-28-11-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 12.6 (info "(org)LaTeX and PDF export")</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (leuven--section <span class=
"org-string">"12.6 (org)LaTeX and PDF export"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">LaTeX back-end</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox-latex"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">markup for </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> keywords and for tags, as a printf format</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-latex-format-headline</span> (todo todo-type priority text tags)
      <span class="org-doc">"Default format function for an headline."</span>
      (concat (<span class="org-keyword">when</span> todo
                (format <span class=
"org-string">"{%s\\textbf{\\textsc{\\textsf{%s}}}} "</span>
                        (<span class=
"org-keyword">cond</span> ((equal todo-type 'todo) <span class=
"org-string">"\\color{red}"</span>)
                              ((equal todo-type 'done) <span class=
"org-string">"\\color{teal}"</span>)
                              (t <span class=
"org-string">"\\color{gray}"</span>))
                        todo))
              (<span class="org-keyword">when</span> priority
                (format <span class=
"org-string">"\\framebox{\\#%c} "</span> priority))
              text
              (<span class="org-keyword">when</span> tags
                (format <span class=
"org-string">"\\hfill{}\\fbox{\\textsc{%s}}"</span>
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> source of "undefined control sequence"?</span>
                  (mapconcat 'identity tags <span class=
"org-string">":"</span>)))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function for formatting the headline's text</span>
    (setq org-latex-format-headline-function
          'org-latex-format-headline)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default width for images</span>
    (setq org-latex-image-default-width <span class=
"org-string">".75\\linewidth"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format string for links with unknown path type</span>
    (setq org-latex-link-with-unknown-path-format <span class=
"org-string">"\\colorbox{red}{%s}"</span>)
</pre>
            </div>

            <p>Look at the variable <code>org-latex-remove-logfiles</code>,
            which controls whether some of the files produced by LaTeX
            (<code>org-latex-logfiles-extensions</code>) are removed.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--change-pdflatex-program</span> (backend)
      <span class=
"org-doc">"Automatically run XeLaTeX, if asked, when exporting to LaTeX."</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default (in Windows binary)</span>
      (setq org-latex-pdf-process
            (<span class="org-keyword">if</span> (executable-find <span class=
"org-string">"latexmk"</span>)
                '(<span class=
"org-string">"latexmk -CF -pdf %f &amp;&amp; latexmk -c"</span>)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">must clean .fdb_latexmk, .fls, .ilg,</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">.ind, etc.</span>
              '(<span class=
"org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
                <span class=
"org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
                <span class=
"org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>)))

      (<span class="org-keyword">when</span> (string-match <span class=
"org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
        (setq org-latex-pdf-process
              (<span class=
"org-keyword">if</span> (executable-find <span class="org-string">"latexmk"</span>)
                  '(<span class=
"org-string">"latexmk -CF -pdf -pdflatex=xelatex %f &amp;&amp; latexmk -c"</span>)
                '(<span class=
"org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>
                  <span class=
"org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>
                  <span class=
"org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>)))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hook run before parsing an export buffer</span>
    (add-hook 'org-export-before-parsing-hook 'leuven--change-pdflatex-program)
</pre>
            </div>

            <p>You can easily customize this variable on a per file basis. If
            you seldom use <code>bibtex</code>, have the default be to run
            <code>pdflatex</code> just once or twice. Then, for any Org file
            that needs <code>bibtex</code>, simply put in the following line
            (or a variation thereof):</p>

            <div class="org-src-container">
              <pre class="src src-org">
<span class=
"org-org-meta-line">#+BIND: org-latex-pdf-process ("pdflatex %b" "bibtex %b" "pdflatex %b" "pdflatex %b")</span>
</pre>
            </div>

            <p>Also, you can use <code>latexmk</code> (in TeX Live) which can
            save you some time when it is not necessary to rebuild index and/or
            bibliography.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">export source code using `</span><span class=
"org-comment"><span class="org-constant">listings</span></span><span class=
"org-comment">' (instead of `</span><span class="org-comment"><span class=
"org-constant">verbatim</span></span><span class="org-comment">')</span>
    (setq org-latex-listings t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">12.6.2 default packages to be inserted in the header</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">include the `</span><span class="org-comment"><span class=
"org-constant">listings</span></span><span class=
"org-comment">' package for fontified source code</span>
    (add-to-list 'org-latex-packages-alist '(<span class=
"org-string">""</span> <span class="org-string">"listings"</span>) t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">include the `</span><span class="org-comment"><span class=
"org-constant">xcolor</span></span><span class=
"org-comment">' package for colored source code</span>
    (add-to-list 'org-latex-packages-alist '(<span class=
"org-string">""</span> <span class="org-string">"xcolor"</span>) t)
</pre>
            </div>

            <p>When using the <code>utf8</code> option to <code>inputenc</code>
            (and not <code>utf8x</code> which should be avoided, as it uses
            <code>ucs</code> which is no longer maintained), we have 2
            solutions to support the UTF-8 <b>non-breaking space</b>:</p>

            <ul class="org-ul">
              <li>
                <p>Convert it in Org mode, when exporting (via a filter),
                or</p>

                <div class="org-src-container">
                  <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">filter for non-breaking spaces</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--latex-filter-nbsp</span> (text backend info)
    <span class=
"org-doc">"Convert non-breaking spaces when exporting to LaTeX/Beamer."</span>
    (<span class="org-keyword">when</span> (memq backend '(latex beamer))
      (replace-regexp-in-string <span class=
"org-string">" "</span> <span class="org-string">"~"</span> text)))

  (add-to-list 'org-export-filter-plain-text-functions
               'leuven--latex-filter-nbsp)
</pre>
                </div>
              </li>

              <li>
                <p>Convert it in LaTeX:</p>

                <div class="org-src-container">
                  <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">convert `</span><span class="org-comment"><span class=
"org-constant">nbsp</span></span><span class=
"org-comment">' to its LaTeX equivalent</span>
  (add-to-list 'org-latex-packages-alist
               (concat <span class=
"org-string">"\\ifdefined\\DeclareUnicodeCharacter{"</span>
                       <span class=
"org-string">"\\DeclareUnicodeCharacter{00A0}{~}"</span>
                       <span class="org-string">"}\\fi"</span>) t)
</pre>
                </div>
              </li>
            </ul>

            <p>XXX The first one is better because … (see mail of Daniel
            Flipo)</p>

            <p>The exporter will <b>add</b> a language option to the LaTeX
            <code>babel</code> package according to the
            <code>#+LANGUAGE:</code> keyword (only) if:</p>

            <ul class="org-ul">
              <li>The <code>babel</code> package is explicitly loaded (in
              preamble), <span class="underline">and</span></li>

              <li>The language is different from the one set by the user.</li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">include the `</span><span class="org-comment"><span class=
"org-constant">babel</span></span><span class=
"org-comment">' package for language-specific hyphenation and</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">typography</span>
    (add-to-list 'org-latex-packages-alist '(<span class=
"org-string">"french"</span> <span class="org-string">"babel"</span>) t)
</pre>
            </div>

            <p>What about <code>apacite</code> and <code>tikz</code> in
            <code>org-latex-packages-alist</code>?</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--change-pdflatex-packages</span> (backend)
      <span class=
"org-doc">"Automatically select the LaTeX packages to include (depending on PDFLaTeX</span>
<span class=
"org-doc">    vs. XeLaTeX) when exporting When exporting to LaTeX."</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unconditionally remove `</span><span class=
"org-comment"><span class="org-constant">inputenc</span></span><span class=
"org-comment">' from all the default packages</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">"AUTO"</span> <span class=
"org-string">"inputenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unconditionally remove `</span><span class=
"org-comment"><span class="org-constant">fontenc</span></span><span class=
"org-comment">' from all the default packages</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">"T1"</span> <span class=
"org-string">"fontenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unconditionally remove `</span><span class=
"org-comment"><span class="org-constant">textcomp</span></span><span class=
"org-comment">' from all the default packages</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">""</span> <span class=
"org-string">"textcomp"</span> t)
                    org-latex-packages-alist))

      (<span class="org-keyword">if</span> (string-match <span class=
"org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">packages to include when XeLaTeX is used</span>
          (setq org-export-latex-packages-alist
                '((<span class="org-string">""</span> <span class=
"org-string">"fontspec"</span> t)
                  (<span class="org-string">""</span> <span class=
"org-string">"xunicode"</span> t)
                  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add here things like `\setmainfont{Georgia}'</span>
                  ))

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">packages to include when PDFLaTeX is used</span>
        (setq org-export-latex-packages-alist
              '((<span class="org-string">"AUTO"</span> <span class=
"org-string">"inputenc"</span> t)
                (<span class="org-string">"T1"</span> <span class=
"org-string">"fontenc"</span> t)
                (<span class="org-string">""</span> <span class=
"org-string">"textcomp"</span> t))))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">packages to always include</span>
      (add-to-list 'org-export-latex-packages-alist
                   '(<span class="org-string">"frenchb"</span> <span class=
"org-string">"babel"</span>) t))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hook run before parsing an export buffer</span>
    (add-hook 'org-export-before-parsing-hook 'leuven--change-pdflatex-packages)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">12.6.5 default position for LaTeX figures</span>
    (setq org-latex-default-figure-position <span class=
"org-string">"!htbp"</span>)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-11-4" class="outline-4">
          <h4 id="sec-28-11-4">“Ignore heading + promote children” tag</h4>

          <div class="outline-text-4" id="text-28-11-4">
            <p>The actual contents of an abstract can be rather large.</p>

            <p>To be able to put it into a collapsable headline <b>without
            exporting the headline</b>, but <b>well its contents</b>, you can
            add a <code>ignore</code> tag to remove the headline:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-export-ignore-headlines</span> (data backend info)
      <span class=
"org-doc">"Remove headlines tagged \"ignore\" retaining contents and promoting children.</span>
<span class=
"org-doc">    Each headline tagged \"ignore\" will be removed retaining its</span>
<span class=
"org-doc">    contents and promoting any children headlines to the level of the</span>
<span class="org-doc">    parent."</span>
      (org-element-map data 'headline
        (<span class="org-keyword">lambda</span> (object)
          (<span class="org-keyword">when</span> (member <span class=
"org-string">"ignore"</span> (org-element-property <span class=
"org-builtin">:tags</span> object))
            (<span class=
"org-keyword">let</span> ((level-top (org-element-property <span class=
"org-builtin">:level</span> object))
                  level-diff)
              (mapc (<span class="org-keyword">lambda</span> (el)
                      <span class=
"org-comment-delimiter">;; </span><span class="org-comment">recursively promote all nested headlines</span>
                      (org-element-map el 'headline
                        (<span class="org-keyword">lambda</span> (el)
                          (<span class=
"org-keyword">when</span> (equal 'headline (org-element-type el))
                            (<span class="org-keyword">unless</span> level-diff
                              (setq level-diff (- (org-element-property <span class="org-builtin">:level</span> el)
                                                  level-top)))
                            (org-element-put-property el
                              <span class=
"org-builtin">:level</span> (- (org-element-property <span class=
"org-builtin">:level</span> el)
                                        level-diff)))))
                      <span class=
"org-comment-delimiter">;; </span><span class="org-comment">insert back into parse tree</span>
                      (org-element-insert-before el object))
                    (org-element-contents object)))
            (org-element-extract-element object)))
        info nil)
      data)

    (add-hook 'org-export-filter-parse-tree-functions
              'org-export-ignore-headlines)
</pre>
            </div>

            <p>In addition, it promotes all headlines under the removed
            <code>ignore</code>-tagged headline. This is useful to support
            structures like the following:</p>

            <div class="org-src-container">
              <pre class="src src-org">
<span class="org-comment"># Wrapping an abstract in a headline</span>

<span class=
"org-org-level-1">* Abstract                                                             </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX:</span> <span class=
"org-org-block">\begin{abstract}</span>
<span class="org-org-meta-line">#+HTML:</span> <span class=
"org-org-block">&lt;div id="abstract"&gt;</span>
...
<span class="org-org-meta-line">#+HTML:</span> <span class=
"org-org-block">&lt;/div&gt;</span>
<span class="org-org-meta-line">#+LaTeX:</span> <span class=
"org-org-block">\end{abstract}</span>

<span class=
"org-comment"># Placing References under a headline (using ox-bibtex in contrib)</span>

<span class=
"org-org-level-1">* References                                                           </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+BIBLIOGRAPHY: dissertation plain</span>

<span class=
"org-comment"># Inserting an appendix for LaTeX using the appendix package.</span>

<span class=
"org-org-level-1">* Appendix                                                             </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX:</span> <span class=
"org-org-block">\begin{appendices}</span>
<span class="org-org-level-2">** Reproduction</span>
<span class="org-org-level-2">** Data Sets</span>
<span class="org-org-level-2">** Tooling</span>
<span class="org-org-level-2">** Definitions</span>
<span class="org-org-meta-line">#+LaTeX:</span> <span class=
"org-org-block">\end{appendices}</span>
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "ox-latex" ends here</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-11-5" class="outline-4">
          <h4 id="sec-28-11-5">LaTeX Beamer and PDF export</h4>

          <div class="outline-text-4" id="text-28-11-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">12.6.6 Beamer class export</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(require 'ox-beamer)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox-beamer"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default title of a frame containing an outline</span>
    (setq org-beamer-outline-frame-title <span class=
"org-string">"Plan"</span>)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[default: "Outline"]</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-11-6" class="outline-4">
          <h4 id="sec-28-11-6">OpenDocument Text (ODT)</h4>

          <div class="outline-text-4" id="text-28-11-6">
            <p>ODT export is not loaded by default. You will have to load it
            explicitly or to add it to <code>org-export-backends</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox-odt"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">convert "odt" format to "doc" format</span>
    (setq org-odt-preferred-output-format <span class=
"org-string">"doc"</span>))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-12" class="outline-3">
        <h3 id="sec-28-12">Publishing</h3>

        <div class="outline-text-3" id="text-28-12">
          <p>Publish related Org mode files as a website.</p>

          <div class="warning">
            <p>It can be used for generating different PDF files from the same
            source file… See <a href=
            "http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-9-2">
            9.2 The Multiple Export Case</a>.</p>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 13 (info "(org)Publishing")</span>

  (leuven--section <span class="org-string">"13 (org)Publishing"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ox-publish"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show message about files *not* published</span>
    (setq org-publish-list-skipped-files nil)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-12-1" class="outline-4">
          <h4 id="sec-28-12-1">Uploading files</h4>

          <div class="outline-text-4" id="text-28-12-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 13.2 always publish all files</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; (do not use time stamp checking for skipping unmodified files)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq org-publish-use-timestamps-flag nil)</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-12-2" class="outline-4">
          <h4 id="sec-28-12-2">Triggering publication</h4>

          <div class="outline-text-4" id="text-28-12-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">13.4 force publishing all files</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">org-publish-all-force</span> ()
      (interactive)
      (org-publish-all t)))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-13" class="outline-3">
        <h3 id="sec-28-13">Working With Source Code</h3>

        <div class="outline-text-3" id="text-28-13">
          <p>Literate programming and reproducible research.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 14 (info "(org)Working With Source Code")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ob-core"</span>
</pre>
          </div>

          <p>Automate the redisplay of inline images, so that the images are
          always up-to-date.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make the images in the Emacs buffer automatically refresh after</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">execution</span>
    (add-hook 'org-babel-after-execute-hook
              (<span class="org-keyword">lambda</span> ()
                (org-display-inline-images nil t)))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">more efficient with refresh == t</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-babel-next-src-block</span>
      (after leuven-org-babel-next-src-block activate)
      <span class=
"org-doc">"Recenter after jumping to the next source block."</span>
      (recenter))

    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-babel-previous-src-block</span>
      (after leuven-org-babel-previous-src-block activate)
      <span class=
"org-doc">"Recenter after jumping to the previous source block."</span>
      (recenter))
    )
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-agenda-switch-to</span>
      (after leuven-org-agenda-switch-to activate)
      <span class=
"org-doc">"Recenter after jumping to the file which contains the item at point."</span>
      (recenter))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(with-eval-after-load "ob-shell"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; command used to invoke a shell</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(setq org-babel-sh-command "bash")  ; now uses `</span><span class="org-comment"><span class="org-constant">shell-file-name</span></span><span class="org-comment">' throughout (2013-12-14)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; use plain old syntax (instead of `$(...)') for Cygwin</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(setq org-babel-sh-var-quote-fmt</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">"`cat &lt;&lt;'BABEL_TABLE'\n%s\nBABEL_TABLE\n`"))</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-13-1" class="outline-4">
          <h4 id="sec-28-13-1">Editing source code</h4>

          <div class="outline-text-4" id="text-28-13-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.2 (info "(org)Editing source code")</span>

  (leuven--section <span class=
"org-string">"14.2 (org)Editing source code"</span>)
</pre>
            </div>

            <p>Mapping between languages (listings in LaTeX) and their major
            mode (in Emacs).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-src"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mapping languages to their major mode (for editing the source code block</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">with `C-c '')</span>
    (add-to-list 'org-src-lang-modes
                 '(<span class="org-string">"dot"</span> . graphviz-dot)))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the source code edit buffer in the current window, keeping</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">all other windows</span>
  (setq org-src-window-setup 'current-window)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Bind this to the correct keys</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-babel-expand-src-block</span> ()
    (interactive)
    (<span class=
"org-keyword">let</span> ((org-src-window-setup 'reorganize-frame))
      (org-babel-expand-src-block)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">indent the content of a source code block</span>
  (setq org-edit-src-content-indentation 2)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fontify code in code blocks (highlight syntax in the Org buffer)</span>
  (setq org-src-fontify-natively t)     <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! create overlay</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! `</span><span class="org-comment"><span class=
"org-constant">org-block-background</span></span><span class=
"org-comment">' and remove</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! text property `</span><span class="org-comment"><span class=
"org-constant">org-block</span></span><span class="org-comment">'</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">preserve spaces and `</span><span class=
"org-comment"><span class="org-constant">tab</span></span><span class=
"org-comment">' characters in source code blocks</span>
  (setq org-src-preserve-indentation t) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">or add a `</span><span class="org-comment"><span class=
"org-constant">-i</span></span><span class=
"org-comment">' flag to you source block</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">same effect for `</span><span class="org-comment"><span class=
"org-constant">tab</span></span><span class=
"org-comment">' as in the language major mode buffer</span>
  (setq org-src-tab-acts-natively t)


  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(message "... Org Editing source code")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; allow indent region in the code edit buffer (according to language)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(defun leuven-org-indent-region (&amp;optional arg)</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(interactive "P")</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(or (org-babel-do-key-sequence-in-edit-buffer (kbd "C-M-\\"))</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">(indent-region arg)))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; make `C-c C-v C-x C-M-\' more convenient</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(define-key org-mode-map</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(kbd "C-M-\\") 'leuven-org-indent-region))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prevent auto-filling in src blocks</span>
  (setq org-src-prevent-auto-filling t)

  (global-set-key
    (kbd <span class=
"org-string">"C-c C-v C-d"</span>) 'org-babel-demarcate-block)
</pre>
            </div>

            <p>C-c TAB Toggle the visibility of existing tags in the buffer.
            This can be used as a cheap preview (sgml-tags-invisible).</p>

            <p>View just the source-code blocks within the current Org-babel
            file (something logically equivalent to “tangle”, but without
            creating a separate file).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">only-code-overlays</span> nil
    <span class="org-doc">"Overlays hiding non-code blocks."</span>)
  (make-variable-buffer-local 'only-code-overlays)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">hide-non-code</span> ()
    <span class=
"org-doc">"Hide non-code-block content of the current Org mode buffer."</span>
    (interactive)
    (add-to-invisibility-spec '(non-code))
    (<span class="org-keyword">let</span> (begs ends)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (<span class=
"org-keyword">while</span> (re-search-forward org-babel-src-block-regexp nil t)
          (push (match-beginning 5) begs)
          (push (match-end 5)       ends))
        (map 'list (<span class="org-keyword">lambda</span> (beg end)
                     (<span class=
"org-keyword">let</span> ((ov (make-overlay beg end)))
                       (push ov only-code-overlays)
                       (overlay-put ov 'invisible 'non-code)))
             (cons (point-min) (reverse ends))
             (append (reverse begs) (list (point-max)))))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">show-non-code</span> ()
    <span class=
"org-doc">"Show non-code-block content of the current Org mode buffer."</span>
    (interactive)
    (mapc 'delete-overlay only-code-overlays))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-13-2" class="outline-4">
          <h4 id="sec-28-13-2">Evaluating code blocks</h4>

          <div class="outline-text-4" id="text-28-13-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.5 (info "(org)Evaluating code blocks")</span>

  (leuven--section <span class=
"org-string">"14.5 (org)Evaluating code blocks"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">I don't want to execute code blocks with `C-c C-c' (evaluate code</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">block only with `C-c C-v e')</span>
  (setq org-babel-no-eval-on-ctrl-c-ctrl-c t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">languages for which Org-babel will raise literate programming errors when</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">noweb references can not be resolved.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ob-core"</span>
    (add-to-list 'org-babel-noweb-error-langs <span class=
"org-string">"emacs-lisp"</span>))
</pre>
            </div>

            <p>Write error messages to the Messages buffer for invalid
            <code>org-sbe</code> calls.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">debugging sbe calls</span>
  (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-sbe</span> (around get-err-msg activate)
    <span class="org-doc">"Issue messages at errors."</span>
    (<span class="org-keyword">condition-case</span> err
        (<span class="org-keyword">progn</span>
      ad-do-it)
      (<span class="org-warning">error</span>
       (message <span class="org-string">"Error in org-sbe: %S"</span> err)
       (<span class="org-warning">signal</span> (car err) (cdr err)))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-13-3" class="outline-4">
          <h4 id="sec-28-13-3">Library of Babel</h4>

          <div class="outline-text-4" id="text-28-13-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.6 (info "(org)Library of Babel")</span>

  (leuven--section <span class=
"org-string">"14.6 (org)Library of Babel"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load the NAMED code blocks defined in Org mode files into the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">library of Babel (global `</span><span class=
"org-comment"><span class=
"org-constant">org-babel-library-of-babel</span></span><span class=
"org-comment">' variable)</span>
    (<span class=
"org-keyword">let</span> ((lob-file (concat (file-name-directory (locate-library <span class="org-string">"org"</span>))
                            <span class=
"org-string">"../doc/library-of-babel.org"</span>)))
      (<span class="org-keyword">when</span> (file-exists-p lob-file)
        (org-babel-lob-ingest lob-file))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-13-4" class="outline-4">
          <h4 id="sec-28-13-4">Languages</h4>

          <div class="outline-text-4" id="text-28-13-4">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ob-exp"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">template used to export the body of code blocks</span>
    (setq org-babel-exp-code-template
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(concat "\n==:\n"</span>
                  org-babel-exp-code-template)
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">)</span>
    )

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keep lower-case</span>
  (setq org-babel-results-keyword <span class="org-string">"results"</span>)
</pre>
            </div>

            <p>Customize the <code>org-babel-load-languages</code> variable to
            enable support for languages which can be evaluated in Org mode
            buffers.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 14.7 (info "(org)Languages")</span>

  (leuven--section <span class="org-string">"14.7 (org)Languages"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Test executable-find (of Rterm, gnuplot, ruby, etc.) before</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">setting language to yes...</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Languages"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">configure Babel to support most languages</span>
    (<span class="org-keyword">if</span> (locate-library <span class=
"org-string">"ob-shell"</span>)     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">ob-sh renamed on Dec 13th, 2013</span>
        (org-babel-do-load-languages    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">loads org, gnus-sum, etc...</span>
         'org-babel-load-languages
         '((R          . t)             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">requires R and ess-mode</span>
           (awk        . t)
           (ditaa      . t)             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">sudo aptitude install openjdk-6-jre</span>
           (dot        . t)
           (emacs-lisp . t)
           <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(latex   . t)             ; shouldn't you use #+begin/end_latex blocks instead?</span>
           (ledger     . t)             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">requires ledger</span>
           (org        . t)
           (shell      . t)
           (sql        . t)))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> (in the future) message saying "Upgrade to Org 8.3"</span>
      (org-babel-do-load-languages
       'org-babel-load-languages
       '((R          . t)
         (awk        . t)
         (ditaa      . t)
         (dot        . t)
         (emacs-lisp . t)
         <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(latex   . t)</span>
         (ledger     . t)
         (org        . t)
         (sh         . t)
         (sql        . t))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">accented characters on graphics</span>
    (setq org-babel-R-command
          (concat org-babel-R-command <span class=
"org-string">" --encoding=UTF-8"</span>)))
</pre>
            </div>

            <p><code>screen</code> offers support for interactive terminals.
            Mostly shell scripts. Heavily inspired by <code>eev</code>.</p>

            <p>Eric Schulte believes screen has more of a focus on sustained
            interaction with an interactive terminal.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-13-5" class="outline-4">
          <h4 id="sec-28-13-5">Prettier (or at least fancier) code block
          delimiters</h4>

          <div class="outline-text-4" id="text-28-13-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">prettier-org-code-blocks</span> ()
      (interactive)
      (font-lock-add-keywords nil
        '((<span class="org-string">"</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">\+begin_src</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>
           (0 (<span class=
"org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?¦)
                     nil)))
          (<span class="org-string">"</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">\+end_src</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>
           (0 (<span class=
"org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?¦)
                     nil))))))

    (add-hook 'org-mode-hook 'prettier-org-code-blocks)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-14" class="outline-3">
        <h3 id="sec-28-14">Miscellaneous</h3>

        <div class="outline-text-3" id="text-28-14">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 15 (info "(org)Miscellaneous")</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">from Dan Davison</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-switch-to-org-scratch</span> ()
    <span class=
"org-doc">"Switch to a temp Org buffer.  If the region is active, insert it."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((contents (and (region-active-p)
                         (buffer-substring (region-beginning)
                                           (region-end)))))
      (find-file <span class="org-string">"/tmp/org-scratch.org"</span>)
      (<span class="org-keyword">if</span> contents (insert contents))))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-28-14-1" class="outline-4">
          <h4 id="sec-28-14-1">Ispell</h4>

          <div class="outline-text-4" id="text-28-14-1">
            <div class="note">
              <p>The <code>leuven--org-switch-dictionary</code> function is
              called as well on each code block (at least, in emails that are
              being read), in buffers called <code>*fontification*</code>.</p>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-switch-dictionary</span> ()
    <span class=
"org-doc">"Set language if Flyspell is enabled and `#+LANGUAGE:' is on top 8 lines."</span>
    (<span class=
"org-keyword">when</span> (and (boundp 'ispell-dictionary-alist)
               ispell-dictionary-alist)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (forward-line 8)
        (<span class="org-keyword">let</span> (lang dict
              (dict-alist '((<span class=
"org-string">"en"</span> . <span class="org-string">"american"</span>)
                            (<span class=
"org-string">"fr"</span> . <span class="org-string">"francais"</span>))))
          (<span class=
"org-keyword">when</span> (re-search-backward <span class=
"org-string">"#\\+LANGUAGE: +</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[[:alpha:]_]*</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span> 1 t)
            (setq lang (match-string 1))
            (setq dict (cdr (assoc lang dict-alist)))
            (<span class="org-keyword">if</span> dict
                (<span class="org-keyword">progn</span>
                  (ispell-change-dictionary dict)
                  (force-mode-line-update))
              (message <span class=
"org-string">"No Ispell dictionary for language `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">' (see file `</span><span class="org-string"><span class=
"org-constant">%s</span></span><span class="org-string">')"</span>
                       lang (file-name-base))
              (sit-for 1.5)))))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">guess dictionary</span>
  (add-hook 'org-mode-hook 'leuven--org-switch-dictionary)
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%">
                  <b>Avoid (error “Undefined dictionary: american”)</b><br />

                  <p>when dictionaries are not installed. IN FACT, ISPELL IS
                  NOT AT ALL INSTALLED!</p>

                  <p>Check out for valid dictionaries: (append
                  ispell-local-dictionary-alist ispell-dictionary-alist)</p>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div id="outline-container-sec-28-14-2" class="outline-4">
          <h4 id="sec-28-14-2">Easy templates</h4>

          <div class="outline-text-4" id="text-28-14-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.2 (info "(org)Easy Templates")</span>

  (leuven--section <span class="org-string">"15.2 (org)Easy Templates"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Easy Templates"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">modify `</span><span class="org-comment"><span class=
"org-constant">org-structure-template-alist</span></span><span class=
"org-comment">' to keep lower-case easy templates</span>
    (mapc (<span class="org-keyword">lambda</span> (asc)
            (<span class=
"org-keyword">let</span> ((org-sce-dc (downcase (nth 1 asc))))
              (setf (nth 1 asc) org-sce-dc)))
          org-structure-template-alist)

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"E"</span> <span class=
"org-string">"\\begin\{equation\}\n?\n\\end\{equation\}"</span> <span class=
"org-string">""</span>))

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"C"</span> <span class=
"org-string">"#+begin_comment\n?\n#+end_comment"</span>)))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-14-3" class="outline-4">
          <h4 id="sec-28-14-3">Speed keys</h4>

          <div class="outline-text-4" id="text-28-14-3">
            <p>Activate single letter commands (for example, outline navigation
            with <code>f</code>, <code>b</code>, <code>n</code>, and
            <code>p</code>) at beginning of a headline:</p>

            <dl class="org-dl">
              <dt><code>f</code></dt>

              <dd><code>org-forward-same-level</code>.</dd>

              <dt><code>b</code></dt>

              <dd><code>org-backward-same-level</code>.</dd>

              <dt><code>n</code></dt>

              <dd><code>outline-next-visible-heading</code>.</dd>

              <dt><code>p</code></dt>

              <dd><code>outline-previous-visible-heading</code>.</dd>
            </dl>

            <p>For navigating blocks:</p>

            <dl class="org-dl">
              <dt>F</dt>

              <dd><code>org-next-block</code>.</dd>

              <dt>B</dt>

              <dd><code>org-previous-block</code>.</dd>
            </dl>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.3 (info "(org)Speed keys")</span>

  (leuven--section <span class="org-string">"15.3 (org)Speed keys"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Speek keys"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate single letter commands at beginning of a headline</span>
    (setq org-use-speed-commands t)

    (add-to-list 'org-speed-commands-user '(<span class=
"org-string">"d"</span> org-todo <span class="org-string">"DONE"</span>))
    (add-to-list 'org-speed-commands-user '(<span class=
"org-string">"y"</span> org-todo-yesterday <span class=
"org-string">"DONE"</span>))
</pre>
            </div>
          </div>

          <div id="outline-container-sec-28-14-3-1" class="outline-5">
            <h5 id="sec-28-14-3-1">Convert Windows Apps key to Hyper</h5>

            <div class="outline-text-5" id="text-28-14-3-1">
              <p>Here are more obvious key bindings (than <code>C-c C-v
              C-e</code> and company) using “hyper”:</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (setq w32-pass-apps-to-system nil)
    (setq w32-apps-modifier 'hyper) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Apps key</span>

    (define-key org-mode-map
      (kbd <span class="org-string">"H-e"</span>) 'org-babel-execute-maybe)
    (define-key org-mode-map
      (kbd <span class="org-string">"H-t"</span>) 'org-babel-tangle)

    )
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-14-4" class="outline-4">
          <h4 id="sec-28-14-4">Code evaluation and security issues</h4>

          <div class="outline-text-4" id="text-28-14-4">
            <p>For security reasons, evaluation is not turned on by
            default.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.4 (info "(org)Code evaluation security") issues</span>

  (leuven--section <span class=
"org-string">"15.4 (org)Code evaluation security issues"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ob-core"</span>

    <span class="org-comment-delimiter">;;</span><span class=
"org-comment">!! don't be prompted on every code block evaluation</span>
    (setq org-confirm-babel-evaluate nil))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-14-5" class="outline-4">
          <h4 id="sec-28-14-5">A cleaner outline view</h4>

          <div class="outline-text-4" id="text-28-14-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.8 A (info "(org)Clean view")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Clean view"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">15.8 don't skip even levels for the outline</span>
    (setq org-odd-levels-only nil))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-14-6" class="outline-4">
          <h4 id="sec-28-14-6"><a id="ID-366386cb-9c4f-4d61-b676-e742e6277587"
          name="ID-366386cb-9c4f-4d61-b676-e742e6277587"></a>Interaction with
          other packages</h4>

          <div class="outline-text-4" id="text-28-14-6">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 15.10 (info "(org)Interaction")</span>

  (leuven--section <span class="org-string">"15.10 (org)Interaction"</span>)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum level for Imenu access to Org-mode headlines</span>
    (setq org-imenu-depth 3)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">extension of Imenu</span>
    (<span class=
"org-keyword">when</span> (and (fboundp 'org-babel-execute-src-block) <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-babel</span></span><span class="org-comment">' has been</span>
                                                      <span class=
"org-comment-delimiter">; </span><span class="org-comment">loaded</span>
               (fboundp 'try-to-add-imenu)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class="org-constant">imenu</span></span><span class=
"org-comment">' has been loaded</span>

      (setq org-src-blocks-imenu-generic-expression
            `((<span class=
"org-string">"Snippets"</span> ,org-babel-src-name-w-name-regexp 2)))

      (add-hook 'org-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (setq imenu-generic-expression
                        org-src-blocks-imenu-generic-expression))))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">alternative to imenu</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">dan/find-in-buffer</span> ()
      (interactive)
      (<span class="org-keyword">let</span> ((targets
             `((<span class=
"org-string">"&lt;named src blocks&gt;"</span> . ,org-babel-src-name-regexp)
               (<span class=
"org-string">"&lt;src block results&gt;"</span> . ,org-babel-result-regexp))))
        (occur
         (cdr
          (assoc
           (completing-read <span class=
"org-string">"Find: "</span> (mapcar #'car targets)) targets)))
        (other-window 1))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-14-7" class="outline-4">
          <h4 id="sec-28-14-7">Org-crypt</h4>

          <div class="outline-text-4" id="text-28-14-7">
            <p>Org-crypt provides for encrypting individual entries in an
            otherwise non-encrypted file.</p>

            <p>To later decrypt an entry that’s encrypted, use <code>M-x
            org-decrypt-entry</code> or <code>C-c C-r</code> (fits nicely with
            the meaning of “reveal”).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keep my encrypted data (like account passwords) in my Org mode</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">files with a special tag instead</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Crypt"</span>)

    (<span class=
"org-keyword">when</span> (try-require 'org-crypt)      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">loads org, gnus-sum, etc...</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">encrypt all entries before saving</span>
      (org-crypt-use-before-save-magic)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">which tag is used to mark headings to be encrypted</span>
      (setq org-tags-exclude-from-inheritance '(<span class=
"org-string">"crypt"</span>))))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-15" class="outline-3">
        <h3 id="sec-28-15">Other</h3>

        <div class="outline-text-3" id="text-28-15">
          <p>Anonymize Org contents.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-scramble-contents</span> ()
    (interactive)
    (<span class="org-keyword">let</span> ((tree (org-element-parse-buffer)))
      (org-element-map tree '(code comment comment-block example-block fixed-width
                                   keyword link node-property plain-text verbatim)
        (<span class="org-keyword">lambda</span> (obj)
          (case (org-element-type obj)
            ((code comment comment-block example-block fixed-width keyword
                   node-property verbatim)
             (<span class=
"org-keyword">let</span> ((value (org-element-property <span class=
"org-builtin">:value</span> obj)))
               (org-element-put-property
                obj <span class=
"org-builtin">:value</span> (replace-regexp-in-string <span class=
"org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> value))))
            (link
             (<span class=
"org-keyword">unless</span> (string= (org-element-property <span class=
"org-builtin">:type</span> obj) <span class="org-string">"radio"</span>)
               (org-element-put-property obj <span class=
"org-builtin">:raw-link</span> <span class=
"org-string">"http://orgmode.org"</span>)))
            (plain-text
             (org-element-set-element
              obj (replace-regexp-in-string <span class=
"org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> obj)))))
        nil nil nil t)
      (<span class=
"org-keyword">let</span> ((buffer (get-buffer-create <span class=
"org-string">"*Scrambled text*"</span>)))
        (<span class="org-keyword">with-current-buffer</span> buffer
          (insert (org-element-interpret-data tree))
          (goto-char (point-min)))
        (switch-to-buffer buffer))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't pad tangled code with newlines</span>
  (setq org-babel-tangle-pad-newline nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">how to combine blocks of the same name during tangling</span>
  (setq org-babel-tangle-named-block-combination 'append)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">speed up tangling dramatically (a couple of orders of magnitude)</span>
  (setq org-babel-use-quick-and-dirty-noweb-expansion t)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">:noweb-ref feature must NOT be used!</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minimum number of lines for output *block* (placed in a</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">#+begin_example...#+end_example) vs. output marked as literal by</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">inserting a *colon* at the beginning of the lines</span>
  (setq org-babel-min-lines-for-block-output 2)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; </span><span class="org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class=
"org-comment"> Make this the default behavior</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; grab the last line too, when selecting a subtree</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(org-end-of-subtree nil t)</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">backend aware export preprocess hook</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--org-export-preprocess-hook</span> ()
    <span class="org-doc">"Backend-aware export preprocess hook."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class=
"org-keyword">when</span> (eq org-export-current-backend 'latex)
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ignoreheading tag for bibliographies and appendices</span>
        (<span class="org-keyword">let*</span> ((tag <span class=
"org-string">"ignoreheading"</span>))
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(goto-char (point-min))</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(while (re-search-forward (concat ":" tag ":") nil t)</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(delete-region (point-at-bol) (point-at-eol)))</span>
          (org-map-entries
           (<span class="org-keyword">lambda</span> ()
             (delete-region (point-at-bol) (point-at-eol)))
           (concat <span class="org-string">":"</span> tag <span class=
"org-string">":"</span>))))
      (<span class=
"org-keyword">when</span> (eq org-export-current-backend 'html)
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set custom css style class based on matched tag</span>
        (<span class="org-keyword">let*</span> ((match <span class=
"org-string">"Qn"</span>))
          (org-map-entries
           (<span class="org-keyword">lambda</span> ()
             (org-set-property <span class=
"org-string">"HTML_CONTAINER_CLASS"</span> <span class=
"org-string">"inlinetask"</span>))
           match)))))

  (add-hook 'org-export-preprocess-hook 'leuven--org-export-preprocess-hook)
</pre>
          </div>

          <p>Promote ignoreheading. Works in ASCII backend too:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">yz/org-export-ignore-headline</span> (backend)
    <span class="org-doc">"Ignore headlines with tag `</span><span class=
"org-doc"><span class="org-constant">ignoreheading</span></span><span class=
"org-doc">'."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class=
"org-keyword">let</span> ((org-allow-promoting-top-level-subtree t))
        (org-map-entries
         (<span class="org-keyword">lambda</span> ()
           (<span class="org-keyword">when</span> (member <span class=
"org-string">"ignoreheading"</span> (org-get-tags-at nil 'local))
             (org-promote-subtree)
             (delete-region (line-beginning-position) (line-end-position))))))))

  (add-hook 'org-export-before-parsing-hook 'yz/org-export-ignore-headline)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">insert-one-equal-or-two</span> ()
    (interactive)
    (<span class="org-keyword">cond</span>
     ((or (bolp) (not (looking-back <span class="org-string">"="</span>)))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert just one =</span>
      (self-insert-command 1))
     ((<span class="org-keyword">save-excursion</span>
        (backward-char)
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Skip symbol backwards.</span>
        (and (not (zerop (skip-syntax-backward <span class=
"org-string">"w_"</span>)))
             (not (looking-back <span class="org-string">"="</span>))
             (or (insert-and-inherit <span class="org-string">"="</span>) t))))
     (t
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert == around following symbol</span>
      (delete-char -1)
      (<span class="org-keyword">unless</span> (looking-back <span class=
"org-string">"="</span>) (insert-and-inherit <span class=
"org-string">"="</span>))
      (<span class="org-keyword">save-excursion</span>
        (skip-syntax-forward <span class="org-string">"w_"</span>)
        (<span class="org-keyword">unless</span> (looking-at <span class=
"org-string">"="</span>) (insert-and-inherit <span class=
"org-string">"="</span>))))))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">must be in eval-after-load "org"?</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(define-key org-mode-map</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(kbd "=") 'insert-one-equal-or-two)</span>
</pre>
          </div>

          <p>Export the current subtree into an email body, using
          <b>properties</b> to populate the mail message:</p>

          <ul class="org-ul">
            <li><code>MAIL_SUBJECT</code> or subtree heading -&gt;
            “Subject”</li>

            <li><code>MAIL_TO</code> -&gt; “To”</li>

            <li><code>MAIL_CC</code> -&gt; “Cc</li>

            <li><code>MAIL_BCC</code> -&gt; “BCc”</li>

            <li><code>MAIL_FMT</code> -&gt; determines the format of the email
            (e.g., <code>org</code> by default, <code>ascii</code> or
            <code>html</code>)</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Mime"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">using Org mode to send buffer/subtree per mail</span>
    (<span class="org-keyword">when</span> (try-require 'org-mime)

      (add-hook 'org-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (local-set-key
                    (kbd <span class=
"org-string">"C-c m"</span>) 'org-mime-subtree)))

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-mail-subtree</span> ()
        (interactive)
        (org-agenda-goto)
        (org-mime-subtree))

      (add-hook 'org-agenda-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (local-set-key
                    (kbd <span class=
"org-string">"C-c m"</span>) 'leuven-mail-subtree)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a `</span><span class="org-comment"><span class=
"org-constant">mail_composed</span></span><span class=
"org-comment">' property with the current time when</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">org-mime-subtree</span></span><span class=
"org-comment">' is called</span>
      (add-hook 'org-mime-send-subtree-hook
                (<span class="org-keyword">lambda</span> ()
                  (org-entry-put (point) <span class=
"org-string">"mail_composed"</span>
                                 (current-time-string))))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-16" class="outline-3">
        <h3 id="sec-28-16">A.3 Adding hyperlink types</h3>

        <div class="outline-text-3" id="text-28-16">
          <p>For more flexibility, you can use a URL-like syntax which could
          then export conditionally on the output format.</p>

          <p>See <a href=
          "http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3">
          http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3</a></p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** A.3 (info "(org)Adding hyperlink types")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class="org-string">"... Org Adding hyperlink types"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">define a new link type (`</span><span class=
"org-comment"><span class="org-constant">latex</span></span><span class=
"org-comment">') whose path argument can hold the name of</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">any LaTeX command</span>
    (org-add-link-type
     <span class="org-string">"latex"</span> nil
     (<span class="org-keyword">lambda</span> (path desc format)
       (<span class="org-keyword">cond</span>
        ((eq format 'html)
         (format <span class=
"org-string">"&lt;span class=\"%s\"&gt;%s&lt;/span&gt;"</span> path desc))
        ((eq format 'latex)
         (format <span class="org-string">"\\%s{%s}"</span> path desc)))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add background color by using custom links like [[bgcolor:red][Warning!]]</span>
    (org-add-link-type
      <span class="org-string">"bgcolor"</span> nil
      (<span class="org-keyword">lambda</span> (path desc format)
       (<span class="org-keyword">cond</span>
        ((eq format 'html)
         (format <span class=
"org-string">"&lt;span style=\"background-color:%s;\"&gt;%s&lt;/span&gt;"</span> path desc))
        ((eq format 'latex)
         (format <span class=
"org-string">"\\colorbox{%s}{%s}"</span> path desc))
        (t
         (format <span class=
"org-string">"BGCOLOR LINK (%s): {%s}{%s}"</span> format path desc))))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-17" class="outline-3">
        <h3 id="sec-28-17">A.5 Tables and lists in arbitrary syntax</h3>

        <div class="outline-text-3" id="text-28-17">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-send-all-buffer-tables</span> ()
    <span class=
"org-doc">"Export all Org tables of the LaTeX document to their corresponding LaTeX tables."</span>
     (interactive)
     (org-table-map-tables
        (<span class=
"org-keyword">lambda</span> () (orgtbl-send-table 'maybe))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-18" class="outline-3">
        <h3 id="sec-28-18">A.6 Dynamic blocks</h3>

        <div class="outline-text-3" id="text-28-18">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** A.6 (info "(org)Dynamic blocks")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org"</span>
    (message <span class=
"org-string">"... Org Update dynamic blocks and tables"</span>)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-org-update-buffer</span> ()
      <span class=
"org-doc">"Update all dynamic blocks and all tables in the buffer."</span>
      (interactive)
      (<span class="org-keyword">when</span> (eq major-mode 'org-mode)
        (message <span class="org-string">"(Info) Update Org buffer %s"</span>
                 (file-name-nondirectory (buffer-file-name)))
        (sit-for 1.5)
        (<span class=
"org-keyword">let</span> ((flyspell-mode-before-save flyspell-mode))
          (flyspell-mode -1)              <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">temporarily disable Flyspell to</span>
                                          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">avoid checking the following</span>
                                          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">modifications of the buffer</span>
          (org-align-all-tags)
          (org-update-all-dblocks)
          (org-table-iterate-buffer-tables)
          (<span class=
"org-keyword">when</span> (file-exists-p (buffer-file-name (current-buffer)))
            (leuven-org-remove-redundant-tags))
          (<span class=
"org-keyword">when</span> flyspell-mode-before-save (flyspell-mode 1)))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make sure that all dynamic blocks and all tables are always</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">up-to-date</span>
    (add-hook 'before-save-hook 'leuven-org-update-buffer)
    (message <span class=
"org-string">"Add leuven-org-update-buffer to before-save-hook  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-28-19" class="outline-3">
        <h3 id="sec-28-19">Org-contrib</h3>

        <div class="outline-text-3" id="text-28-19"></div>

        <div id="outline-container-sec-28-19-1" class="outline-4">
          <h4 id="sec-28-19-1">Org-effectiveness</h4>

          <div class="outline-text-4" id="text-28-19-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(message "... Org Effectiveness")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(when (try-require 'org-effectiveness)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(add-hook 'org-mode-hook</span>
  <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(org-effectiveness-count-todo)</span>
  <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">(sit-for 0.2)))))</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-28-19-2" class="outline-4">
          <h4 id="sec-28-19-2">Org-notmuch</h4>

          <div class="outline-text-4" id="text-28-19-2">
            <p>Link emails from Org files.</p>
          </div>
        </div>

        <div id="outline-container-sec-28-19-3" class="outline-4">
          <h4 id="sec-28-19-3">Google Weather</h4>

          <div class="outline-text-4" id="text-28-19-3">
            <pre class="example">
* Weather
  :PROPERTIES:
  :CATEGORY: Weather
  :END:

%%(org-google-weather "Lille" "en-gb")
</pre>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add weather forecast in your Org agenda</span>
    (autoload 'org-google-weather <span class=
"org-string">"org-google-weather"</span>
      <span class=
"org-doc">"Return Org entry with the weather for LOCATION in LANGUAGE."</span> t)

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"org-google-weather"</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'url)</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add the city</span>
      (setq org-google-weather-format <span class=
"org-string">"%C %i %c, %l°-%h°"</span>)))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 25.9-org-mode ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-29" class="outline-2">
      <h2 id="sec-29">TeX</h2>

      <div class="outline-text-2" id="text-29">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.10 (info "(emacs)TeX Mode")</span>

(leuven--chapter leuven-chapter-25.10-tex-mode <span class=
"org-string">"25.10 TeX Mode"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-29-1" class="outline-3">
        <h3 id="sec-29-1">Native TeX Mode</h3>

        <div class="outline-text-3" id="text-29-1">
          <dl class="org-dl">
            <dt>(la)tex-mode</dt>

            <dd>Default Emacs built-in (La)TeX mode (menu <code>TeX</code>;
            text <code>LaTeX</code> displayed in the mode line).</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"25.10 (emacs)TeX Mode"</span>)
</pre>
          </div>

          <p>Under Windows, in the <b>native</b> TeX mode,
          <code>shell-file-name</code> must be <code>cmdproxy.exe</code>
          to:</p>

          <ul class="org-ul">
            <li>avoid the error “comint-send-string: writing to process:
            invalid argument, tex-shell”, and</li>

            <li>properly quote <code>tex-start-commands</code>.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get colored PDFLaTeX output</span>
  (<span class="org-keyword">define-derived-mode</span> <span class=
"org-function-name">latex-output-mode</span> fundamental-mode <span class=
"org-string">"LaTeX-Output"</span>
    <span class="org-doc">"Simple mode for colorizing LaTeX output."</span>
    (set (make-local-variable 'font-lock-defaults)
         '(((<span class="org-string">"^!.*"</span> .
             compilation-error-face)    <span class=
"org-comment-delimiter">; </span><span class="org-comment">LaTeX error</span>
            (<span class="org-string">"^-+$"</span> .
             compilation-info-face)     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Latexmk separator</span>
            (<span class="org-string">"^Package .* Warning: .*"</span> .
             compilation-warning-face)
            (<span class="org-string">"Reference .* undefined"</span> .
             compilation-warning-face)
            (<span class="org-string">"^</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(?:</span></span><span class=
"org-string">Overfull</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Underfull</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Tight</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Loose</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">.*"</span> .
             font-lock-string-face)
            (<span class="org-string">"^LaTeX Font Warning:"</span> .
             font-lock-string-face)
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">...</span>
            ))))

  (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">TeX-recenter-output-buffer</span>
    (after leuven-colorize-latex-output activate)
    (<span class=
"org-keyword">with-selected-window</span> (get-buffer-window (TeX-active-buffer))
      (latex-output-mode)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-29-2" class="outline-3">
        <h3 id="sec-29-2">AUCTeX</h3>

        <div class="outline-text-3" id="text-29-2">
          <dl class="org-dl">
            <dt>(La)TeX-mode</dt>

            <dd>AUCTeX (menus <code>Preview</code>, <code>LaTeX</code>,
            <code>Command</code> and <code>Ref</code>; text
            <code>LaTeX/P</code> displayed in the mode line).</dd>
          </dl>

          <p>AUCTeX supports TeX and extensions such as LaTeX. For LaTeX, there
          is a (major) <code>LaTeX-mode</code> in AUCTeX which runs (in this
          order):</p>

          <ol class="org-ol">
            <li><code>text-mode-hook</code>, then</li>

            <li><code>TeX-mode-hook</code>, and then</li>

            <li>a hook <code>LaTeX-mode-hook</code> special to the LaTeX
            mode.</li>
          </ol>

          <p>If you need to make a customization via a hook which is only
          relevant for the LaTeX mode, put it into the
          <code>LaTeX-mode-hook</code>; if it is relevant for any AUCTeX mode,
          add it to <code>TeX-mode-hook</code> and if it is relevant for all
          text modes, append it to <code>text-mode-hook</code>.</p>

          <p>AUCTeX defines the <code>tex-mode.el</code> mode names as alias of
          its own modes: it aliases <code>(la)tex-mode</code> to
          <code>(La)TeX-mode</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"25.10 (emacs)AUCTeX Mode"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 1.2 (info "(auctex)Installation") of AUCTeX</span>

  (try-require 'tex-site)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">support for LaTeX documents</span>
  (GNUEmacs
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"latex"</span>
</pre>
          </div>

          <p>You can detect the <b>successful activation of AUCTeX</b>: after
          loading a LaTeX file, AUCTeX gives you a <code>Command</code>
          menu.</p>

          <ul class="org-ul">
            <li>Press <code>C-c C-c File &lt;RET&gt; &lt;RET&gt;</code> to run
            <code>dvips</code> (note that the command is <code>File</code> and
            not <code>Dvips</code> as one might expect)</li>

            <li>Press <code>C-c C-c Print &lt;RET&gt; &lt;RET&gt;</code> to run
            <code>GSview</code> (also somewhat misleading name)</li>

            <li>If you want to print the document, do it from
            <code>GSview</code>.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; LaTeX-sensitive spell checking</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'tex-mode-hook</span>
      <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(lambda ()</span>
      <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(make-local-variable 'ispell-parser)</span>
      <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(setq ispell-parser 'tex)))</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 2.6 (info "(auctex)Completion")</span>

      (leuven--section <span class=
"org-string">"2.6 (auctex)Completion"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">if this is non-nil when AUCTeX is loaded, the TeX escape</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">character `\' will be bound to `</span><span class=
"org-comment"><span class=
"org-constant">TeX-electric-macro</span></span><span class=
"org-comment">'</span>
      (setq TeX-electric-escape t)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 2.8 (info "(auctex)Indenting")</span>

      (leuven--section <span class="org-string">"2.8 (auctex)Indenting"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">leave the `</span><span class="org-comment"><span class=
"org-constant">tikzpicture</span></span><span class=
"org-comment">' code unfilled when doing `</span><span class=
"org-comment"><span class="org-constant">M-q</span></span><span class=
"org-comment">'</span>
      (add-to-list 'LaTeX-indent-environment-list '(<span class=
"org-string">"tikzpicture"</span>))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-indentation (suggested by the AUCTeX manual -- instead of</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">adding a local key binding to `</span><span class=
"org-comment"><span class="org-constant">&lt;RET&gt;</span></span><span class=
"org-comment">' in the `</span><span class="org-comment"><span class=
"org-constant">LaTeX-mode-hook</span></span><span class="org-comment">')</span>
      (setq TeX-newline-function 'newline-and-indent)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 3 Controlling Screen (info "(auctex)Display")</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 3.1 (info "(auctex)Font Locking")</span>

      (leuven--section <span class=
"org-string">"3.1 (auctex)Font Locking"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(for Org mode) add the `</span><span class=
"org-comment"><span class="org-constant">comment</span></span><span class=
"org-comment">' environment to the variable</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">LaTeX-verbatim-environments</span></span><span class=
"org-comment">' so that, if the `#+TBLFM' line</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">contains an odd number of dollar characters, this does not</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cause problems with font-lock in LaTeX-mode</span>
      (add-to-list 'LaTeX-verbatim-environments <span class=
"org-string">"comment"</span>)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.1 Executing (info "(auctex)Commands")</span>

      (leuven--section <span class=
"org-string">"4.1 Executing (auctex)Commands"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a command to execute on the LaTeX document</span>
      (add-to-list 'TeX-command-list
                   '(<span class="org-string">"XeLaTeX"</span> <span class=
"org-string">"%`xelatex%(mode)%' %t"</span> TeX-run-TeX nil t))

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--LaTeX-mode-hook</span> ()
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default command to run in the LaTeX buffer</span>
        (setq TeX-command-default
              (<span class="org-keyword">save-excursion</span>
                (<span class="org-keyword">save-restriction</span>
                  (widen)
                  (goto-char (point-min))
                  (<span class="org-keyword">let</span> ((re (concat
                             <span class=
"org-string">"^\\s-*\\\\usepackage</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(?:</span></span><span class=
"org-string">\\[.*\\]</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">?"</span>
                             <span class=
"org-string">"{.*\\&lt;</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(?:</span></span><span class=
"org-string">font</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">math</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">spec\\&gt;.*}"</span>)))
                    (<span class="org-keyword">save-match-data</span>
                      (<span class=
"org-keyword">if</span> (re-search-forward re 3000 t)
                          <span class="org-string">"XeLaTeX"</span>
                        <span class="org-string">"LaTeX"</span>)))))))

      (add-hook 'LaTeX-mode-hook 'leuven--LaTeX-mode-hook)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't ask user for permission to save files before starting TeX</span>
      (setq TeX-save-query nil)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">TeX-default</span> ()
        <span class=
"org-doc">"Choose the default command from `C-c C-c'."</span>
        (interactive)
        (TeX-save-document <span class=
"org-string">""</span>)          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">or just use `</span><span class="org-comment"><span class=
"org-constant">TeX-save-query</span></span><span class="org-comment">'</span>
        (execute-kbd-macro (kbd <span class=
"org-string">"C-c C-c RET"</span>)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">rebind the "compile command" to default command from `C-c C-c'</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(in LaTeX mode only)</span>
      (define-key LaTeX-mode-map
        (kbd <span class="org-string">"&lt;f9&gt;"</span>) 'TeX-default)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use PDF mode by default (instead of DVI)</span>
      (setq-default TeX-PDF-mode t)
</pre>
          </div>

          <p>A decent viewer reloads the PDF automatically when the file has
          changed while staying on the same page (no need to close &amp;
          reopen).</p>

          <p>Support for forward search with PDF files means that the viewer
          jumps to the page in the output file corresponding to the position in
          the source file. Currently, this only works if you use the pdfsync
          LaTeX package and xpdf or SumatraPDF as your PDF viewer.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.2 (info "(auctex)Viewing") the formatted output</span>

      (leuven--section <span class=
"org-string">"4.2 (auctex)Viewing the formatted output"</span>)

      (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">sumatrapdf-command</span>
        (concat windows-program-files-dir <span class=
"org-string">"SumatraPDF/SumatraPDF.exe"</span>)
        <span class="org-doc">"Path to the SumatraPDF executable."</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use a saner PDF viewer (evince, SumatraPDF)</span>
      (setcdr (assoc <span class=
"org-string">"^pdf$"</span> TeX-output-view-style)
              (<span class="org-keyword">cond</span> (running-ms-windows
                     `(<span class="org-string">"."</span> (concat <span class=
"org-string">"\""</span> ,sumatrapdf-command <span class=
"org-string">"\" %o"</span>)))
                    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">under Windows, we could open the PDF file with</span>
                    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`start "" xxx.pdf' (in a command prompt)</span>
                    (t
                     '(<span class="org-string">"."</span> <span class=
"org-string">"evince %o"</span>))))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for AUCTeX 11.86+</span>
      (<span class="org-keyword">when</span> (boundp 'TeX-view-program-list)
        (add-to-list 'TeX-view-program-list
                     `(<span class="org-string">"SumatraPDF"</span>
                       (concat <span class=
"org-string">"\""</span> ,sumatrapdf-command <span class=
"org-string">"\" %o"</span>))))

      (<span class="org-keyword">when</span> running-ms-windows
        (setcdr (assoc 'output-pdf TeX-view-program-selection)
                '(<span class="org-string">"SumatraPDF"</span>)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4.7 (info "(auctex)Documentation")</span>
</pre>
          </div>

          <p><code>C-c ?</code> (or <code>M-x TeX-doc</code>) displays
          documentation for a package.</p>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%">
                <b>TeX-doc does not provide a list of available keywords for
                completion</b><br />

                <p>Nor a default when point is on a command name…</p>
              </td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.2 (info "(auctex)Multifile") Documents</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; assume that the file is a master file itself</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq-default TeX-master t)</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.3 Automatic (info "(auctex)Parsing Files")</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable parse on load (if no style hook is found for the file)</span>
      (setq TeX-parse-self t)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable automatic save of parsed style information when saving</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the buffer</span>
      (setq TeX-auto-save t)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 5.5 (info "(auctex)Automatic") Customization</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Add beamer.el to TeX-style-path</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.5.1 (info "(auctex)Automatic Global") Customization for the Site</span>

      (leuven--section <span class=
"org-string">"5.5.1 (auctex)Automatic Global Customization for the Site"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directory containing automatically generated TeX information</span>
      (setq TeX-auto-global
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">must end with a slash</span>
            <span class=
"org-string">"~/.emacs.d/auctex-auto-generated-info/"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.5.3 (info "(auctex)Automatic Local") Customization for a Directory</span>

      (leuven--section <span class=
"org-string">"5.5.3 (auctex)Automatic Local Customization for a Directory"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directory containing automatically generated TeX information</span>
      (setq TeX-auto-local <span class=
"org-string">"~/.emacs.d/auctex-auto-generated-info/"</span>)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">must end with a slash</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-29-3" class="outline-3">
        <h3 id="sec-29-3">Preview-LaTeX</h3>

        <div class="outline-text-3" id="text-29-3">
          <p>You can detect the successful activation of
          <code>preview-latex</code>: after loading a LaTeX file,
          <code>preview-latex</code> gives you a <code>Preview</code> menu.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(preview-latex)Top")</span>

      (leuven--section <span class="org-string">"(preview-latex)Top"</span>)

      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"preview"</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">path to `</span><span class="org-comment"><span class=
"org-constant">gs</span></span><span class=
"org-comment">' command (for format conversions)</span>
        (setq preview-gs-command
          (<span class="org-keyword">cond</span> (running-ms-windows
                 (or (executable-find <span class=
"org-string">"gswin32c.exe"</span>)
                     <span class=
"org-string">"C:/texlive/2014/tlpkg/tlgs/bin/gswin32c.exe"</span>))
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">default value</span>
                (t
                 <span class="org-string">"/usr/bin/gs"</span>)))
        (leuven--file-exists-and-executable-p preview-gs-command)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scale factor for included previews</span>
        (setq preview-scale-function 1.2))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-29-4" class="outline-3">
        <h3 id="sec-29-4">RefTeX</h3>

        <div class="outline-text-3" id="text-29-4">
          <p>AUCTeX is fantastic, and RefTeX just makes things better.</p>

          <p>To fill in <code>\ref{}</code> and <code>\cite{}</code> commands,
          you can use <code>C-c &amp;</code>
          (<code>reftex-view-crossref</code>).</p>

          <p>XXX Conflict with YASnippet.</p>

          <p>A Table of Contents of the entire (multifile) document with
          browsing capabilities is available with <code>C-c =</code>. Hitting
          <code>l</code> there will show all the labels and cites.</p>

          <p>Labels can be created with <code>C-c (</code> and referenced with
          <code>C-c )</code>. When referencing, you get a menu with all labels
          of a given type and context of the label definition. The selected
          label is inserted as a <code>\ref</code> macro.</p>

          <p>Citations can be made with <code>C-c [</code> which will use a
          regular expression to pull out a <b>formatted</b> list of articles
          from your BibTeX database. The selected citation is inserted as a
          <code>\cite</code> macro.</p>

          <p>Index entries can be made with <code>C-c /</code> which indexes
          the word at point or the current selection. More general index
          entries are created with <code>C-c &lt;</code>. <code>C-c &gt;</code>
          displays the compiled index.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      (add-hook 'LaTeX-mode-hook 'reftex-mode) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with AUCTeX LaTeX mode</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minor mode with distinct support for `\label', `\ref', `\cite'</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">and `\index' in LaTeX</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"reftex"</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn all plug-ins on</span>
        (setq reftex-plug-into-AUCTeX t)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use a separate selection buffer for each label type -- so the</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">menu generally comes up faster</span>
        (setq reftex-use-multiple-selection-buffers t))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-29-5" class="outline-3">
        <h3 id="sec-29-5">BibTeX</h3>

        <div class="outline-text-3" id="text-29-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">BibTeX mode</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"bibtex"</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">current BibTeX dialect</span>
        (setq bibtex-dialect 'biblatex))

      ))                                <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "latex" ends here</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 25.10-tex-mode ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-30" class="outline-2">
      <h2 id="sec-30">SGML and HTML Modes</h2>

      <div class="outline-text-2" id="text-30">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(leuven--chapter leuven-chapter-25-text <span class=
"org-string">"25 Commands for Human Languages"</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 25.11 (info "(emacs)HTML Mode")</span>

  (leuven--section <span class="org-string">"25.11 (emacs)HTML Mode"</span>)
</pre>
        </div>
      </div>

      <div id="outline-container-sec-30-1" class="outline-3">
        <h3 id="sec-30-1">HTML</h3>

        <div class="outline-text-3" id="text-30-1"></div>

        <div id="outline-container-sec-30-1-1" class="outline-4">
          <h4 id="sec-30-1-1">html-mode</h4>

          <div class="outline-text-4" id="text-30-1-1">
            <p>The default HTML mode, derived from SGML mode (see the HTML and
            SGML menus), works quite well for editing HTML4 documents (whose
            tags don’t have to close).</p>

            <dl class="org-dl">
              <dt><code>C-c C-v</code></dt>

              <dd><b>View</b> your file <b>in your browser</b>
              (<code>browse-url-of-buffer</code>).</dd>

              <dt><code>C-c C-b</code> (or <code>C-c &lt;left&gt;</code>)</dt>

              <dd>Jump to the opening HTML tag
              (<code>sgml-skip-tag-backward</code>).</dd>

              <dt><code>C-c C-f</code> (or <code>C-c &lt;right&gt;</code>)</dt>

              <dd>Jump to the closing HTML tag
              (<code>sgml-skip-tag-forward</code>).</dd>

              <dt><code>C-c TAB</code></dt>

              <dd>Hide all of the angle-bracketed tags in the buffer
              (<code>sgml-tags-invisible</code>). This can be used as a cheap
              <b>preview</b> of <b>just the bare text</b>.</dd>

              <dt><code>C-c /</code></dt>

              <dd><code>sgml-close-tag</code>.</dd>

              <dt><code>C-M-i</code></dt>

              <dd><code>ispell-complete-word</code>.</dd>
            </dl>

            <p>Plug <a href="http://tidy.sourceforge.net/">HTML Tidy</a> with
            <code>tidy.el</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (and (locate-library <span class=
"org-string">"tidy"</span>)
             (executable-find <span class="org-string">"tidy"</span>))

    (autoload 'tidy-buffer <span class="org-string">"tidy"</span>
      <span class="org-doc">"Run Tidy HTML parser on current buffer."</span> t)
    (autoload 'tidy-parse-config-file <span class="org-string">"tidy"</span>
      <span class="org-doc">"Parse the `</span><span class=
"org-doc"><span class="org-constant">tidy-config-file</span></span><span class=
"org-doc">'."</span> t)
    (autoload 'tidy-save-settings <span class="org-string">"tidy"</span>
      <span class="org-doc">"Save settings to `</span><span class=
"org-doc"><span class="org-constant">tidy-config-file</span></span><span class=
"org-doc">'."</span> t)
    (autoload 'tidy-build-menu  <span class="org-string">"tidy"</span>
      <span class="org-doc">"Install an options menu for HTML Tidy."</span> t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--html-mode-hook</span> ()
      <span class="org-doc">"Customize html(-helper)-mode."</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set up a "tidy" menu in the menu bar</span>
      (<span class="org-keyword">when</span> (boundp 'html-mode-map)
        (tidy-build-menu html-mode-map))
      (<span class="org-keyword">when</span> (boundp 'html-helper-mode-map)
        (tidy-build-menu html-helper-mode-map))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind the key sequence `C-c C-c' to `</span><span class=
"org-comment"><span class="org-constant">tidy-buffer</span></span><span class=
"org-comment">'</span>
      (local-set-key
        (kbd <span class="org-string">"C-c C-c"</span>) 'tidy-buffer)

      (setq sgml-validate-command <span class="org-string">"tidy"</span>))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">also run from `</span><span class="org-comment"><span class=
"org-constant">html-helper-mode</span></span><span class="org-comment">'</span>
    (add-hook 'html-mode-hook 'leuven--html-mode-hook))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-30-1-2" class="outline-4">
          <h4 id="sec-30-1-2">html-helper-mode</h4>

          <div class="outline-text-4" id="text-30-1-2">
            <p>You might also want to consider <code>html-helper-mode</code>,
            which has a lot more features than plain
            <code>html-mode</code>:</p>

            <ul class="org-ul">
              <li>autocompletion,</li>

              <li>auto-insertion of closing tags… and</li>

              <li>a lot more.</li>
            </ul>

            <p>When you open a buffer for HTML editing, a didactic HTML menu
            appears, so you can use your mouse to invoke commands.</p>

            <p>Using the prefix-arg (<code>C-u</code>) to relevant HTML tags,
            <code>html-helper-mode</code> will put tags around a region you’ve
            specified.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"html-helper-mode"</span>)

    (autoload 'html-helper-mode <span class=
"org-string">"html-helper-mode"</span>
      <span class="org-doc">"Mode for editing HTML documents."</span> t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">invoke html-helper-mode automatically on .html files</span>
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.html?\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">invoke html-helper-mode automatically on .asp files</span>
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.asp\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">invoke html-helper-mode automatically on .jsp files</span>
    (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.jsp\\'"</span> . html-helper-mode)))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-30-2" class="outline-3">
        <h3 id="sec-30-2">XHTML</h3>

        <div class="outline-text-3" id="text-30-2">
          <p><a href="#sec-30-3">nXML</a> seems to be the most recommended mode
          to view and edit well-formed <b>XHTML</b> (reformulation of HTML as
          an XML application).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.xhtml?\\'"</span> . xml-mode))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">alias for `</span><span class="org-comment"><span class=
"org-constant">nxml-mode</span></span><span class="org-comment">'</span>
</pre>
          </div>

          <p>Alternatively, you can use <a href=
          "http://ourcomments.org/Emacs/nXhtml/doc/nxhtml.html">nXhtml</a>
          mode, derived from nXML mode. It adds a lot of things useful for
          <b>XHTML</b> files with mixed content:</p>

          <ul class="org-ul">
            <li>handling <b>multiple major modes</b> (Mumamo) in one buffer
            (for CSS, JS, PHP and similar things): get the correct syntax
            highlighting and indentation for each of them,</li>

            <li>folding,</li>

            <li>improved interface to Tidy (?),</li>

            <li>etc.</li>
          </ul>

          <p>Though, it takes a while to load.</p>

          <p>web-mode could be another alternative for editing HTML documents
          embedding CSS/JS.</p>
        </div>
      </div>

      <div id="outline-container-sec-30-3" class="outline-3">
        <h3 id="sec-30-3"><a id="ID-786a2051-476a-4277-82df-d8ebf8ba0e99" name=
        "ID-786a2051-476a-4277-82df-d8ebf8ba0e99"></a>XML</h3>

        <div class="outline-text-3" id="text-30-3">
          <p>nXML mode (default for editing XML files, since GNU Emacs 23.2)
          does:</p>

          <ul class="org-ul">
            <li>real-time <b>validation against a schema in RELAX NG</b>
            (actually RNC, i.e. the “Compact” Syntax): <code>C-c C-n</code>
            (assuming RNG validation is on),</li>

            <li><b>code completion</b> against the RNG schema.</li>
          </ul>

          <p>Some key bindings:</p>

          <dl class="org-dl">
            <dt><code>C-M-p</code></dt>

            <dd>Move backward over one element
            (<code>nxml-backward-element</code>).</dd>

            <dt><code>C-M-n</code></dt>

            <dd>Move forward over one element
            (<code>nxml-forward-element</code>).</dd>

            <dt><code>C-M-u</code></dt>

            <dd>Move up the element structure
            (<code>nxml-backward-up-element</code>).</dd>

            <dt><code>C-M-d</code></dt>

            <dd>Move down the element structure
            (<code>nxml-down-element</code>).</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"nxml-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove the binding of `C-c C-x' (`</span><span class=
"org-comment"><span class=
"org-constant">nxml-insert-xml-declaration</span></span><span class=
"org-comment">'), used</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">by Org timeclocking commands</span>
    (define-key nxml-mode-map
      (kbd <span class="org-string">"C-c C-x"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">view the buffer contents in a browser</span>
    (define-key nxml-mode-map
      (kbd <span class="org-string">"C-c C-v"</span>) 'browse-url-of-buffer))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> (normally bound to `</span><span class=
"org-comment"><span class="org-constant">rng-validate-mode</span></span><span class="org-comment">')</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-30-4" class="outline-3">
        <h3 id="sec-30-4">Highlight the closing tag</h3>

        <div class="outline-text-3" id="text-30-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight the current SGML tag context</span>
  (<span class="org-keyword">when</span> (try-require 'hl-tags-mode)

    (add-hook 'html-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class="org-keyword">require</span> '<span class=
"org-constant">sgml-mode</span>)
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">when `</span><span class="org-comment"><span class=
"org-constant">html-mode-hook</span></span><span class=
"org-comment">' is called from `</span><span class="org-comment"><span class=
"org-constant">html-helper-mode</span></span><span class="org-comment">'</span>
                (hl-tags-mode 1)))

    (add-hook 'nxml-mode-hook 'hl-tags-mode))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 25 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-31" class="outline-2">
      <h2 id="sec-31">Editing Programs</h2>

      <div class="outline-text-2" id="text-31">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 26 Editing (info "(emacs)Programs")</span>

(leuven--chapter leuven-chapter-26-programs <span class=
"org-string">"26 Editing Programs"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-31-1" class="outline-3">
        <h3 id="sec-31-1">Major Modes for Programming Languages</h3>

        <div class="outline-text-3" id="text-31-1">
          <p>Have a look at:</p>

          <ul class="org-ul">
            <li><a href="http://cedet.sourceforge.net/">CEDET</a> for
            development in AWK, C/C++, C#, Calc, Erlang, Java, Javascript,
            Make, PHP, Python, Ruby and Scheme,</li>

            <li><a href="http://common-lisp.net/project/slime">SLIME</a> for
            Common Lisp development,</li>

            <li>JDEE for Java programs.</li>
          </ul>

          <p>Emacs tool for Emacs Lisp code analysis (to keep overview of the
          function calls and dependecies between functions/variables):
          byte-compile-generate-call-tree</p>

          <p>Also <code>who-calls.el</code></p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.1 Major Modes for (info "(emacs)Program Modes")</span>

  (leuven--section <span class=
"org-string">"26.1 Major Modes for (emacs)Program Modes"</span>)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (autoload 'graphviz-dot-mode <span class=
"org-string">"graphviz-dot-mode"</span>
    <span class="org-doc">"Major mode for the dot language."</span> t)
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.dot\\'"</span> . graphviz-dot-mode))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-2" class="outline-3">
        <h3 id="sec-31-2">Top-Level Definitions, or Defuns</h3>

        <div class="outline-text-3" id="text-31-2">
          <p>Imenu is a great tool allowing you to go to a function definition,
          but only if the definition is in the buffer you are currently editing
          (it won’t jump and open another file).</p>

          <p>XXX Autoloaded?</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.2 Top-Level Definitions, or (info "(emacs)Defuns")</span>

  (leuven--section <span class=
"org-string">"26.2 Top-Level Definitions, or (emacs)Defuns"</span>)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">making buffer indexes as menus</span>
    (<span class=
"org-keyword">when</span> (try-require 'imenu)          <span class=
"org-comment-delimiter">; </span><span class="org-comment">awesome!</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically add Imenu to the menu bar in /any/ mode that supports it</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">try-to-add-imenu</span> ()
        (<span class="org-keyword">condition-case</span> nil
            (imenu-add-to-menubar <span class="org-string">"Imenu"</span>)
          (<span class="org-warning">error</span> nil)))
      (add-hook 'font-lock-mode-hook 'try-to-add-imenu)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show current function in mode line (based on Imenu)</span>
      (which-function-mode 1)))         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">~ Stickyfunc mode (in header line)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'imenu+)</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-3" class="outline-3">
        <h3 id="sec-31-3">Indentation for Programs</h3>

        <div class="outline-text-3" id="text-31-3">
          <p>Changing the “hanginess” of a brace and then reindenting, will not
          move the brace to a different line. For this, you’re better off
          getting an external program like GNU <code>indent</code>, which will
          rearrange brace location, among other things.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.3 (info "(emacs)Program Indent")ation</span>

    (leuven--section <span class=
"org-string">"26.3 (emacs)Program Indentation"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn on auto-fill mode in Lisp modes</span>
    (add-hook 'lisp-mode-hook 'auto-fill-mode)
    (add-hook 'emacs-lisp-mode-hook 'auto-fill-mode)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-indentation: automatically jump to the "correct" column when</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the &lt;RET&gt; key is pressed while editing a program (act as if you</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">pressed `</span><span class="org-comment"><span class=
"org-constant">C-j</span></span><span class="org-comment">')</span>
    (GNUEmacs24
      (add-hook 'prog-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (local-set-key
                    (kbd <span class=
"org-string">"&lt;return&gt;"</span>) 'newline-and-indent))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun back-to-indentation-or-beginning ()</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(if (/= (point) (line-beginning-position))</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(beginning-of-line)</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(back-to-indentation)))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun align-with-spaces (beg end)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Align selected using only spaces for whitespace."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive "r")</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(let ((indent-tabs-mode nil))</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(align beg end)))</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"sh-script"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use the SMIE code for navigation and indentation</span>
      (setq sh-use-smie t))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-4" class="outline-3">
        <h3 id="sec-31-4">Commands for Editing with Parentheses</h3>

        <div class="outline-text-3" id="text-31-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.4 Commands for Editing with (info "(emacs)Parentheses")</span>

  (leuven--section <span class=
"org-string">"26.4 Commands for Editing with (emacs)Parentheses"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight matching paren</span>
  (GNUEmacs
    (show-paren-mode 1)
    (setq show-paren-style 'mixed)
    (setq show-paren-ring-bell-on-mismatch t))
  (XEmacs
    (paren-set-mode 'paren))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight surrounding parentheses</span>
  (GNUEmacs
    (autoload 'highlight-parentheses-mode <span class=
"org-string">"highlight-parentheses"</span>
      <span class=
"org-doc">"Minor mode to highlight the surrounding parentheses."</span> t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'emacs-lisp-mode-hook 'highlight-parentheses-mode)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"highlight-parentheses"</span>

      (<span class=
"org-keyword">define-globalized-minor-mode</span> <span class=
"org-function-name">global-highlight-parentheses-mode</span>
        highlight-parentheses-mode
        (<span class="org-keyword">lambda</span> ()
          (highlight-parentheses-mode t)))
      (global-highlight-parentheses-mode t)

      (setq hl-paren-background-colors
            '(<span class="org-string">"#FF993F"</span> <span class=
"org-string">"#B0FF3F"</span> <span class=
"org-string">"#3FFFB0"</span> <span class="org-string">"#3F99FF"</span>))

      (setq hl-paren-colors
            '(<span class="org-string">"black"</span> <span class=
"org-string">"black"</span> <span class=
"org-string">"black"</span> <span class="org-string">"black"</span>))))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-31-4-1" class="outline-4">
          <h4 id="sec-31-4-1">Moving in the Parenthesis Structure</h4>

          <div class="outline-text-4" id="text-31-4-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">jump to matching parenthesis</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">match-paren</span> (arg)
    <span class=
"org-doc">"Go to the matching parenthesis, if on a parenthesis."</span>
    (interactive <span class="org-string">"p"</span>)
    (<span class="org-keyword">cond</span> ((looking-at <span class=
"org-string">"\\s\("</span>) (forward-list 1) (backward-char 1))
          ((looking-at <span class=
"org-string">"\\s\)"</span>) (forward-char 1) (backward-list 1))))

  (global-set-key
    (kbd <span class="org-string">"C-)"</span>) 'match-paren)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-31-4-2" class="outline-4">
          <h4 id="sec-31-4-2">Matching Parentheses</h4>

          <div class="outline-text-4" id="text-31-4-2">
            <p>Balanced editing: inserting two matching parentheses at once,
            etc.</p>

            <ul class="org-ul">
              <li>
                <p>electric-pair-mode (in Emacs, since 24.1)</p>

                <p>Here’s a quick summary (<code>|</code> marks point):</p>

                <ul class="org-ul">
                  <li>typing <code>((((</code> makes
                  <code>((((|))))</code></li>

                  <li>typing <code>))))</code> afterwards makes
                  <code>(((())))|</code></li>

                  <li>if the buffer has too many closers, an opener before them
                  will <b>not</b> autopair</li>

                  <li>if the buffer has too many openers, a closer after them
                  will <b>not</b> autoskip</li>

                  <li>in a mixed parenthesis situation with <code>[]</code>’s
                  and <code>()</code>’s, it tries to do sensible things</li>
                </ul>
              </li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (electric-pair-mode 1)
</pre>
            </div>

            <p>Deleting one bracket doesn’t delete the other. If you want that,
            install <code>autopairs</code> package.</p>

            <ul class="org-ul">
              <li>paredit</li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minor mode for editing parentheses</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"paredit"</span>)

    (autoload 'enable-paredit-mode <span class="org-string">"paredit"</span>
      <span class=
"org-doc">"Minor mode for pseudo-structurally editing Lisp code."</span> t)

    (add-hook 'emacs-lisp-mode-hook 'enable-paredit-mode)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Common Lisp editing extensions</span>
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"redshank"</span>)   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">requires `</span><span class="org-comment"><span class=
"org-constant">paredit</span></span><span class="org-comment">'</span>

      (autoload 'redshank-mode <span class="org-string">"redshank"</span>
        <span class=
"org-doc">"Minor mode for restructuring Lisp code (i.e., refactoring)."</span> t)

      (add-hook 'emacs-lisp-mode-hook 'redshank-mode)))
</pre>
            </div>

            <ul class="org-ul">
              <li>
                <p>autopair</p>
              </li>

              <li>
                <p>smartparens</p>

                <p>Pair can be simple as parentheses or brackets, or can be
                programming tokens such as <code>if</code> … <code>fi</code> or
                <code>if</code> … <code>end</code> in many languages.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-5" class="outline-3">
        <h3 id="sec-31-5">Manipulating Comments</h3>

        <div class="outline-text-3" id="text-31-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.5 (info "(emacs)Comments")</span>

  (leuven--section <span class="org-string">"26.5 (emacs)Comments"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always comments out empty lines</span>
  (setq comment-empty-lines t)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (GNUEmacs
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">comment-dwim</span> (around leuven-comment activate)
      <span class=
"org-doc">"When called interactively with no active region, comment a single line instead."</span>
      (<span class=
"org-keyword">if</span> (or (use-region-p) (not (called-interactively-p 'any)))
          ad-do-it
        (comment-or-uncomment-region (line-beginning-position)
                                     (line-end-position))
        (message <span class="org-string">"Commented line"</span>))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-6" class="outline-3">
        <h3 id="sec-31-6">Documentation Lookup</h3>

        <div class="outline-text-3" id="text-31-6">
          <p>Function argument hint.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.6 (info "(emacs)Documentation") Lookup</span>

  (leuven--section <span class=
"org-string">"26.6 (emacs)Documentation Lookup"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">idle time to wait before printing documentation</span>
  (setq eldoc-idle-delay 0.2)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">resize echo area to fit documentation</span>
  (setq eldoc-echo-area-use-multiline-p t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show the function arglist or the variable docstring in the echo area</span>
  (GNUEmacs
    (add-hook 'emacs-lisp-mode-hook 'eldoc-mode)
    (add-hook 'lisp-interaction-mode-hook 'eldoc-mode)
    (add-hook 'ielm-mode-hook 'eldoc-mode)
    (add-hook 'eval-expression-minibuffer-setup-hook 'eldoc-mode))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight the arguments in `</span><span class=
"org-comment"><span class=
"org-constant">font-lock-variable-name-face</span></span><span class=
"org-comment">'</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--frob-eldoc-argument-list</span> (string)
    <span class=
"org-doc">"Upcase and fontify STRING for use with `</span><span class=
"org-doc"><span class="org-constant">eldoc-mode</span></span><span class=
"org-doc">'."</span>
    (propertize (upcase string)
                'face 'font-lock-variable-name-face))
  (setq eldoc-argument-case 'leuven--frob-eldoc-argument-list)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-7" class="outline-3">
        <h3 id="sec-31-7"><a id="ID-a36b1dbd-1d05-4ff2-b19a-167e50c4f1f7" name=
        "ID-a36b1dbd-1d05-4ff2-b19a-167e50c4f1f7"></a>Hideshow minor mode</h3>

        <div class="outline-text-3" id="text-31-7">
          <p>XXX See <a href=
          "http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs">
          http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs</a></p>

          <p>Hideshow can <b>fold</b> (i.e. hide and un-hide) logical blocks of
          <b>code</b> in many programming modes.</p>

          <p><code>hs-minor-mode.el</code> collapses code for a lot of
          languages, not only Lisp. See <a href=
          "#sec-27-5">outline-minor-mode</a> as well.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.7 (info "(emacs)Hideshow") minor mode</span>

  (leuven--section <span class=
"org-string">"26.7 (emacs)Hideshow minor mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Hideshow (code folding) for programming modes</span>
  (add-hook 'prog-mode-hook 'hs-minor-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"hideshow"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">change those really awkward key bindings with `@' in the middle</span>
    (define-key hs-minor-mode-map
      (kbd <span class=
"org-string">"&lt;C-S-left&gt;"</span>) 'hs-hide-block) <span class=
"org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-h'</span>
    (define-key hs-minor-mode-map
      (kbd <span class=
"org-string">"&lt;C-S-right&gt;"</span>) 'hs-show-block) <span class=
"org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-s'</span>
    (define-key hs-minor-mode-map
      (kbd <span class=
"org-string">"&lt;C-S-up&gt;"</span>) 'hs-hide-all)    <span class=
"org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-h'</span>
    (define-key hs-minor-mode-map
      (kbd <span class=
"org-string">"&lt;C-S-down&gt;"</span>) 'hs-show-all)  <span class=
"org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-s'</span>

    (<span class="org-keyword">defcustom</span> <span class=
"org-variable-name">hs-face</span> 'hs-face
      <span class=
"org-doc">"*Specify the face to to use for the hidden region indicator"</span>
      <span class="org-builtin">:type</span> 'face
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">hs-face</span>
      '((t (<span class="org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 1 <span class=
"org-builtin">:color</span> <span class="org-string">"#999999"</span>)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#999999"</span> <span class=
"org-builtin">:background</span> <span class="org-string">"#FFF8C0"</span>)))
      <span class=
"org-doc">"Face to hightlight the ... area of hidden regions"</span>
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">display-code-line-counts</span> (ov)
      (<span class="org-keyword">when</span> (eq 'code (overlay-get ov 'hs))
        (overlay-put ov 'display
                     (propertize <span class=
"org-string">"..."</span> 'face 'hs-face))))

    (setq hs-set-up-overlay 'display-code-line-counts))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">if hideshowvis is not installed, do not attempt to configure it, as this</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">will prevent packages (including hideshowvis itself) from compiling</span>
  (<span class="org-keyword">when</span> (and (display-graphic-p)
             (try-require 'hideshowvis))

    (autoload 'hideshowvis-enable <span class="org-string">"hideshowvis"</span>
      <span class="org-doc">"Highlight foldable regions."</span> t)

    (autoload 'hideshowvis-minor-mode <span class=
"org-string">"hideshowvis"</span>
      <span class=
"org-doc">"Will indicate regions foldable with hideshow in the fringe."</span> t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable hideshowvis for programming modes</span>
    (add-hook 'prog-mode-hook
              (<span class="org-keyword">lambda</span> ()
                <span class="org-comment-delimiter">;; </span><span class=
"org-comment">more syntax definitions</span>
                (<span class="org-keyword">require</span> '<span class=
"org-constant">fold-dwim</span>)
                (hideshowvis-enable)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">+/- fold buttons</span>
    (define-fringe-bitmap 'hs-marker [0 24 24 126 126 24 24 0])

    (<span class="org-keyword">defcustom</span> <span class=
"org-variable-name">hs-fringe-face</span> 'hs-fringe-face
      <span class=
"org-doc">"*Specify face used to highlight the fringe on hidden regions."</span>
      <span class="org-builtin">:type</span> 'face
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defface</span> <span class=
"org-variable-name">hs-fringe-face</span>
      '((t (<span class="org-builtin">:box</span> (<span class=
"org-builtin">:line-width</span> 2 <span class=
"org-builtin">:color</span> <span class=
"org-string">"#808080"</span> <span class=
"org-builtin">:style</span> released-button)
            <span class="org-builtin">:foreground</span> <span class=
"org-string">"#999999"</span>)))
      <span class=
"org-doc">"Face used to highlight the fringe on folded regions"</span>
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">display-code-line-counts</span> (ov)
      (<span class="org-keyword">when</span> (eq 'code (overlay-get ov 'hs))
        (<span class="org-keyword">let*</span> ((marker-string <span class=
"org-string">"*fringe-dummy*"</span>)
               (marker-length (length marker-string))
               (display-string <span class="org-string">"..."</span>))
          (overlay-put ov 'help-echo <span class=
"org-string">"Hidden text. C-c,= to show"</span>)
          (put-text-property 0 marker-length
                             'display (list 'left-fringe
                                            'hs-marker
                                            'hs-fringe-face)
                             marker-string)
          (overlay-put ov 'before-string marker-string)
          (put-text-property 0 (length display-string)
                             'face 'hs-face display-string)
          (overlay-put ov 'display display-string))))

    (setq hs-set-up-overlay 'display-code-line-counts))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-31-8" class="outline-3">
        <h3 id="sec-31-8"><a id="ID-4b262301-5370-40c6-8da6-019215634e20" name=
        "ID-4b262301-5370-40c6-8da6-019215634e20"></a>Completion for Symbol
        Names</h3>

        <div class="outline-text-3" id="text-31-8">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.8 (info "(emacs)Symbol Completion")</span>

  (leuven--section <span class=
"org-string">"26.8 (emacs)Symbol Completion"</span>)
</pre>
          </div>

          <p>It’s more or less a convention that each language mode binds its
          symbol completion command (<code>completion-at-point</code>) to
          <code>&lt;M-tab&gt;</code>.</p>

          <p>Note that <code>&lt;M-tab&gt;</code> is used by many window
          managers themselves (typically for switching between windows) and is
          not passed to applications.</p>

          <p>In that case, you should:</p>

          <ul class="org-ul">
            <li>type <code>C-M-i</code> (or <code>&lt;escape&gt;
            &lt;tab&gt;</code>) for completion, or</li>

            <li>bind the command normally bound to <code>&lt;M-tab&gt;</code>
            to a key that is convenient for you to hit, such as
            <code>&lt;C-tab&gt;</code>.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">when you hit `</span><span class="org-comment"><span class=
"org-constant">&lt;C-tab&gt;</span></span><span class=
"org-comment">', call the command normally bound to `</span><span class=
"org-comment"><span class=
"org-constant">&lt;M-tab&gt;</span></span><span class="org-comment">'</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;C-tab&gt;"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (call-interactively (key-binding (kbd <span class=
"org-string">"&lt;M-tab&gt;"</span>)))))
</pre>
          </div>

          <p>See also <a href="#sec-34-2">Dabbrev</a>, Emacs’ standard
          autocompletion (on by default).</p>
        </div>
      </div>

      <div id="outline-container-sec-31-9" class="outline-3">
        <h3 id="sec-31-9">Glasses minor mode</h3>

        <div class="outline-text-3" id="text-31-9">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 26.9 (info "(emacs)Glasses") minor mode</span>

  (leuven--section <span class=
"org-string">"26.9 (emacs)Glasses minor mode"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"glasses"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">face to be put on capitals of an identifier looked through glasses</span>
    (setq glasses-face 'bold)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">string to be displayed as a visual separator in unreadable</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">identifiers</span>
    (setq glasses-separator <span class="org-string">""</span>))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 26 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-32" class="outline-2">
      <h2 id="sec-32">Compiling and Testing Programs</h2>

      <div class="outline-text-2" id="text-32">
        <p>It is possible to see a warning, while we are programming, if we did
        a mistake: there’s a CWarn mode for C and C++, but I don’t know about
        similar features for Java.</p>

        <p>flymake can compile in the background and colorize lines with
        errors/warnings</p>

        <ul class="org-ul">
          <li><a href=
          "http://flymake.sourceforge.net/">http://flymake.sourceforge.net/</a></li>

          <li><a href=
          "http://www.emacswiki.org/cgi-bin/wiki/JdeeFlymake">http://www.emacswiki.org/cgi-bin/wiki/JdeeFlymake</a></li>
        </ul>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 27 (info "(emacs)Building") Compiling and Testing Programs</span>

(leuven--chapter leuven-chapter-27-building <span class=
"org-string">"27 Compiling and Testing Programs"</span>

  (autoload 'flymake-mode <span class="org-string">"flymake"</span>
    <span class="org-doc">"Toggle on-the-fly syntax checking."</span> t)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"flymake"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set up `</span><span class="org-comment"><span class=
"org-constant">flymake</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">activate-flymake</span> ()
      <span class=
"org-doc">"Activate Flymake when real buffer and you have write access."</span>
      (<span class="org-keyword">when</span> (and (buffer-file-name)
                 (file-writable-p buffer-file-name))
        (flymake-mode t)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> add errors to mode line</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--flymake-show-help</span> ()
      <span class=
"org-doc">"Display the error output of the current line in the mode line."</span>
      (<span class=
"org-keyword">when</span> (get-char-property (point) 'flymake-overlay)
        (<span class=
"org-keyword">let</span> ((help (get-char-property (point) 'help-echo)))
          (<span class="org-keyword">if</span> help (message <span class=
"org-string">"%s"</span> help)))))

    (add-hook 'post-command-hook 'leuven--flymake-show-help))
</pre>
        </div>
      </div>

      <div id="outline-container-sec-32-1" class="outline-3">
        <h3 id="sec-32-1">Running Compilations under Emacs</h3>

        <div class="outline-text-3" id="text-32-1">
          <p>My build command: <code>cd /path/to/Makefile &amp;&amp; make -f
          Makefile</code>.</p>

          <p>You don’t need a <code>Makefile</code> to perform simple tasks,
          because <code>make</code> knows a lot of built in rules out of the
          box. For example, to compile a <code>.c</code> source file
          <code>foo.c</code> into a program <code>foo</code>, all you need is
          say <code>make -k foo</code>, and <code>make</code> will do it even
          without a <code>Makefile</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.1 Running (info "(emacs)Compilation")s under Emacs</span>

  (leuven--section <span class=
"org-string">"27.1 Running (emacs)Compilations under Emacs"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">invoke a compiler with the same command as in the last invocation of</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">compile</span></span><span class="org-comment">'</span>
  (autoload 'recompile <span class="org-string">"compile"</span>
    <span class=
"org-doc">"Re-compile the program including the current buffer."</span> t)

  (global-set-key
    (kbd <span class="org-string">"&lt;f9&gt;"</span>) 'recompile)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">scroll the `</span><span class="org-comment"><span class=
"org-constant">*compilation*</span></span><span class=
"org-comment">' buffer window to follow output as it appears</span>
  (setq compilation-scroll-output t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of lines in a compilation window</span>
  (setq compilation-window-height 8)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; I also don't like that the compilation window sticks around after</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; a successful compile.  After all, most of the time, all I care</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; about is that the compile completed cleanly.  Here's how I make the</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; compilation window go away, only if there was no compilation</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; errors:</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq compilation-finish-function</span>
  <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(lambda (buf str)</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">(if (string-match "exited abnormally" str)</span>
  <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">;; there were errors</span>
  <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(message "Compilation errors, press C-x ` to visit")</span>
  <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">;; no errors, make compilation window go away in 0.5 sec</span>
  <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(run-at-time 0.5 nil 'delete-windows-on buf)</span>
  <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(message "NO COMPILATION ERRORS!"))))</span>

  (GNUEmacs
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">cc-goto-first-error</span>( buffer exit-condition )
      (<span class="org-keyword">with-current-buffer</span> buffer
        (goto-char (point-min))
        (compilation-next-error 1)
        (beep)))

    (add-to-list 'compilation-finish-functions 'cc-goto-first-error))

  (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">make-clean-command</span> <span class=
"org-string">"make clean all"</span>
    <span class="org-doc">"*Command used by the `</span><span class=
"org-doc"><span class="org-constant">make-clean</span></span><span class=
"org-doc">' function."</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">make-clean</span> (<span class=
"org-type">&amp;optional</span> arg)
    <span class="org-doc">"Run a make clean."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">require</span> '<span class=
"org-constant">compile</span>)                  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">needed for compile-internal</span>
    (<span class="org-keyword">if</span> arg
        (setq make-clean-command
              (read-string <span class=
"org-string">"Command: "</span> make-clean-command)))
    (save-some-buffers (not compilation-ask-about-save) nil)
    (compile-internal make-clean-command <span class=
"org-string">"No more errors"</span>))

  (global-set-key
    (kbd <span class="org-string">"&lt;S-f9&gt;"</span>) 'make-clean)
</pre>
          </div>

          <p>You’re debugging Bash code? I normally use
          <code>mode-compile.el</code> for this. Basically, it runs Bash with
          lots of debug output.</p>
        </div>
      </div>

      <div id="outline-container-sec-32-2" class="outline-3">
        <h3 id="sec-32-2">Compilation Mode</h3>

        <div class="outline-text-3" id="text-32-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.2 (info "(emacs)Compilation Mode")</span>

  (leuven--section <span class=
"org-string">"27.2 (emacs)Compilation Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically jump to the first error during compilation</span>
  (setq compilation-auto-jump-to-first-error t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the next compiler error message</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;f10&gt;"</span>) 'next-error)          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">also on `C-x `' and `M-g n'</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the previous compiler error message</span>
  (global-set-key
    (kbd <span class=
"org-string">"&lt;S-f10&gt;"</span>) 'previous-error)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">also on `M-g p'</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the first compiler error message</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;C-f10&gt;"</span>) 'first-error)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">highlight and parse the whole compilation output as soon as it</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">arrives</span>
  (setq compile-auto-highlight t)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-3" class="outline-3">
        <h3 id="sec-32-3">Searching with Grep under Emacs</h3>

        <div class="outline-text-3" id="text-32-3">
          <p>Find files matching some regexp, and click on the hyperlinks to
          the files to locate your match.</p>

          <p>The commands</p>

          <ul class="org-ul">
            <li><code>lgrep</code> (local search, with
            <code>grep-template</code>) and</li>

            <li><code>rgrep</code> (<b>recursive</b> search, with
            <code>grep-find-template</code>)</li>
          </ul>

          <p>are somehow more user-friendly than the <code>M-x grep</code>
          command.</p>

          <p>The doc string of <code>grep-use-null-device</code> which explains
          that, with its default value <code>auto-detect</code>, Emacs invokes
          Grep once with <code>/dev/null</code> appended (causing the search to
          return no results) for the purposes of detecting how to invoke it
          thereafter.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.4 (info "(emacs)Grep Searching") under Emacs</span>

  (leuven--section <span class=
"org-string">"27.4 (emacs)Grep Searching under Emacs"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ignore case distinctions in the default `</span><span class=
"org-comment"><span class="org-constant">grep</span></span><span class=
"org-comment">' command</span>
  (setq grep-command <span class="org-string">"grep -i -H -n -e "</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">do not append `</span><span class="org-comment"><span class=
"org-constant">null-device</span></span><span class=
"org-comment">' (`</span><span class="org-comment"><span class=
"org-constant">/dev/null</span></span><span class=
"org-comment">' or `</span><span class="org-comment"><span class=
"org-constant">NUL</span></span><span class=
"org-comment">') to `</span><span class="org-comment"><span class=
"org-constant">grep</span></span><span class="org-comment">' commands</span>
  (setq grep-use-null-device nil)       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">not necessary if the `</span><span class=
"org-comment"><span class="org-constant">grep</span></span><span class=
"org-comment">' program</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">used supports the `</span><span class="org-comment"><span class=
"org-constant">-H</span></span><span class="org-comment">' option</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; for Windows</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq grep-find-command '("findstr /sn *" . 13))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use `find -print0' and `xargs -0'</span>
  (setq grep-find-use-xargs 'gnu)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">run `</span><span class="org-comment"><span class=
"org-constant">grep</span></span><span class=
"org-comment">' via `</span><span class="org-comment"><span class=
"org-constant">find</span></span><span class=
"org-comment">', with user-friendly interface</span>
  (global-set-key
    (kbd <span class="org-string">"C-c 3"</span>) 'rgrep)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">10.3.5 Org keyword search</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-grep-org-files</span> (regexp <span class=
"org-type">&amp;optional</span> context)
    <span class=
"org-doc">"Recursively search for REGEXP in Org files in directory tree rooted at `</span><span class="org-doc"><span class="org-constant">org-directory</span></span><span class="org-doc">'.</span>
<span class=
"org-doc">  Prefix argument determines number of lines of output context."</span>
    (interactive <span class="org-string">"sSearch regexp: \nP"</span>)
    (<span class=
"org-keyword">let</span> ((grep-find-ignored-files '(<span class=
"org-string">"#*"</span> <span class="org-string">".#*"</span>))
          (grep-template (concat <span class=
"org-string">"grep &lt;X&gt; -i -nH "</span>
                                 (<span class="org-keyword">when</span> context
                                   (concat <span class=
"org-string">"-C"</span> (number-to-string context)))
                                 <span class=
"org-string">" -e &lt;R&gt; &lt;F&gt;"</span>)))
      (rgrep regexp <span class="org-string">"*.org"</span> org-directory)))
</pre>
          </div>

          <p>See <code>leuven-helm-grep-org-files</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-32-4" class="outline-3">
        <h3 id="sec-32-4">Finding Syntax Errors On The Fly</h3>

        <div class="outline-text-3" id="text-32-4">
          <p>Perform static code analysis on-the-fly, and highlight warnings
          and errors in the code immediately as you are editing it.</p>

          <p>“Flymake done right”</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.5 (info "(emacs)Flymake")</span>

  (leuven--section <span class="org-string">"27.5 (emacs)Flymake"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">modern on-the-fly syntax checking</span>
  (<span class="org-keyword">when</span> (try-require 'flycheck)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; indicate errors and warnings via icons in the right fringe</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq flycheck-indication-mode 'right-fringe)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Flycheck mode in all buffers</span>
    (add-hook 'after-init-hook 'global-flycheck-mode)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--adjust-flycheck-automatic-syntax-eagerness</span> ()
      <span class=
"org-doc">"Adjust how often we check for errors based on if there are any.</span>

<span class=
"org-doc">This lets us fix any errors as quickly as possible, but in</span>
<span class=
"org-doc">a clean buffer we're an order of magnitude laxer about checking."</span>
      (setq flycheck-idle-change-delay
            (<span class=
"org-keyword">if</span> (assq 'error (flycheck-count-errors flycheck-current-errors))
                <span class="org-comment-delimiter">; </span><span class=
"org-comment">only check for REAL errors (original source: Magnars)</span>
                1
              20)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Each buffer get its local `</span><span class=
"org-comment"><span class=
"org-constant">flycheck-idle-change-delay</span></span><span class=
"org-comment">' because of the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">buffer-sensitive adjustment above.</span>
    (make-variable-buffer-local 'flycheck-idle-change-delay)

    (add-hook 'flycheck-after-syntax-check-hook
              'leuven--adjust-flycheck-automatic-syntax-eagerness)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Remove newline checks, since they would trigger an immediate check when</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">we want the `</span><span class="org-comment"><span class=
"org-constant">flycheck-idle-change-delay</span></span><span class=
"org-comment">' to be in effect while editing.</span>
    (setq flycheck-check-syntax-automatically
          '(save
            idle-change
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">new-line</span>
            mode-enabled))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">flycheck-handle-idle-change</span> ()
      <span class=
"org-doc">"Handle an expired idle time since the last change.</span>

<span class="org-doc">This is an overwritten version of the original</span>
<span class=
"org-doc">flycheck-handle-idle-change, which removes the forced deferred.</span>
<span class=
"org-doc">Timers should only trigger inbetween commands in a single</span>
<span class=
"org-doc">threaded system and the forced deferred makes errors never show</span>
<span class="org-doc">up before you execute another command."</span>
      (flycheck-clear-idle-change-timer)
      (flycheck-buffer-automatically 'idle-change)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-5" class="outline-3">
        <h3 id="sec-32-5">Running Debuggers Under Emacs</h3>

        <div class="outline-text-3" id="text-32-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.6 Running (info "(emacs)Debuggers") Under Emacs</span>

  (leuven--section <span class=
"org-string">"27.6 Running (emacs)Debuggers Under Emacs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"gdb-mi"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Gdb-Many-Windows mode</span>
    (setq gdb-many-windows t))
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the only important parameter for GDB</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-6" class="outline-3">
        <h3 id="sec-32-6">Debugging Lisp programs</h3>

        <div class="outline-text-3" id="text-32-6">
          <p>Emacs has the basic debugger/stack trace, but it also has the
          Edebug facility, which is very powerful, for the more complex
          situation.</p>

          <p>With that source-level debugger for Emacs Lisp, you can:</p>

          <ul class="org-ul">
            <li>step through evaluation, stopping before and after each
            expression,</li>

            <li>set conditional or unconditional breakpoints.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Debugging Lisp programs</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">source-level debugger for Emacs Lisp</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"edebug"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display a trace of function entry and exit</span>
    (setq edebug-trace t)
</pre>
          </div>

          <p>While <code>edebug</code>’ging, use <code>T</code> to view a trace
          buffer (<code>*edebug-trace*</code>). Emacs will quickly execute the
          rest of your code, printing out the arguments and return values for
          each expression it evaluates.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">edebug-overlay-arrow</span> (around leuven-highlight-line activate)
      <span class="org-doc">"Highlight line currently being Edebug'ged."</span>
      (<span class="org-keyword">require</span> '<span class=
"org-constant">hl-line</span>)
      (hl-line-mode)
      ad-do-it)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-edebug-quit</span> ()
      <span class="org-doc">"Stop Edebug'ging and remove highlighting."</span>
      (interactive)
      (hl-line-mode -1)
      (top-level))

    (define-key edebug-mode-map
      [remap top-level] 'leuven-edebug-quit))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-7" class="outline-3">
        <h3 id="sec-32-7">Executing Lisp Expressions</h3>

        <div class="outline-text-3" id="text-32-7">
          <p>Just as in C, C++, Java, Perl, Python, etc, Lisp code is kept in
          files. All the normal editing operations are performed on files. In
          this respect, hacking in Lisp is like hacking in any other language
          that you are used to. What’s different is that what you are hacking
          is a running Lisp program. When you edit a function definition or add
          a new one, you compile it into a running program. There is no
          compile, link, run, debug cycle as you know it from C or Java.</p>

          <p>Ponder that for a minute.</p>

          <p>When you fix a bug in a C function, you have to recompile, relink,
          and reload your program before you can test the fix. You don’t do
          that in Lisp. You make the fix and then go straight to testing it.
          This process can be even faster than fixing a bug in a scripting
          language like Perl.</p>
        </div>
      </div>

      <div id="outline-container-sec-32-8" class="outline-3">
        <h3 id="sec-32-8">Libraries of Lisp Code for Emacs</h3>

        <div class="outline-text-3" id="text-32-8">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.8 (info "(emacs)Lisp Libraries") for Emacs</span>

  (leuven--section <span class=
"org-string">"27.8 (emacs)Lisp Libraries"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">force load of `</span><span class="org-comment"><span class=
"org-constant">.el</span></span><span class=
"org-comment">' files when they are newer than the `</span><span class=
"org-comment"><span class="org-constant">.elc</span></span><span class=
"org-comment">' files</span>
  (setq load-prefer-newer t)            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">from Emacs 24.4</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-9" class="outline-3">
        <h3 id="sec-32-9">Evaluating Emacs Lisp Expressions</h3>

        <div class="outline-text-3" id="text-32-9">
          <dl class="org-dl">
            <dt><code>C-x C-e</code></dt>

            <dd>Evaluate the Emacs Lisp expression before point, and print the
            value in the echo area (<code>eval-last-sexp</code>).</dd>

            <dt><code>C-M-x</code> (in Emacs Lisp mode)</dt>

            <dd>Evaluate the defun containing or after point, and print the
            value in the echo area (<code>eval-defun</code>).</dd>
          </dl>

          <p>To (attempt to) cleanly reevaluate a buffer of Emacs Lisp code,
          use <code>nuke-and-eval</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.9 (info "(emacs)Lisp Eval") Expressions</span>

  (leuven--section <span class=
"org-string">"27.9 (emacs)Lisp Eval Expressions"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable the use of the command `</span><span class=
"org-comment"><span class=
"org-constant">eval-expression</span></span><span class=
"org-comment">' without confirmation</span>
  (put 'eval-expression 'disabled nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum depth of lists to print in the result of the evaluation</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">commands before abbreviating them</span>
  (setq eval-expression-print-level nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment">no limit</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum length of lists to print in the result of the evaluation</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">commands before abbreviating them</span>
  (setq eval-expression-print-length nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment">no limit</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-10" class="outline-3">
        <h3 id="sec-32-10">Lisp Interaction Buffers</h3>

        <div class="outline-text-3" id="text-32-10">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 27.10 Lisp Interaction Buffers</span>

  (leuven--section <span class=
"org-string">"27.10 (emacs)Lisp Interaction Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't display the "Welcome to GNU Emacs" buffer on startup</span>
  (setq inhibit-startup-screen t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't insert instructions in the `</span><span class=
"org-comment"><span class="org-constant">*scratch*</span></span><span class=
"org-comment">' buffer at startup</span>
  (setq initial-scratch-message nil)
</pre>
          </div>

          <p>Don’t use any specific mode for the initial buffer. That ensure
          that no Lisp or Org specific stuff gets loaded at each startup
          time.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">major mode command symbol to use for the initial `</span><span class="org-comment"><span class="org-constant">*scratch*</span></span><span class="org-comment">' buffer</span>
  (setq initial-major-mode 'fundamental-mode)
</pre>
          </div>

          <p><b>That code must be used in the <code>.emacs</code> file (or
          libraries loaded from it).</b> Otherwise, <code>*scratch*</code> will
          already have been created, in the default major mode.</p>

          <p>To evaluate a non-interactive command, simply use
          <code>IELM</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-32-11" class="outline-3">
        <h3 id="sec-32-11">Other</h3>

        <div class="outline-text-3" id="text-32-11">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">elint-current-buffer</span> ()
    (interactive)
    (elint-initialize)
    (elint-current-buffer))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"elint"</span>
    (add-to-list 'elint-standard-variables 'current-prefix-arg)
    (add-to-list 'elint-standard-variables 'command-line-args-left)
    (add-to-list 'elint-standard-variables 'buffer-file-coding-system)
    (add-to-list 'elint-standard-variables 'emacs-major-version)
    (add-to-list 'elint-standard-variables 'window-system))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun elisp-indent-or-complete (&amp;optional arg)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive "p")</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(call-interactively 'lisp-indent-line)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(unless (or (looking-back "^\\s-*")</span>
  <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">(bolp)</span>
  <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">(not (looking-back "[-[:alnum:]_*+/=&lt;&gt;!?]+")))</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(call-interactively 'lisp-complete-symbol)))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(with-eval-after-load "lisp-mode"</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(define-key emacs-lisp-mode-map</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(kbd "&lt;tab&gt;") 'elisp-indent-or-complete))</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-32-12" class="outline-3">
        <h3 id="sec-32-12"><span class="todo TODO">TODO</span> From Thierry
        Volpiatto</h3>

        <div class="outline-text-3" id="text-32-12">
          <p>Seems good, except that it changes the behavior of TAB when done
          in a word. Instead of indenting, it completes the word at point,
          changing the buffer’s contents!</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Lisp complete or indent</span>
  (define-key lisp-interaction-mode-map
    [remap indent-for-tab-command] 'helm-lisp-completion-at-point-or-indent)
  (define-key emacs-lisp-mode-map
    [remap indent-for-tab-command] 'helm-lisp-completion-at-point-or-indent)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Lisp complete</span>
  (define-key lisp-interaction-mode-map
    [remap completion-at-point] 'helm-lisp-completion-at-point)
  (define-key emacs-lisp-mode-map
    [remap completion-at-point] 'helm-lisp-completion-at-point)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 27 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-33" class="outline-2">
      <h2 id="sec-33">Maintaining Programs</h2>

      <div class="outline-text-2" id="text-33">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 28 (info "(emacs)Maintaining") Programs</span>

(leuven--chapter leuven-chapter-28-maintaining <span class=
"org-string">"28 Maintaining Programs"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-33-1" class="outline-3">
        <h3 id="sec-33-1">Version Control</h3>

        <div class="outline-text-3" id="text-33-1">
          <p>Version control systems that interact with Emacs in a generic
          way.</p>

          <dl class="org-dl">
            <dt><code>C-x v d</code></dt>

            <dd>Open Dired buffer in VC-mode.</dd>

            <dt><code>C-x v v</code></dt>

            <dd>Take appropriate action (add, commit).</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 28.1 (info "(emacs)Version Control")</span>

  (leuven--section <span class=
"org-string">"28.1 (emacs)Version Control"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(try-require 'vc)                     ; for defining function `</span><span class="org-comment"><span class="org-constant">vc-switches</span></span><span class="org-comment">'</span>
  <span class=
"org-comment-delimiter">;;                                       </span><span class="org-comment">; (</span><span class="org-comment"><span class="org-leuven-highlight">XXX</span></span><span class="org-comment"> autoload?)</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-33-1-1" class="outline-4">
          <h4 id="sec-33-1-1">Version Control and the Mode Line</h4>

          <div class="outline-text-4" id="text-33-1-1">
            <p>“Unmodified-according-to-VC” buffers use <code>-</code> as a
            separator in their VC indicator, and modified buffers have
            <code>:</code> (e.g., <code>CVS-1.2</code> vs.
            <code>CVS:1.2</code>). The tooltip over the VC indicator also says
            more explicitly.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 28.1.2 (info "(emacs)VC Mode Line")</span>

  (leuven--section <span class=
"org-string">"28.1.2 Version Control and the Mode Line"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"vc"</span>

    (GNUEmacs
      (<span class="org-keyword">when</span> (image-type-available-p 'png)
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">http://www.emacswiki.org/emacs/VcIcon</span>
        (<span class="org-keyword">defun</span> <span class=
"org-function-name">vc-icon</span> ()
          <span class=
"org-doc">"Display a colored icon indicating the vc status of the current file."</span>
          (<span class="org-keyword">let</span> ((icon (<span class=
"org-keyword">if</span> (vc-workfile-unchanged-p (buffer-file-name))
                          (concat leuven--directory
                                  <span class=
"org-string">"Pictures/NormalIcon.png"</span>)
                        (concat leuven--directory
                                <span class=
"org-string">"Pictures/ModifiedIcon.png"</span>)))
                (bg-colour (face-attribute 'mode-line <span class=
"org-builtin">:background</span>)))
            (propertize
             <span class="org-string">"  "</span>
             'display (find-image `((<span class="org-builtin">:type</span> png
                                     <span class=
"org-builtin">:file</span> ,icon
                                     <span class=
"org-builtin">:ascent</span> center
                                     <span class=
"org-builtin">:background</span> ,bg-colour))))))

        (setq-default mode-line-format
                      (push '(vc-mode (<span class=
"org-builtin">:eval</span> (vc-icon))) mode-line-format)))))
</pre>
            </div>

            <p>If you choose a JPG icon, you must set its type to
            <code>jpeg</code> (<b>NOT</b> <code>jpg</code>) in
            <code>find-image</code>.</p>

            <p>But don’t forget that JPEG images can’t have <i>transparent
            backgrounds</i>…</p>

            <p>If PNG images are not correctly supported, see <a href=
            "#sec-48-2">Images</a>.</p>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"></td>

                <td width="100%">
                  <b>Lisp expression in mode-line-format</b><br />

                  <p>The Lisp expressions supported in
                  <code>mode-line-format</code> are those documented in the
                  manual, and nothing else. In particular, the
                  <code>:eval</code> part must appear explicitly, and any
                  symbol stands for its value (which is not eval’ed). IOW, a
                  full-blown Lisp evaluation there is not implemented…</p>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div id="outline-container-sec-33-1-2" class="outline-4">
          <h4 id="sec-33-1-2">Features of the Log Entry Buffer</h4>

          <div class="outline-text-4" id="text-33-1-2">
            <p>Show the diff we are about to commit: <code>C-c C-d</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 28.1.4 (info "(emacs)Log Buffer")</span>

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--vc-log-mode-setup</span> ()
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check if `</span><span class="org-comment"><span class=
"org-constant">ispell-program-name</span></span><span class=
"org-comment">' seems correct</span>
    (<span class="org-keyword">when</span> (ispell-check-program-name)
      (setq ispell-local-dictionary <span class="org-string">"american"</span>)
      (flyspell-mode)))

  (add-hook 'vc-log-mode-hook 'leuven--vc-log-mode-setup)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"vc-git"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">major mode for editing git commit messages</span>
    (<span class="org-keyword">when</span> (try-require 'git-commit-mode)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn on on-the-fly spell-checking</span>
      (add-hook 'git-commit-mode-hook 'flyspell-mode)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn off save-place</span>
      (add-hook 'git-commit-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (toggle-save-place 0)))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-1-3" class="outline-4">
          <h4 id="sec-33-1-3">Examining And Comparing Old Revisions</h4>

          <div class="outline-text-4" id="text-33-1-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 28.1.6 (info "(emacs)Old Revisions")</span>

  (leuven--section <span class=
"org-string">"28.1.6 Examining And Comparing Old Revisions"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">switches for diff under VC</span>
  (setq vc-diff-switches diff-switches)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-1-4" class="outline-4">
          <h4 id="sec-33-1-4">VC Directory Mode</h4>

          <div class="outline-text-4" id="text-33-1-4">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 28.1.9 (info "(emacs)VC Directory Mode")</span>

  (leuven--section <span class="org-string">"28.1.9 VC Directory Mode"</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-vc-jump</span> ()
    <span class="org-doc">"Jump to VC status buffer."</span>
    (interactive)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class=
"org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory)))
      (message <span class=
"org-string">"VC status for directory: %s"</span> dname)
      (vc-dir dname)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">vc status without asking for a directory</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;C-f9&gt;"</span>) 'leuven-vc-jump)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hide up-to-date and unregistered files</span>
  (add-hook  'vc-dir-mode-hook
             (<span class="org-keyword">lambda</span> ()
               (define-key vc-dir-mode-map
                 (kbd <span class=
"org-string">"x"</span>) 'leuven-vc-dir-hide-up-to-date-and-unregistered)
               (define-key vc-dir-mode-map
                 (kbd <span class="org-string">"E"</span>) 'vc-ediff)
               (define-key vc-dir-mode-map
                 (kbd <span class=
"org-string">"#"</span>) 'vc-ediff-ignore-whitespace)
                                         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">ediff-windows-wordwise?</span>
               ))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-vc-dir-hide-up-to-date-and-unregistered</span> ()
    (interactive)
    (vc-dir-hide-up-to-date)
    (vc-dir-hide-unregistered))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">vc-dir-hide-unregistered</span> ()
    <span class="org-doc">"Hide unregistered items from display."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((crt (ewoc-nth vc-ewoc -1))
          (first (ewoc-nth vc-ewoc 0)))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">go over from the last item to the first and remove the</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unregistered files and directories with no child files</span>
      (<span class="org-keyword">while</span> (not (eq crt first))
        (<span class="org-keyword">let*</span> ((data (ewoc-data crt))
               (dir (vc-dir-fileinfo-&gt;directory data))
               (next (ewoc-next vc-ewoc crt))
               (prev (ewoc-prev vc-ewoc crt))
               <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ewoc-delete does not work without this...</span>
               (inhibit-read-only t))
          (<span class="org-keyword">when</span> (or
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove directories with no child files</span>
                 (and dir
                      (or
                       <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">nothing follows this directory</span>
                       (not next)
                       <span class=
"org-comment-delimiter">;; </span><span class=
"org-comment">next item is a directory</span>
                       (vc-dir-fileinfo-&gt;directory (ewoc-data next))))
                 <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove files in the unregistered state</span>
                 (eq (vc-dir-fileinfo-&gt;state data) 'unregistered))
            (ewoc-delete vc-ewoc crt))
          (setq crt prev)))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">vc-ediff-ignore-whitespace</span> (historic <span class=
"org-type">&amp;optional</span> not-urgent)
    <span class=
"org-doc">"Ignore regions that differ in white space &amp; line breaks only."</span>
    (interactive (list current-prefix-arg t))
    (<span class="org-keyword">require</span> '<span class=
"org-constant">ediff</span>)
    (<span class="org-keyword">let</span> ((ediff-ignore-similar-regions t))
      (call-interactively 'vc-ediff)))  <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span><span class=
"org-comment"> does not work yet</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-1-5" class="outline-4">
          <h4 id="sec-33-1-5">Customizing VC</h4>

          <div class="outline-text-4" id="text-33-1-5">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 28.1.13 (info "(emacs)Customizing VC")</span>

  (leuven--section <span class="org-string">"28.1.13 Customizing VC"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">files covered by VC get backups (as with other files)</span>
  (setq vc-make-backup-files t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">http://www.emacswiki.org/emacs/VcTopDirectory</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">For git</span>
  (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">vc-dir-prepare-status-buffer</span>
             (before leuven-vcs-goto-top-directory activate compile)
    (<span class="org-keyword">let*</span> ((backend (ad-get-arg 2))
           (vcs-dir (ad-get-arg 1))
           (vcs-top-dir (vc-call-backend backend 'responsible-p vcs-dir)))
      (<span class="org-keyword">when</span> (stringp vcs-top-dir)
        (ad-set-arg 1 vcs-top-dir))))

  (GNUEmacs
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--ediff-revision</span> (file rev1 <span class=
"org-type">&amp;optional</span> rev2)
      <span class=
"org-doc">"Run Ediff by comparing 'master' against the 'current'."</span>
      (<span class="org-keyword">require</span> '<span class=
"org-constant">ediff</span>)
      (find-file file)
      (<span class="org-keyword">if</span> (and (buffer-modified-p)
               (y-or-n-p (format <span class=
"org-string">"Buffer %s is modified.  Save buffer? "</span>
                                 (buffer-name))))
          (save-buffer (current-buffer)))
      (ediff-load-version-control)
      (funcall
       (intern (format <span class=
"org-string">"ediff-%S-internal"</span> ediff-version-control-package))
       rev1 rev2 nil))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-vc-diff</span> (<span class=
"org-type">&amp;optional</span> arg)
      (interactive <span class="org-string">"P"</span>)
      (call-interactively
       (<span class="org-keyword">cond</span> (arg
              (<span class="org-keyword">lambda</span> ()
                (interactive)
                (vc-diff nil)))
             (t
              (<span class="org-keyword">lambda</span> ()
                (interactive)
                (leuven--ediff-revision (buffer-file-name)
                                        (read-string <span class=
"org-string">"revision? "</span>
                                                     <span class=
"org-string">"HEAD"</span> nil <span class="org-string">"HEAD"</span>)
                                        <span class=
"org-string">""</span>))))))

    (define-key vc-prefix-map
      (kbd <span class="org-string">"="</span>) 'leuven-vc-diff))
</pre>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Customize `vc-annotate-background’ (and
                future `vc-annotate-foreground’)</b><br /></td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-33-2" class="outline-3">
        <h3 id="sec-33-2">Change Logs</h3>

        <div class="outline-text-3" id="text-33-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 28.2 (info "(emacs)Change Log")</span>

  (leuven--section <span class="org-string">"28.2 (emacs)Change Logs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"add-log"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't make a new entry, when the last entry was made by you and on</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the same date</span>
    (setq add-log-always-start-new-record nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">adds the file's version number to the change log entry</span>
    (setq change-log-version-info-enabled t)

    (add-hook 'change-log-mode-hook
              (add-to-list
               'change-log-font-lock-keywords
               '(<span class="org-string">"^[0-9-]+:? +</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">^</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">Sun</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Mon</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Tue</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Wed</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Thu</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Fri</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">Sat</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string"> [A-z][a-z][a-z] [0-9:+ ]+"</span>
                 (0 'change-log-date-face)
                 (<span class="org-string">"</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string">&lt;(]+?</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">[   ]*[(&lt;]</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[[:alnum:]_.+-]+@[[:alnum:]_.-]+</span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">[&gt;)]"</span> nil nil
                  (1 'change-log-name)
                  (2 'change-log-email))))))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-33-3" class="outline-3">
        <h3 id="sec-33-3">Tags Tables</h3>

        <div class="outline-text-3" id="text-33-3">
          <p>Using tags tables is the most generic approach to setup code
          navigation. A “tag” signifies a language object for which an index
          entry is available.</p>

          <p>Once you’ve built a <code>TAGS</code> file (<code>ctags</code> /
          <code>etags</code>), you can find all commands that match a
          regexp.</p>

          <p>Support for tags has been in Emacs for a long time: any
          installation of Emacs should comes with the <code>etags</code>
          program, which supports many different languages.</p>

          <p>Comparison of tools:</p>

          <dl class="org-dl">
            <dt>etags (Emacs-style TAGS file)</dt>

            <dd>
              <p>Ada, Asm, C, Objective C, C++, C#, Cobol, Erlang, Forth,
              Fortran, HTML, Java, Lisp, Lua, Makefile, Pascal, Perl, PHP,
              Postscript, Prolog, Python, Scheme, TeX, TeXinfo, and YACC.</p>

              <p>On Windows, Emacs comes with <code>etags</code> and a similar
              executable file called <code>ctags</code>. In the Emacs
              distribution, <code>etags.exe</code> = <code>ctags.exe</code> in
              the <code>bin</code> directory.</p>
            </dd>

            <dt>Exuberant Ctags</dt>

            <dd>
              <p>Ant, Asm, Asp, Awk, Basic, BETA, C, C++, C#, Cobol, DosBatch,
              Eiffel, Erlang, Flex, Fortran, HTML, Java, JavaScript, Lisp, Lua,
              Makefile, MatLab, OCaml, Pascal, Perl, PHP, Python, REXX, Ruby,
              Scheme, Sh, SLang, SML, SQL, Tcl, TeX, Vera, Verilog, VHDL, Vim,
              and YACC.</p>

              <p>You should download <b>Exuberant Ctags</b> from <a href=
              "http://ctags.sourceforge.net/">http://ctags.sourceforge.net/</a>
              or from Cygwin. Only <b>Exuberant</b> <code>ctags.exe</code>
              recognizes <code>-e</code> option (<i>etags mode</i>, which will
              create a tag file for use with the Emacs editor).</p>

              <p>Exuberant Ctags can be extended to look for other things via
              regular expression. It is a wonderful thing!</p>

              <p>For example, I can now look for tags in my shell code to by
              running:</p>

              <div class="org-src-container">
                <pre class="src src-sh">
etags --langdef=shell --regex-shell=<span class=
"org-string">'/function [_[:alnum:]]+/[_[:alnum:]]+/'</span> --language-force=shell
</pre>
              </div>
            </dd>

            <dt>Cscope</dt>

            <dd>
              <p>C, but flexible enough to support C++ and Java, and to be used
              as a generalized “grep database”.</p>
            </dd>

            <dt>ebrowse</dt>

            <dd>
              <p>For C++, you will be better off with ebrowse, a program that
              also comes with Emacs. It understands C++ much better than etags
              does, and provides similar commands (so you don’t lose anything).
              Check out the Ebrowse manual, which is part of the Emacs
              distribution, for details.</p>
            </dd>

            <dt>GNU Idutils</dt>

            <dt>GNU Global (gtags)</dt>

            <dd>
              <p>C, C++, Yacc, Java, and PHP4.</p>

              <p>Global is a lot smarter about finding tags tables, and is
              fairly fast to update.</p>
            </dd>
          </dl>

          <p><b>Emacs TAGS</b> and <b>Exuberant Ctags</b> don’t do fancy stuff,
          e.g. keeping an index of function references. They record only
          positions where a function (or variable etc.) is <b>defined</b>.</p>

          <p>Recording positions where a function is <b>called</b> (finding all
          <b>symbol references</b>) is the kind of thing external tools such as
          <b>GNU Global</b>, <b>GNU Idutils</b> and <b>Cscope</b> can do for
          you, if you’re working with a language that they support. <b>Grep</b>
          would be the fallback method.</p>

          <p>Please also see <a href=
          "http://hub.opensolaris.org/bin/view/Project+opengrok/">Comparison
          with Similar Tools</a>.</p>

          <p>Once you have a good tagging system in place, many tools become
          enabled for your language, such as:</p>

          <ul class="org-ul">
            <li>tag decoration mode (like drawing lines over the top of
            function tags),</li>

            <li>stickyfunc mode (which shows the current function in the header
            line),</li>

            <li><a href="#sec-33-4-2">Emacs Code Browser</a>, and</li>

            <li>tag jumping.</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 28.3 (info "(emacs)Tags")</span>

  (leuven--section <span class="org-string">"28.3 (emacs)Tags Tables"</span>)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-33-3-1" class="outline-4">
          <h4 id="sec-33-3-1">Creating Tags Tables</h4>

          <div class="outline-text-4" id="text-33-3-1">
            <p>First of all, you must build a <code>TAGS</code> file (which
            keeps the symbols from your project, by scanning all the source and
            header files with the <code>etags</code> command).</p>

            <p>For example, you can have a <code>TAGS</code> Makefile target to
            do this for you:</p>
            <pre class="example">
TAGS:
        rm -f TAGS
        find $$(pwd) \( -name \*.el \
                     -o -name \*.[chCH] \
                     \) -print | /usr/bin/ctags -e -
</pre>

            <p>You can create a <code>TAGS</code> file by using <code>M-x
            compile &lt;RET&gt; tags &lt;RET&gt;</code>.</p>

            <p>Alternatively,</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"etags"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">tags enhancements</span>
    (try-require 'sure-tags))
</pre>
            </div>

            <p>will make sure that <code>TAGS</code> file exists (and builds it
            if it doesn’t), allowing you to</p>

            <ul class="org-ul">
              <li>first rebuild the <code>TAGS</code> file or</li>

              <li>specify a new one</li>
            </ul>

            <p>when the search fails.</p>
          </div>
        </div>

        <div id="outline-container-sec-33-3-2" class="outline-4">
          <h4 id="sec-33-3-2">Selecting a Tags Table</h4>

          <div class="outline-text-4" id="text-33-3-2">
            <p>After this, you can select the tag file to use with the command
            <code>M-x visit-tags-table &lt;RET&gt;</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of file names of tags tables to search</span>
  (setq tags-table-list
        '(
          <span class="org-string">"~/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"/usr/local/lib/emacs/src/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"/usr/share/texmf-texlive/tex/latex/TAGS"</span>
          ))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-3-3" class="outline-4">
          <h4 id="sec-33-3-3">Finding a Tag</h4>

          <div class="outline-text-4" id="text-33-3-3">
            <p>You can <b>jump to</b> the first <b>definition</b> of a tag
            (matching your regexp) – <b>according to TAGS file</b> – by using
            <code>M-x find-tag</code> (bound to <code>M-.</code>). The default
            tag is the identifier under the cursor.</p>

            <p>To continue searching for <b>next definition</b>, use <code>C-u
            M-.</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">find-next-tag</span> ()
    (interactive)
    (find-tag nil t))
</pre>
            </div>

            <p>Use <code>M-*</code> (<code>M-x pop-tag-mark</code>) to <b>jump
            back</b> to where you last invoked <code>M-.</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-33-3-4" class="outline-4">
          <h4 id="sec-33-3-4">Select from multiple TAGS files</h4>

          <div class="outline-text-4" id="text-33-3-4">
            <p>You can search for <b>occurrences</b> of tags that match you
            regexp on all files in the TAGS table, by using <code>M-x
            tags-search &lt;RET&gt;</code>.</p>

            <p>To continue searching for next match, use ~M-,~.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"etags"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">select from multiple tags</span>
    (<span class="org-keyword">when</span> (try-require 'etags-select)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">do a `</span><span class="org-comment"><span class=
"org-constant">find-tag-at-point</span></span><span class=
"org-comment">', and display all exact matches</span>
      (global-set-key
        (kbd <span class=
"org-string">"M-?"</span>) 'etags-select-find-tag-at-point)))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-3-5" class="outline-4">
          <h4 id="sec-33-3-5">Find Emacs Lisp symbol definition</h4>

          <div class="outline-text-4" id="text-33-3-5">
            <p>Find the definition of the Emacs Lisp symbol near point:</p>

            <dl class="org-dl">
              <dt><code>C-x F</code></dt>

              <dd>Find <b>function</b>.</dd>

              <dt><code>C-x V</code></dt>

              <dd>Find <b>variable</b>.</dd>

              <dt><code>C-x K</code></dt>

              <dd>Find function <b>bound to key</b> sequence.</dd>
            </dl>

            <p>Use <code>C-x 4</code> for displaying in another window, and
            <code>C-x 5</code> for displaying in another frame.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">find the definition of the Emacs Lisp function or variable near point</span>
  (GNUEmacs
    (find-function-setup-keys))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
(<span class="org-keyword">progn</span>
  (<span class="org-keyword">require</span> '<span class=
"org-constant">thingatpt</span>)

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-find-symbol-at-point</span> ()
    <span class="org-doc">"Find the definition of the symbol at point."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((sym (symbol-at-point)))
      (funcall (<span class="org-keyword">pcase</span> sym
                 ((pred facep)           'find-face)
                 ((pred symbol-function) 'find-function)
                 (_                      'find-variable))
               sym)))

  (global-set-key (kbd <span class=
"org-string">"&lt;S-return&gt;"</span>) 'leuven-find-symbol-at-point))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-33-4" class="outline-3">
        <h3 id="sec-33-4">Emacs Development Environment</h3>

        <div class="outline-text-3" id="text-33-4"></div>

        <div id="outline-container-sec-33-4-1" class="outline-4">
          <h4 id="sec-33-4-1">Collection of Emacs Development Environment
          Tools</h4>

          <div class="outline-text-4" id="text-33-4-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 28.4 (info "(emacs)EDE")</span>

  (leuven--section <span class=
"org-string">"28.4 Emacs Development Environment"</span>)
</pre>
            </div>

            <p>CEDET (integrated into Emacs 23.2) brings improvements over a
            plain TAGS file. It provides:</p>

            <dl class="org-dl">
              <dt><a href=
              "http://www.gnu.org/software/emacs/manual/semantic.html">Semantic</a></dt>

              <dd>
                <p>A <b>parser</b> and code analyzer which provides <b>smart
                completion</b> (“Intellisense”).</p>
              </dd>

              <dt>EDE</dt>

              <dd>
                <p>A <b>project management</b> system which can <b>generate
                Makefiles</b> to compile your code for you.</p>

                <p>Look as well at Projectile!</p>
              </dd>

              <dt>SRecode</dt>

              <dd>
                <p>A template / <b>code generation</b> system which can convert
                tags from semantic back into code.</p>
              </dd>

              <dt>COGRE (COnnected GRaph Editor)</dt>

              <dd>
                <p>A <b>UML diagram editor</b> which can generate code from a
                class diagram that you draw in Emacs.</p>
              </dd>
            </dl>

            <p>See <a href=
            "http://cedet.sourceforge.net/languagesupport.shtml">supported
            languages</a>.</p>

            <p>The commands to display <b>symbol references</b> are:</p>

            <dl class="org-dl">
              <dt><code>C-c , g</code></dt>

              <dd><code>semantic-symref-symbol</code>.</dd>

              <dt><code>C-c , G</code></dt>

              <dd><code>semantic-symref</code> (current tag).</dd>
            </dl>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (<span class=
"org-keyword">unless</span> (string&lt; emacs-version <span class=
"org-string">"23.2"</span>)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; enable global EDE (project management) features</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-ede-mode 1)</span>

    (setq semantic-default-submodes
          '(
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn Semantic DB mode on (Semantic parsers store the results of</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">parsing source code in a database file, which can be saved for</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">future Emacs sessions)</span>
            global-semanticdb-minor-mode

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the idle scheduler will automatically reparse buffers in idle</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">time</span>
            global-semantic-idle-scheduler-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[minimum-features]</span>

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display a summary of the symbol at point in the echo area</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(~ ElDoc)</span>
            global-semantic-idle-summary-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display a tooltip with a list of possible completions near the</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cursor</span>
            global-semantic-idle-completions-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn Semantic MRU Bookmarks on (keep track of the Most</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Recently Used tags)</span>
            global-semantic-mru-bookmark-mode

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Semantic-Stickyfunc mode (display a header line that shows</span>
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the declaration line of the function or tag)</span>
            global-semantic-stickyfunc-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Semantic-Highlight-Func mode</span>
            global-semantic-highlight-func-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[excessive-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn on all active decorations</span>
            global-semantic-decoration-mode <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">[gaudy-code-helpers]</span>
            ))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> if prog-mode, then Semantic will be launched after Emacs init, as</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the scratch buffer is in Emacs Lisp...</span>
    (add-hook 'java-mode-hook 'semantic-mode) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">enable parser features (Semantic</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">mode) and install a `</span><span class=
"org-comment"><span class="org-constant">Development</span></span><span class=
"org-comment">' menu</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">on the menu-bar</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; smart completion, and display of information for tags &amp; classes</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(require 'semantic/ia)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(require 'semantic/db)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"semantic"</span>

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--semantic</span> ()
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically complete whatever symbol you are typing</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c ?"</span>) 'semantic-ia-complete-symbol) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">better binding: `</span><span class="org-comment"><span class=
"org-constant">M-/</span></span><span class="org-comment">'?</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">jump to the definition of the symbol under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c j"</span>) 'semantic-ia-fast-jump) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">where a symbol is declared</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show the documentation of the symbol under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c q"</span>) 'semantic-ia-show-doc) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">show javadoc of the right method</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show a summary about the symbol under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c s"</span>) 'semantic-ia-show-summary)


        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show possible public member functions or data members (when at `.'</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">or `</span><span class="org-comment"><span class=
"org-constant">-&gt;</span></span><span class=
"org-comment">' after an object name)</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c &gt;"</span>) 'semantic-complete-analyze-inline)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">toggle between the implementation and a prototype of symbol under</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c p"</span>) 'semantic-analyze-proto-impl-toggle)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">visit the header file under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c ="</span>) 'semantic-decoration-include-visit)


        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unfold the block under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c +"</span>) 'semantic-tag-folding-show-block)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fold the block under cursor</span>
        (local-set-key
          (kbd <span class=
"org-string">"C-c -"</span>) 'semantic-tag-folding-fold-block)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">C-c C-c is not a prefix key!</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; unfold all</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(kbd "C-c C-c +") 'semantic-tag-folding-show-all)</span>
        <span class="org-comment-delimiter">;;</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; fold all</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(kbd "C-c C-c -") 'semantic-tag-folding-fold-all)</span>
        )

      (add-hook 'prog-mode-hook 'leuven--semantic)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--c-mode-semantic</span> ()
        <span class="org-doc">"Completion on `.' or `</span><span class=
"org-doc"><span class="org-constant">-&gt;</span></span><span class=
"org-doc">'."</span>
        (local-set-key (kbd <span class=
"org-string">"."</span>) 'semantic-complete-self-insert)
        (local-set-key (kbd <span class=
"org-string">"&gt;"</span>) 'semantic-complete-self-insert)
        (local-set-key (kbd <span class=
"org-string">"C-c C-r"</span>) 'semantic-symref))

      (add-hook 'c-mode-common-hook 'leuven--c-mode-semantic))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">hooks, specific for Semantic</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--semantic-imenu</span> ()
      (imenu-add-to-menubar <span class="org-string">"TAGS"</span>))

    (add-hook 'semantic-init-hooks 'leuven--semantic-imenu)

    )
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-33-4-2" class="outline-4">
          <h4 id="sec-33-4-2"><a id="ID-5032bcdb-ac6b-4101-a0ce-28192fb7e247"
          name="ID-5032bcdb-ac6b-4101-a0ce-28192fb7e247"></a>Advanced Code
          Browsing</h4>

          <div class="outline-text-4" id="text-33-4-2">
            <p>Some people use CEDET in combination with <a href=
            "http://www.xemacs.org/Documentation/packages/html/ecb_2.html">ECB
            (the Emacs Code Browser)</a>, which provides views of directories
            and files.</p>

            <p>Keyboard navigation:</p>

            <dl class="org-dl">
              <dt><code>C-c . g d</code></dt>

              <dd>Go to directories.</dd>

              <dt><code>C-c . g s</code></dt>

              <dd>Go to sources.</dd>

              <dt><code>C-c . g m</code></dt>

              <dd>Go to methods.</dd>

              <dt><code>C-c . g h</code></dt>

              <dd>Go to history.</dd>

              <dt><code>C-c . g 1</code></dt>

              <dd>Go to edit buffer.</dd>
            </dl>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Emacs Code Browser</span>
  (custom-set-variables '(ecb-options-version <span class=
"org-string">"2.40"</span>))
  (<span class="org-keyword">when</span> (try-require 'ecb-autoloads)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">trick for starting ECB 2.40 (with CEDET merged in Emacs since 23.2)</span>
    (GNUEmacs
      (<span class="org-keyword">require</span> '<span class=
"org-constant">semantic/analyze</span>))
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semantic-analyze</span>)
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semantic-ctxt</span>)
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semanticdb</span>)
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semanticdb-find</span>)
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semanticdb-mode</span>)
    (<span class="org-keyword">provide</span> '<span class=
"org-constant">semantic-load</span>)

    (setq stack-trace-on-error t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't show tip of the day at start time of ECB</span>
    (setq ecb-tip-of-the-day nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">toggle activation of ECB (between `</span><span class=
"org-comment"><span class="org-constant">ecb-activate</span></span><span class=
"org-comment">' and</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">ecb-deactivate</span></span><span class="org-comment">')</span>
    (global-set-key
      (kbd <span class="org-string">"C-c e"</span>) 'ecb-minor-mode)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key (kbd "&lt;M-left&gt;") 'ecb-goto-window-methods)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key (kbd "&lt;M-right&gt;") 'ecb-goto-window-edit1)</span>
    )
</pre>
            </div>

            <p>If you’ve installed CEDET and ECB, EmacsAssist is worth trying
            out: <a href=
            "http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html">
            http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html</a></p>

            <p>It uses CEDET to provide a handy symbols browser for the current
            file, that narrows down the list as you type substrings. Tastes
            differ, but I for one really like this.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
   (<span class="org-keyword">when</span> (try-require 'eassist)

     (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--c-mode-eassist</span> ()
       (local-set-key
         (kbd <span class="org-string">"C-c t"</span>) 'eassist-switch-h-cpp)
       (local-set-key
         (kbd <span class="org-string">"C-x t"</span>) 'eassist-switch-h-cpp)
       (local-set-key
         (kbd <span class="org-string">"C-c e"</span>) 'eassist-list-methods))

     (add-hook 'c-mode-common-hook 'leuven--c-mode-eassist))
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 28 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-34" class="outline-2">
      <h2 id="sec-34">Abbrevs</h2>

      <div class="outline-text-2" id="text-34">
        <p>An “abbrev” is a <b>word</b> which has been defined (in a fixed
        list) to “expand” into a specified <b>expansion</b>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 29 (info "(emacs)Abbrevs")</span>

(leuven--chapter leuven-chapter-29-abbrevs <span class=
"org-string">"29 Abbrevs"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">See (info "(autotype)") as well</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-34-1" class="outline-3">
        <h3 id="sec-34-1">Controlling Abbrev Expansion</h3>

        <div class="outline-text-3" id="text-34-1">
          <p>For complex templates, I use <code>YASnippet</code>. For example,
          new file templates (where it’s Lisp evaluation is handy), class and
          function templates with docblocks, etc. I use it to reduce the
          repetitious parts of programming, and let me focus on getting things
          done.</p>

          <p><code>YASnippet</code> does support mirror fields and
          transformations. It also does support multiple snippet with same
          name. It will also expand snippets containing non-word-constituent
          characters, which <code>abbrev</code> can’t. So I can’t have
          <code>@p</code> expand to <code>@param</code> with
          <code>abbrev</code>, but I can with <code>YASnippet</code>.</p>

          <p>XXX Look at <a href=
          "https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el">
          https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el</a></p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 29.3 Controlling (info "(emacs)Expanding Abbrevs")</span>

  (leuven--section <span class=
"org-string">"29.3 Controlling Expanding Abbrevs"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Yet Another Snippet extension for Emacs</span>
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use the "standard" package (NOT `</span><span class=
"org-comment"><span class=
"org-constant">yasnippet-bundle</span></span><span class=
"org-comment">'!)</span>
    (<span class="org-keyword">when</span> (try-require 'yasnippet)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-34-1-1" class="outline-4">
          <h4 id="sec-34-1-1">Installation</h4>

          <div class="outline-text-4" id="text-34-1-1"></div>

          <div id="outline-container-sec-34-1-1-1" class="outline-5">
            <h5 id="sec-34-1-1-1">Use YASnippet as a global minor mode</h5>

            <div class="outline-text-5" id="text-34-1-1-1">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable YASnippet in all buffers</span>
      (yas-global-mode 1)
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-34-1-1-2" class="outline-5">
            <h5 id="sec-34-1-1-2">Use <code>yas-minor-mode</code> on a
            per-buffer basis</h5>

            <div class="outline-text-5" id="text-34-1-1-2">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load the snippet tables</span>
      (yas-reload-all)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable YASnippet in programming modes only</span>
      (add-hook 'prog-mode-hook
                '(<span class="org-keyword">lambda</span> ()
                   (yas-minor-mode)))
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-1-2" class="outline-4">
          <h4 id="sec-34-1-2">Organizing snippets</h4>

          <div class="outline-text-4" id="text-34-1-2">
            <p>Where are the snippets? <code>yas-snippet-dirs</code> is assumed
            to contain <b>directories of modes</b> with snippets.</p>

            <p>By default, put <b>your own snippets</b> in the directory
            <code>~/.emacs.d/snippets</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
      (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven-yasnippet-my-snippets-dir</span>
        <span class="org-string">"~/src/yasnippet/snippets"</span>
        <span class=
"org-doc">"Directory containing my personal additional YASnippets."</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">root directories that store the snippets</span>
      (<span class="org-keyword">let</span> ((my-snippets
             leuven-yasnippet-my-snippets-dir)
            (org-snippets
             (concat leuven-local-repos-directory <span class=
"org-string">"yasnippet-org-mode"</span>)))

        (<span class="org-keyword">when</span> (file-directory-p org-snippets)
          (add-to-list 'yas-snippet-dirs org-snippets))

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the first element is always the user-created snippets directory</span>
        (<span class="org-keyword">when</span> (file-directory-p my-snippets)
          (add-to-list 'yas-snippet-dirs my-snippets)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use Snippet mode for files with a `</span><span class=
"org-comment"><span class="org-constant">yasnippet</span></span><span class=
"org-comment">' extension</span>
      (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.yasnippet\\'"</span> . snippet-mode))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-1-3" class="outline-4">
          <h4 id="sec-34-1-3">Expanding snippets</h4>

          <div class="outline-text-4" id="text-34-1-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insert snippet at point</span>
      (global-set-key (kbd <span class=
"org-string">"C-c s"</span>) 'yas-insert-snippet) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">also on `C-c &amp; C-s'</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind `</span><span class="org-comment"><span class=
"org-constant">yas-expand</span></span><span class=
"org-comment">' to SPC</span>
      (define-key yas-minor-mode-map (kbd <span class=
"org-string">"&lt;tab&gt;"</span>) nil)
      (define-key yas-minor-mode-map (kbd <span class=
"org-string">"TAB"</span>) nil)
      (define-key yas-minor-mode-map (kbd <span class=
"org-string">"SPC"</span>) 'yas-expand)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't expand when you are typing in a string or comment</span>
      (add-hook 'prog-mode-hook
                '(<span class="org-keyword">lambda</span> ()
                   (setq yas-buffer-local-condition
                         '(<span class=
"org-keyword">if</span> (nth 8 (syntax-ppss)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">non-nil if in a string or comment</span>
                              '(require-snippet-condition . force-in-comment)
                            t))))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">UI for selecting snippet when there are multiple candidates</span>
      (setq yas-prompt-functions '(yas-dropdown-prompt))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-1-4" class="outline-4">
          <h4 id="sec-34-1-4">Writing snippets</h4>

          <div class="outline-text-4" id="text-34-1-4">
            <p>See <a href=
            "http://cupfullofcode.com/snippet-expansion-with-yasnippet/">http://cupfullofcode.com/snippet-expansion-with-yasnippet/</a>.</p>

            <dl class="org-dl">
              <dt><code>C-c &amp; C-n</code>
              (<code>yas-new-snippet</code>)</dt>

              <dd>Creates a new snippet, pre-filled out with the basic
              structure.</dd>

              <dt><code>C-c &amp; C-v</code></dt>

              <dd><code>yas-visit-snippet-file</code></dd>
            </dl>

            <p>After editing your snippets:</p>

            <ul class="org-ul">
              <li><code>M-x yas-recompile-all</code> to compile all
              snippets,</li>

              <li><code>M-x yas-reload-all</code> to reload them all.</li>
            </ul>

            <p>Automatically reload snippets after saving.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically reload snippets after saving</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">recompile-and-reload-all-snippets</span> ()
        (interactive)
        (<span class="org-keyword">when</span> (eq major-mode 'snippet-mode)
          (yas-recompile-all)
          (yas-reload-all)
          (message <span class="org-string">"Reloaded all snippets"</span>)))

      (add-hook 'after-save-hook 'recompile-and-reload-all-snippets)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-1-5" class="outline-4">
          <h4 id="sec-34-1-5">Frequently Asked Questions</h4>

          <div class="outline-text-4" id="text-34-1-5"></div>

          <div id="outline-container-sec-34-1-5-1" class="outline-5">
            <h5 id="sec-34-1-5-1">Why is there an extra newline?</h5>

            <div class="outline-text-5" id="text-34-1-5-1">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
      (add-hook 'snippet-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (setq require-final-newline nil)))))
</pre>
              </div>
            </div>
          </div>

          <div id="outline-container-sec-34-1-5-2" class="outline-5">
            <h5 id="sec-34-1-5-2">Why doesn’t TAB expand a snippet?</h5>

            <div class="outline-text-5" id="text-34-1-5-2">
              <ol class="org-ol">
                <li>
                  <p>Check the mode line to see if there’s <code>yas</code>. If
                  not, then try <code>M-x yas-minor-mode</code> to manually
                  turn on the minor mode and try to expand the snippet
                  again.</p>

                  <p>If it works, then, you can add the following code to your
                  <code>.emacs</code> before loading YASnippet:</p>
                  <pre class="example">
(add-hook 'the-major-mode-hook 'yas-minor-mode-on)
</pre>

                  <p>where <code>the-major-mode</code> is the major mode in
                  which <code>yas-minor-mode</code> isn’t enabled by
                  default.</p>

                  <p>You can also use the command <code>M-x
                  yas-global-mode</code> to turn on YASnippet automatically for
                  all major modes.</p>
                </li>

                <li>
                  <p>If <code>yas-minor-mode</code> is on but the snippet still
                  not expanded, then try to see what command is bound to the
                  <code>TAB</code> key: press <code>C-h k</code> and then press
                  <code>TAB</code>. Emacs will show you the result.</p>

                  <p>You’ll see a buffer prompted by Emacs saying that
                  <code>TAB</code> runs the command “…”. Alternatively, you
                  might see <code>&lt;tab&gt;</code> runs the command “…”. Note
                  the difference between <code>TAB</code> and
                  <code>&lt;tab&gt;</code> where the latter has priority.</p>

                  <p>If you see <code>&lt;tab&gt;</code> bound to a command
                  other than <code>yas-expand</code> (e.g. in org-mode), you
                  can try a work around. See <a href=
                  "https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org">
                  https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org</a>.</p>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-34-2" class="outline-3">
        <h3 id="sec-34-2"><a id="ID-0fa23e4a-e42c-4317-834c-d2ef7c9d741c" name=
        "ID-0fa23e4a-e42c-4317-834c-d2ef7c9d741c"></a>Dynamic Abbrev
        Expansion</h3>

        <div class="outline-text-3" id="text-34-2">
          <p>“Dynamic abbrevs” allow the meanings of abbreviations (expansions)
          to be <b>determined automatically from the contents of the
          buffer</b>. It is completely independent of Abbrev mode.</p>

          <ul class="org-ul">
            <li><code>M-/</code> runs the command <code>dabbrev-expand</code>
            by default. Expand previous word “dynamically”. <b>Expands to the
            most recent, preceding word</b> for which this is a prefix.</li>

            <li><code>C-M-/</code> runs the command
            <code>dabbrev-completion</code>. Completion on current word. Like
            <code>M-/</code> but finds all expansions in the current buffer and
            <b>presents suggestions for completion</b>.</li>
          </ul>

          <p>See <a href="#sec-31-8">completion for symbol names</a>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 29.7 (info "(emacs)Dabbrev Customization")</span>

  (leuven--section <span class=
"org-string">"29.7 Dabbrev Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(with-eval-after-load "dabbrev"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; preserve case when expanding the abbreviation</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(setq dabbrev-case-replace nil))</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-34-2-1" class="outline-4">
          <h4 id="sec-34-2-1">Hippie-expand</h4>

          <div class="outline-text-4" id="text-34-2-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">expand text trying various ways to find its expansion</span>
  (global-set-key
    (kbd <span class="org-string">"M-/"</span>) 'hippie-expand)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"hippie-exp"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of expansion functions tried (in order) by `</span><span class="org-comment"><span class="org-constant">hippie-expand</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(completion strategy)</span>
    (setq hippie-expand-try-functions-list
          '(try-expand-dabbrev          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">current buffer</span>
            try-expand-dabbrev-visible  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">visible (parts of all) buffers</span>
            try-expand-dabbrev-from-kill <span class=
"org-comment-delimiter">; </span><span class="org-comment">kill ring</span>
            try-complete-file-name-partially <span class=
"org-comment-delimiter">; </span><span class="org-comment">file names</span>
            try-complete-file-name
            try-expand-all-abbrevs      <span class=
"org-comment-delimiter">; </span><span class="org-comment">abbreviations</span>
            try-expand-list
            try-expand-line
            try-complete-lisp-symbol-partially
            try-complete-lisp-symbol
            try-expand-whole-kill))

    (setq hippie-expand-try-functions-list
          '(try-complete-file-name-partially <span class=
"org-comment-delimiter">; </span><span class="org-comment">file names</span>
            try-complete-file-name
            try-expand-all-abbrevs      <span class=
"org-comment-delimiter">; </span><span class="org-comment">abbreviations</span>
            try-expand-dabbrev          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">current buffer</span>
            try-expand-dabbrev-from-kill)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">kill ring</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">integrate YASnippet with `</span><span class=
"org-comment"><span class=
"org-constant">hippie-expand</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"yasnippet"</span>

      (add-to-list 'hippie-expand-try-functions-list
                    'yas-hippie-try-expand)))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">makes more sense when placed at the</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">top of the list</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-2-2" class="outline-4">
          <h4 id="sec-34-2-2">Auto-Complete (“IntelliSensy” completion when
          writing code)</h4>

          <div class="outline-text-4" id="text-34-2-2">
            <p>Extensible inline text completion mechanism – really
            brilliant!</p>

            <p>Auto-complete uses the variable <code>ac-modes</code> to decide
            whether to enable auto-completion in a particular mode; by default,
            <code>org-mode</code> (which interprets the
            <code>&lt;tab&gt;</code> key) is not present in this list. So, to
            enable auto-completion in Org mode, simply add it to the
            <code>ac-modes</code>:</p>
            <pre class="example">
(add-to-list 'ac-modes 'org-mode)
</pre>

            <p>Popups:</p>

            <ul class="org-ul">
              <li>
                <p><b>Completion menu</b></p>

                <p>Candidates suffix:</p>

                <ul class="org-ul">
                  <li>(nothing) – means it is buffer string cache
                  complete.</li>

                  <li><code>v</code> – Variable</li>

                  <li><code>f</code> – Function</li>

                  <li><code>s</code> – Symbol</li>

                  <li><code>c</code> – Constant</li>

                  <li><code>a</code> – Abbrev, yasnippet</li>

                  <li><code>d</code> – Dictionary, environment variable (e.g.
                  LC_CTYPE)</li>

                  <li><code>m</code> – Module</li>
                </ul>
              </li>

              <li>
                <p><b>Quick help</b> (tooltip appearing at the side of the
                completion menu)</p>
              </li>
            </ul>

            <p>According to the settings, completion is done by
            <code>TAB</code> or <code>RET</code>:</p>

            <dl class="org-dl">
              <dt><code>ac-expand</code> (<code>TAB</code>, by default)</dt>

              <dd>Select candidates in cycle.</dd>

              <dt><code>ac-complete</code> (<code>RET</code>)</dt>

              <dd>Complete a selected candidate immediately.</dd>
            </dl>

            <p>There are other ways to select candidates:</p>

            <ul class="org-ul">
              <li><code>M-1</code> to select candidate 1,</li>

              <li><code>M-2</code> to select candidate 2,</li>

              <li>and so on (until 9).</li>
            </ul>

            <p>Other operations are enabled temporarily when completion is
            started:</p>

            <dl class="org-dl">
              <dt><code>C-s</code> (<code>ac-isearch</code>)</dt>

              <dd>
                <p><b>Filter</b> completion candidates.</p>
              </dd>

              <dt><code>&lt;C-down&gt;</code> or <code>C-M-n</code>
              (<code>ac-quick-help-scroll-down</code>)</dt>

              <dd>
                <p>Scroll down quick help.</p>
              </dd>

              <dt><code>&lt;C-up&gt;</code> or <code>C-M-p</code>
              (<code>ac-quick-help-scroll-up</code>)</dt>

              <dd>
                <p>Scroll up quick help.</p>
              </dd>

              <dt><code>&lt;f1&gt;</code> (or <code>C-?</code>,
              <code>ac-help</code>)</dt>

              <dd>
                <p>Show additional <b>help</b> (for functions, arguments and
                objects) in <b>temporary buffer</b>.</p>

                <p>Use <code>C-M-v</code> (or <code>C-M-S-v</code>) to scroll
                down (or up).</p>
              </dd>

              <dt><code>&lt;M-f1&gt;</code> (or <code>C-M-?</code>,
              <code>ac-persist-help</code>)</dt>

              <dd>
                <p>Show additional <b>help</b> in <b>persistent buffer</b>.</p>
              </dd>
            </dl>

            <p>Eventually, see <a href=
            "http://stackoverflow.com/questions/19900949/how-to-make-auto-complete-work-with-yasnippet-and-abbrev">
            How to make auto-complete work with yasnippet and abbrev?</a></p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (GNUEmacs

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Auto Completion</span>
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"auto-complete-config"</span>)
      (idle-require 'auto-complete-config)

      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"auto-complete-config"</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; 5.4 completion will be started automatically by inserting 2 characters</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ac-auto-start 2)</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">6.1 set a list of sources to use (by default + for some major modes)</span>
        (ac-config-default)             <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">... and enable Auto-Complete mode in</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">all buffers</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">7.5 use `</span><span class="org-comment"><span class=
"org-constant">C-n/C-p</span></span><span class=
"org-comment">' to select candidates (only when completion menu is</span>
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">displayed)</span>
        (setq ac-use-menu-map t)
        (define-key ac-menu-map (kbd <span class=
"org-string">"C-n"</span>) 'ac-next)
        (define-key ac-menu-map (kbd <span class=
"org-string">"C-p"</span>) 'ac-previous)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unbind some keys (inconvenient in Comint buffers)</span>
        (define-key ac-completing-map (kbd <span class=
"org-string">"M-n"</span>) nil)
        (define-key ac-completing-map (kbd <span class=
"org-string">"M-p"</span>) nil)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add other modes into `</span><span class=
"org-comment"><span class="org-constant">ac-modes</span></span><span class=
"org-comment">'</span>
        (setq ac-modes
              (append ac-modes
                      '(change-log-mode
                        org-mode
                        prog-mode       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">programming modes</span>
                        snippet-mode
                        sql-mode
                        text-mode)))

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">7.8 enable auto-complete-mode automatically for Sword mode</span>
        (add-to-list 'ac-modes 'sword-mode) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">brand new mode</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.1 delay to completions will be available</span>
        (setq ac-delay 0)               <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">faster than default 0.1</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.2 completion menu will be automatically shown</span>
        (setq ac-auto-show-menu 0.2)    <span class=
"org-comment-delimiter">; </span><span class="org-comment">or 0.8?</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.13 delay to show quick help</span>
        (setq ac-quick-help-delay 0.5)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.15 max height of quick help</span>
        (setq ac-quick-help-height 10)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">same as `</span><span class="org-comment"><span class=
"org-constant">ac-menu-height</span></span><span class="org-comment">'</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">8.16 limit on number of candidates</span>
        (setq ac-candidate-limit 100)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completion by TAB</span>
        (define-key ac-completing-map
          (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'ac-complete)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completion by right arrow</span>
        (define-key ac-completing-map
          (kbd <span class="org-string">"&lt;right&gt;"</span>) 'ac-complete)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">11.1 avoid Flyspell processes when auto completion is being started</span>
        (ac-flyspell-workaround))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-34-2-3" class="outline-4">
          <h4 id="sec-34-2-3">Company mode</h4>

          <div class="outline-text-4" id="text-34-2-3">
            <p>The best alternative to Auto-Complete seems to be Company
            mode.</p>

            <p>See <a href=
            "https://github.com/company-mode/company-mode/issues/68">https://github.com/company-mode/company-mode/issues/68</a>
            for a <b>feature comparison</b> between both.</p>

            <p>Completion will start automatically after you type a few
            letters. Use <code>M-n</code> and <code>M-p</code> to select,
            <code>&lt;return&gt;</code> to complete or <code>&lt;tab&gt;</code>
            to complete the common part. Search through the completions with
            <code>C-s</code>, <code>C-r</code> and <code>C-o</code>. Press
            <code>M-(digit)</code> to quickly complete with one of the first 10
            candidates.</p>

            <p>Type <code>M-x company-complete</code> to initiate completion
            manually. Bind this command to a key combination of your
            choice.</p>

            <p>When the completion candidates are shown, press
            <code>&lt;f1&gt;</code> to display the documentation for the
            selected candidate, or <code>C-w</code> to see its source. Not all
            back-ends support this.</p>

            <p>company-mode has a unique take on auto-completion where it will
            reject keystrokes if it doesn’t match any possibilities. It can
            also search available completions and filter as well.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">modular text completion framework</span>
  (<span class="org-keyword">when</span> (try-require 'company-<span class=
"org-leuven-highlight">XXX</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">minimum prefix length for idle completion</span>
    (setq company-minimum-prefix-length 2)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">start completion immediately</span>
    (setq company-idle-delay 0)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show quick-access numbers for the first ten candidates</span>
    (setq company-show-numbers t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable Company mode in all buffers ...</span>
    (add-hook 'after-init-hook 'global-company-mode)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">... except in some modes</span>
    (setq company-global-modes
          '(not ess-mode                <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">in (i)ESS buffers, Auto-Complete is</span>
                inferior-ess-mode       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">enabled by default</span>
                magit-status-mode
                help-mode))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use `</span><span class="org-comment"><span class=
"org-constant">C-n/C-p</span></span><span class=
"org-comment">' to select candidates (only when completion menu is</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">displayed)</span>
    (define-key company-active-map (kbd <span class=
"org-string">"C-n"</span>) 'company-select-next)
    (define-key company-active-map (kbd <span class=
"org-string">"C-p"</span>) 'company-select-previous)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">unbind some keys (inconvenient in Comint buffers)</span>
    (define-key company-active-map (kbd <span class=
"org-string">"M-n"</span>) nil)
    (define-key company-active-map (kbd <span class=
"org-string">"M-p"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completion by TAB</span>
    (define-key company-active-map (kbd <span class=
"org-string">"&lt;tab&gt;"</span>) 'company-complete-selection)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completion by right arrow</span>
    (define-key company-active-map (kbd <span class=
"org-string">"&lt;right&gt;"</span>) 'company-complete-selection)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">abort</span>
    (define-key company-active-map (kbd <span class=
"org-string">"C-g"</span>) 'company-abort)
    (define-key company-active-map (kbd <span class=
"org-string">"&lt;left&gt;"</span>) 'company-abort))
</pre>
            </div>

            <p>XXX What about company-search-candidates vs
            company-filter-candidates?</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    (setq company-idle-delay nil)
    (global-set-key (kbd <span class=
"org-string">"&lt;tab&gt;"</span>) 'company-complete-selection)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 29 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-35" class="outline-2">
      <h2 id="sec-35">Dired, the Directory Editor</h2>

      <div class="outline-text-2" id="text-35">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 30 (info "(emacs)Dired"), the Directory Editor</span>

(leuven--chapter leuven-chapter-30-dired <span class=
"org-string">"30 Dired, the Directory Editor"</span>
</pre>
        </div>

        <p>Type <code>0 w</code> (<code>dired-copy-filename-as-kill</code>) in
        Dired to put the <b>full path</b> to some local file into the kill
        ring.</p>

        <div class="note">
          <p>If you want to insert a link to a file in an Org mode document,
          you can also call <code>org-insert-link</code> (<code>C-c C-l</code>)
          with a <code>C-u</code> prefix (to get the regular
          <code>find-file</code> interface).</p>
        </div>
      </div>

      <div id="outline-container-sec-35-1" class="outline-3">
        <h3 id="sec-35-1">Entering Dired</h3>

        <div class="outline-text-3" id="text-35-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Dired Enter")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directory-browsing commands</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"dired"</span>

    (leuven--section <span class="org-string">"30.1 (emacs)Dired Enter"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">switches passed to `</span><span class="org-comment"><span class=
"org-constant">ls</span></span><span class="org-comment">' for Dired</span>
    (setq dired-listing-switches
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"-a -F --group-directories-first -l -p --time-style=long-iso"</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">causes display problems on Windows</span>
          <span class="org-string">"-a -F -l -p"</span>
          )
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-2" class="outline-3">
        <h3 id="sec-35-2">Deleting Files with Dired</h3>

        <div class="outline-text-3" id="text-35-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Dired Deletion")</span>

    (leuven--section <span class=
"org-string">"30.3 (emacs)Dired Deletion"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">recursive deletes allowed, after asking for each directory at top level</span>
    (setq dired-recursive-deletes 'top)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-3" class="outline-3">
        <h3 id="sec-35-3">Visiting Files in Dired</h3>

        <div class="outline-text-3" id="text-35-3">
          <dl class="org-dl">
            <dt><code>^</code></dt>

            <dd><code>dired-up-directory</code>.</dd>
          </dl>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Dired Visiting")</span>

    (leuven--section <span class=
"org-string">"30.5 (emacs)Dired Visiting"</span>)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-35-3-1" class="outline-4">
          <h4 id="sec-35-3-1">Reuse Dired buffers</h4>

          <div class="outline-text-4" id="text-35-3-1">
            <p>Single Dired buffer.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">reuse Dired buffers, by running the command</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">dired-find-alternate-file</span></span><span class=
"org-comment">' (bound to `a') on a directory</span>
    (put 'dired-find-alternate-file 'disabled nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">reuse the current Dired directory buffer to visit another directory</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(limit Dired to 1 single buffer)</span>
    (<span class="org-keyword">when</span> (try-require 'dired-single)

      (define-key dired-mode-map
        (kbd <span class=
"org-string">"&lt;return&gt;"</span>) 'dired-single-buffer)

      (define-key dired-mode-map
        (kbd <span class=
"org-string">"&lt;mouse-1&gt;"</span>) 'dired-single-buffer-mouse)

      (define-key dired-mode-map
        (kbd <span class="org-string">"^"</span>)
        (<span class="org-keyword">lambda</span> ()
          (interactive)
          (dired-single-buffer <span class="org-string">".."</span>)))

      (define-key dired-mode-map
        (kbd <span class="org-string">"C-x C-j"</span>)
        (<span class="org-keyword">lambda</span> ()
          (interactive)
          (dired-single-buffer <span class="org-string">".."</span>))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-35-3-2" class="outline-4">
          <h4 id="sec-35-3-2">Open file with default tool (open directory with
          Windows Explorer)</h4>

          <div class="outline-text-4" id="text-35-3-2">
            <p>On top of the traditional ways, there are also these add-ons
            which open files using external programs (such as PDF viewers),
            based on their extension.</p>

            <p>One advantage is that using the traditional <code>!</code> (or
            <code>X</code>) switch with Dired locks up Emacs until you close
            the other program. These add-ons do not and leave Emacs free for
            continued used.</p>

            <div class="note">
              <p>Alternative</p>

              <p>Nowadays, there’s at least the built-in
              <code>dired-do-async-shell-command</code>, bound to
              <code>&amp;</code>.</p>

              <p>In addition to what others have mentioned, if you are on MS
              Windows then, after loading `w32-browser.el’ and `dired+.el’, you
              can use item `Open Associated Windows App’ in the `Single’ menu
              to open a file with the associated program.</p>

              <p>Same thing for the marked files, using `Open Associated
              Windows Apps’ in menus `Multiple’ and `Multiple &gt; Marked Here
              and Below’.</p>

              <p>And you can use item `Single’ &gt; `Open in Windows Explorer’
              to open a file or folder in Windows Explorer.</p>

              <p>You can also right-click on a file and pick `Open Associated
              Windows App’ or `Open in Windows Explorer’.</p>

              <p>There are key bindings for these as well:</p>

              <p>`M-RET’ or `mouse-2’ - open with associated program `C-RET’ -
              open in Explorer</p>
            </div>

            <table class="inlinetask" width="100%">
              <tr>
                <td valign="top"><b><span class=
                "todo TODO">TODO</span></b></td>

                <td width="100%"><b>Read <a href=
                "http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/">
                http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/</a></b><br />
                </td>
              </tr>
            </table>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class=
"org-function-name">helm-open-file-with-default-tool</span> (file)
  <span class=
"org-doc">"Open FILE with the default tool on this platform."</span>
  (<span class="org-keyword">let</span> (process-connection-type)
    (<span class="org-keyword">if</span> (eq system-type 'windows-nt)
        (helm-w32-shell-execute-open-file file)
        (start-process <span class=
"org-string">"helm-open-file-with-default-tool"</span>
                       nil
                       (<span class=
"org-keyword">cond</span> ((eq system-type 'gnu/linux)
                              <span class="org-string">"xdg-open"</span>)
                             ((or (eq system-type 'darwin) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Mac OS X</span>
                                  (eq system-type 'macos)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Mac OS 9</span>
                              <span class="org-string">"open"</span>))
                       file))))
</pre>
            </div>

            <p>If <code>xdg-open</code> is not available, one can replace it
            with <code>gnome-open</code> or <code>kde-open</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class=
"org-function-name">dired-launch-command</span> ()
 (interactive)
 (dired-do-shell-command
  (case system-type
    (gnu/linux <span class=
"org-string">"gnome-open"</span>)            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">right for gnome (ubuntu), not for other systems</span>
    (darwin <span class="org-string">"open"</span>))
  nil
  (dired-get-marked-files t current-prefix-arg)))

(define-key dired-mode-map
  (kbd <span class="org-string">"F"</span>) 'dired-launch-command)
</pre>
            </div>

            <p>&gt; These days, there are mature programs for launching an
            arbitrary file with an &gt; appropriate viewer: run-mailcap (which
            is mature to the point of obsolescence) &gt; and xdg-open on GNU
            systems; open on Mac OS X; start on MS Windows).</p>

            <p>It would be a bad idea to use ‘start’ on Windows: it has too
            many quirks regarding quoting of its command line. Instead, just
            invoke the existing primitive w32-shell-execute with the ‘open’
            verb. As a nice side effect, this will support Unicode file names,
            something that is currently impossible when you invoke an external
            command.</p>
          </div>

          <div id="outline-container-sec-35-3-2-1" class="outline-5">
            <h5 id="sec-35-3-2-1">Ask a WWW browser to display file</h5>

            <div class="outline-text-5" id="text-35-3-2-1">
              <p>Just ask a WWW browser to display the current file.</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    (define-key dired-mode-map
      (kbd <span class=
"org-string">"e"</span>) 'browse-url-of-dired-file) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">&lt;C-RET&gt;?</span>
</pre>
              </div>

              <p>It works for files as well as for directories.</p>

              <p>It opens the Windows explorer for:</p>

              <ul class="org-ul">
                <li>
                  <p>the <b>current directory</b> when invoked on
                  <code>.</code>.</p>
                </li>

                <li>
                  <p>the <b>parent directory</b> when invoked on
                  <code>..</code>.</p>

                  <table class="inlinetask" width="100%">
                    <tr>
                      <td valign="top"><b><span class=
                      "todo TODO">TODO</span></b></td>

                      <td width="100%">
                        <b>Mapcar on the browse-url function</b><br />

                        <p>See code of
                        <code>w32-dired-open-files-externally</code>.</p>
                      </td>
                    </tr>
                  </table>

                  <table class="inlinetask" width="100%">
                    <tr>
                      <td valign="top"><b><span class=
                      "todo TODO">TODO</span></b></td>

                      <td width="100%">
                        <b><code>C-u &lt;RET&gt;</code> opens dired on Org
                        link</b><br />

                        <p>We should probably have the same type of key binding
                        for opening Explorer from Dired.</p>
                      </td>
                    </tr>
                  </table>
                </li>
              </ul>
            </div>
          </div>

          <div id="outline-container-sec-35-3-2-2" class="outline-5">
            <h5 id="sec-35-3-2-2">Many files at once (for Windows)</h5>

            <div class="outline-text-5" id="text-35-3-2-2">
              <p>For those under Windows:</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open files using Windows associations</span>
    (GNUEmacs
      (<span class="org-keyword">when</span> running-ms-windows
        (<span class="org-keyword">defun</span> <span class=
"org-function-name">w32-dired-open-files-externally</span> (<span class=
"org-type">&amp;optional</span> arg)
          <span class=
"org-doc">"In Dired, open the marked files (or directories) with the default</span>
<span class="org-doc">        Windows tool."</span>
          (interactive <span class="org-string">"P"</span>)
          (mapcar
           (<span class="org-keyword">lambda</span> (file)
             (w32-shell-execute <span class=
"org-string">"open"</span> (convert-standard-filename file)))
           (dired-get-marked-files nil arg)))

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">bind it to `E' in Dired mode</span>
        (define-key dired-mode-map
          (kbd <span class=
"org-string">"E"</span>) 'w32-dired-open-files-externally)))
</pre>
              </div>

              <p>XXX It works for files as well as for directories. It opens
              the Windows explorer for the <b>current directory</b> when
              invoked on <code>.</code> (correct) or <code>..</code>
              (bug!!).</p>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-35-3-3" class="outline-4">
          <h4 id="sec-35-3-3">Open file with w3m</h4>

          <div class="outline-text-4" id="text-35-3-3">
            <p>See news “Opening html-File in Dired with w3m” for extra
            info.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open current file with w3m</span>
    (<span class="org-keyword">when</span> (executable-find <span class=
"org-string">"w3m"</span>)
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">dired-find-w3m</span> ()
        <span class=
"org-doc">"In Dired, visit (with find-w3m) the file named on this line."</span>
        (interactive)
        (w3m-find-file (file-name-sans-versions (dired-get-filename) t)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add a binding "W" -&gt; `</span><span class=
"org-comment"><span class=
"org-constant">dired-find-w3m</span></span><span class=
"org-comment">' to Dired</span>
      (define-key dired-mode-map
        <span class="org-string">"W"</span> 'dired-find-w3m))
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-4" class="outline-3">
        <h3 id="sec-35-4">Operating on Files</h3>

        <div class="outline-text-3" id="text-35-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Operating on Files")</span>

    (leuven--section <span class=
"org-string">"30.7 (emacs)Operating on Files"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">try to guess a default target directory</span>
    (setq dired-dwim-target t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">copy recursively without asking</span>
    (setq dired-recursive-copies 'always)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-5" class="outline-3">
        <h3 id="sec-35-5">Updating the Dired Buffer</h3>

        <div class="outline-text-3" id="text-35-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Dired Updating")</span>

    (leuven--section <span class=
"org-string">"30.15 (emacs)Dired Updating"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Dired sort</span>
    (try-require 'dired-sort-map)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">press `s' then `s', `x', `t', `n' or `d' to sort by</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Size, eXtension, Time, Name or name grouping Dirs first</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-6" class="outline-3">
        <h3 id="sec-35-6">Dired and <code>find</code></h3>

        <div class="outline-text-3" id="text-35-6">
          <p>For searches in Dired, see <code>dired-do-search</code>
          (<code>A</code>).</p>

          <ul class="org-ul">
            <li>Search through all <b>marked files</b> for a match for
            regexp</li>

            <li>Stops when a match is found</li>

            <li>To continue searching for next match, use command “M-,”</li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Dired and Find")</span>

    (leuven--section <span class=
"org-string">"30.16 (emacs)Dired and Find"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; what to use in place of `</span><span class=
"org-comment"><span class="org-constant">-ls</span></span><span class=
"org-comment">' as the final argument</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq find-ls-option '("-print0 | xargs -0 ls -ld" . "-ld"))</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; quicker to collate the matches and then use `</span><span class="org-comment"><span class="org-constant">xargs</span></span><span class="org-comment">' to run the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; command (variable defined in `</span><span class=
"org-comment"><span class=
"org-constant">find-dired.el</span></span><span class="org-comment">')</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when Cygwin... </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">search for files with names matching a wild card pattern and Dired</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the output</span>
    (global-set-key
      (kbd <span class="org-string">"C-c 1"</span>) 'find-name-dired)
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">case insensitive if `</span><span class=
"org-comment"><span class="org-constant">read-file-name-completion-ignore-case</span></span><span class="org-comment">' is non-nil</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">find-grep-dired</span></span><span class=
"org-comment">' case insensitivity</span>
    (setq find-grep-options <span class="org-string">"-i -q"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">search for files with contents matching a wild card pattern and Dired</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the output</span>
    (global-set-key
      (kbd <span class="org-string">"C-c 2"</span>) 'find-grep-dired)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-7" class="outline-3">
        <h3 id="sec-35-7">Editing the Dired Buffer</h3>

        <div class="outline-text-3" id="text-35-7">
          <p><code>Wdired</code> mode is great for renaming (a lot of) files in
          a directory, as it allows editing the Dired buffer like a text file,
          using all the power of Emacs. That is, one can use keyboard macros,
          search and replace, rectangle mode (great for adding prefixes to file
          names), flip mode bits with the mouse, etc.!</p>

          <p>To enter it, type <code>C-x C-q</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Wdired")</span>

    (leuven--section <span class=
"org-string">"30.17 Editing the (emacs)Wdired Buffer"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">put a Dired buffer in a mode in which filenames are editable</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"wdired"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">permissions bits of the files are editable</span>
      (setq wdired-allow-to-change-permissions t))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-8" class="outline-3">
        <h3 id="sec-35-8">Viewing Image Thumbnails in Dired</h3>

        <div class="outline-text-3" id="text-35-8">
          <p><code>M-x image-dired</code> and choose a directory with
          images.</p>

          <p>Prerequisites:</p>

          <ul class="org-ul">
            <li><a href="http://www.imagemagick.org./">ImageMagick</a>
            package</li>

            <li>JpegTRAN program</li>

            <li><a href=
            "http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a> to
            <b>edit comments and tags</b> for each image.</li>
          </ul>

          <p>Key bindings:</p>

          <dl class="org-dl">
            <dt>C-t d</dt>

            <dd><code>image-dired-display-thumbs</code> (on marked files).</dd>

            <dt>C-t e</dt>

            <dd><code>image-dired-dired-edit-comment-and-tags</code>.</dd>
          </dl>

          <p>For more information, see:</p>

          <ul class="org-ul">
            <li><a href=
            "http://www.emacswiki.org/Tumme">http://www.emacswiki.org/Tumme</a></li>

            <li><a href=
            "http://wikemacs.org/wiki/Image-dired">http://wikemacs.org/wiki/Image-dired</a></li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)Image-Dired")</span>

    (leuven--section <span class=
"org-string">"30.18 Viewing Image Thumbnails in Dired"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use Dired to browse and manipulate your images</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"image-dired"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum number of files to show before warning the user</span>
      (setq image-dired-show-all-from-dir-max-files 100)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">size of button-like border around thumbnails</span>
      (setq image-dired-thumb-relief 0)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">size of the margin around thumbnails</span>
      (setq image-dired-thumb-margin 4))
</pre>
          </div>

          <p>The following code block is currently disabled, because it causes
          problems with Org and PDF LaTeX: when we’ve opened the TeX file, to
          compile it from LaTeX because an error has been reported (with no
          details), then the TeX file blocks the next automatic exports
          (<code>C-u C-c C-e</code>), asking for confirmation because the TeX
          buffer is open…</p>
          <pre class="example">
Reverting buffer `prestations/'.
prestations-2013-06.tex changed on disk; really edit the buffer? (y, n, r or C-h) n
</pre>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(add-hook 'dired-mode-hook
          (<span class="org-keyword">lambda</span> ()

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">auto-refresh Dired on file change</span>
            (auto-revert-mode)
            (setq-default auto-revert-interval 1)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-9" class="outline-3">
        <h3 id="sec-35-9">Dired Extra</h3>

        <div class="outline-text-3" id="text-35-9">
          <p>Extra Dired functionality</p>

          <ul class="org-ul">
            <li>
              <p><code>dired-x</code> has a feature to “guess” the right shell
              command and the right external viewer for documents (see
              <code>dired-guess-shell-alist-user</code>)</p>
            </li>

            <li>
              <p>You can also jump to the Dired buffer corresponding to the
              current buffer by pressing <code>C-x C-j</code>
              (<code>dired-jump</code>). If in Dired already, pop up a level
              and goto old directory’s line.</p>

              <p><b>Standard</b> alternative: <code>C-x d &lt;RET&gt;</code>,
              though it doesn’t set point on the right file.</p>
            </li>
          </ul>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Dired Extra</span>

    (leuven--section <span class="org-string">"30.XX (dired-x)Top"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load `</span><span class="org-comment"><span class=
"org-constant">dired-x.el</span></span><span class=
"org-comment">' when Dired is first invoked (for example, when</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">you first type `C-x d')</span>
    (add-hook 'dired-load-hook
              (<span class="org-keyword">lambda</span> ()
                (load <span class="org-string">"dired-x"</span>)))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "dired" ends here</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-10" class="outline-3">
        <h3 id="sec-35-10">Dired+</h3>

        <div class="outline-text-3" id="text-35-10">
          <p>Library <code>Dired+</code> lets you act on sets of marked files
          in subdirs, recursively, for example.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Dired+</span>

  (leuven--section <span class="org-string">"30.XX Dired+"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">extensions to Dired (provides fancy highlighting, etc.)</span>
  (add-hook 'dired-load-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't hide details in Dired</span>
              (setq diredp-hide-details-initially-flag nil)

              <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't wrap "next" command around to buffer beginning</span>
              (setq diredp-wrap-around-flag nil)

              (try-require 'dired+)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-35-11" class="outline-3">
        <h3 id="sec-35-11">Emulation of <code>ls</code> on MS-Windows</h3>

        <div class="outline-text-3" id="text-35-11">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(emacs)ls in Lisp")</span>

  (leuven--section <span class="org-string">"G.4 (emacs)ls in Lisp"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">emulate insert-directory completely in Emacs Lisp</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ls-lisp"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable the case sensitive sort of file names</span>
    (setq ls-lisp-ignore-case t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sort directories first</span>
    (setq ls-lisp-dirs-first t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use ISO 8601 dates (on MS-Windows)</span>
    (setq ls-lisp-format-time-list
          '(<span class="org-string">"%Y-%m-%d %H:%M"</span>
            <span class="org-string">"%Y-%m-%d %H:%M"</span>))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use localized date/time format</span>
    (setq ls-lisp-use-localized-time-format t))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 30 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-36" class="outline-2">
      <h2 id="sec-36">The Calendar and the Diary</h2>

      <div class="outline-text-2" id="text-36">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 31 The (info "(emacs)Calendar/Diary")</span>

(leuven--chapter leuven-chapter-31-calendar-diary <span class=
"org-string">"31 The Calendar and the Diary"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-36-1" class="outline-3">
        <h3 id="sec-36-1">Calendar Motion</h3>

        <div class="outline-text-3" id="text-36-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 31.1 (info "(emacs)Calendar Motion")</span>

  (leuven--section <span class=
"org-string">"31.1 (emacs)Calendar Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">years must be written in full</span>
  (setq diary-abbreviated-year-flag nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set the style of calendar and diary dates to ISO (how to interpret the</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">dates)</span>
  (setq calendar-date-style 'iso)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">week in the calendar begins on Monday</span>
  (setq calendar-week-start-day 1)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mark all visible dates that have diary entries</span>
  (<span class="org-keyword">when</span> (file-exists-p <span class=
"org-string">"~/diary"</span>)
    (setq calendar-mark-diary-entries-flag t))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mark the current date (by changing its face) after generating a calendar,</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">if today's date is visible</span>
  (add-hook 'calendar-today-visible-hook 'calendar-mark-today)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-36-2" class="outline-3">
        <h3 id="sec-36-2">Scroll Calendar</h3>

        <div class="outline-text-3" id="text-36-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 31.2 (info "(emacs)Scroll Calendar")</span>

  (leuven--section <span class=
"org-string">"31.2 (emacs)Scroll Calendar"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fix foolish calendar-mode scrolling after loading `</span><span class="org-comment"><span class="org-constant">calendar.el</span></span><span class="org-comment">'</span>
  (add-hook 'calendar-load-hook
            (<span class="org-keyword">lambda</span> ()
              (define-key calendar-mode-map
                (kbd <span class=
"org-string">"&gt;"</span>) 'scroll-calendar-left)
              (define-key calendar-mode-map
                (kbd <span class=
"org-string">"&lt;"</span>) 'scroll-calendar-right)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-36-3" class="outline-3">
        <h3 id="sec-36-3">Times of Sunrise/Sunset</h3>

        <div class="outline-text-3" id="text-36-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 31.7 Times of (info "(emacs)Sunrise/Sunset")</span>

  (leuven--section <span class=
"org-string">"31.7 Times of (emacs)Sunrise/Sunset"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">calendar functions for solar events</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"solar"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of the calendar location</span>
    (setq calendar-location-name <span class="org-string">"Leuven, BE"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">latitude of `</span><span class="org-comment"><span class=
"org-constant">calendar-location-name</span></span><span class=
"org-comment">'</span>
    (setq calendar-latitude 50.88)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">longitude of `</span><span class="org-comment"><span class=
"org-constant">calendar-location-name</span></span><span class=
"org-comment">'</span>
    (setq calendar-longitude 4.70))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-36-4" class="outline-3">
        <h3 id="sec-36-4">Diary</h3>

        <div class="outline-text-3" id="text-36-4">
          <p>The Emacs diary keeps track of appointments or other events on a
          daily basis, in conjunction with the calendar. To use the diary
          feature, you must first create a “diary file” containing a list of
          events and their dates.</p>

          <p>But <a href="#sec-28">Org</a> outperforms it!</p>
        </div>
      </div>

      <div id="outline-container-sec-36-5" class="outline-3">
        <h3 id="sec-36-5">Appointments</h3>

        <div class="outline-text-3" id="text-36-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 31.11 (info "(emacs)Appointments")</span>

  (leuven--section <span class="org-string">"31.11 (emacs)Appointments"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">insinuate appt if `</span><span class="org-comment"><span class=
"org-constant">diary-file</span></span><span class=
"org-comment">' exists</span>
  (<span class="org-keyword">if</span> (file-readable-p <span class=
"org-string">"~/diary"</span>)
      (try-require 'appt)               <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">requires `</span><span class="org-comment"><span class=
"org-constant">diary-lib</span></span><span class=
"org-comment">', which requires</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">diary-loaddefs</span></span><span class="org-comment">'</span>
    (message <span class=
"org-string">"Appointment reminders lib `</span><span class=
"org-string"><span class="org-constant">appt</span></span><span class=
"org-string">' not loaded (no diary file found)"</span>))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"appt"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">send the first warning 60 minutes before an appointment</span>
    (setq appt-message-warning-time 60) <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 12]</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">warn every 15 minutes</span>
    (setq appt-display-interval 15)     <span class=
"org-comment-delimiter">; </span><span class="org-comment">[default: 3]</span>
</pre>
          </div>

          <p>Send notifications using <code>notifications-notify</code> (which
          was added in Emacs 24). It uses <code>notify-send</code> (if the
          <code>libnotify-bin</code> Ubuntu package is installed).</p>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>For Windows users: use `todochicku.el’ and
              the snarl notifier</b><br /></td>
            </tr>
          </table>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Diff between shell-command and call-process?
              Blocking call?</b><br /></td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use a separate window to display appointment reminders</span>
    (setq appt-display-format 'window)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">function called to display appointment reminders *in a window*</span>
    (setq appt-disp-window-function (function leuven--appt-display))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--appt-display</span> (mins-to-appt current-time notification-string)
      <span class="org-doc">"Display a reminder for appointments.</span>
<span class="org-doc">    Use `</span><span class="org-doc"><span class=
"org-constant">libnotify</span></span><span class=
"org-doc">' if available and if display is graphical, or fall back on a</span>
<span class="org-doc">    message in the echo area."</span>
      (or (listp mins-to-appt)
          (setq notification-string (list notification-string)))
      (<span class=
"org-keyword">dotimes</span> (i (length notification-string))
        (<span class="org-keyword">cond</span> ((and (display-graphic-p)
                    (executable-find <span class=
"org-string">"notify-send"</span>))
               (shell-command
                (concat <span class="org-string">"notify-send "</span>
                        <span class=
"org-string">"-i /usr/share/icons/gnome/32x32/status/appointment-soon.png "</span>
                        <span class="org-string">"-t 1000 "</span>
                        <span class="org-string">"'Appointment' "</span>
                        <span class=
"org-string">"'"</span> (nth i notification-string) <span class=
"org-string">"'"</span>)))
              (t
               (message <span class=
"org-string">"%s"</span> (nth i notification-string))
               (sit-for 1)))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">turn appointment checking on (enable reminders)</span>
    (<span class="org-keyword">when</span> leuven-load-verbose
      (message <span class=
"org-string">"(Info) Enable appointment reminders..."</span>))
    (GNUEmacs
      (appt-activate 1))
    (XEmacs
      (appt-initialize))
    (<span class="org-keyword">when</span> leuven-load-verbose
      (message <span class=
"org-string">"(Info) Enable appointment reminders... Done"</span>))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable appointment notification, several minutes beforehand</span>
    (add-hook 'diary-hook 'appt-make-list)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keep your appointment list clean: if you delete an appointment from your</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Org agenda file, delete the corresponding alert</span>
    (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">org-agenda-to-appt</span> (before leuven-org-agenda-to-appt activate)
      <span class="org-doc">"Clear the existing `</span><span class=
"org-doc"><span class=
"org-constant">appt-time-msg-list</span></span><span class="org-doc">'."</span>
      (setq appt-time-msg-list nil))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add today's appointments (found in `</span><span class=
"org-comment"><span class=
"org-constant">org-agenda-files</span></span><span class=
"org-comment">') each time the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">agenda buffer is (re)built</span>
    (add-hook 'org-agenda-finalize-hook 'org-agenda-to-appt)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! don't use the `</span><span class="org-comment"><span class=
"org-constant">org-agenda-mode-hook</span></span><span class=
"org-comment">'</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! because the Org agenda files would be</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! opened once by `</span><span class="org-comment"><span class=
"org-constant">org-agenda-to-appt</span></span><span class=
"org-comment">',</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! and then killed by</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! `</span><span class="org-comment"><span class=
"org-constant">org-release-buffers</span></span><span class=
"org-comment">' (because</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! `</span><span class="org-comment"><span class=
"org-constant">org-agenda-to-appt</span></span><span class=
"org-comment">' closes all the</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! files it opened itself -- as they</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! weren't already opened), to be</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! finally re-opened!</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add today's appointments (found in `</span><span class=
"org-comment"><span class=
"org-constant">org-agenda-files</span></span><span class=
"org-comment">') each time such a</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">file is saved</span>
    (add-hook 'after-save-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class=
"org-keyword">when</span> (and (eq major-mode 'org-mode)
                           (org-agenda-file-p))
                  (org-agenda-to-appt))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "appt" ends here</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-36-6" class="outline-3">
        <h3 id="sec-36-6">Advanced Calendar/Diary Usage</h3>

        <div class="outline-text-3" id="text-36-6">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 31.15 (info "(emacs)Advanced Calendar/Diary Usage")</span>

  (leuven--section <span class=
"org-string">"31.15 (emacs)Advanced Calendar/Diary Usage"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get rid of some holidays</span>
  (setq holiday-general-holidays nil)   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">too U.S.-centric holidays</span>
  (setq holiday-oriental-holidays nil)  <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Oriental holidays</span>
  (setq holiday-hebrew-holidays nil)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">religious holidays</span>
  (setq holiday-islamic-holidays nil)   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">religious holidays</span>
  (setq holiday-bahai-holidays nil)     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Baha'i holidays</span>
  (setq holiday-solar-holidays nil)     <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">sun-related holidays</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mark dates of holidays in the calendar window</span>
  (setq calendar-mark-holidays-flag t)
</pre>
          </div>

          <p>After the calendar is loaded, <code>calendar-holidays</code> is
          the list of notable days for the command <code>M-x
          holidays</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-insert-current-date</span> (prefix)
    <span class="org-doc">"Insert the current date in ISO format.</span>
<span class=
"org-doc">  With one PREFIX argument, add day of week.  With two PREFIX arguments, add day</span>
<span class="org-doc">  of week and time."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((format (<span class=
"org-keyword">cond</span> ((not prefix) <span class=
"org-string">"%Y-%m-%d"</span>)
                        ((equal prefix '(4)) <span class=
"org-string">"%Y-%m-%d %a"</span>)
                        ((equal prefix '(16)) <span class=
"org-string">"%Y-%m-%d %a %H:%M"</span>))))
      (insert (format-time-string format))))

  (global-set-key
    (kbd <span class="org-string">"C-c ."</span>) 'leuven-insert-current-date)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-36-7" class="outline-3">
        <h3 id="sec-36-7">Calendar framework</h3>

        <div class="outline-text-3" id="text-36-7">
          <p>After displaying your <code>calfw</code> buffer, you can get a
          HTML buffer with <code>M-x htmlfontify-buffer</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Calendar view framework on Emacs</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">calendar view framework on Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"calfw"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Unicode characters</span>
    (setq cfw:fchar-junction ?╋
          cfw:fchar-vertical-line ?┃
          cfw:fchar-horizontal-line ?━
          cfw:fchar-left-junction ?┣
          cfw:fchar-right-junction ?┫
          cfw:fchar-top-junction ?┯
          cfw:fchar-top-left-corner ?┏
          cfw:fchar-top-right-corner ?┓))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">calendar view for org-agenda</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"calfw-org"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">remove some strings (tags and filenames) from item summary</span>
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">cfw:org-summary-format</span> (item)
      <span class=
"org-doc">"Format an item (How should it be displayed?)."</span>
      (<span class="org-keyword">let*</span> ((time (cfw:org-tp item 'time))
             (time-of-day (cfw:org-tp item 'time-of-day))
             (time-str (and time-of-day
                            (format <span class=
"org-string">"%02i:%02i "</span>
                                    (/ time-of-day 100)
                                    (% time-of-day 100))))
             (category (cfw:org-tp item 'org-category))
             (tags (cfw:org-tp item 'tags))
             (marker (cfw:org-tp item 'org-marker))
             (buffer (and marker (marker-buffer marker)))
             (text (cfw:org-extract-summary item))
             (props (cfw:extract-text-props item 'face 'keymap)))
        (propertize
         (concat
          (<span class=
"org-keyword">if</span> time-str (apply 'propertize time-str props)) text <span class="org-string">" "</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(and buffer (buffer-name buffer))</span>
          )
         'keymap cfw:org-text-keymap
         <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Delete the display property, since displaying images will break our</span>
         <span class="org-comment-delimiter">;; </span><span class=
"org-comment">table layout</span>
         'display nil))))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 31 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-37" class="outline-2">
      <h2 id="sec-37">Sending Mail</h2>

      <div class="outline-text-2" id="text-37">
        <p>Minimal configuration for sending a bug report, for example.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 32 (info "(emacs)Sending Mail")</span>

(leuven--chapter leuven-chapter-32-sending-mail <span class=
"org-string">"32 Sending Mail"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">full name of this user</span>
  (setq user-full-name <span class="org-string">"John Doe"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">full mailing address of this user</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(used in MAIL envelope FROM, and to select the default personality ID)</span>
  (setq user-mail-address <span class=
"org-string">"johndoe@example.com"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">sending mail</span>
  (setq send-mail-function 'smtpmail-send-it)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default SMTP server (overriden by `</span><span class=
"org-comment"><span class=
"org-constant">smtpmail-smtp-server</span></span><span class=
"org-comment">')</span>
  (setq smtpmail-default-smtp-server <span class="org-string">"smtp"</span>)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">SMTP process must be running there</span>

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 32 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-38" class="outline-2">
      <h2 id="sec-38">Gnus</h2>

      <div class="outline-text-2" id="text-38">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 34 (info "(emacs)Gnus")</span>

(leuven--chapter leuven-chapter-34-gnus <span class=
"org-string">"34 Gnus"</span>

  (global-set-key
    (kbd <span class="org-string">"C-c n"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'gnus <span class="org-string">"*Group*"</span>)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">directory beneath which additional per-user Gnus-specific files are placed</span>
  (setq gnus-directory <span class=
"org-string">"~/.gnus.d/"</span>)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">this should end with a directory</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">separator</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">a newsreader for GNU Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">package to compose an outgoing mail (Message, with Gnus paraphernalia)</span>
    (setq mail-user-agent 'gnus-user-agent)
    (XEmacs
      (setq toolbar-mail-reader 'gnus))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">reading mail with Gnus</span>
    (setq read-mail-command 'gnus))
</pre>
        </div>
      </div>

      <div id="outline-container-sec-38-1" class="outline-3">
        <h3 id="sec-38-1">BBDB</h3>

        <div class="outline-text-3" id="text-38-1">
          <p>bbdb3: <a href=
          "https://savannah.nongnu.org/projects/bbdb">https://savannah.nongnu.org/projects/bbdb</a></p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Insidious bbdb</span>

  (leuven--section <span class="org-string">"Insidious bbdb"</span>)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* (info "(bbdb)Installation")</span>

  (<span class="org-keyword">unless</span> (<span class=
"org-keyword">ignore-errors</span> (load-library <span class=
"org-string">"bbdb-autoloads"</span>)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">"hand-made"</span>
    (autoload 'bbdb <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-name <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-company <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-net <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-notes <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)

    (autoload 'bbdb-insinuate-gnus <span class="org-string">"bbdb-gnus"</span>
      <span class="org-doc">"Hook BBDB into Gnus."</span>)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(autoload 'bbdb-insinuate-message "bbdb"</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Hook BBDB into `</span><span class="org-comment"><span class=
"org-constant">message-mode</span></span><span class=
"org-comment">'.") ; BBDB 2.35</span>
    (autoload 'bbdb-insinuate-message <span class=
"org-string">"bbdb-message"</span>
      <span class="org-doc">"Hook BBDB into `</span><span class=
"org-doc"><span class="org-constant">message-mode</span></span><span class=
"org-doc">'."</span>))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">search the BBDB</span>
  (global-set-key
    (kbd <span class="org-string">"&lt;C-f11&gt;"</span>) 'bbdb)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"bbdb"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">coding system used for reading and writing `</span><span class=
"org-comment"><span class="org-constant">bbdb-file</span></span><span class=
"org-comment">'</span>
    (setq bbdb-file-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ensure `</span><span class="org-comment"><span class=
"org-constant">~/.bbdb</span></span><span class=
"org-comment">' never becomes non utf-8 again (it is defined with</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">defconst</span></span><span class=
"org-comment">', so it is reset whenever `</span><span class=
"org-comment"><span class="org-constant">bbdb.el</span></span><span class=
"org-comment">' is loaded)</span>
    (add-hook 'bbdb-load-hook
              (<span class="org-keyword">lambda</span> ()
                (setq bbdb-file-coding-system 'utf-8)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable the various package-specific BBDB functions</span>
    (bbdb-initialize 'gnus 'message)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- add bindings for the default keys to Gnus and configure Gnus to notify</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">the BBDB when new messages are loaded (required if the BBDB is to be</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">able to display BBDB entries for messages displayed in Gnus)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- add a binding for `</span><span class=
"org-comment"><span class="org-constant">M-TAB</span></span><span class=
"org-comment">' to Message mode.  This will enable completion</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">of addresses based on BBDB records</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">what do we do when invoking bbdb interactively (`:' to display sender)</span>
    (setq bbdb-mua-update-interactive-p '(query . create))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">update BBDB silently (don't display an auto-updated BBDB window)</span>
    (setq bbdb-mua-pop-up nil)
</pre>
          </div>
        </div>

        <div id="outline-container-sec-38-1-1" class="outline-4">
          <h4 id="sec-38-1-1">Interfaces</h4>

          <div class="outline-text-4" id="text-38-1-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* (info "(bbdb)Interfaces")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mail aliases (local mailing lists)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'message-setup-hook 'bbdb-define-all-aliases) ; BBDB 2.35</span>
    (add-hook 'message-setup-hook 'bbdb-mail-aliases) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always use full name when sending mail</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(even if User Name has an address of the form <a href=
"mailto:user.name%40domain">&lt;user.name@domain&gt;</a>)</span>
    (setq bbdb-dwim-net-address-allow-redundancy t) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-mail-avoid-redundancy nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">no popup on auto-complete</span>
    (setq bbdb-completion-display-record nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">completion is done across the set of all full-names and user-ids</span>
    (setq bbdb-completion-type nil)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-38-1-2" class="outline-4">
          <h4 id="sec-38-1-2">Reader-specific Features</h4>

          <div class="outline-text-4" id="text-38-1-2">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* (info "(bbdb)Reader-specific Features")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">marking posters with records in the BBDB</span>
    (setq bbdb/gnus-summary-mark-known-posters t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">mark authors in the Summary Buffer who have records in the BBDB</span>
    (setq bbdb/gnus-summary-known-poster-mark <span class=
"org-string">"B"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display the poster's name from the BBDB if we have one</span>
    (setq bbdb/gnus-summary-prefer-real-names t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">replace the information provided in the From header with data from the</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">BBDB if we have one</span>
    (setq bbdb/gnus-summary-prefer-bbdb-data t)

    (setq bbdb/gnus-summary-show-bbdb-names t)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-38-1-3" class="outline-4">
          <h4 id="sec-38-1-3">Options</h4>

          <div class="outline-text-4" id="text-38-1-3">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* (info "(bbdb)Options")</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">You can add the author of a mail or posting to the BBDB</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">by hitting `:'</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of the file which contains your personal database</span>
    (setq bbdb-file <span class="org-string">"~/.bbdb"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">no default area code to use when prompting for a new phone number</span>
    (setq bbdb-default-area-code nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default country to use if none is specified</span>
    (setq bbdb-default-country <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable syntax-checking of telephone numbers</span>
    (setq bbdb-north-american-phone-numbers-p nil) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-phone-style nil)         <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">restoration of the window configuration</span>
    (setq bbdb-electric-p t)            <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-electric t)              <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't display a continuously-updating BBDB window while in GNUS</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq bbdb-use-pop-up nil)       ; BBDB 2.35</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq bbdb-pop-up-layout nil)    ; BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">desired number of lines in a GNUS pop-up BBDB window</span>
    (setq bbdb-pop-up-target-lines 1)   <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-pop-up-window-size 1)    <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default display layout</span>
    (setq bbdb-display-layout 'multi-line)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default display layout pop-up BBDB buffers</span>
    (setq bbdb-pop-up-display-layout 'one-line)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">omit creation-date and time stamp from BBDB display</span>
    (setq bbdb-display-layout-alist
          '((one-line          (order     . (phones notes))
                               (name-end  . 24)
                               (toggle    . t)
                               (omit      . (net AKA mail-alias gnus-private
                                                 creation-date timestamp)))
            (multi-line        (indention . 14)
                               (toggle    . t)
                               (omit      . (AKA creation-date timestamp)))
            (pop-up-multi-line (indention . 14))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">allow cycling of email addresses while completing them</span>
    (setq bbdb-complete-name-allow-cycling t) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-complete-mail-allow-cycling t) <span class=
"org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save the database without asking (any time it would ask)</span>
    (setq bbdb-offer-save 'auto)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically add some text to the notes field of the BBDB record</span>
    (add-hook 'bbdb-notice-hook 'bbdb-auto-notes-hook)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">capture auto-notes</span>
    (setq bbdb-auto-notes-alist
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">organization</span>
          `((<span class="org-string">"Organization"</span> (<span class=
"org-string">".*"</span> Organization 0))

            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">X-Face bitmaps of the people</span>
            (<span class=
"org-string">"x-face"</span> ,(list (concat <span class=
"org-string">"[ \t\n]*</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string"> \t\n]*</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>
                                     <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[ \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string"> \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">?"</span>
                                     <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[ \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string"> \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">?"</span>
                                     <span class=
"org-string">"</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[ \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string">[</span><span class="org-string"><span class=
"org-negation-char">^</span></span><span class=
"org-string"> \t\n]+</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">?"</span>)
                             'face
                             <span class=
"org-string">"\\1\\3\\5\\7"</span>)))))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-38-1-4" class="outline-4">
          <h4 id="sec-38-1-4">Utilities</h4>

          <div class="outline-text-4" id="text-38-1-4">
            <p>BBDB 3 has a dial interface which allows you to call an external
            interface to make a call. This is done by modifying
            <code>bbdb-dial-function</code>. There are examples which interface
            with Skype to make a phone call.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 34 ends here</span>
</pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-39" class="outline-2">
      <h2 id="sec-39">Document Viewing</h2>

      <div class="outline-text-2" id="text-39">
        <p>If <code>doc-view</code> is not showing the PDF files as images in
        Emacs, it may be because:</p>

        <ul class="org-ul">
          <li>no PNG support is available in Emacs (see <a href=
          "#sec-48-2">Images</a>), or</li>

          <li>some conversion utility for PDF files (Ghostscript) is not on
          your <code>PATH</code>.</li>
        </ul>

        <p>In that case, <code>doc-view</code> falls back to show you the plain
        text contents of the PDF if <code>doc-view-pdftotext-program</code> is
        on your <code>PATH</code>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 35 (info "(emacs)Document View")</span>

(leuven--chapter leuven-chapter-35-document-view <span class=
"org-string">"35 Document Viewing"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">view PDF/PostScript/DVI files in Emacs</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-39-1" class="outline-3">
        <h3 id="sec-39-1">Navigation</h3>

        <div class="outline-text-3" id="text-39-1">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 35.1 (info "(emacs)Navigation")</span>

  (leuven--section <span class="org-string">"35.1 (emacs)Navigation"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">doc-view</span></span><span class=
"org-comment">' integrates with the usual bookmark facility.  So simply use</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`C-x r m' (`</span><span class="org-comment"><span class=
"org-constant">bookmark-set</span></span><span class=
"org-comment">') to jump back to the last page you've read in</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">a PDF document.</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-39-2" class="outline-3">
        <h3 id="sec-39-2">Conversion</h3>

        <div class="outline-text-3" id="text-39-2">
          <p>In <code>doc-view-mode</code>, you can use <code>C-s</code> to do
          regexp search on the page images.</p>

          <p>In addition, by pressing <code>C-c C-t</code>, you can open the
          <b>text</b>-only representation (actually, the output of the command
          <code>pdftotext</code>) of the current doc in a new buffer, which is
          more suitable for heavy manipulation of the text of the PDF.</p>

          <p>Another option, without <code>doc-view</code>, is <code>! pdtotext
          ? - &lt;RET&gt;</code>.</p>

          <p><code>doc-view-enlarge</code> (<code>+</code>) and
          <code>doc-view-shrink</code> (<code>-</code>) work fine to zoom in or
          out.</p>
        </div>
      </div>

      <div id="outline-container-sec-39-3" class="outline-3">
        <h3 id="sec-39-3">XXX</h3>

        <div class="outline-text-3" id="text-39-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">antiword will be run on every `</span><span class=
"org-comment"><span class="org-constant">.doc</span></span><span class=
"org-comment">' file you open</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> sudo aptitude install antiword (or via Cygwin setup)</span>
  (autoload 'no-word <span class="org-string">"no-word"</span>
    <span class="org-doc">"Word to txt."</span>)
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.doc\\'"</span> . no-word))



  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.docx\\'"</span> . docx2txt))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">docx2txt</span> ()
    <span class="org-doc">"Run `</span><span class="org-doc"><span class=
"org-constant">docx2txt</span></span><span class=
"org-doc">' on the entire buffer."</span>
    (shell-command-on-region (point-min) (point-max) <span class=
"org-string">"docx2txt.pl"</span> t t))



  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">un-xls files</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> sudo aptitude install xlhtml</span>
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.xls\\'"</span> . no-xls))
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">no-xls</span> (<span class=
"org-type">&amp;optional</span> filename)
    <span class="org-doc">"Run `</span><span class="org-doc"><span class=
"org-constant">xlhtml</span></span><span class=
"org-doc">' and `w3m -dump' on the entire buffer.</span>
<span class=
"org-doc">  Optional FILENAME says what filename to use.  This is only necessary for</span>
<span class="org-doc">  buffers without proper `</span><span class=
"org-doc"><span class="org-constant">buffer-file-name</span></span><span class=
"org-doc">'.  FILENAME should be a real</span>
<span class="org-doc">  filename, not a path."</span>
    (interactive <span class="org-string">"fExcel File: "</span>)
    (<span class="org-keyword">when</span> (and filename
               (not (buffer-file-name)))
      (write-file (make-temp-file filename)))
    (erase-buffer)
    (shell-command
     (format <span class=
"org-string">"xlhtml -nc -te %s | w3m -dump -T text/html"</span>
             (buffer-file-name))
     (current-buffer))
    (setq buffer-file-name nil)
    (set-buffer-modified-p nil))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">no-ppt</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> sudo aptitude install ppthtml</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Not that good! (some text repeated multiple times)</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">no-ppt</span> (<span class=
"org-type">&amp;optional</span> filename)
    <span class="org-doc">"Run `</span><span class="org-doc"><span class=
"org-constant">ppthtml</span></span><span class=
"org-doc">' and `w3m -dump' on the entire buffer.</span>
<span class=
"org-doc">  Optional FILENAME says what filename to use.  This is only necessary for</span>
<span class="org-doc">  buffers without proper `</span><span class=
"org-doc"><span class="org-constant">buffer-file-name</span></span><span class=
"org-doc">'.  FILENAME should be a real</span>
<span class="org-doc">  filename, not a path."</span>
    (interactive <span class="org-string">"fPowerPoint File: "</span>)
    (<span class="org-keyword">when</span> (and filename
               (not (buffer-file-name)))
      (write-file (make-temp-file filename)))
    (erase-buffer)
    (shell-command
     (format <span class=
"org-string">"ppthtml %s | w3m -dump -T text/html"</span> (buffer-file-name))
     (current-buffer))
    (setq buffer-file-name nil)
    (set-buffer-modified-p nil))
  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.ppt\\'"</span> . no-ppt))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 35 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-40" class="outline-2">
      <h2 id="sec-40">Running Shell Commands from Emacs</h2>

      <div class="outline-text-2" id="text-40">
        <p>See customizations at <a href=
        "http://snarfed.org/why_i_run_shells_inside_emacs">http://snarfed.org/why_i_run_shells_inside_emacs</a>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 36 Running (info "(emacs)Shell") Commands from Emacs</span>

(leuven--chapter leuven-chapter-36-shell <span class=
"org-string">"36 Running Shell Commands from Emacs"</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">transform shell names to what they really are</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"sh-script"</span>

    (add-to-list 'sh-alias-alist '(sh . bash)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">XXX</span></span><span class=
"org-comment"> Test the following (added on 2011-08-03)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (eq system-type 'windows-nt)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; Workaround for Cygwin shell, when set 'CYGWIN=noglob'.  By default</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; shell-quote-argument' quoted by double '\' chars, this cause failure.</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(defun shell-quote-argument (argument)</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(concat "'" argument "'"))</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; Workaround for Cygwin when 'shell-file-name' is 'bash'.</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(setq null-device "/dev/null"))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; Use shell from Cygwin/MinGW.</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq shell-file-name "bash")</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setenv "SHELL" "/bin/bash")</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq explicit-bash-args '("-i"))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq explicit-sh-args '("-i"))</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-40-1" class="outline-3">
        <h3 id="sec-40-1">Single Shell</h3>

        <div class="outline-text-3" id="text-40-1">
          <p><code>M-!</code> (<code>shell-command</code>) reads a line of text
          using the minibuffer and executes it as a shell command, in a
          subshell made just for that command.</p>

          <p><code>M-|</code> (<code>shell-command-on-region</code>) passes the
          contents of the region as the standard input to the shell command. By
          prefixing it with <code>C-u</code>, it deletes the old region and
          <b>replaces</b> it with the output from the shell command.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.1 Single Shell</span>

  (leuven--section <span class="org-string">"36.1 Single Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">force interactive behavior (to get my handy shell aliases)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class="org-comment"> Fix for Zsh (zsh:1: command not found: shopt)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defadvice shell-command (before leuven-shell-command activate)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(ad-set-arg 0</span>
  <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(concat "source ~/.bashrc; shopt -s -q expand_aliases;\n "</span>
  <span class=
"org-comment-delimiter">;;                       </span><span class=
"org-comment">(ad-get-arg 0))))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for single shell commands (= "the" reference)</span>
  (setq shell-file-name                 <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">must be in the `</span><span class="org-comment"><span class=
"org-constant">PATH</span></span><span class="org-comment">'</span>
        (or (<span class="org-keyword">ignore-errors</span>
              (file-name-nondirectory (or (executable-find <span class=
"org-string">"zsh"</span>)
                                          (executable-find <span class=
"org-string">"bash"</span>)
                                          (executable-find <span class=
"org-string">"sh"</span>))))
            (<span class=
"org-keyword">when</span> running-ms-windows <span class=
"org-string">"cmdproxy.exe"</span>)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use `</span><span class="org-comment"><span class=
"org-constant">shell-file-name</span></span><span class=
"org-comment">' as the default shell</span>
  (setenv <span class="org-string">"SHELL"</span> shell-file-name)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">switch used to have the shell execute its command line argument</span>
  (setq shell-command-switch <span class=
"org-string">"-c"</span>)      <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class="org-constant">/c</span></span><span class=
"org-comment">' does not work with XEmacs</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">quote process arguments to ensure correct parsing on Windows</span>
  (setq w32-quote-process-args t)
</pre>
          </div>

          <p>The above assignments may <b>NOT</b> be done <b>in an
          eval-after-load</b> as those variables are used by the (La)TeX modes
          (default + AUCTeX) among others.</p>
        </div>
      </div>

      <div id="outline-container-sec-40-2" class="outline-3">
        <h3 id="sec-40-2">Interactive Shell</h3>

        <div class="outline-text-3" id="text-40-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.2 Interactive Shell</span>

  (leuven--section <span class="org-string">"36.2 Interactive Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for the interactive (sub)shell (and AUCTeX compilation?)</span>
  (setq explicit-shell-file-name shell-file-name)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-3" class="outline-3">
        <h3 id="sec-40-3">Shell Mode</h3>

        <div class="outline-text-3" id="text-40-3"></div>

        <div id="outline-container-sec-40-3-1" class="outline-4">
          <h4 id="sec-40-3-1">Entering commands and fixing mistakes</h4>

          <div class="outline-text-4" id="text-40-3-1">
            <dl class="org-dl">
              <dt><code>RET</code></dt>

              <dd><b>Execute</b> the <b>command (on</b> the <b>current
              line)</b>.</dd>

              <dt><code>C-c C-u</code></dt>

              <dd><b>Delete input</b> from the prompt to point (equivalent to
              <code>C-u</code> in Unix shells).</dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-40-3-2" class="outline-4">
          <h4 id="sec-40-3-2">Completion of filenames</h4>

          <div class="outline-text-4" id="text-40-3-2">
            <dl class="org-dl">
              <dt><code>M-?</code></dt>

              <dd>Display a list of possible completions for the filename at
              point.</dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-40-3-3" class="outline-4">
          <h4 id="sec-40-3-3">Manipulating the output from the last
          command</h4>

          <div class="outline-text-4" id="text-40-3-3">
            <dl class="org-dl">
              <dt><code>C-c C-r</code></dt>

              <dd><b>Show output</b> from last command (move first line of
              output to top of window).</dd>

              <dt><code>C-c C-o</code></dt>

              <dd><b>Delete output</b> (only) from last command.</dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-40-3-4" class="outline-4">
          <h4 id="sec-40-3-4">Sending signals</h4>

          <div class="outline-text-4" id="text-40-3-4">
            <dl class="org-dl">
              <dt><code>C-c C-c</code></dt>

              <dd>Interrupt current job (equivalent to <code>C-c</code> in Unix
              shells, <code>BREAK</code> signal).</dd>

              <dt><code>C-c C-z</code></dt>

              <dd>Suspend or stop current job (equivalent to <code>C-z</code>
              in Unix shells, <code>STOP</code> signal).</dd>

              <dt><code>C-c C-d</code></dt>

              <dd>Send <code>EOF</code> character.</dd>
            </dl>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.3 Shell Mode</span>

  (leuven--section <span class="org-string">"36.3 Shell Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">general command-interpreter-in-a-buffer stuff (Shell, SQLi, Lisp, R,</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Python, ...)</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (try-require 'comint)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">comint prompt is read only</span>
    (setq comint-prompt-read-only t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">no duplicates in command history</span>
    (setq-default comint-input-ignoredups t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">input to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(insert at the bottom)</span>
    (setq-default comint-scroll-to-bottom-on-input t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">output to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add output at the bottom)</span>
    (setq-default comint-move-point-for-output t)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">maximum size in lines for Comint buffers</span>
    (setq comint-buffer-maximum-size (* 5 1024)) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">if the function</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">comint-truncate-buffer</span></span><span class=
"org-comment">' is added to</span>
                                        <span class=
"org-comment-delimiter">; </span><span class="org-comment">`</span><span class=
"org-comment"><span class=
"org-constant">comint-output-filter-functions</span></span><span class=
"org-comment">'</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">strip `</span><span class="org-comment"><span class=
"org-constant">^M</span></span><span class="org-comment">' characters</span>
    (add-to-list 'process-coding-system-alist
                 '(<span class=
"org-string">"bash"</span> . (undecided-dos . undecided-unix)))
    (add-to-list 'process-coding-system-alist
                 '(<span class=
"org-string">"zsh"</span> . (undecided-dos . undecided-unix)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show completion list when ambiguous</span>
    (setq comint-completion-autolist t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-comint-clear-buffer</span> ()
      <span class="org-doc">"Clear the Comint buffer."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((comint-buffer-maximum-size 0))
        (comint-truncate-buffer)))

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"comint"</span>
      (define-key comint-mode-map
        (kbd <span class=
"org-string">"C-c C-k"</span>) 'leuven-comint-clear-buffer))

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">)</span>
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-4" class="outline-3">
        <h3 id="sec-40-4">Shell Prompts</h3>

        <div class="outline-text-3" id="text-40-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.4 Shell Prompts</span>

  (leuven--section <span class="org-string">"36.4 Shell Prompts"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">regexp to match prompts in the inferior shell</span>
  (setq shell-prompt-pattern <span class="org-string">"^[</span><span class=
"org-string"><span class="org-negation-char">^</span></span><span class=
"org-string">#$%&gt;\n]*[#$%&gt;] *"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">regexp to recognize prompts in the inferior process</span>
  (setq comint-prompt-regexp shell-prompt-pattern)
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! only used if the variable</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! `</span><span class="org-comment"><span class=
"org-constant">comint-use-prompt-regexp</span></span><span class=
"org-comment">' is non-nil</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-5" class="outline-3">
        <h3 id="sec-40-5">History</h3>

        <div class="outline-text-3" id="text-40-5">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.5 Shell Command History</span>

  (leuven--section <span class=
"org-string">"36.5 Shell Command History"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">rejects short commands</span>
  (setq comint-input-filter
    #'(<span class="org-keyword">lambda</span> (str)
        (and (not (string-match <span class=
"org-string">"\\`\\s *\\'"</span> str))
             (&gt; (length str) 2))))      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">ignore '!!' and kin</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"comint"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cycle backwards/forwards through input history</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"C-p"</span>) 'comint-previous-input) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"&lt;up&gt;"</span>) 'comint-previous-input) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Shell + RStudio</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"C-n"</span>) 'comint-next-input)   <span class=
"org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"&lt;down&gt;"</span>) 'comint-next-input) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">Shell + RStudio</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">search backwards/forwards through input history for match for current</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">input</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"M-p"</span>) 'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"&lt;C-up&gt;"</span>) 'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"M-n"</span>) 'comint-next-matching-input-from-input) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class=
"org-string">"&lt;C-down&gt;"</span>) 'comint-next-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio</span>

    (<span class="org-keyword">when</span> (<span class=
"org-keyword">featurep</span> '<span class="org-constant">helm-misc</span>)
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">provide completion of `</span><span class=
"org-comment"><span class="org-constant">comint</span></span><span class=
"org-comment">' history</span>
      (define-key comint-mode-map
        (kbd <span class=
"org-string">"C-c C-l"</span>) 'helm-comint-input-ring)))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-40-5-1" class="outline-4">
          <h4 id="sec-40-5-1">Command History</h4>

          <div class="outline-text-4" id="text-40-5-1">
            <dl class="org-dl">
              <dt><code>C-p</code> (or <code>&lt;up&gt;</code>)</dt>

              <dd>Fetch the next <b>earlier</b> command in the history (doesn’t
              execute it).</dd>

              <dt><code>C-n</code> (or <code>&lt;down&gt;</code>)</dt>

              <dd>Fetch the next <b>later</b> command in the history (doesn’t
              execute it).</dd>

              <dt><code>M-p</code> (or <code>&lt;C-up&gt;</code>)</dt>

              <dd>Fetch the next <b>earlier</b> command in the history matching
              the string typed so far (doesn’t execute it).</dd>

              <dt><code>M-n</code> (or <code>&lt;C-down&gt;</code>)</dt>

              <dd>Fetch the next <b>later</b> command in the history matching
              the string typed so far (doesn’t execute it).</dd>

              <dt><code>M-r</code></dt>

              <dd>Begin an incremental <b>regexp search of old
              commands</b>.</dd>

              <dt><code>C-c C-l</code></dt>

              <dd>Display the current buffer’s <b>history</b> of shell
              commands.</dd>
            </dl>
          </div>
        </div>

        <div id="outline-container-sec-40-5-2" class="outline-4">
          <h4 id="sec-40-5-2">Manipulating the transcript: Viewing older
          commands</h4>

          <div class="outline-text-4" id="text-40-5-2">
            <dl class="org-dl">
              <dt><code>C-c C-p</code></dt>

              <dd>Move point to <b>previous command prompt</b>.</dd>

              <dt><code>C-c C-n</code></dt>

              <dd>Move point to <b>next command prompt</b>.</dd>
            </dl>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-6" class="outline-3">
        <h3 id="sec-40-6">Directory Tracking</h3>

        <div class="outline-text-3" id="text-40-6">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.6 Directory Tracking</span>

  (leuven--section <span class="org-string">"36.6 Directory Tracking"</span>)
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%">
                <b>Fix case when 2 Shell buffers are run in the same dir (same
                name error!)</b><br />

                <p>apply: Buffer name `*shell d:/Users/fni/*’ is in use</p>
              </td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--rename-buffer-to-curdir</span> (<span class=
"org-type">&amp;optional</span> _string)
    <span class=
"org-doc">"Change Shell buffer's name to current directory."</span>
    (rename-buffer (concat <span class=
"org-string">"*shell "</span> default-directory <span class=
"org-string">"*"</span>)))

  (add-hook 'shell-mode-hook
            (<span class="org-keyword">lambda</span> ()
              (leuven--rename-buffer-to-curdir)
              (add-hook 'comint-output-filter-functions
                        'leuven--rename-buffer-to-curdir nil t)))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">local to Shell comint</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-7" class="outline-3">
        <h3 id="sec-40-7">Options</h3>

        <div class="outline-text-3" id="text-40-7">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.7 Options</span>

  (leuven--section <span class="org-string">"36.7 Options"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">disable command echoing</span>
  (setq-default comint-process-echoes t) <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">for Linux (not needed for Cygwin)</span>
</pre>
          </div>
        </div>

        <div id="outline-container-sec-40-7-1" class="outline-4">
          <h4 id="sec-40-7-1">Paging in Shell</h4>

          <div class="outline-text-4" id="text-40-7-1">
            <p>If you ever tried to run a program like <code>git</code> under
            <code>M-x shell</code>, you will have come across the warning
            “terminal is not fully functional” followed by unusable behavior.
            This is because <code>git</code> sends its output through a pager
            (probably <code>less</code>), which requires a real <a href=
            "#sec-40-8">terminal emulator</a>.</p>

            <p>Setting the <code>PAGER</code> environment variable to
            <code>/bin/cat</code> (but only inside Emacs) solves this
            problem:</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (setenv <span class="org-string">"PAGER"</span> <span class=
"org-string">"/usr/bin/cat"</span>)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-8" class="outline-3">
        <h3 id="sec-40-8"><a id="ID-d12c2e1e-8147-4b39-8128-aaa70fbf4657" name=
        "ID-d12c2e1e-8147-4b39-8128-aaa70fbf4657"></a>Terminal emulator</h3>

        <div class="outline-text-3" id="text-40-8">
          <p>Full terminal emulation is available.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.8 Terminal emulator</span>

  (leuven--section <span class="org-string">"36.8 Terminal emulator"</span>)
</pre>
          </div>

          <p>From my experience, none of the terminal emulators in Emacs
          (<code>term</code>, <code>ansi-term</code>, <code>multi-term</code>)
          is supported under Windows. It looks like the main reason is all of
          them rely on low-level support for terminals (<code>stty</code>,
          etc.) which is not provided by Windows.</p>

          <p>Though, <code>term</code>, <code>ansi-term</code>, and
          <code>multi-term</code> do <b>work in Cygwin Emacs</b>.</p>
        </div>
      </div>

      <div id="outline-container-sec-40-9" class="outline-3">
        <h3 id="sec-40-9">Term Mode</h3>

        <div class="outline-text-3" id="text-40-9">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.9 Term Mode</span>

  (leuven--section <span class="org-string">"36.9 Term Mode"</span>)
</pre>
          </div>

          <p>Emacs <b>Shell mode</b> doesn’t support (all) terminal control
          codes, so <code>less</code> doesn’t work (“page-at-a-time”
          feature).</p>

          <p>Shell mode buffers do not use ptys (pseudo-terminals), so programs
          running in such a buffer (the shell, the programs run by the shell,
          etc.) can’t perform character-at-a-time input. Each line is typed in
          full and only sent when <code>&lt;RET&gt;</code> is pressed. To see
          proof, run the <code>tty</code> command in a Shell mode buffer, and
          its output will be <code>not a tty</code>.</p>

          <p>Note that it may seem that this is not true because you can
          perform command-line editing with <code>C-b</code>, <code>C-f</code>,
          etc. But this is only because <code>shell-mode</code> itself
          simulates the typical command-line editing features of shells like
          Bash, Zsh, etc. using Emacs own internal editing capabilities.</p>

          <p>Anyway, you can:</p>

          <ul class="org-ul">
            <li>use <code>isearch</code> to search through the command
            output,</li>

            <li>copy stuff into the kill ring or</li>

            <li>use the rectangle functions.</li>
          </ul>

          <p>Or you might just prefer the Emacs key bindings over the ones your
          shell offers.</p>

          <p>On the other hand, <b>Term mode</b> provides a proper <b>terminal
          emulator</b> (though not as good as the good old <code>xterm</code>).
          You must use it for applications that are interactive with your
          terminal (such as the command <code>top</code>).</p>

          <div class="note">
            <p>In Shell mode, use <code>M-x proced</code> instead of
            <code>top</code>.</p>
          </div>

          <div class="note">
            <p><code>MPlayer</code> commands do not work in the Emacs shell.
            Use <code>term</code> for <code>/</code> and <code>*</code> to
            decrease / increase volume.</p>
          </div>

          <p>You can <b>switch to line mode</b> (<code>C-c C-j</code>) when you
          need Term to <i>basically</i> act like a Shell mode buffer, and move
          around the buffer pretty much like anywhere else in Emacs. Copy /
          kill-ring commands, <code>isearch</code>, etc. do work.</p>

          <p>Then, you can use <code>C-c C-k</code> to <b>switch</b> back <b>to
          character mode</b>, the default, which is like your normal
          <b>terminal</b> emulator except the escape key.</p>

          <p>It’s wrong to think that <code>M-x term</code> captures everything
          it seems (which would defeat the purpose of running it inside
          Emacs):</p>

          <ul class="org-ul">
            <li>In the default character mode, <code>C-c</code> is the key
            prefix.</li>

            <li>In line mode, you don’t need a prefix.</li>
          </ul>

          <p>Try also to use <code>M-x ansi-term</code> that is much better
          than <code>term</code>:</p>

          <ul class="org-ul">
            <li>with <code>M-x term</code>, you can run <b>only one
            shell</b>;</li>

            <li>with <code>M-x ansi-term</code>, you can start more than one
            (<code>*ansi-term*&lt;2&gt;</code>,
            <code>*ansi-term*&lt;3&gt;</code>).</li>
          </ul>

          <p>Note that <code>TERM</code> is different in both environments:</p>

          <ul class="org-ul">
            <li>In <code>M-x shell</code>, <code>TERM=emacs</code></li>

            <li>In <code>M-x term</code>, <code>TERM=eterm-color</code></li>
          </ul>

          <p>MultiTerm (<a href=
          "http://www.emacswiki.org/emacs/MultiTerm">http://www.emacswiki.org/emacs/MultiTerm</a>)
          works much better than shell or term.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">managing multiple terminal buffers in Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(and fixing some troubles of `</span><span class=
"org-comment"><span class="org-constant">term-mode</span></span><span class=
"org-comment">': key bindings, etc.)</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"multi-term on POSIX hosts has let me switch from using screen, with one</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Emacs screen and lots of shell screens; to just using Emacs, with lots of</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">terminals inside it."</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (locate-library "multi-term")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(autoload 'multi-term "multi-term"</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">"Create new term buffer." t)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(autoload 'multi-term-next "multi-term"</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">"Go to the next term buffer." t)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(setq multi-term-program shell-file-name)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">;; (global-set-key (kbd "C-c t") 'multi-term-next)</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(global-set-key</span>
  <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(kbd "C-c T") 'multi-term))       ; create a new one</span>
</pre>
          </div>

          <table class="inlinetask" width="100%">
            <tr>
              <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

              <td width="100%"><b>Try <i>visual</i> commands (like
              <code>top</code> or <code>less</code>) in
              <code>multi-term</code></b><br /></td>
            </tr>
          </table>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; run an inferior shell, with I/O through buffer `</span><span class="org-comment"><span class="org-constant">*shell*</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(global-set-key</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(kbd "C-c !")</span>
  <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(cond (running-ms-windows 'shell)</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">(t 'term)))</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">toggle to and from the `</span><span class=
"org-comment"><span class="org-constant">*shell*</span></span><span class=
"org-comment">' buffer</span>
  (global-set-key
    (kbd <span class="org-string">"C-!"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'shell <span class="org-string">"*shell*"</span>)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-10" class="outline-3">
        <h3 id="sec-40-10">Remote Host</h3>

        <div class="outline-text-3" id="text-40-10">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 36.10 Remote Host Shell</span>

  (leuven--section <span class="org-string">"36.10 Remote Host Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">load ssh.el file</span>
  (add-to-list 'same-window-regexps <span class=
"org-string">"^\\*ssh-.*\\*</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">(</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">|</span></span><span class=
"org-string">&lt;[0-9]+&gt;</span><span class="org-string"><span class=
"org-regexp-grouping-backslash">\\</span></span><span class=
"org-string"><span class=
"org-regexp-grouping-construct">)</span></span><span class=
"org-string">"</span>)
  (autoload 'ssh <span class="org-string">"ssh"</span>
    <span class=
"org-doc">"Open a network login connection via `</span><span class=
"org-doc"><span class="org-constant">ssh</span></span><span class=
"org-doc">'."</span> t)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">this is to run ESS remotely on another computer in my own Emacs, or just</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">plain old reading remote files</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">See http://emacs.1067599.n5.nabble.com/SSH-inside-Emacs-td225528.html</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- plink (with `</span><span class="org-comment"><span class=
"org-constant">dumb</span></span><span class=
"org-comment">' terminal option?) as interactive shell</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- ssh -t -t user@host</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- Cygwin'ized Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">- MSYS (MinGW)</span>
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-11" class="outline-3">
        <h3 id="sec-40-11">Serial Terminal</h3>

        <div class="outline-text-3" id="text-40-11">
          <p>Since GNU Emacs 23, there’s now support for serial port access.
          The new command <code>serial-term</code> starts an interactive
          terminal on a serial port.</p>
        </div>
      </div>

      <div id="outline-container-sec-40-12" class="outline-3">
        <h3 id="sec-40-12">Helper for GNU Emacs on w32</h3>

        <div class="outline-text-3" id="text-40-12">
          <p>Let Emacs, for example, find the program
          <code>/usr/bin/w3m</code>.</p>

          <p><b>But it causes problems (Emacs crashes or unable to connect)
          when reading mail with Gnus…</b></p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; let Emacs recognize Cygwin paths (e.g. /usr/local/lib)</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(when (and running-ms-windows</span>
    <span class="org-comment-delimiter">;;            </span><span class=
"org-comment">(executable-find "mount")) ; Cygwin bin directory found</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(when (try-require 'cygwin-mount)</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(cygwin-mount-activate)))</span>
</pre>
          </div>

          <p>See <code>w32-settings.el</code> for more!</p>
        </div>
      </div>

      <div id="outline-container-sec-40-13" class="outline-3">
        <h3 id="sec-40-13">Emacs Speaks Statistics (ESS)</h3>

        <div class="outline-text-3" id="text-40-13">
          <p>See:</p>

          <ul class="org-ul">
            <li><a href=
            "http://ess.r-project.org/Manual/ess.html">http://ess.r-project.org/Manual/ess.html</a>,</li>

            <li><a href=
            "http://www.emacswiki.org/emacs/EmacsSpeaksStatistics">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics</a>.</li>
          </ul>
        </div>

        <div id="outline-container-sec-40-13-1" class="outline-4">
          <h4 id="sec-40-13-1">2 Installing ESS on your system</h4>

          <div class="outline-text-4" id="text-40-13-1">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"Utilities -- ESS"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ESS: Emacs Speaks Statistics</span>
  (autoload 'R <span class="org-string">"ess-site"</span>
    <span class=
"org-doc">"Call 'R', the 'GNU S' system from the R Foundation."</span> t)

  (autoload 'R-mode <span class="org-string">"ess-site"</span>
    <span class="org-doc">"Major mode for editing R source."</span> t)

  (add-to-list 'auto-mode-alist '(<span class=
"org-string">"\\.[rR]\\'"</span> . R-mode))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-2" class="outline-4">
          <h4 id="sec-40-13-2">3 Interacting with statistical programs</h4>

          <div class="outline-text-4" id="text-40-13-2">
            <p>Start an R session with <code>M-x R</code>.</p>

            <div class="note">
              <p>To run statistical processes under ESS, Windows users will
              need to make sure that the directories for <code>R</code> and
              <code>Rterm</code> are in their <code>PATH</code> environment
              variable.</p>
            </div>

            <p><b>Customize</b> variables for ESS (set these variables
            <b>before</b> loading <code>ess-site</code>).</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">start R in current working directory, don't ask user</span>
  (setq ess-ask-for-ess-directory nil)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">new inferior ESS process appears in another window in the current frame</span>
  (setq inferior-ess-same-window nil)
</pre>
            </div>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">accented characters on graphics</span>
  (add-to-list 'process-coding-system-alist
               '(<span class="org-string">"R.*"</span> . iso-latin-1))
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-3" class="outline-4">
          <h4 id="sec-40-13-3">4 Interacting with the ESS process</h4>

          <div class="outline-text-4" id="text-40-13-3">
            <ul class="org-ul">
              <li><code>inferior-ess-mode-map</code> for R console only</li>

              <li><code>comint-mode-map</code> for Shell console as well</li>
            </ul>
          </div>
        </div>

        <div id="outline-container-sec-40-13-4" class="outline-4">
          <h4 id="sec-40-13-4">5 Sending code to the ESS process</h4>

          <div class="outline-text-4" id="text-40-13-4">
            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; display input commands in the process buffer</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ess-eval-visibly 'nowait)       ; but avoid Emacs hanging on large</span>
  <span class=
"org-comment-delimiter">;;                                       </span><span class="org-comment">; evaluations</span>
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-5" class="outline-4">
          <h4 id="sec-40-13-5">7 Editing objects and functions</h4>

          <div class="outline-text-4" id="text-40-13-5">
            <p>Smart underscore:</p>

            <ul class="org-ul">
              <li>Pressing underscore once inserts <code>&lt;-</code>.</li>

              <li>Pressing underscore twice inserts a literal underscore.</li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default ESS indentation style</span>
  (setq ess-default-style 'DEFAULT)
</pre>
            </div>
          </div>

          <div id="outline-container-sec-40-13-5-1" class="outline-5">
            <h5 id="sec-40-13-5-1">Code folding</h5>

            <div class="outline-text-5" id="text-40-13-5-1">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ess-site"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">code folding in ESS mode</span>
    (add-hook 'ess-mode-hook 'hs-minor-mode)
</pre>
              </div>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-6" class="outline-4">
          <h4 id="sec-40-13-6">9 Completion</h4>

          <div class="outline-text-4" id="text-40-13-6"></div>

          <div id="outline-container-sec-40-13-6-1" class="outline-5">
            <h5 id="sec-40-13-6-1">Integration with auto-complete package</h5>

            <div class="outline-text-5" id="text-40-13-6-1">
              <p>Note – R docs are not in Info format. Though, they are
              available via the quick help of Auto-Complete.</p>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable auto-completion of arguments</span>
    (add-hook 'ess-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (add-to-list 'ac-sources 'ac-source-R-args)))
</pre>
              </div>

              <p>XXX See <a href=
              "https://github.com/cofi/dotfiles/blob/master/emacs.d/config/cofi-completion.el">
              https://github.com/cofi/dotfiles/blob/master/emacs.d/config/cofi-completion.el</a></p>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-7" class="outline-4">
          <h4 id="sec-40-13-7">10 Developing with ESS</h4>

          <div class="outline-text-4" id="text-40-13-7">
            <p>See</p>

            <ul class="org-ul">
              <li><a href=
              "http://code.google.com/p/ess-tracebug/">http://code.google.com/p/ess-tracebug/</a></li>

              <li><a href=
              "http://code.google.com/p/ess-tracebug/wiki/GettingStarted">http://code.google.com/p/ess-tracebug/wiki/GettingStarted</a>.</li>
            </ul>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">activate ess-tracebug every time r session starts</span>
    (add-hook 'ess-post-run-hook 'ess-tracebug)
</pre>
            </div>
          </div>
        </div>

        <div id="outline-container-sec-40-13-8" class="outline-4">
          <h4 id="sec-40-13-8">11 Other ESS features and tools</h4>

          <div class="outline-text-4" id="text-40-13-8"></div>

          <div id="outline-container-sec-40-13-8-1" class="outline-5">
            <h5 id="sec-40-13-8-1">Describe object at point</h5>

            <div class="outline-text-5" id="text-40-13-8-1">
              <p>Get info for object at point, and display it in an electric
              buffer with the command <code>ess-describe-object-at-point</code>
              (bound to <code>C-c C-d C-e</code>, repeat <code>C-e</code> or
              <code>e</code> to cycle between <code>str()</code>,
              <code>head()</code>, <code>tail()</code> and
              <code>summary()</code>).</p>

              <p>Use <code>other-window</code> to switch to
              <code>*ess-describe*</code> window.</p>

              <p>It was inspired by Erik Iverson’s
              <code>ess-R-object-tooltip</code>.</p>
            </div>
          </div>

          <div id="outline-container-sec-40-13-8-2" class="outline-5">
            <h5 id="sec-40-13-8-2">ElDoc</h5>

            <div class="outline-text-5" id="text-40-13-8-2">
              <p>Since ESS v12.02, ElDoc functionality (to report R function
              arguments) has been moved into the core, and is active by
              default; so you don’t need to configure anything…</p>

              <p>When you visit a R mode, ElDoc will be turned on. However, you
              will <b>first need to associate the R buffer with an R
              process</b> so that args can be looked up – otherwise, ElDoc will
              silently not report anything.</p>

              <p>So, e.g. try:</p>

              <ol class="org-ol">
                <li><code>C-x C-f somefile.R</code></li>

                <li><code>M-x R</code> (so that <code>somefile.R</code> is
                associated with <code>*R*</code>)</li>

                <li>ElDoc should then work.</li>
              </ol>
            </div>
          </div>

          <div id="outline-container-sec-40-13-8-3" class="outline-5">
            <h5 id="sec-40-13-8-3">Rdired</h5>

            <div class="outline-text-5" id="text-40-13-8-3">
              <p>With your point on the line of a variable,</p>

              <ul class="org-ul">
                <li><code>p</code> will plot the object,</li>

                <li><code>v</code> will view it, and</li>

                <li><code>d</code> will mark the object for deletion
                (<code>x</code> will actually perform the deletion).</li>
              </ul>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">prototype object browser for R, looks like dired mode</span>
    (autoload 'ess-rdired <span class="org-string">"ess-rdired"</span>
      <span class=
"org-doc">"View *R* objects in a dired-like buffer."</span> t)
</pre>
              </div>

              <p>You could prefer to have the <code>*R dired*</code> buffer in
              a separate frame. Check out
              <code>special-display-buffer-names</code>.</p>

              <p>Or have it dedicated in a window. Check out <a href=
              "https://github.com/emacsmirror/dedicated">https://github.com/emacsmirror/dedicated</a>.</p>
            </div>
          </div>

          <div id="outline-container-sec-40-13-8-4" class="outline-5">
            <h5 id="sec-40-13-8-4">Interaction with Org mode</h5>
          </div>

          <div id="outline-container-sec-40-13-8-5" class="outline-5">
            <h5 id="sec-40-13-8-5">Helm</h5>

            <div class="outline-text-5" id="text-40-13-8-5">
              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">helm-sources and some utilities for GNU R</span>
    (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"helm"</span>)
      (try-require 'helm-R))
</pre>
              </div>

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
)
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-40-14" class="outline-3">
        <h3 id="sec-40-14">Proced</h3>

        <div class="outline-text-3" id="text-40-14">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Proced</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">start Proced in a similar manner to Dired</span>
  (global-set-key
    (kbd <span class="org-string">"C-x p"</span>) 'proced)

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"proced"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">current sort scheme for proced listing</span>
    (setq-default proced-sort 'start)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">display of Proced buffer as process tree</span>
    (setq-default proced-tree-flag t))
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-41" class="outline-2">
      <h2 id="sec-41">Using Emacs Server</h2>

      <div class="outline-text-2" id="text-41">
        <p>The Emacs version you’re using and the <code>emacsclient</code>
        version you’re using must be from the <b>same Emacs version</b>… If the
        latter is not the cause of a refused connection, re-try <code>M-x
        server-start</code> in Emacs.</p>

        <p><code>emacsclient</code> is waiting for Emacs to tell it it’s done
        editing that file. That’s important if you use <code>emacsclient</code>
        as your <code>EDITOR</code>. If you want <code>emacsclient</code> to
        return immediately, use the <code>-n</code> option.</p>

        <p>Do you use <code>emacsclient</code> in terminals? If not, just use
        parameter <code>-c -n</code>, which creates an X Window and doesn’t
        wait for <code>(server-edit)</code>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 37 (info "(emacs)Emacs Server")</span>

(leuven--chapter leuven-chapter-37-emacs-server <span class=
"org-string">"37 Using Emacs as a Server"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">use Emacs as a server (with the `</span><span class=
"org-comment"><span class="org-constant">emacsclient</span></span><span class=
"org-comment">' program)</span>
  (GNUEmacs
    (idle-require 'server)              <span class=
"org-comment-delimiter">; </span><span class="org-comment">after init</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"server"</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">test whether server is (definitely) running, avoiding the message of</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"server-start" while opening another Emacs session</span>
      (or (equal (server-running-p) t)

          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">start the Emacs server</span>
          (server-start))               <span class=
"org-comment-delimiter">; </span><span class="org-comment">~ 0.20 s</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save file without confirmation before returning to the client</span>
      (<span class="org-keyword">defadvice</span> <span class=
"org-function-name">server-edit</span> (before save-buffer-if-needed activate)
        <span class=
"org-doc">"Save current buffer before marking it as done."</span>
        (<span class=
"org-keyword">when</span> server-buffer-clients (save-buffer)))))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 37 ends here</span>
</pre>
        </div>

        <p>Since GNU Emacs 23, there is also a <code>--daemon</code> flag to
        start the server in a convenient way.</p>

        <table class="inlinetask" width="100%">
          <tr>
            <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

            <td width="100%">
              <b>Understand the following:</b><br />

              <div class="org-src-container">
                <pre class="src src-emacs-lisp">
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'server-done-hook</span>
        <span class="org-comment-delimiter">;;        </span><span class=
"org-comment">(lambda ()</span>
        <span class="org-comment-delimiter">;;          </span><span class=
"org-comment">(shell-command "screen -r -X select `cat ~/tmp/emacsclient-caller`")))</span>
</pre>
              </div>

              <p>and see <a href=
              "http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html">
              http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html</a>
              for ideas about having the right <code>emacsclient</code> used to
              connect to the Emacs server.</p>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div id="outline-container-sec-42" class="outline-2">
      <h2 id="sec-42">Printing Hard Copies</h2>

      <div class="outline-text-2" id="text-42">
        <p>You can print any buffer with <code>C-u M-x
        ps-print-buffer-with-faces &lt;RET&gt;</code>. Because of the
        <code>C-u</code>, it will prompt for a file to place the PostScript
        into. You can then convert PS to PDF, if so desired.</p>

        <p>You can print without faces (i.e. no colour) with
        <code>ps-print-buffer</code>.</p>

        <p>You may wish to set <code>ps-print-landscape</code> to
        <code>t</code>.</p>

        <p>See <code>(info "(emacs)Windows Printing")</code> for several
        methods of correctly setting up printing on Windows.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 38 (info "(emacs)Printing")</span>

(leuven--chapter leuven-chapter-38-printing <span class=
"org-string">"38 Printing Hard Copies"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">print Emacs buffer on line printer</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">for {lpr,print}-{buffer,region}</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"lpr"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of program for printing a file</span>
    (setq lpr-command (executable-find <span class=
"org-string">"enscript"</span>))
                                    <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Install `</span><span class="org-comment"><span class=
"org-constant">enscript</span></span><span class="org-comment">'</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of strings to pass as extra options for the printer program</span>
    (setq lpr-switches (list <span class="org-string">"--font=Courier8"</span>
                             <span class=
"org-string">"--header-font=Courier10"</span>
                             (format <span class=
"org-string">"--header=%s"</span> (buffer-name))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of a printer to which data is sent for printing</span>
    (setq printer-name
          (<span class=
"org-keyword">cond</span> (running-ms-windows <span class=
"org-string">"//PRINT-SERVER/Brother HL-4150CDN"</span>) <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
                (t t))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-ps-print-buffer-with-faces-query</span> ()
    <span class="org-doc">"Query user before printing the buffer."</span>
    (interactive)
    (<span class="org-keyword">when</span> (y-or-n-p <span class=
"org-string">"Are you sure you want to print this buffer? "</span>)
      (ps-print-buffer-with-faces)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">generate and print a PostScript image of the buffer</span>
  (GNUEmacs
    (<span class="org-keyword">when</span> running-ms-windows
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">override `Print Screen' globally used as a hotkey by Windows</span>
      (w32-register-hot-key (kbd <span class=
"org-string">"&lt;snapshot&gt;"</span>))
      (global-set-key
        (kbd <span class=
"org-string">"&lt;snapshot&gt;"</span>) 'leuven-ps-print-buffer-with-faces-query)))

  (global-set-key
    (kbd <span class=
"org-string">"M-p"</span>) 'leuven-ps-print-buffer-with-faces-query)

  (XEmacs
    (setq toolbar-print-function 'ps-print-buffer-with-faces))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">print text from the buffer as PostScript</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"ps-print"</span>

    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">gsprint-program</span>
      (concat windows-program-files-dir <span class=
"org-string">"Ghostgum/gsview/gsprint.exe"</span>)
      <span class=
"org-doc">"Defines the Windows path to the gsview executable."</span>)

    (leuven--file-exists-and-executable-p gsprint-program)

    (<span class="org-keyword">if</span> (and gsprint-program
             (executable-find gsprint-program))

        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of a local printer for printing PostScript files</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">adjusted to run Ghostscript</span>
          (setq ps-printer-name t)

          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of program for printing a PostScript file</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">tell Emacs where Ghostscript print utility is located</span>
          (setq ps-lpr-command gsprint-program)

          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of extra switches to pass to `</span><span class=
"org-comment"><span class=
"org-constant">ps-lpr-command</span></span><span class="org-comment">'</span>
          <span class="org-comment-delimiter">;; </span><span class=
"org-comment">tell Ghostscript to query which printer to use</span>
          (setq ps-lpr-switches '(<span class="org-string">"-query"</span>)))
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">'("-q" "-dNOPAUSE" "-dBATCH" "-sDEVICE=mswinpr2")</span>

      (setq ps-printer-name <span class=
"org-string">"//PRINT-SERVER/Brother HL-4150CDN"</span>) <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">XXX</span></span>
      (setq ps-lpr-command <span class="org-string">""</span>)
      (setq ps-lpr-switches '(<span class="org-string">"raw"</span>)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ps-error-handler-message 'system)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">size of paper to format for</span>
    (setq ps-paper-type 'a4)
    (setq ps-warn-paper-type nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">print in portrait mode</span>
    (setq ps-landscape-mode nil)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ps-print-control-characters nil)</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of columns</span>
    (setq ps-number-of-columns 1)

    (setq ps-left-margin 40)
    (setq ps-right-margin 56)
    (setq ps-bottom-margin 22)
    (setq ps-top-margin 32)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Page layout: Header [file-name     2001-06-18 Mon]</span>
    (setq ps-print-header-frame nil)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">no box around the header</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">see http://www.emacswiki.org/emacs/PsPrintPackage-23</span>
    (setq ps-header-frame-alist '((fore-color . <span class=
"org-string">"#CCCCCC"</span>)))
    (setq ps-header-lines 1)
    (setq ps-header-font-family 'Helvetica)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq ps-header-font-size 11)</span>
    (setq ps-header-title-font-size 11)
    (<span class="org-keyword">defun</span> <span class=
"org-function-name">ps-time-stamp-yyyy-mm-dd-aaa</span> ()
      <span class=
"org-doc">"Return date as \"2001-06-18 Mon\" (ISO date + day of week)."</span>
      (format-time-string <span class="org-string">"%Y-%m-%d %a"</span>))
    (setq ps-right-header '(ps-time-stamp-yyyy-mm-dd-aaa))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Page layout: Footer [                         n/m]</span>
    (setq ps-footer-offset 14)
    (setq ps-footer-line-pad .50)
    (setq ps-print-footer t)
    (setq ps-print-footer-frame nil)    <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">no box around the footer</span>
    (setq ps-footer-frame-alist '((fore-color . <span class=
"org-string">"#666666"</span>)))
    (setq ps-footer-lines 1)
    (setq ps-footer-font-family 'Helvetica)
    (setq ps-footer-font-size 8)
    (setq ps-left-footer nil)
    (setq ps-right-footer (list <span class=
"org-string">"/pagenumberstring load"</span>)) <span class=
"org-comment-delimiter">; </span><span class="org-comment">Page n of m</span>

    (setq ps-font-family 'Courier)      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">see `</span><span class="org-comment"><span class=
"org-constant">ps-font-info-database</span></span><span class=
"org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">legitimate values include Courier, Helvetica, NewCenturySchlbk,</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Palatino and Times</span>
    (setq ps-font-size 9.1)

    (setq ps-use-face-background t)

    (setq ps-line-spacing 3))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 38 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-43" class="outline-2">
      <h2 id="sec-43">Sorting Text</h2>

      <div class="outline-text-2" id="text-43">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 39 (info "(emacs)Sorting") Text</span>

(leuven--chapter leuven-chapter-39-sorting <span class=
"org-string">"39 Sorting Text"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">key binding</span>
  (global-set-key
    (kbd <span class="org-string">"C-c ^"</span>) 'sort-lines)

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 39 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-44" class="outline-2">
      <h2 id="sec-44">Saving Emacs Sessions</h2>

      <div class="outline-text-2" id="text-44">
        <table class="inlinetask" width="100%">
          <tr>
            <td valign="top"><b><span class="todo TODO">TODO</span></b></td>

            <td width="100%"><b>Check that there is no extra ~/.saves
            directory!</b><br /></td>
          </tr>
        </table>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 42 (info "(emacs)Saving Emacs Sessions")</span>

(leuven--chapter leuven-chapter-42-saving-emacs-sessions <span class=
"org-string">"42 Saving Emacs Sessions"</span>

  (try-require 'saveplace)
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"saveplace"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">automatically save place in each file</span>
    (setq-default save-place t)         <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">default value for all buffers</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of the file that records `</span><span class=
"org-comment"><span class=
"org-constant">save-place-alist</span></span><span class=
"org-comment">' value</span>
    (setq save-place-file
          (convert-standard-filename <span class=
"org-string">"~/.emacs.d/.places"</span>))
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! a .txt extension would load `</span><span class=
"org-comment"><span class="org-constant">org</span></span><span class=
"org-comment">' at</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! the time Emacs is killed (if not</span>
                                        <span class=
"org-comment-delimiter">;</span><span class=
"org-comment">! already loaded)!</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">do not make backups of master save-place file</span>
    (setq save-place-version-control <span class="org-string">"never"</span>))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 42 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-45" class="outline-2">
      <h2 id="sec-45">Hyperlinking and Navigation Features</h2>

      <div class="outline-text-2" id="text-45">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 45 (info "(emacs)Hyperlinking")</span>

(leuven--chapter leuven-chapter-45-hyperlinking <span class=
"org-string">"45 Hyperlinking and Navigation Features"</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** pass a URL to a WWW browser</span>

  (leuven--section <span class=
"org-string">"pass a URL to a WWW browser"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default browser started when you click on some URL in the buffer</span>
  (setq browse-url-browser-function
        (<span class="org-keyword">if</span> (not (display-graphic-p))
            'w3m-browse-url
          (<span class="org-keyword">if</span> running-ms-windows
              'browse-url-default-windows-browser
            'browse-url-generic)))
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq browse-url-browser-function</span>
  <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">'(("file:///usr/share/doc/hyperspec/" . w3m-browse-url)</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">("emacswiki.org" . w3m-browse-url)</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">("lispdoc.com" . w3m-browse-url)</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">( "." . browse-url-firefox)))</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">that let me use `</span><span class="org-comment"><span class=
"org-constant">w3m</span></span><span class=
"org-comment">' for EmacsWiki/Common Lisp documentation and</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Firefox otherwise.</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment"><span class="org-leuven-highlight">TODO</span></span><span class=
"org-comment"> Check if this is needed, or must be fixed/adapted</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; name of the browser program used by `</span><span class=
"org-comment"><span class=
"org-constant">browse-url-generic</span></span><span class=
"org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq browse-url-generic-program</span>
  <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(when (and (display-graphic-p)</span>
  <span class="org-comment-delimiter">;;                  </span><span class=
"org-comment">(not running-ms-windows))</span>
  <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">(executable-find "firefox"))) ; could be `</span><span class=
"org-comment"><span class=
"org-constant">google-chrome</span></span><span class="org-comment">'</span>

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven--browse</span> (url)
    <span class=
"org-doc">"If prefix is specified, use the system default browser, else use the</span>
<span class="org-doc">  configured Emacs one."</span>
    (<span class="org-keyword">require</span> '<span class=
"org-constant">browse-url</span>)
    (<span class="org-keyword">if</span> current-prefix-arg
        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open in your desktop browser (firefox here)</span>
        (<span class=
"org-keyword">when</span> url (browse-url-default-browser url))
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">open using your Emacs browser (whatever that is configured to)</span>
      (<span class=
"org-keyword">if</span> url (browse-url url) (call-interactively 'browse-url))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-browse-url</span> (<span class=
"org-type">&amp;optional</span> url)
    <span class="org-doc">"Browse the URL passed in."</span>
    (interactive)
    (<span class="org-keyword">require</span> '<span class=
"org-constant">w3m</span>)
    (<span class="org-keyword">require</span> '<span class=
"org-constant">browse-url</span>)
    (setq url (or url
                  (w3m-url-valid (w3m-anchor))
                  (browse-url-url-at-point)
                  (find-tag-default)))
    (setq url (read-string (format <span class=
"org-string">"URL \"%s\" :"</span> url) url nil url))
    (leuven--browse url))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Web search</span>

  (leuven--section <span class="org-string">"Web search"</span>)

  (<span class=
"org-keyword">when</span> t                               <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">(try-require 'browse-url)</span>

    (<span class="org-keyword">defconst</span> <span class=
"org-variable-name">leuven--google-maxlen</span> (* 32 7)
      <span class="org-doc">"Maximum length of search string to send.</span>
<span class=
"org-doc">    This prevents you from accidentally sending a 5 MB query string."</span>)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-google-search</span> ()
      <span class=
"org-doc">"Prompt for a query in the minibuffer, launch the web browser and</span>
<span class="org-doc">    query Google."</span>
      (interactive)
      (<span class=
"org-keyword">let</span> ((query (read-from-minibuffer <span class=
"org-string">"Google Search: "</span>)))
        (browse-url (concat <span class=
"org-string">"http://www.google.com/search?q="</span>
                            (url-hexify-string query)))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun google-it (search-string)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Search for SEARCH-STRING on Google."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive "sSearch for: ")</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(browse-url (concat "http://www.google.com/search?q="</span>
    <span class=
"org-comment-delimiter">;;                   </span><span class="org-comment">(url-hexify-string</span>
    <span class=
"org-comment-delimiter">;;                     </span><span class=
"org-comment">(encode-coding-string search-string 'utf-8)))))</span>

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-google-search-word-at-point</span> ()
      <span class="org-doc">"Google the word at point."</span>
      (interactive)
      (browse-url
       (concat <span class=
"org-string">"http://www.google.com/search?q="</span> (find-tag-default))))

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-google-search-region</span> (prefix start end)
      <span class=
"org-doc">"Create a search URL and send it to the web browser."</span>
      (interactive <span class="org-string">"P\nr"</span>)
      (<span class=
"org-keyword">if</span> (&gt; (- end start) leuven--google-maxlen)
          (message <span class="org-string">"Search string too long!"</span>)
        (<span class=
"org-keyword">let</span> ((query (buffer-substring-no-properties start end)))
          (browse-url
           (concat <span class=
"org-string">"http://www.google.com/search?q="</span>
                   (url-hexify-string query))))))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(defun google-search-selection ()</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">"Create a Google search URL and send it to your web browser."</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(interactive)</span>
    <span class="org-comment-delimiter">;;   </span><span class=
"org-comment">(let (start end term url)</span>
    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(if (or (not (fboundp 'region-exists-p)) (region-exists-p))</span>
    <span class="org-comment-delimiter">;;         </span><span class=
"org-comment">(progn</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(setq start (region-beginning)</span>
    <span class="org-comment-delimiter">;;                 </span><span class=
"org-comment">end   (region-end))</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(if (&gt; (- start end) leuven--google-maxlen)</span>
    <span class="org-comment-delimiter">;;               </span><span class=
"org-comment">(setq term (buffer-substring</span>
    <span class=
"org-comment-delimiter">;;                           </span><span class=
"org-comment">start (+ start leuven--google-maxlen)))</span>
    <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(setq term (buffer-substring start end)))</span>
    <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(google-it term))</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(beep)</span>
    <span class="org-comment-delimiter">;;       </span><span class=
"org-comment">(message "Region not active"))))</span>


         (<span class="org-keyword">defun</span> <span class=
"org-function-name">google</span> (what)
           <span class="org-doc">"Use Google to search for WHAT."</span>
           (interactive <span class="org-string">"sSearch: "</span>)
           (<span class="org-keyword">save-window-excursion</span>
             (delete-other-windows)
             (<span class="org-keyword">let</span> ((dir default-directory))
               (w3m-browse-url (concat <span class=
"org-string">"http://www.google.com/search?q="</span>
                                       (w3m-url-encode-string what)))
               (cd dir)
               (recursive-edit))))
         (global-set-key
           (kbd <span class="org-string">"C-c g s"</span>) 'google)
</pre>
        </div>

        <p>If you know how to build the right url to the documentation of a
        given operator, you can just replace the google url with the right one
        in the following code:</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">pm/region-or-word</span> (prompt)
    <span class=
"org-doc">"Read a string from the minibuffer, prompting with PROMPT.</span>
<span class="org-doc">  If `</span><span class="org-doc"><span class=
"org-constant">transient-mark-mode</span></span><span class=
"org-doc">' is non-nil and the mark is active, it defaults to the</span>
<span class=
"org-doc">  current region, else to the word at or before point.  This function returns a</span>
<span class="org-doc">  list (string) for use in `</span><span class=
"org-doc"><span class="org-constant">interactive</span></span><span class=
"org-doc">'."</span>
    (list (read-string prompt (or (and (use-region-p)
                                       (buffer-substring-no-properties
                                        (region-beginning) (region-end)))
                                  (current-word)))))

  (<span class="org-keyword">defun</span> <span class=
"org-function-name">pm/google</span> (string)
    <span class="org-doc">"Ask a WWW browser to Google STRING.</span>
<span class=
"org-doc">  Prompt for a string, defaulting to the active region or the current word at or</span>
<span class="org-doc">  before point."</span>
    (interactive (pm/region-or-word <span class=
"org-string">"Google: "</span>))
    (browse-url (concat <span class=
"org-string">"http://google.com/search?num=100&amp;q="</span> string)))
</pre>
        </div>

        <p>(end of interrupt)</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
    (<span class="org-keyword">defvar</span> <span class=
"org-variable-name">leuven--google-prefix-map</span> (make-sparse-keymap)
      <span class="org-doc">"Keymap for my Google commands."</span>)

    <span class="org-comment-delimiter">;;     </span><span class=
"org-comment">(global-set-key (kbd "M-s") 'leuven-google-search-region)</span>

    (global-set-key
      (kbd <span class="org-string">"C-c g"</span>) leuven--google-prefix-map)

    (define-key leuven--google-prefix-map
      (kbd <span class="org-string">"g"</span>) 'leuven-google-search)

    (define-key leuven--google-prefix-map
      (kbd <span class=
"org-string">"w"</span>) 'leuven-google-search-word-at-point)

    (define-key leuven--google-prefix-map
      (kbd <span class="org-string">"r"</span>) 'leuven-google-search-region)
)
</pre>
        </div>
      </div>

      <div id="outline-container-sec-45-1" class="outline-3">
        <h3 id="sec-45-1">Emacs-w3m</h3>

        <div class="outline-text-3" id="text-45-1">
          <p>Emacs/W3 is dead, long live <a href=
          "http://emacs-w3m.namazu.org/">Emacs-w3m</a> (a terrific text-based
          web and file browser).</p>

          <p>For Win32, use the Cygwin version of the executable.</p>

          <p><code>w3m-browse-url</code> asks Emacs-w3m to browse a URL.</p>

          <p>When JavaScript is needed or the “design” is just too bad, use an
          <b>external browser</b>: you can open the current page in your
          graphical browser by hitting <code>M</code> (bound to
          <code>w3m-view-url-with-external-browser</code>) – at your own risk.
          For what “risk” means, please see: <code>(info
          "(emacs-w3m)Gnus")</code>.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Emacs-w3m</span>

  (leuven--section <span class="org-string">"Emacs-w3m"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">only use if `</span><span class="org-comment"><span class=
"org-constant">w3m</span></span><span class=
"org-comment">' command is available on system</span>
  (<span class="org-keyword">when</span> (executable-find <span class=
"org-string">"w3m"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name of the executable file of the `</span><span class=
"org-comment"><span class="org-constant">w3m</span></span><span class=
"org-comment">' command</span>
    (setq w3m-command <span class="org-string">"w3m"</span>)
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">I don't want `</span><span class="org-comment"><span class=
"org-constant">/usr/bin/w3m</span></span><span class=
"org-comment">' (which requires `</span><span class="org-comment"><span class=
"org-constant">cygwin-mount</span></span><span class="org-comment">')</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">w3m</span></span><span class=
"org-comment">' slows down the startup process dramatically</span>
    (<span class="org-keyword">unless</span> (try-require 'w3m-autoloads)
      (autoload 'w3m <span class="org-string">"w3m"</span>
        <span class="org-doc">"Visit the WWW page using w3m."</span> t)
      (autoload 'w3m-find-file <span class="org-string">"w3m"</span>
        <span class="org-doc">"Find a local file using emacs-w3m."</span> t)
      (autoload 'w3m-browse-url <span class="org-string">"w3m"</span>
        <span class="org-doc">"Ask emacs-w3m to show a URL."</span> t))

    (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"w3m"</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 3.1 Browsing Web Pages</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">go ahead, just try it</span>
      (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-w3m-goto-url</span> ()
        <span class=
"org-doc">"Type in directly the URL to visit (avoiding to hit `</span><span class="org-doc"><span class="org-constant">C-k</span></span><span class="org-doc">')."</span>
        (interactive)
        (<span class="org-keyword">let</span> ((w3m-current-url <span class=
"org-string">""</span>))
          (call-interactively 'w3m-goto-url)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">make w3m stop "stealing" my arrow keys, allowing to move the</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">cursor down the lines of an HTML email (in Gnus)</span>
      (setq w3m-minor-mode-map nil)

      (define-key w3m-mode-map
        (kbd <span class="org-string">"U"</span>) 'leuven-w3m-goto-url)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">fix inappropriate key bindings for moving from place to place in a page</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(let the cursor keys behave normally, don't jump from link to link)</span>
      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;up&gt;"</span>) 'previous-line)
      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;down&gt;"</span>) 'next-line)
      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;left&gt;"</span>) 'backward-char)
      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;right&gt;"</span>) 'forward-char)

      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'w3m-next-anchor)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">moving from page to page</span>
      (define-key w3m-mode-map
        (kbd <span class="org-string">"F"</span>) 'w3m-view-next-page)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 3.5 Using Tabs</span>

      (define-key w3m-mode-map
        (kbd <span class="org-string">"&lt;C-tab&gt;"</span>) 'w3m-next-buffer)
      (define-key w3m-mode-map
        (kbd <span class=
"org-string">"&lt;C-S-tab&gt;"</span>) 'w3m-previous-buffer)

      (<span class="org-keyword">defun</span> <span class=
"org-function-name">w3m-new-tab</span> ()
        (interactive)
        (w3m-copy-buffer nil nil nil t))

      (define-key w3m-mode-map
        (kbd <span class="org-string">"C-t"</span>) 'w3m-new-tab)

      (define-key w3m-mode-map
        (kbd <span class="org-string">"C-w"</span>) 'w3m-delete-buffer)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.1 General Variables</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">send referers only when both the current page and the target page are</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">provided by the same server</span>
      (setq w3m-add-referer 'lambda)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">home page</span>
      (setq w3m-home-page <span class=
"org-string">"http://www.emacswiki.org/"</span>)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">number of steps in columns used when scrolling a window horizontally</span>
      (setq w3m-horizontal-shift-columns 1)  <span class=
"org-comment-delimiter">; </span><span class="org-comment">2</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">proxy settings</span>
      (<span class=
"org-keyword">when</span> (string= (upcase (system-name)) <span class=
"org-string">"PC3701"</span>)
        (setq w3m-command-arguments
                 (nconc w3m-command-arguments
                        '(<span class="org-string">"-o"</span> <span class=
"org-string">"http_proxy=proxy:8080"</span>))))
                                 <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class=
"org-comment"> https_proxy for HTTPS support</span>

      (setq w3m-no-proxy-domains '(<span class=
"org-string">"localhost"</span> <span class="org-string">"127.0.0.1"</span>))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.2 Image Variables</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">always display images</span>
      (setq w3m-default-display-inline-images t)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">show favicon images if they are available</span>
      (setq w3m-use-favicon t)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.4 Cookie Variables</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">functions for cookie processing</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"w3m-cookie"</span>

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">ask user whether accept bad cookies or not</span>
        (setq w3m-cookie-accept-bad-cookies 'ask)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of trusted domains</span>
        (setq w3m-cookie-accept-domains
              '(<span class="org-string">"google.com"</span> <span class=
"org-string">"google.be"</span>
                <span class="org-string">"yahoo.com"</span> <span class=
"org-string">".yahoo.com"</span> <span class=
"org-string">"groups.yahoo.com"</span>
                <span class="org-string">"www.dyndns.org"</span>)))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable cookies (mostly required to use sites such as Gmail)</span>
      (setq w3m-use-cookies t)

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 5.14 Other Variables</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of content types, regexps (matching a url or a file</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">name), commands to view contents, and filters to override the</span>
      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">content type specified at first</span>
      (setq w3m-content-type-alist
            (append '((<span class="org-string">"text/html"</span> <span class=
"org-string">"\\.xhtml\\'"</span> nil nil))
                    w3m-content-type-alist))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">toggle a minor mode showing link numbers</span>
      (<span class="org-keyword">when</span> (try-require 'w3m-lnum)

        (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-w3m-go-to-link-number</span> ()
          <span class=
"org-doc">"Turn on link numbers and ask for one to go to."</span>
          (interactive)
          (<span class="org-keyword">let</span> ((active w3m-lnum-mode))
            (<span class=
"org-keyword">when</span> (not active) (w3m-lnum-mode))
            (<span class="org-keyword">unwind-protect</span>
                (w3m-move-numbered-anchor (read-number
                                           <span class=
"org-string">"Anchor number: "</span>))
              (<span class=
"org-keyword">when</span> (not active) (w3m-lnum-mode))
              (w3m-view-this-url))))

        (define-key w3m-mode-map
          (kbd <span class=
"org-string">"f"</span>) 'leuven-w3m-go-to-link-number)

        <span class="org-comment-delimiter">;; </span><span class=
"org-comment">enable link numbering mode by default</span>
        (add-hook 'w3m-mode-hook 'w3m-lnum-mode))

      ))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-45-1-1" class="outline-4">
          <h4 id="sec-45-1-1">9.1 Turning Gnus into a web browser!</h4>

          <div class="outline-text-4" id="text-45-1-1">
            <p><code>Nnshimbun</code> is a Gnus back end, but it is distributed
            with emacs-w3m, not Gnus, exceptionally.</p>

            <p><code>Nnshimbun</code> allows you to turn Gnus into an
            exceptionally useful web browser. You can skim through the articles
            on a newspaper’s web server without having to see all the
            advertisement. You can read articles in mailing list archives as if
            you were subscribed to the list. You can also read submissions in
            bulletin boards, etc…</p>
          </div>
        </div>

        <div id="outline-container-sec-45-1-2" class="outline-4">
          <h4 id="sec-45-1-2">EWW (Emacs Web Browser)</h4>

          <div class="outline-text-4" id="text-45-1-2">
            <p><code>eww</code> is the new web-browser for Emacs. See <a href=
            "http://lars.ingebrigtsen.no/2013/06/eww.html">http://lars.ingebrigtsen.no/2013/06/eww.html</a>.</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-45-2" class="outline-3">
        <h3 id="sec-45-2">Google Maps</h3>

        <div class="outline-text-3" id="text-45-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Google maps</span>
    (try-require 'google-maps))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-45-3" class="outline-3">
        <h3 id="sec-45-3">Babel translator</h3>

        <div class="outline-text-3" id="text-45-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Babel</span>

  (leuven--section <span class="org-string">"Babel"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">interface to web translation services such as Babelfish</span>
  (<span class="org-keyword">when</span> (locate-library <span class=
"org-string">"babel"</span>)

    (autoload 'babel <span class="org-string">"babel"</span>
      <span class=
"org-doc">"Use a web translation service to translate the message MSG."</span> t)
    (autoload 'babel-region <span class="org-string">"babel"</span>
      <span class=
"org-doc">"Use a web translation service to translate the current region."</span> t)
    (autoload 'babel-as-string <span class="org-string">"babel"</span>
      <span class=
"org-doc">"Use a web translation service to translate MSG, returning a string."</span> t)
    (autoload 'babel-buffer <span class="org-string">"babel"</span>
      <span class=
"org-doc">"Use a web translation service to translate the current buffer."</span> t)

    (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-babel-translate</span> ()
      <span class="org-doc">"Translate using many online translators."</span>
      (interactive)
      (<span class="org-keyword">require</span> '<span class=
"org-constant">babel</span>)
      (<span class="org-keyword">let</span> (source)
        (switch-to-buffer <span class=
"org-string">"*leuven--translate*"</span>)
        (erase-buffer)
        (yank)
        (setq source (buffer-substring-no-properties (point-min) (point-max)))
        (erase-buffer)
        (insert <span class="org-string">"--- Source ---\n\n"</span>)
        (insert source)
        (insert <span class=
"org-string">"\n\n\n--- Translation FR -&gt; EN done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class=
"org-string">"fr"</span> <span class=
"org-string">"en"</span> 'babel-free-fetch 'babel-free-wash))
        (insert <span class=
"org-string">"\n\n\n--- Translation EN -&gt; FR done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class=
"org-string">"en"</span> <span class=
"org-string">"fr"</span> 'babel-free-fetch 'babel-free-wash)))))

)
</pre>
          </div>

          <p>XXX Look at google-translate.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-46" class="outline-2">
      <h2 id="sec-46">Other Amusements</h2>

      <div class="outline-text-2" id="text-46">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 46 Other (info "(emacs)Amusements")</span>

(leuven--chapter leuven-chapter-46-amusements <span class=
"org-string">"46 Other Amusements"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">define a default menu bar</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"menu-bar"</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get rid of the Games in the Tools menu</span>
    (define-key menu-bar-tools-menu
      [games] nil))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 46 ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-47" class="outline-2">
      <h2 id="sec-47">Customization</h2>

      <div class="outline-text-2" id="text-47">
        <p>Emacs 24 custom themes allow loading multiple themes simultaneously.
        If you don’t want the previous theme to stay in effect, you will need
        to unload it first.</p>

        <p>Install Leuven Theme via the <i>Emacs Lisp Packages</i> (or use the
        one bundled in GNU Emacs 24.4)</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* 48 (info "(emacs)Customization")</span>

(leuven--chapter leuven-chapter-48-customization <span class=
"org-string">"48 Customization"</span>

  (GNUEmacs24
    (<span class="org-keyword">ignore-errors</span>
      (load-theme 'leuven t)))
</pre>
        </div>
      </div>

      <div id="outline-container-sec-47-1" class="outline-3">
        <h3 id="sec-47-1">Color</h3>

        <div class="outline-text-3" id="text-47-1">
          <p>You can govern the sort order of colors now such as HSV or RGB
          distance from a particular color…</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">color sort order for `</span><span class=
"org-comment"><span class=
"org-constant">list-colors-display</span></span><span class=
"org-comment">'</span>
  (setq list-colors-sort '(rgb-dist . <span class=
"org-string">"#FFFFFF"</span>))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-47-2" class="outline-3">
        <h3 id="sec-47-2">Color theme</h3>

        <div class="outline-text-3" id="text-47-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">the real color theme functions</span>
    (<span class="org-keyword">when</span> (try-require 'color-theme-autoloads)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">`</span><span class="org-comment"><span class=
"org-constant">color-theme-print</span></span><span class=
"org-comment">' allows to keep what you see</span>

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">initialize the color theme package</span>
      (<span class="org-keyword">if</span> (fboundp 'color-theme-initialize)
          (color-theme-initialize))

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">color themes will be installed for all frames</span>
      (setq color-theme-is-global t)

      <span class="org-comment-delimiter">;; </span><span class=
"org-comment">set my default color theme</span>
      (<span class="org-keyword">when</span> (try-require 'color-theme-leuven)
        (color-theme-leuven)))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">save whatever changes you make to the faces (colors and other font</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">properties)</span>
    (setq options-save-faces t))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-47-3" class="outline-3">
        <h3 id="sec-47-3">Not sorted</h3>

        <div class="outline-text-3" id="text-47-3">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; limit serving to catch infinite recursions for you before they</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">;; cause actual stack overflow in C, which would be fatal for Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(setq max-lisp-eval-depth 600)        ; 1000?</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">limit on number of Lisp variable bindings &amp; unwind-protects</span>
  (setq max-specpdl-size 3000)          <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">XEmacs 21.5.29</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">speed up things by preventing garbage collections</span>
  (setq gc-cons-threshold 3500000)      <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">make Gnus fast</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">from (info "(gnus)FAQ 9-2")</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">don't display messages at start and end of garbage collection (as it hides</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">too many interesting messages)</span>
  (setq garbage-collection-messages nil)
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-47-4" class="outline-3">
        <h3 id="sec-47-4">Variables</h3>

        <div class="outline-text-3" id="text-47-4">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 48.3 (info "(emacs)Variables")</span>

  (leuven--section <span class="org-string">"48.3 (emacs)Variables"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">file local variables specifications are obeyed, without query --</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">RISKY!</span>
  (setq enable-local-variables t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">obey `</span><span class="org-comment"><span class=
"org-constant">eval</span></span><span class=
"org-comment">' variables -- RISKY!</span>
  (setq enable-local-eval t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">record safe values for some local variables</span>
  (setq safe-local-variable-values
        '((TeX-master . t)
          (ac-sources . (ac-source-words-in-buffer ac-source-dictionary))
          (flycheck-emacs-lisp-initialize-packages . t)
          (flyspell-mode . -1)
          (flyspell-mode . 1)
          (ispell-local-dictionary . <span class=
"org-string">"american"</span>)
          (ispell-local-dictionary . <span class=
"org-string">"francais"</span>)
          (org-tags-column . -80)       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">org-issues.org</span>
          (outline-minor-mode)
          (whitespace-style face tabs spaces trailing lines
                            space-before-tab::space newline indentation::space
                            empty space-after-tab::space space-mark tab-mark
                            newline-mark)))
</pre>
          </div>

          <p>Have a look at (info "(emacs)Directory Variables”).</p>
        </div>
      </div>

      <div id="outline-container-sec-47-5" class="outline-3">
        <h3 id="sec-47-5">Key Bindings</h3>

        <div class="outline-text-3" id="text-47-5">
          <p>The keys <code>C-c LETTER</code> are <a href=
          "http://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html">
          reserved for user functions</a>.</p>

          <p>You can get a list of all the disabled functions by typing:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
M-: (<span class="org-keyword">let</span> (lst) (mapatoms (<span class=
"org-keyword">lambda</span> (x) (<span class=
"org-keyword">if</span> (get x 'disabled) (push x lst)))) lst) &lt;RET&gt;
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 48.4 Customizing (info "(emacs)Key Bindings")</span>

  (leuven--section <span class=
"org-string">"48.4 Customizing (emacs)Key Bindings"</span>)
</pre>
          </div>

          <p>See as well Print keybindings (pkb).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">print the key bindings in a tabular form</span>
  (GNUEmacs
   (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-keytable</span> (arg)
     <span class="org-doc">"Print the key bindings in a tabular form."</span>
     (interactive <span class="org-string">"sEnter a modifier string:"</span>)
     (<span class="org-keyword">with-output-to-temp-buffer</span> <span class=
"org-string">"*Key table*"</span>
       (<span class="org-keyword">let*</span> ((i 0)
              (keys (list <span class="org-string">"a"</span> <span class=
"org-string">"b"</span> <span class="org-string">"c"</span> <span class=
"org-string">"d"</span> <span class="org-string">"e"</span> <span class=
"org-string">"f"</span> <span class="org-string">"g"</span> <span class=
"org-string">"h"</span> <span class="org-string">"i"</span> <span class=
"org-string">"j"</span> <span class="org-string">"k"</span> <span class=
"org-string">"l"</span>
                          <span class="org-string">"m"</span> <span class=
"org-string">"n"</span> <span class="org-string">"o"</span> <span class=
"org-string">"p"</span> <span class="org-string">"q"</span> <span class=
"org-string">"r"</span> <span class="org-string">"s"</span> <span class=
"org-string">"t"</span> <span class="org-string">"u"</span> <span class=
"org-string">"v"</span> <span class="org-string">"w"</span> <span class=
"org-string">"x"</span>
                          <span class="org-string">"y"</span> <span class=
"org-string">"z"</span> <span class=
"org-string">"&lt;return&gt;"</span> <span class=
"org-string">"&lt;down&gt;"</span> <span class=
"org-string">"&lt;up&gt;"</span> <span class=
"org-string">"&lt;right&gt;"</span>
                          <span class=
"org-string">"&lt;left&gt;"</span> <span class=
"org-string">"&lt;home&gt;"</span> <span class=
"org-string">"&lt;end&gt;"</span> <span class=
"org-string">"&lt;f1&gt;"</span> <span class=
"org-string">"&lt;f2&gt;"</span> <span class="org-string">"&lt;f3&gt;"</span>
                          <span class=
"org-string">"&lt;f4&gt;"</span> <span class=
"org-string">"&lt;f5&gt;"</span> <span class=
"org-string">"&lt;f6&gt;"</span> <span class=
"org-string">"&lt;f7&gt;"</span> <span class=
"org-string">"&lt;f8&gt;"</span> <span class="org-string">"&lt;f9&gt;"</span>
                          <span class=
"org-string">"&lt;f10&gt;"</span> <span class=
"org-string">"&lt;f11&gt;"</span> <span class=
"org-string">"&lt;f12&gt;"</span> <span class=
"org-string">"1"</span> <span class="org-string">"2"</span> <span class=
"org-string">"3"</span> <span class="org-string">"4"</span> <span class=
"org-string">"5"</span> <span class="org-string">"6"</span>
                          <span class="org-string">"7"</span> <span class=
"org-string">"8"</span> <span class="org-string">"9"</span> <span class=
"org-string">"0"</span> <span class="org-string">"`"</span> <span class=
"org-string">"~"</span> <span class="org-string">"!"</span> <span class=
"org-string">"@"</span> <span class="org-string">"#"</span> <span class=
"org-string">"$"</span> <span class="org-string">"%"</span> <span class=
"org-string">"^"</span>
                          <span class="org-string">"&amp;"</span> <span class=
"org-string">"*"</span> <span class="org-string">"("</span> <span class=
"org-string">")"</span> <span class="org-string">"-"</span> <span class=
"org-string">"_"</span> <span class="org-string">"="</span> <span class=
"org-string">"+"</span> <span class="org-string">"\\"</span> <span class=
"org-string">"|"</span> <span class="org-string">"{"</span> <span class=
"org-string">"["</span>
                          <span class="org-string">"]"</span> <span class=
"org-string">"}"</span> <span class="org-string">";"</span> <span class=
"org-string">"'"</span> <span class="org-string">":"</span> <span class=
"org-string">"\""</span> <span class="org-string">"&lt;"</span> <span class=
"org-string">"&gt;"</span> <span class="org-string">","</span> <span class=
"org-string">"."</span> <span class="org-string">"/"</span> <span class=
"org-string">"?"</span>
                          ))
              (n (length keys))
              (modifiers (list <span class="org-string">""</span> <span class=
"org-string">"S-"</span> <span class="org-string">"C-"</span> <span class=
"org-string">"M-"</span> <span class="org-string">"M-C-"</span>))
              (k))
         (or (string= arg <span class=
"org-string">""</span>) (setq modifiers (list arg)))
         (setq k (length modifiers))
         (princ (format <span class=
"org-string">" %-10.10s |"</span> <span class="org-string">"Key"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class=
"org-string">" %-28.28s |"</span> (nth j modifiers)))
             (setq j (1+ j))))
         (princ <span class="org-string">"\n"</span>)
         (princ (format <span class=
"org-string">"_%-10.10s_|"</span> <span class=
"org-string">"__________"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class="org-string">"_%-28.28s_|"</span>
                            <span class=
"org-string">"_______________________________"</span>))
             (setq j (1+ j))))
         (princ <span class="org-string">"\n"</span>)
         (<span class="org-keyword">while</span> (&lt; i n)
           (princ (format <span class=
"org-string">" %-10.10s |"</span> (nth i keys)))
           (<span class="org-keyword">let</span> ((j 0))
             (<span class="org-keyword">while</span> (&lt; j k)
               (<span class="org-keyword">let*</span> ((binding
                       (key-binding (read-kbd-macro
                                     (concat (nth j modifiers)
                                             (nth i keys)))))
                      (binding-string <span class="org-string">"_"</span>))
                 (<span class="org-keyword">when</span> binding
                   (<span class=
"org-keyword">if</span> (eq binding 'self-insert-command)
                       (setq binding-string (concat <span class=
"org-string">"'"</span> (nth i keys) <span class="org-string">"'"</span>))
                     (setq binding-string (format <span class=
"org-string">"%s"</span> binding))))
                 (setq binding-string
                       (substring binding-string 0
                                  (min (length binding-string) 28)))
                 (princ (format <span class=
"org-string">" %-28.28s |"</span> binding-string))
                 (setq j (1+ j)))))
           (princ <span class="org-string">"\n"</span>)
           (setq i (1+ i)))
         (princ (format <span class=
"org-string">"_%-10.10s_|"</span> <span class=
"org-string">"__________"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class="org-string">"_%-28.28s_|"</span>
                            <span class=
"org-string">"_______________________________"</span>))
             (setq j (1+ j))))))
     (delete-window)
     (setq truncate-lines t)))
</pre>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-47-6" class="outline-3">
        <h3 id="sec-47-6">Syntax Table</h3>

        <div class="outline-text-3" id="text-47-6">
          <p>The syntax table contains information that tells Emacs how to
          operate on text, words, sentences etc. It will make Emacs know enough
          about all the symbols in a buffer. Syntax table is used for example
          for:</p>

          <ul class="org-ul">
            <li>commands like <code>forward-word</code> (<code>M-f</code>) or
            <code>backward-kill-word</code> (<code>M-DEL</code>),</li>

            <li>spell-checking of words,</li>

            <li>expansion commands of abbrevs,</li>

            <li>etc.</li>
          </ul>

          <p>Evaluate <code>current-word</code> and see whether characters such
          as <code>-</code> and <code>_</code> are considered part of the word
          (depending on the current major mode).</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 48.5 The (info "(emacs)Syntax") Table</span>

  (leuven--section <span class=
"org-string">"48.5 The (emacs)Syntax Table"</span>)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">now '-' is not considered a word-delimiter</span>
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">(add-hook 'emacs-lisp-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class=
"org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;             </span><span class=
"org-comment">(modify-syntax-entry ?- "w")))</span>
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter 48 ends here</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-48" class="outline-2">
      <h2 id="sec-48">Emacs Display</h2>

      <div class="outline-text-2" id="text-48">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Emacs Display</span>

(leuven--chapter leuven-chapter-XX-emacs-display <span class=
"org-string">"XX Emacs Display"</span>
</pre>
        </div>
      </div>

      <div id="outline-container-sec-48-1" class="outline-3">
        <h3 id="sec-48-1">Faces</h3>

        <div class="outline-text-3" id="text-48-1">
          <p>You can get text properties of any char by typing <code>C-u C-x
          =</code>.</p>

          <p>Under Windows, you can get the current <b>font</b> by typing
          <code>(w32-select-font)</code> followed by <code>C-x C-e</code>.</p>

          <p>You can find the current <b>font string</b> by typing <code>M-x
          ielm &lt;RET&gt; (frame-parameters) &lt;RET&gt;</code> – see the line
          <code>font</code>.</p>

          <p>To check if some font is available in Emacs do following:</p>

          <ol class="org-ol">
            <li>
              <p>Switch to the <code>*scratch*</code> buffer.</p>
            </li>

            <li>
              <p>Type</p>

              <p><code>(prin1-to-string (x-list-fonts "font-you-want-to-check
              or pattern"))</code></p>
            </li>

            <li>
              <p>Place the cursor after the last closing paren and hit
              <code>C-j</code>. List of the names of available fonts matching
              given pattern will appear in the current buffer
              (<code>*scratch*</code>).</p>
            </li>

            <li>
              <p>For listing of all available fonts, use</p>

              <p><code>(prin1-to-string (x-list-fonts "*"))</code></p>

              <p>or</p>

              <p><code>(dolist (i (x-list-fonts "*")) (princ i)
              (terpri))</code></p>

              <p>for a better output.</p>
            </li>
          </ol>

          <p>Under Linux, use the <code>xfontsel</code> utility (or the
          command-line <code>xlsfonts</code>) to try out different fonts. After
          choosing a font, click the select button in <code>xfontsel</code>
          window. This will copy font name you choose to copy &amp; paste
          buffer.</p>

          <p>Now Emacs should start with that font.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** (info "(elisp)Faces")</span>

  (leuven--section <span class="org-string">"Faces"</span>)
</pre>
          </div>

          <p>For reasons unknown to me, Emacs takes a long time to change fonts
          in an X environment.</p>

          <p>Rather than using <code>(set-default-font ...)</code> in
          <code>.emacs</code>, stick the font definition in your
          <code>.Xresources</code> file (key ‘Emacs*font’) and then use
          <code>xrdb -load</code> to activate it. You will find that startup
          time is greatly improved!</p>

          <p>Edit your <code>~/.Xresources</code> file to have a line with
          “Emacs.font”. Then do a</p>

          <p><code>xrdb -merge ~/.Xresources</code></p>

          <p>or restart your X11 to validate the modification. I let Emacs do
          this for me:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">merge-x-resources</span> ()
    (<span class=
"org-keyword">let</span> ((file (file-name-nondirectory (buffer-file-name))))
      (<span class="org-keyword">when</span> (or (string= file <span class=
"org-string">".Xdefaults"</span>)
                (string= file <span class="org-string">".Xresources"</span>))
        (start-process <span class="org-string">"xrdb"</span> nil <span class=
"org-string">"xrdb"</span> <span class=
"org-string">"-merge"</span> (buffer-file-name))
        (message (format <span class=
"org-string">"Merged %s into X resource database"</span> file)))))

  (add-hook 'after-save-hook 'merge-x-resources)
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">allow any scalable font</span>
  (<span class="org-keyword">when</span> running-ms-windows
    (setq scalable-fonts-allowed t))
</pre>
          </div>
        </div>

        <div id="outline-container-sec-48-1-1" class="outline-4">
          <h4 id="sec-48-1-1">UTF-8</h4>

          <div class="outline-text-4" id="text-48-1-1">
            <p>Fonts that have a good UTF-8 coverage are:</p>

            <ul class="org-ul">
              <li>DejaVu Sans Mono</li>

              <li>DejaVu Sans</li>

              <li>FreeMono (FreeSans, FreeSerif)</li>

              <li>Monospace</li>
            </ul>

            <p>None of them has all four variants, some have regular (medium)
            and bold or light and regular, one regular and oblique.</p>
          </div>
        </div>

        <div id="outline-container-sec-48-1-2" class="outline-4">
          <h4 id="sec-48-1-2">Anti-aliasing</h4>

          <div class="outline-text-4" id="text-48-1-2">
            <p>To see if anti-aliasing is active, use <code>xmag</code> (under
            Linux) or any of the other magnifier applications. The fonts should
            have gray edges.</p>
          </div>
        </div>

        <div id="outline-container-sec-48-1-3" class="outline-4">
          <h4 id="sec-48-1-3">Adjust the height of the default face</h4>

          <div class="outline-text-4" id="text-48-1-3">
            <p>There are a few commands to adjust the font sizes:</p>

            <dl class="org-dl">
              <dt><code>C-x C-+</code></dt>

              <dd>Increase the default face height by one step.</dd>

              <dt><code>C-x C--</code></dt>

              <dd>Decrease the default face height by one step.</dd>

              <dt><code>C-x C-0</code></dt>

              <dd>Resets to defaults.</dd>
            </dl>

            <p>Those bindings are global and repeatable, e.g. <code>C-x C-+ C-+
            C-+</code>.</p>

            <div class="org-src-container">
              <pre class="src src-emacs-lisp">
)
</pre>
            </div>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-48-2" class="outline-3">
        <h3 id="sec-48-2"><a id="ID-9432da83-fa9d-4466-a4da-57f33d662bbd" name=
        "ID-9432da83-fa9d-4466-a4da-57f33d662bbd"></a>Images</h3>

        <div class="outline-text-3" id="text-48-2">
          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 38.16 (info "(elisp)Images")</span>
</pre>
          </div>

          <p>How do I get image support? See <code>image-library-alist</code>,
          a list of image types vs. external libraries needed to display
          them.</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(describe-variable 'image-library-alist)
</pre>
          </div>

          <p>If you use compiled Emacs binaries (available on the <a href=
          "http://ftp.gnu.org/gnu/emacs/windows/">GNU Website</a>), eventually,
          copy those DLLs (<code>libpng16.dll</code>, for example) from an old
          EmacsW32 installation to your Emacs <code>bin</code> directory, and
          restart Emacs for image support to be enabled.</p>

          <p>If you use Cygwin Emacs, install <code>libpng</code> via Cygwin as
          well.</p>

          <p>You can do:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(image-type-available-p 'png)
</pre>
          </div>

          <p>to check if you have <code>png</code> image support in your
          Emacs.</p>

          <p><code>image-library-alist</code> maps image type to a list of dlls
          which support it.</p>

          <p>To check all image libraries at once:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(mapcar (<span class="org-keyword">lambda</span> (elt)
          (list (car elt) (image-type-available-p (car elt))))
        dynamic-library-alist)
</pre>
          </div>

          <p>If missing image libraries bother you, read
          <code>README.W32</code> (or <code>nt/INSTALL</code>).</p>

          <p>For animated GIF (or multi-page TIFF):</p>

          <ul class="org-ul">
            <li><code>f</code> steps through image frame, and</li>

            <li><code>RET</code> animates.</li>
          </ul>

          <p>No need for ImageMagick.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-49" class="outline-2">
      <h2 id="sec-49">Calc</h2>

      <div class="outline-text-2" id="text-49">
        <p><code>C-x *</code> invokes the GNU Emacs Calculator.</p>
      </div>

      <div id="outline-container-sec-49-1" class="outline-3">
        <h3 id="sec-49-1">Introduction</h3>

        <div class="outline-text-3" id="text-49-1"></div>

        <div id="outline-container-sec-49-1-1" class="outline-4">
          <h4 id="sec-49-1-1">Basic Commands</h4>

          <div class="outline-text-4" id="text-49-1-1">
            <p>Start the Calc: <code>C-x * c</code>.</p>
          </div>
        </div>

        <div id="outline-container-sec-49-1-2" class="outline-4">
          <h4 id="sec-49-1-2">“Quick Calculator” Mode</h4>

          <div class="outline-text-4" id="text-49-1-2">
            <p>Run the Calculator in the minibuffer: <code>C-x * q</code>
            (<code>M-x quick-calc</code>).</p>
          </div>
        </div>
      </div>

      <div id="outline-container-sec-49-2" class="outline-3">
        <h3 id="sec-49-2">Embedded Mode</h3>

        <div class="outline-text-3" id="text-49-2">
          <p>Try the Embedded mode of Calc: <code>C-x * e</code> (no need to
          mark the region).</p>

          <p>Similar commands: in place of <code>e</code>,</p>

          <dl class="org-dl">
            <dt><code>w</code></dt>

            <dd>Start Embedded mode on the current “word”.</dd>

            <dt><code>j</code></dt>

            <dd>Operate on <b>assignments</b>.</dd>
          </dl>

          <p>You need to type <code>C-x * e</code> again to exit the Embedded
          mode.</p>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-50" class="outline-2">
      <h2 id="sec-50">IRC client for Emacs</h2>

      <div class="outline-text-2" id="text-50">
        <p>See <a href="http://en.wikipedia.org/wiki/List_of_IRC_commands">List
        of Internet Relay Chat commands</a>:</p>

        <ul class="org-ul">
          <li><code>/whois</code></li>

          <li><code>/leave</code></li>
        </ul>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Emacs IRC client</span>

<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Other IRC for Emacs: rcirc, circe, bitlbee, liece, riece, zenirc, erc</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Circe is advised by Tassilo (contributor)</span>

  (autoload 'circe <span class="org-string">"circe"</span>
    <span class="org-doc">"Connect to an IRC server."</span> t)

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">connect to the Freenode network</span>
  (<span class="org-keyword">defun</span> <span class=
"org-function-name">leuven-irc-connect</span> ()
    <span class="org-doc">"Connect to Freenode."</span>
    (interactive)
    (circe <span class="org-string">"irc.freenode.net"</span> <span class=
"org-string">"6667"</span> <span class="org-string">"freenode"</span>))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">... upon hitting `C-c i'</span>
  (global-set-key
    (kbd <span class="org-string">"C-c i"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'leuven-irc-connect
                       <span class=
"org-string">"irc.freenode.net:6667"</span>)))

  (<span class="org-keyword">with-eval-after-load</span> <span class=
"org-string">"circe"</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 1 Basics</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default channels to join whenever connecting to Freenode</span>
    (setq circe-server-auto-join-channels
          '((<span class="org-string">"^freenode$"</span>
             <span class="org-string">"#emacs"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#gnus"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#latex"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#ledger"</span>
             <span class="org-string">"#org-mode"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#stumpwm"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#zsh"</span>
             <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"#xemacs"</span>
             )))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 2 Reference</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 2.3 Configuration</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">default nick</span>
    (setq circe-default-nick <span class="org-string">"johndoe"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">your "real name" on IRC</span>
    (setq circe-default-realname <span class="org-string">"John Doe"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">authentication info</span>
    (setq freenode-passwd <span class="org-string">""</span>)
    (setq circe-nickserv-passwords
          `((<span class="org-string">"freenode"</span> ,freenode-passwd)))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 3 Fighting Information Overload</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 3.1 Channels</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">When other people say things in buffers that are currently buried (no</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">window is showing them), the mode line will now show you the abbreviated</span>
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">channel or nick name.  Use `C-c C-SPC' to switch to these buffers.</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 3.3 Keywords</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">list of keywords to highlight</span>
    (setq lui-highlight-keywords
          '(
            <span class="org-comment-delimiter">;; </span><span class=
"org-comment">"[</span><span class="org-comment"><span class=
"org-negation-char">^</span></span><span class=
"org-comment">&lt;]vauban"</span>
            <span class="org-string">"org"</span> <span class=
"org-string">"beamer"</span> <span class=
"org-string">"ledger"</span> <span class="org-string">"tikz"</span>))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">add IRC color support to LUI</span>
    (<span class="org-keyword">when</span> (try-require 'lui-irc-colors)
      (add-to-list 'lui-pre-output-hook 'lui-irc-colors))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** 4 Hacking and Tweaking</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">*** 4.2 Using fly spell mode</span>

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">check if `</span><span class="org-comment"><span class=
"org-constant">ispell-program-name</span></span><span class=
"org-comment">' seems correct</span>
    (<span class="org-keyword">when</span> (ispell-check-program-name)
      (setq lui-flyspell-p t)
      (setq lui-flyspell-alist '((<span class=
"org-string">"."</span> <span class="org-string">"american"</span>))))

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">** Others</span>

    (setq circe-highlight-nick-type 'occurrence)

    (<span class=
"org-keyword">when</span> (try-require 'circe-highlight-all-nicks)
      (enable-circe-highlight-all-nicks))

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">format for messages to queries or channels</span>
    (setq circe-format-self-say <span class=
"org-string">"&lt;{nick}&gt; {body}"</span>)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">truncate the buffer (at the top) if it grows too much</span>
    (setq lui-max-buffer-size 30000)

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">column at which Lui should break output</span>
    (setq lui-fill-column fill-column)

    )                                   <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">with-eval-after-load "circe" ends here</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">Jabber (GTalk)</span>
  (<span class=
"org-keyword">when</span> (try-require 'jabber-autoloads-<span class=
"org-leuven-highlight">XXX</span>)
    (setq jabber-account-list '((<span class=
"org-string">"johndoe@example.com"</span>
                                 (<span class=
"org-builtin">:network-server</span> . <span class=
"org-string">"talk.google.com"</span>)
                                 (<span class=
"org-builtin">:connection-type</span> . ssl)
                                 (<span class=
"org-builtin">:port</span> . 443))))

    (setq jabber-history-enabled t)

    (setq jabber-use-global-history nil)

    (setq jabber-history-dir <span class=
"org-string">"~/.emacs.d/jabber"</span>)

    (setq jabber-vcard-avatars-retrieve nil)

    (setq jabber-chat-buffer-show-avatar nil))
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-51" class="outline-2">
      <h2 id="sec-51">Emacs and Microsoft Windows/MS-DOS</h2>

      <div class="outline-text-2" id="text-51">
        <p>Eventually have a look as well at <code>input-decode-map</code>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* App G Emacs and (info "(emacs)Microsoft Windows/MS-DOS")</span>

(leuven--chapter leuven-chapter-AppG-ms-dos <span class=
"org-string">"Appendix G Emacs and MS-DOS"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">divide key (needed in GNU Emacs for Windows)</span>
  (GNUEmacs
    (global-set-key
      (kbd <span class=
"org-string">"&lt;kp-divide&gt;"</span>) (kbd <span class=
"org-string">"/"</span>)))

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">numeric keypad (needed in XEmacs for Windows)</span>
  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keys to the right of the regular keyboard</span>
    (define-key key-translation-map [kp-divide]     [?/])
    (define-key key-translation-map [kp-multiply]   [?*])
    (define-key key-translation-map [kp-subtract]   [?-])
    (define-key key-translation-map [kp-add]        [?+])
    (define-key key-translation-map [kp-enter]     [?\r])
    (define-key key-translation-map [kp-decimal]    [?.])

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">keys with digits</span>
    (define-key key-translation-map [kp-0]          [?0])
    (define-key key-translation-map [kp-1]          [?1])
    (define-key key-translation-map [kp-2]          [?2])
    (define-key key-translation-map [kp-3]          [?3])
    (define-key key-translation-map [kp-4]          [?4])
    (define-key key-translation-map [kp-5]          [?5])
    (define-key key-translation-map [kp-6]          [?6])
    (define-key key-translation-map [kp-7]          [?7])
    (define-key key-translation-map [kp-8]          [?8])
    (define-key key-translation-map [kp-9]          [?9])

    <span class="org-comment-delimiter">;; </span><span class=
"org-comment">additional keypad duplicates of keys ordinarily found elsewhere</span>
    (define-key key-translation-map [kp-left]     [left])
    (define-key key-translation-map [kp-right]   [right])
    (define-key key-translation-map [kp-up]         [up])
    (define-key key-translation-map [kp-down]     [down])
    (define-key key-translation-map [kp-begin]   [begin])
    (define-key key-translation-map [kp-home]     [home])
    (define-key key-translation-map [kp-end]       [end])
    (define-key key-translation-map [kp-next]     [next])
    (define-key key-translation-map [kp-prior]   [prior])
    (define-key key-translation-map [kp-insert] [insert])
    (define-key key-translation-map [kp-delete] [delete]))

)                                       <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">chapter G ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-52" class="outline-2">
      <h2 id="sec-52">Profiler</h2>

      <div class="outline-text-2" id="text-52">
        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Profiler</span>

  (setq profiler-report-cpu-line-format
    '((100 left)
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">The 100 above is increased from the</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">default of 50 to allow the deeply</span>
                                        <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">nested call tree to be seen.</span>
      (24 right ((19 right)
                 (5 right)))))
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-53" class="outline-2">
      <h2 id="sec-53">Reporting Bugs</h2>

      <div class="outline-text-2" id="text-53">
        <p>To get a backtrace when a specific regexp is displayed in the echo
        area (through calls to message), set the variable
        <code>debug-on-message</code>.</p>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Recovery from Problems</span>

<span class="org-comment-delimiter">;;</span><span class=
"org-comment">* Reporting Bugs</span>

(leuven--chapter leuven-chapter-99-debugging <span class=
"org-string">"99 Debugging"</span>

  <span class="org-comment-delimiter">;; </span><span class=
"org-comment">get the backtrace when uncaught errors occur</span>
  (setq debug-on-error nil))            <span class=
"org-comment-delimiter">; </span><span class=
"org-comment">was set to `t' at beginning of buffer</span>
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> (and (string-match <span class=
"org-string">"GNU Emacs"</span> (version))
           leuven-load-verbose)
  (ad-disable-advice 'message 'before 'leuven-when-was-that)
  (ad-update 'message))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> leuven-load-verbose
  (message <span class="org-string">"| Chapter | Time |"</span>)
  (message <span class="org-string">"|---------+------|"</span>)
  (mapcar (<span class=
"org-keyword">lambda</span> (el)                  <span class=
"org-comment-delimiter">; </span><span class="org-comment"><span class=
"org-leuven-highlight">FIXME</span></span><span class=
"org-comment"> use mapc or dolist</span>
            (message el))
          (nreverse leuven--load-times-list))
  (message <span class="org-string">"|---------+------|"</span>)
  (message <span class="org-string">"|         | =vsum(@-I..@-II) |"</span>))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(message <span class="org-string">"Loading `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'...done (in %.3f s)"</span>
         load-file-name
         (- (float-time) leuven-before-time))
(sit-for 0.3)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(<span class=
"org-keyword">let</span> ((elapsed (float-time (time-subtract (current-time)
                                          emacs-start-time))))
  (message <span class="org-string">"Loading `</span><span class=
"org-string"><span class="org-constant">%s</span></span><span class=
"org-string">'... loaded in %.3f s"</span> load-file-name elapsed))

(add-hook 'after-init-hook
          `(<span class="org-keyword">lambda</span> ()
             (<span class=
"org-keyword">let</span> ((elapsed (float-time (time-subtract (current-time)
                                                       emacs-start-time))))
               (message <span class=
"org-string">"Loading %s...done (%.3fs) [after-init]"</span>
                        ,load-file-name elapsed)))
  t)
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(message <span class=
"org-string">"Emacs initialization: %s"</span> (emacs-init-time))
</pre>
        </div>

        <div class="org-src-container">
          <pre class="src src-emacs-lisp">
(message <span class=
"org-string">"* --[ Loaded Emacs Leuven 20140828.2131]--"</span>)

(<span class="org-keyword">provide</span> '<span class=
"org-constant">emacs-leuven</span>)


<span class="org-comment-delimiter">;; </span><span class=
"org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">Local Variables:</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">coding: utf-8</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">ispell-local-dictionary: "american"</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">eval: (when (locate-library "rainbow-mode") (require 'rainbow-mode) (rainbow-mode))</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">flycheck-emacs-lisp-initialize-packages: t</span>
<span class="org-comment-delimiter">;; </span><span class=
"org-comment">End:</span>

<span class="org-comment-delimiter">;;; </span><span class=
"org-comment">emacs-leuven.el ends here</span>
</pre>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-54" class="outline-2">
      <h2 id="sec-54">Tasks</h2>

      <div class="outline-text-2" id="text-54"></div>

      <div id="outline-container-sec-54-1" class="outline-3">
        <h3 id="sec-54-1"><span class="todo TODO">TODO</span> Automate
        reporting of style errors</h3>

        <div class="outline-text-3" id="text-54-1">
          <p>Report all errors with:</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(checkdoc-current-buffer t)
</pre>
          </div>

          <ul class="org-ul">
            <li>
              <p>Format the documentation string so that it fits in an Emacs
              window on an 80-column screen. It is a good idea for most lines
              to be no wider than 60 characters. The first line should not be
              wider than 67 characters or it will look bad in the output of
              apropos.</p>

              <p>You can fill the text if that looks good. However, rather than
              blindly filling the entire documentation string, you can often
              make it much more readable by choosing certain line breaks with
              care. Use blank lines between topics if the documentation string
              is long.</p>
            </li>

            <li>
              <p>Do not indent subsequent lines of a documentation string so
              that the text is lined up in the source code with the text of the
              first line. This looks nice in the source code, but looks bizarre
              when users view the documentation.</p>

              <p>Remember that the indentation before the starting double-quote
              is not part of the string!</p>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div id="outline-container-sec-55" class="outline-2">
      <h2 id="sec-55">Startup time</h2>

      <div class="outline-text-2" id="text-55"></div>

      <div id="outline-container-sec-55-1" class="outline-3">
        <h3 id="sec-55-1">Context</h3>

        <div class="outline-text-3" id="text-55-1">
          <p>Identify what parts of your <code>.emacs</code> take so long. You
          can do this e.g. by starting Emacs with <code>emacs -q</code>, set up
          your <code>load-path</code>, and then evaluate</p>

          <div class="org-src-container">
            <pre class="src src-emacs-lisp">
(benchmark-run
  (<span class="org-keyword">require</span> '<span class=
"org-constant">some-package</span>))
</pre>
          </div>

          <p>The first number appearing in the echo area will be the time
          needed to run that command.</p>

          <p>Use autoloads, which delay the loading of the complete package
          until one of the interactive functions is used.</p>

          <p>If you want to set options which need to be evaluated after a
          package is loaded, you can use <code>eval-after-load</code>.</p>
        </div>
      </div>

      <div id="outline-container-sec-55-2" class="outline-3">
        <h3 id="sec-55-2">Timings from my system</h3>

        <div class="outline-text-3" id="text-55-2">
          <p>After much optimization…</p>

          <p>$ time emacs -f kill-emacs real 0m0.157s user 0m0.140s sys
          0m0.012s $ time emacs -q -f kill-emacs real 0m0.137s user 0m0.116s
          sys 0m0.016s $ time emacs -Q -f kill-emacs real 0m0.051s user
          0m0.028s sys 0m0.020s</p>

          <div class="org-src-container">
            <pre class="src src-sh">
<span class="org-builtin">time</span> emacs -f kill-emacs 2&gt;&amp;1
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-sh">
<span class="org-builtin">time</span> emacs -q -f kill-emacs 2&gt;&amp;1
</pre>
          </div>

          <div class="org-src-container">
            <pre class="src src-sh">
<span class="org-builtin">time</span> emacs -Q -f kill-emacs 2&gt;&amp;1
</pre>
          </div>

          <p>Note that your first test is going to be dramatically slower than
          subsequent tests.</p>
        </div>
      </div>
    </div>
  </div>

  <div id="postamble" class="status">
    <div id="footer">
      <div id="copyright">
        Copyright © Fabrice Niessen
      </div>
    </div>
  </div>
</body>
</html>
